{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-changeset", "page_type": "doc", "title": "版本说明", "keywords": "变更,OpenAPI,文档,发生,操作,2025,12", "last_modified_ms": 1743140628000, "last_modified_iso": "2025-03-28T13:43:48+08:00", "excerpt": "## 变更时间：2025-03-28变更集发布说明：\n\n[表格]\nOpenAPI 名称变更内容概要操作[DescribeContainerLog](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainerlog)OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerLog?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerLog)[DescribeContainerGroupEvents](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupevents)OpenAPI 错误码发生变更、OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupEvents?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupEvents)[DescribeContainerGroupStatus](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupstatus)OpenAPI 错误码发生变更、OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupStatus?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupStatus)[DescribeContainerGroupMetric](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupmetric)OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupMetric?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupMetric)[DescribeMultiContainerGroupMetric](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describemulticontainergroupmetric)OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeMultiContainerGroupMetric?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeMultiContainerGroupMetric)\n## 变更时间：2025-03-28变更集发布说明：\n\n[表格]\nOpenAPI 名称变更内容概要操作[DescribeContainerGroupEvents](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupevents)OpenAPI 错误码发生变更、OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupEvents?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupEvents)[DescribeContainerGroupStatus](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupstatus)OpenAPI 错误码发生变更、OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupStatus?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupStatus)[DescribeContainerGroupMetric](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupmetric)OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupMetric?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerGroupMetric)[DescribeContainerLog](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainerlog)OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerLog?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerLog)[DescribeMultiContainerGroupMetric](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describemulticontainergroupmetric)OpenAPI 返回结构发生变更。[查看变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeMultiContainerGroupMetric?updateTime=2025-03-28#workbench-doc-change-demo)[查看API文档](https://api.aliyun.com/document/Eci/2018-08-08/DescribeMultiContainerGroupMetric)\n## 变更时间：2025-01-06变更集发布说明：\n\n[表格]\nOpenAPI 名称变更内容概要操作[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)OpenAPI 错误码发生变更、OpenAPI 入参发生变更。"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-commitcontainer", "page_type": "doc", "title": "CommitContainer - 创建CommitContainer任务", "keywords": "CommitContainer,调用CommitContainer接口,查询CommitContainer参数,CommitContainer API参考,CommitContainer请求参数", "last_modified_ms": 1760669951000, "last_modified_iso": "2025-10-17T10:59:11+08:00", "excerpt": "调用CommitContainer接口创建异步任务，将ECI实例中的指定容器保存为镜像，并推送至阿里云ACR的镜像仓库中。   \n## 接口说明 \n\n调用 CommitContainer 接口前，您需要准备好 ACR 镜像仓库，然后创建 RAM 角色并完成授权操作。具体操作，请参见[提交容器生成镜像并推送到 ACR](https://help.aliyun.com/zh/eci/user-guide/commit-a-container-to-generate-an-image-and-push-the-image-to-an-image-repository-in-container-registry)。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/CommitContainer) [调试](https://api.aliyun.com/api/Eci/2018-08-08/CommitContainer)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:CommitContainer   \n\ncreate   \n\n*CommitContainerTask \n\nacs:eci:{#regionId}:{#accountId}:containergroup/*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\n要创建 CommitContainer 任务的 ECI 实例。   \n\neci-bp1do4xz75fa5sd****     ContainerName   \n\nstring   \n\n 是    \n\n要制作镜像的容器的名称。   \n\ncontainer-1      Image   \n\nobject   \n\n 否    \n\n容器镜像信息。   \n\n     Repository   \n\nstring   \n\n 是    \n\nACR 镜像仓库地址。\n 出于安全考虑，目前仅支持将镜像推送（Push）至 ACR。   \n\nregistry-vpc.cn-beijing.aliyuncs.com/test/test-****     Tag   \n\nstring   \n\n 是    \n\n镜像标签。默认为空，代表不修改标签。   \n\n0.0.6     Message   \n\nstring   \n\n 否    \n\n镜像的说明信息。   \n\ntest commit     Author   \n\nstring   \n\n 否    \n\n镜像的 authorization。   \n\nalice      AcrRegistryInfo   \n\nobject   \n\n 否    \n\nACR 企业版实例的访问凭证配置信息。 说明  \n\n使用 ACR 个人版实例时无需配置该参数；使用 ACR 企业版实例时必须配置该参数。    \n\n     InstanceId   \n\nstring   \n\n 否    \n\nACR 企业版实例 ID。   \n\ncri-nwj395hgf6f3****     RegionId   \n\nstring   \n\n 否    \n\nACR 企业版实例所属的地域。   \n\ncn-hangzhou     ArnService   \n\nstring   \n\n 否    \n\n跨账号授权场景下，使用者（被授权者）的 RAM 角色 ARN。   \n\nacs:ram::1609982529******:role/role-test     ArnUser   \n\nstring   \n\n 否    \n\n跨账号授权场景下，授权者的 RAM 角色 ARN。   \n\nacs:ram::1298452580******:role/role-test      Arn   \n\nobject   \n\n 否    \n\n授权需要的 ARN 信息。   \n\n     RoleArn   \n\nstring   \n\n 否    \n\n授权角色的 ARN。   \n\nacs:ram:xxx     RoleType   \n\nstring   \n\n 否    \n\n授权类型。可配置为 service，表示使用 RAM 角色进行授权。   \n\nservice       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\nCB8D2B22-D636-4182-****-1FC9DBDAD66F     TaskId   \n\nstring   \n\n任务 ID。   \n\nt-bp18cwvrb3v9tjk0tekz       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"CB8D2B22-D636-4182-****-1FC9DBDAD66F\",\n  \"TaskId\": \"t-bp18cwvrb3v9tjk0tekz\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   InvalidParameter   %s   不合法的参数     403   InvalidVolumeType   The specified volumeName is invalid, only volume of cloud disk support capacity resize        403   IncorrectStatusDetail   %s        403   InvalidAction   The specified action is invalid         \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/CommitContainer#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-copydatacache", "page_type": "doc", "title": "CopyDataCache - 拷贝数据缓存", "keywords": "CopyDataCache,跨地域拷贝数据缓存,查询CopyDataCache参数,CopyDataCache API参考,CopyDataCache请求参数,CopyDataCache错误码", "last_modified_ms": 1760671204000, "last_modified_iso": "2025-10-17T11:20:04+08:00", "excerpt": "将数据缓存从一个地域拷贝到另一个地域。   \n## 接口说明 \n\n数据缓存不支持直接跨地域使用，通过本接口可以将数据缓存从一个地域拷贝到另一个地域。该接口适用于以下场景： \n \n- \n\n需要在多个地域使用数据缓存，在 A 地域已有数据缓存的情况，可以通过本接口快速拷贝到 B 地域。 \n- \n\n对于中国内地地域的用户，创建数据缓存时如果直接拉取国外地址的数据，可能会因为网络限制导致数据拉取过慢，此时可以先在非中国内地的地域（例如中国香港）创建数据缓存，然后通过本接口拷贝到中国内地地域。 \n 重要  拷贝数据缓存的过程相当于复制快照，费用涉及复制过程产生的流量费用以及最终生成的数据缓存的存储费用。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/CopyDataCache) [调试](https://api.aliyun.com/api/Eci/2018-08-08/CopyDataCache)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:CopyDataCache   \n\ncreate   \n\n*DataCache \n\nacs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n已有数据缓存所在地域。   \n\ncn-beijing     RegionId   \n\nstring   \n\n 是    \n\n已有数据缓存所在地域。   \n\ncn-beijing     Bucket   \n\nstring   \n\n 否    \n\n数据缓存 Bucket。   \n\ndefault     Path   \n\nstring   \n\n 否    \n\n数据缓存路径   \n\n/bucket-test     Name   \n\nstring   \n\n 否    \n\n数据缓存名称。   \n\ntest     RetentionDays   \n\ninteger   \n\n 否    \n\n数据缓存保留天数。   \n\n7      Tag   \n\narray<object>   \n\n 否    \n\n数据缓存标签列表。   \n\n         \n\nobject   \n\n 否    \n\n数据缓存标签列表。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\ntestkey     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntestvalue     ResourceGroupId   \n\nstring   \n\n 否    \n\n数据缓存所属资源组 。   \n\nrg-2df3isufhi38****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000      DataCacheId   \n\nstring   \n\n 是    \n\n数据缓存 ID。   \n\nedc-bp15l4vvys94oo******      DestinationRegionId   \n\nstring   \n\n 是    \n\n要拷贝到的目的地域。   \n\ncn-hangzhou       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject   \n\n返回参数列表。   \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n58EE0CB3-C864-5395-A4F7-24F425074839     DataCacheId   \n\nstring   \n\n拷贝到新的地域后，生成的数据缓存 ID。   \n\nedc-bp1423y6d7v7l6ua****       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"58EE0CB3-C864-5395-A4F7-24F425074839\",\n  \"DataCacheId\": \"edc-bp1423y6d7v7l6ua****\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   Account.Arrearage   Your account has an outstanding payment.   账号已经欠费。     400   DryRunOperation   Request validation has been passed with DryRun flag set.   此次DryRun预检请求合格。     400   InvalidParameter.CPU.Memory   The specified cpu and memory are not allowed        400   IncorrectStatus   %s   指定的实例状态不正确。     400   ServiceNotEnabled   %s   该次请求所依赖的服务没有开通，请开通后再试。     400   DiskVolume.NotSupport   The disk volume is not supported.   云盘卷暂不支持，如有需要请联系我们。     400   RamRole.NotSupport   The RAM role is not supported.   ram实例角色不支持。     400   ImageCache.IncorrectStatus   %s   镜像缓存当前的状态不对。     400   ImageCacheNotSupport   Image cache is not available for all users. If you want to enable this function, contact us.   镜像缓存功能还未全网开放，如果有需要请联系我们。     400   EipAddressPoolIpNotEnough   The ip address of specified PublicIpAddressPool is not enough.   指定的eip公网地址池地址资源不足。     403   OperationDenied.VswZoneMisMatch   The specified VSwitchId is not in the specified Zone.        403   QuotaExceeded   %s quota exceeded.        403   Zone.NotOnSale   The specified zone is not available for purchase.   创建实例的可用区已经关闭售卖，请更换其他可用区。或者无法在该可用区使用指定 VPC 的虚拟交换机。     403   Forbidden.RiskControl   This operation has been identified as an abnormal operation and cannot be processed.   此操作已被确定为一个操作异常，无法处理。     403   Forbidden.SubUser   The specified action is not available for you.        403   Forbidden.OnlyForInvitedTest   Eci create action is only "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup", "page_type": "doc", "title": "CreateContainerGroup - 创建一个容器组", "keywords": "CreateContainerGroup,调用CreateContainerGroup,查CreateContainerGroup参数,CreateContainerGroup API参考,CreateContainerGroup请求参数,CreateContainerGroup错误码", "last_modified_ms": 1767082034000, "last_modified_iso": "2025-12-30T16:07:14+08:00", "excerpt": "调用CreateContainerGroup创建一个ECI实例（即容器组）。   \n## 接口说明 \n\n调用 CreateContainerGroup 创建 ECI 实例时，系统将自动为您创建一个服务关联角色 AliyunServiceRoleForECI，用于访问 ECS、VPC 等相关云服务。更多信息，请参见[弹性容器实例服务关联角色](https://help.aliyun.com/zh/eci/security-and-compliance/elastic-container-instance-service-linked-role)。 \n\n创建 ECI 实例时，您可以根据需要配置实例、镜像、存储等相关功能。各功能涉及的参数及其说明，请参见以下功能文档： \n\n实例 \n\nECI 支持以下两种方式创建实例： \n \n- \n\n[指定 vCPU 和内存创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-an-elastic-container-instance) \n- \n\n[指定 ECS 规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/) \n \n\n以下功能两种创建方式均支持： \n \n- \n\n[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance) \n- \n\n[配置多可用区](https://help.aliyun.com/zh/eci/user-guide/specify-multiple-zones-to-create-an-elastic-container-instance) \n- \n\n[配置多规格](https://help.aliyun.com/zh/eci/user-guide/specify-multiple-specifications-to-create-an-elastic-container-instance) \n- \n\n[使用标签管理实例](https://help.aliyun.com/zh/eci/user-guide/use-tags-to-manage-elastic-container-instances) \n \n\n镜像 \n \n- \n\n[配置容器镜像](https://help.aliyun.com/zh/eci/user-guide/configure-a-container-image) \n- \n\n[使用镜像缓存加速创建实例](https://help.aliyun.com/zh/eci/user-guide/use-the-image-cache-feature-to-accelerate-the-creation-of-an-elastic-container-instance) \n- \n\n[指定 ACR 企业版实例](https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret-2) \n- \n\n[使用自建镜像仓库](https://help.aliyun.com/zh/eci/user-guide/use-self-managed-image-repositories) \n \n\n网络 \n \n- \n\n[绑定 EIP](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access) \n- \n\n[指定安全组](https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-2) \n- \n\n[配置 IPv6 地址](https://help.aliyun.com/zh/eci/user-guide/assign-an-ipv6-address-to-an-elastic-container-instance-1) \n- \n\n[配置带宽限速](https://help.aliyun.com/zh/eci/user-guide/limit-the-bandwidth-of-an-elastic-container-instance) \n \n\n存储 \n \n- \n\n[挂载云盘数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-disk-volume) \n- \n\n[挂载 NAS 数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-nas-volume) \n- \n\n[挂载 OSS 数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-an-oss-bucket-to-an-elastic-container-instance-as-a-volume) \n- \n\n[挂载 EmptyDir 数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-an-emptydir-volume) \n- \n\n[挂载 ConfigFile 数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-configfile-volume) \n- \n\n[自定义临时存储空间大小](https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space-1) \n \n\n容器配置 \n \n- \n\n[设置容器启动命令和参数](https://help.aliyun.com/zh/eci/user-guide/configure-startup-commands-and-arguments-for-a-container) \n- \n\n[使用探针对容器进行健康检查](https://help.aliyun.com/zh/eci/user-guide/use-probes-to-perform-health-checks-on-containers) \n- \n\n[通过环境变量获取元数据](https://help.aliyun.com/zh/eci/user-guide/obtain-the-metadata-from-a-container) \n- \n\n[配置 Security Context](https://help.aliyun.com/zh/eci/user-guide/configure-a-security-context-for-an-elastic-container-instance-or-a-container) \n- \n\n[配置 NTP 服务](https://help.aliyun.com/zh/eci/user-guide/configure-the-ntp-service) \n \n\n日志与运维 \n \n- \n\n[通过环境变量配置日志采集](https://help.aliyun.com/zh/eci/user-guide/configure-log-collection-for-an-elastic-container-instance) \n- \n\n[设置 core 文件保存到数据卷](https://help.aliyun.com/zh/eci/user-guide/use-coredump-to-analyze-instance-program-exceptions-1) \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/CreateContainerGroup) [调试](https://api.aliyun.com/api/Eci/2018-08-08/CreateContainerGroup)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache", "page_type": "doc", "title": "CreateDataCache - 创建数据缓存", "keywords": "CreateDataCache,调用CreateDataCache接口,查询CreateDataCache参数,CreateDataCache API参考,CreateDataCache请求参数,CreateDataCache错误码", "last_modified_ms": 1760669960000, "last_modified_iso": "2025-10-17T10:59:20+08:00", "excerpt": "创建一个数据缓存。   \n## 接口说明 \n \n- \n\n创建镜像缓存涉及资源计费。建议您提前了解相关计费信息。更多信息，请参见[数据缓存计费](https://help.aliyun.com/zh/eci/product-overview/data-cache-billing)。 \n- \n\n创建镜像缓存前，您需要评估待缓存数据的大小，如果数据大小超过设置的缓存大小，将会创建失败。 \n- \n\n创建数据缓存时，系统将自动创建一个 ECI 实例和一块 ESSD 云盘用于中转创建数据缓存。创建过程中请勿删除 ECI 实例和云盘，否则数据缓存将创建失败。 \n- \n\n创建数据缓存将生成对应的快照。请勿删除快照，否则数据缓存将会失效。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/CreateDataCache) [调试](https://api.aliyun.com/api/Eci/2018-08-08/CreateDataCache)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:CreateDataCache   \n\ncreate   \n\n*DataCache \n\nacs:eci:{#regionId}:{#accountId}:datacache/*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     SecurityGroupId   \n\nstring   \n\n 否    \n\n创建数据缓存过程中生成的 ECI 实例所属的安全组 ID。   \n\nsg-2ze81zoc3yl7a3we****     VSwitchId   \n\nstring   \n\n 否    \n\n创建数据缓存过程中生成的 ECI 实例所属的交换机 ID。   \n\nvsw-bp1jrgfqqy54kg5hc****     Bucket   \n\nstring   \n\n 否    \n\n数据的存储空间。默认为 default。支持自定义，以便进行业务分组和避免路径冲突。 说明  \n\neci-system 为 ECI 保留空间，不可使用。    \n\ndefault     Path   \n\nstring   \n\n 否    \n\n数据存储的路径。   \n\n/model/test     Name   \n\nstring   \n\n 否    \n\n数据缓存名称。   \n\ntest     Size   \n\ninteger   \n\n 否    \n\n数据缓存大小。单位为 GiB，默认为 20 GiB。请根据实际数据量评估所需大小。   \n\n30      DataSource   \n\nobject   \n\n 否    \n\n数据源。   \n\n     Type   \n\nstring   \n\n 否    \n\n数据源类型。取值范围： \n \n- \n\nURL \n- \n\nNAS \n- \n\nOSS \n- \n\nSNAPSHOT \n  \n\n枚举值： \n \n- NAS : \n\nNAS \n- SNAPSHOT : \n\nSNAPSHOT \n- URL : \n\nURL \n- OSS : \n\nOSS \n    \n\nURL      Options   \n\nobject   \n\n 否    \n\n数据源的配置参数。   \n\n        \n\nstring   \n\n 否    \n\n数据源的配置参数。不同类型数据源要传入的参数不同。各类型数据源及其配置参数说明，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches)。   \n\n{ \"#10#repoSource\": \"HuggingFace/Model\", \"#6#repoId\": \"stabilityai/stable-diffusion-2-1\" }     RetentionDays   \n\ninteger   \n\n 否    \n\n保留天数。过期会被清理。默认不过期。   \n\n7      Tag   \n\narray<object>   \n\n 否    \n\n数据缓存绑定的标签列表。   \n\n         \n\nobject   \n\n 否    \n\n数据缓存绑定的标签列表。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\ntestkey     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntestvalue     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-2df3isufhi38****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-****-12d3-****-426655440000     EipInstanceId   \n\nstring   \n\n 否    \n\n绑定已有的弹性公网 IP（EIP）。 如果 VPC 没有配置 NAT 网关，可以绑定 EIP，以便拉取公网数据。   \n\neip-uf66jeqopgqa9hdn****      EipCreateParam   \n\nobject   \n\n 否    \n\n创建一个弹性公网 IP（EIP）并绑定。 如果 VPC 没有配置 NAT 网关，可以绑定 EIP，以便拉取公网数据。   \n\n     Bandwidth   \n\ninteger   \n\n 否    \n\nEIP 带宽。单位为 Mbps。默认为 5 Mbps。   \n\n10     CommonBandwidthPackage   \n\nstring   \n\n 否    \n\n绑定已有的共享带宽包。   \n\ncbwp-2zeukbj916scmj51m****     InternetChargeType   \n\nstring   \n\n 否    \n\nEIP 的计量方式。取值范围： \n \n- \n\nPayByBandwidth：按带宽计费 \n- \n\nPayByTraffic：按流量计费 \n   \n\nPayByTraffic     PublicIpAddressPoolId   \n\nstring   \n\n 否    \n\nIP 地址池 ID。 EIP 将从该 IP 地址池中分配。 IP 地址池功能默认不开放。如需使用，请在配额中心申请 IP 地址池功能权益配额。   \n\npippool-2vc4xdtjhwl4t0go5****     ISP   \n\nstring   \n\n 否    \n\nEIP 的线路类型。取值范围： \n \n- \n\nBGP（默认值）：BGP（多线）线路 \n- \n\nBGP_PRO：BGP（多线）精品线路 \n   \n\nBGP       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\nD81A4A13-6DCC-4579-AC62-90A6C3EC7BBC     DataCacheId   \n\nstring   \n\n数据缓存 ID。   \n\nedc-bp15l4vvys94oo******       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"D81A4A13-6DCC-4579-AC62-90A6C3EC7BBC\",\n  \"DataCacheId\": \"edc-bp15l4vvys94oo******\"\n}\n\n   "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createimagecache", "page_type": "doc", "title": "CreateImageCache - 创建一个镜像缓存", "keywords": "CreateImageCache,创建镜像缓存,调用CreateImageCache,查CreateImageCache参数,CreateImageCache参数,CreateImageCache错误码,CreateImageCache用法", "last_modified_ms": 1760672136000, "last_modified_iso": "2025-10-17T11:35:36+08:00", "excerpt": "调用CreateImageCache接口创建一个镜像缓存，以便后续创建ECI实例可以加速镜像拉取，减少实例启动耗时。   \n## 接口说明 \n### 注意事项 \n \n- \n\n创建镜像缓存涉及资源计费。建议您提前了解相关计费信息。更多信息，请参见[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches)。 \n- \n\n创建镜像缓存前，您需要评估待缓存镜像的总大小，如果镜像总大小超过设置的缓存大小，将会创建失败。 \n- \n\n创建镜像缓存时，系统将自动创建一个 ECI 实例和一块 ESSD PL1 类型的云盘用于中转创建镜像缓存。创建过程中请勿删除 ECI 实例和云盘，否则镜像缓存将创建失败。 \n- \n\n创建镜像缓存将生成对应的快照。请勿删除快照，否则镜像缓存将会失效。 \n- \n\n如果使用 SDK，则对应版本为：Java 1.0.10 以上，Python 1.0.7 以上。 \n \n### 使用建议 \n \n- \n\n对于使用自定义域名的 ACR 企业版镜像，需要指定 ACR 实例（设置 AcrRegistryInfo 相关参数）来配置免密。设置 AcrRegistryInfo 相关参数时，必须设置 AcrRegistryInfo.N.InstanceId。 \n- \n\n如果该镜像缓存将用于批量创建多个（超过 1000 个）ECI 实例，建议您设置 StandardCopyCount 和 FlashCopyCount 实现快照多副本功能。快照多副本按增量数据收费，由于本次创建的多个快照副本数据均一致，因此使用快照多副本功能不会增加额外费用。 \n 说明  \n\n调用 CreateImageCache 创建镜像缓存时，系统将自动为您创建一个服务关联角色 AliyunServiceRoleForECI，用于访问 ECS、VPC 等相关云服务。更多信息，请参见[弹性容器实例服务关联角色](https://help.aliyun.com/zh/eci/security-and-compliance/elastic-container-instance-service-linked-role)。    \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/CreateImageCache) [调试](https://api.aliyun.com/api/Eci/2018-08-08/CreateImageCache)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:CreateImageCache   \n\ncreate   \n\n*ImageCache \n\nacs:eci:{#regionId}:{#accountId}:imagecache/*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ZoneId   \n\nstring   \n\n 否    \n\n可用区。   \n\ncn-hangzhou-g     SecurityGroupId   \n\nstring   \n\n 否    \n\n安全组 ID。   \n\nsg-uf66jeqopgqa9hdn****     VSwitchId   \n\nstring   \n\n 否    \n\n交换机 ID。支持指定多个交换机 ID（单次最多 10 个），各交换机 ID 之间可以用半角逗号（,）进行分割，例如vsw-***,vsw-***。   \n\nvsw-uf6h3rbwbm90urjwa****     ImageCacheName   \n\nstring   \n\n 是    \n\n镜像缓存名称。   \n\ntestcache     EipInstanceId   \n\nstring   \n\n 否    \n\n弹性公网 IP。如果需要拉取公网镜像，需要确保 ECI 实例能够访问公网，您可以配置 EIP 或者 NAT 网关实现公网访问。   \n\neip-2zedsm5mfl3uhdj2d****     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-aekzh43v*****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-xxx-xxx-xxxx-42665544xxxx     ImageCacheSize   \n\ninteger   \n\n 否    \n\n镜像缓存的大小。默认为 20 GiB。   \n\n20     RetentionDays   \n\ninteger   \n\n 否    \n\n镜像缓存保留时间，过期将会被清理，默认永不过期。 说明  \n\n创建失败的镜像缓存仅保留一天。    \n\n7     AutoMatchImageCache   \n\nboolean   \n\n 否    \n\n是否开启镜像缓存复用。开启后，新创建的镜像缓存可以复用已有镜像缓存的镜像层，加快镜像缓存的制作速度。取值范围： \n \n-  \n\ntrue：开启  \n-  \n\nfalse：不开启  \n \n\n默认为 false。   \n\ntrue      ImageRegistryCredential   \n\narray<object>   \n\n 否    \n\n镜像仓库信息。   \n\n         \n\nobject   \n\n 否    \n\n镜像仓库信息。   \n\n     Password   \n\nstring   \n\n 否    \n\n镜像仓库密码。   \n\npassword     Server   \n\nstring   \n\n 否    \n\n不带 http:// 或 https:// 前缀的镜像仓库地址。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com     UserName   \n\nstring   \n\n 否    \n\n镜像仓库用户名。   \n\nusername      Image   \n\narray   \n\n 是    \n\n用于制作镜像缓存的容器镜像。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl        \n\nstring   \n\n 否    \n\n用于制作镜像缓存的容器镜像。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl      Tag   \n\narray<object>   \n\n 否    \n\n镜像缓存标签信息，最多 20 个。   \n\n         \n\nobject   \n\n 否    \n\n镜像缓存标签信息，最多 20 个。   \n\n     Key   \n\nstring   \n\n 否    \n\n镜像缓存标签键。   \n\nimc     Value   \n\nstring   \n\n 否    \n\n镜像缓存标签值。   \n\ntest     Flash   \n\nboolean   \n\n 否    \n\n是否开启极速镜像缓存功能，开启后，可以加速镜像缓存创建。取值范围： \n \n-  \n\ntrue：开启  \n-  \n\nfalse：不开启  \n \n\n默认为 false。   \n\ntrue      AcrRegistryInfo   \n\narray<object>   \n\n 否    \n\nACR 实例信息。更多信息，请参见[免密拉取 ACR 镜像](https://help.aliyun.com/zh/eci/user-guide/pull-images-f"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createinstanceopstask", "page_type": "doc", "title": "CreateInstanceOpsTask - 创建运维任务", "keywords": "CreateInstanceOpsTask,创建运维任务,调用CreateInstanceOpsTask,开启coredump,CreateInstanceOpsTask参考,CreateInstanceOpsTask参数,CreateInstanceOpsTask错误码", "last_modified_ms": 1760669908000, "last_modified_iso": "2025-10-17T10:58:28+08:00", "excerpt": "调用CreateInstanceOpsTask创建一个运维任务。   \n## 接口说明 \n## 接口说明 \n\n运维任务支持以下两种： \n \n- \n\ncoredump：开启 coredump 后，在容器异常终止时，系统会生成 core 文件，以便您分析异常，找出问题原因。更多信息，请参见[开启 coredump](https://help.aliyun.com/zh/eci/user-guide/use-coredump-to-analyze-instance-program-exceptions-1)。 \n- \n\ntcpdump：开启 tcpdump 后，系统将抓取网络数据包，以便您分析报文，定位网络问题。更多信息，请参见[开启 tcpdump](https://help.aliyun.com/zh/eci/user-guide/use-tcpdump-to-capture-packets-and-analyze-network-problems)。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/CreateInstanceOpsTask) [调试](https://api.aliyun.com/api/Eci/2018-08-08/CreateInstanceOpsTask)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:CreateInstanceOpsTask   \n\ncreate   \n\n*全部资源 \n\n*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\nECI 实例 ID。   \n\neci-bp1dvysdafbh00t7****     OpsType   \n\nstring   \n\n 是    \n\n运维任务类型。取值范围： \n \n- \n\ncoredump \n- \n\ntcpdump \n   \n\ncoredump     OpsValue   \n\nstring   \n\n 是    \n\n运维任务参数。根据 OpsType 的取值，可设置相应参数。 \n \n- 当 OpsType 取值为 coredump 时，OpsValue 取值范围如下： \n \n- \n\nenable：开启 coredump。 \n- \n\ndisable：关闭 coredump。 \n  \n- 当 OpsType 取值为 tcpdump 时，OpsValue 取值为 JSON 格式的参数字符串，例如{\"Enable\":true, \"IfDeviceName\":\"eth0\"}。具体参数如下： \n \n- \n\nEnable：是否开启 tcpdump，必填参数，取值为 true 表示开启，取值为 false 表示关闭。 \n- \n\nProtocol：网络协议。取值范围为 tcp、udp、icmpv4。 \n- \n\nSourceIp：源 IP 地址。 \n- \n\nSourceCidr：源 IP 网段。CIDR 格式。如果同时设置了 IP 和 IP 网段，在 IP 网段有效时，将忽略 IP 设置。 \n- \n\nSourcePort：源端口。取值范围为 1~65535。 \n- \n\nDestIp：目的 IP 地址。 \n- \n\nDestCidr：目的 IP 网段。CIDR 格式。如果同时设置了 IP 和 IP 网段，在 IP 网段有效时，将忽略 IP 设置。 \n- \n\nDestPort：目的端口。取值范围为 1~65535。 \n- \n\nIfDeviceName：目标网卡。默认为 eth0。 \n- \n\nSnaplen：数据包抓取长度。默认为 65535 字节。 \n- \n\nDuration：抓取时间。单位为秒。 \n- \n\nPacketNum：抓取数据包的目标个数。 \n- \n\nFileSize：抓取数据包的目标文件大小。单位为字节。最大为 1073741824 字节（即 1 GB）。 \n  \n   \n\nenable       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89945DD3-9072-47D0-A318-353284CFC7B     Result   \n\nstring   \n\n运维任务执行结果。   \n\nEnable Success       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A318-353284CFC7B\",\n  \"Result\": \"Enable Success\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   Coredump.RefrshIntervalTooShort   The time interval since last setting too short, please try again later.        400   Ops.TypeNotSupport   %s        400   Coredump.RegionNotSupport   %s        400   CorePattern.UpdateFail   Update coredump settings fail, please try again later        400   Coredump.InvalidCorePatternType   %s        400   InvalidCorePatternValue   %s        400   InvalidInstanceId.NotFound   The specified instanceId does not exist        400   Ops.InstanceNotSupport   %s        400   Ops.IntervalTooShort   The time interval since last setting too short, please try again later.        400   Ops.RegionNotSupport   %s        400   Ops.OpsValueInvalid   Ops value check failed, please confirm by ops type and try again later.        400   Ops.ExecuteTaskFail   %s        400   Tcpdump.InvalidValue   %s        \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/CreateInstanceOpsTask#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createvirtualnode", "page_type": "doc", "title": "CreateVirtualNode - 创建一个虚拟节点", "keywords": "CreateVirtualNode,调用CreateVirtualNode,查询CreateVirtualNode参数,排查CreateVirtualNode错误,CreateVirtualNode API参考,CreateVirtualNode请求参数,CreateVirtualNode错误码", "last_modified_ms": 1761892763000, "last_modified_iso": "2025-10-31T14:39:23+08:00", "excerpt": "创建一个虚拟节点（VNode），用于对接自建Kubernetes集群，使其可以扩展资源到ECI。   \n## 接口说明 \n \n-  \n\n调用本接口创建虚拟节点时，系统将自动为您创建一个服务关联角色 AliyunServiceRoleForECIVnode，用于访问 ECI、ECS、VPC 等相关云服务。更多信息，请参见[虚拟节点服务关联角色](https://help.aliyun.com/zh/eci/security-and-compliance/service-linked-role-for-virtual-nodes)。  \n-  \n\n虚拟节点按个数计费。每个虚拟节点会有一个常驻节点，相当于 2 vCPU，8 GiB 的 ECI 实例，收取相关 ECI 实例费用。  \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/CreateVirtualNode) [调试](https://api.aliyun.com/api/Eci/2018-08-08/CreateVirtualNode)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:CreateVirtualNode   \n\ncreate   \n\n*VirtualNode \n\nacs:eci:{#regionId}:{#accountId}:virtualnode/*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ZoneId   \n\nstring   \n\n 否    \n\n可用区 ID。   \n\ncn-hangzhou-b     SecurityGroupId   \n\nstring   \n\n 是    \n\n安全组 ID。虚拟节点以及该虚拟节点下的 ECI 实例将加入到该安全组中。   \n\nsg-2ze81zoc3yl7a3we****     VSwitchId   \n\nstring   \n\n 是    \n\n交换机 ID。虚拟节点以及虚拟节点下的 ECI 实例所使用的交换机。\n 支持指定多个（1~10 个）属于同一 VPC 的交换机。   \n\nvsw-2ze23nqzig8inprou****     VirtualNodeName   \n\nstring   \n\n 否    \n\n虚拟节点的名称。长度为 2~128 个英文字符，可以包含小写英文字符、数字、半角句号（.）或者短划线（-）。   \n\ntestNode     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-uf66jeqopgqa9hdn****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多详情，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000     EnablePublicNetwork   \n\nboolean   \n\n 否    \n\n是否支持公网。默认为 false。\n 如果设置为 true，则虚拟节点将对外暴露一个公网 IP。   \n\nfalse     EipInstanceId   \n\nstring   \n\n 否    \n\n弹性公网 IP 的 ID。   \n\neip-uf66jeqopgqa9hdn****     KubeConfig   \n\nstring   \n\n 否    \n\n虚拟节点要连接的 Kubernetes 集群的 KubeConfig。需进行 Base64 编码后传入。   \n\nJTVDbmFwaVZlcnNpb24lM0ElMjB2MSU1Q25jbHVzdGVycyUzQSU1Q24tJTIwY2x1c3RlciUzQSU1Q24uLi******     CustomResources   \n\nstring   \n\n 否    \n\n虚拟节点支持的自定义资源。如果 ECI Pod 的 request 中声明了相应的自定义资源，则该 Pod 会被调度到 VNode。 格式为资源名称=资源数量，多个资源之间使用半角逗号间隔。   \n\nexample1.com=100,example2.com=200     ClusterDomain   \n\nstring   \n\n 否    \n\n集群的域名。配置后，除了主机的搜索域外，Kubelet 会配置所有容器来搜索该域名。   \n\nexample.com     ClusterDNS   \n\nstring   \n\n 否    \n\nDNS 服务器的 IP 地址。如果 ECI Pod 中设置了dnsPolicy=ClusterFirst，则使用该配置值为容器提供 DNS 服务。 支持配置多个 IP 地址，多个 IP 地址之间使用半角逗号间隔。   \n\n100.1.XX.XX      Tag   \n\narray<object>   \n\n 否    \n\n虚拟节点标签信息。最多可以配置 20 个。   \n\n         \n\nobject   \n\n 否    \n\n虚拟节点标签信息。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\nname     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntest      Taint   \n\narray<object>   \n\n 否    \n\n虚拟节点污点信息。最多可以配置 20 个。   \n\n         \n\nobject   \n\n 否    \n\n虚拟节点污点信息。   \n\n     Key   \n\nstring   \n\n 否    \n\n污点的 Key。   \n\ntestKey     Value   \n\nstring   \n\n 否    \n\n污点的 Value。   \n\ntestValue     Effect   \n\nstring   \n\n 否    \n\n污点的 Effect。取值范围： \n \n- \n\nNoSchedule：不将 Pod 调度到具有该污点的节点上。 \n- \n\nNoExecute：不将 Pod 调度到具有该污点的节点上的同时，驱逐节点上已经存在的 Pod。 \n- \n\nPreferNoSchedule：尽量不将 Pod 调度到具有该污点的节点上。 \n   \n\nNoSchedule     TlsBootstrapEnabled   \n\nboolean   \n\n 否    \n\n是否启用 TLS 启动引导。启用后，请使用 TLS 启动引导的 KubeConfig 证书。取值范围： \n \n- \n\ntrue：启用 \n- \n\nfalse：不启用 \n \n\n默认为 false。   \n\nfalse       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject   \n\n返回信息。   \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89164E78-FC82-4684-BE97-DCDD85D26546     VirtualNodeId   \n\nstring   \n\n虚拟节点 ID。   \n\nvnd-2ze960zkdqrldeaw****       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89164E78-FC82-4684-BE97-DCDD85D26546\",\n  \"VirtualNodeId\": \"vnd-2ze960zkdqrldeaw****\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   Account.Arrearage   You"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletecontainergroup", "page_type": "doc", "title": "DeleteContainerGroup - 删除一个容器组", "keywords": "DeleteContainerGroup,调用DeleteContainerGroup,删除ECI实例,DeleteContainerGroup参考,DeleteContainerGroup参数,DeleteContainerGroup报错", "last_modified_ms": 1760669836000, "last_modified_iso": "2025-10-17T10:57:16+08:00", "excerpt": "调用DeleteContainerGroup删除一个ECI实例。   \n## 接口说明 \n\n您可以删除不再使用的 ECI 实例。操作前，请确保您已了解 ECI 实例的生命周期。具体请参见 [ECI 实例生命周期介绍](https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-1)。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DeleteContainerGroup) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DeleteContainerGroup)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DeleteContainerGroup   \n\ndelete   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\nECI 实例 ID，即容器组 ID。   \n\neci-2zelg8vwnlzdhf8hv****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000     Force   \n\nboolean   \n\n 否    \n\n是否强制清理资源。取值范围： \n \n- \n\ntrue：不等待 graceful termination 超时时间，强制清理资源。 \n- \n\nfalse（默认值）：等待 graceful termination 超时时间，正常清理资源。 \n   \n\ntrue       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n45D5B0AD-3B00-4A9B-9911-6D5303B06712       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"45D5B0AD-3B00-4A9B-9911-6D5303B06712\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   IncorrectStatus   %s   指定的实例状态不正确。     400   OperationConflict   Request was denied due to conflict with a previous request.   该请求被禁止，因为与之前的请求冲突     \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DeleteContainerGroup#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletedatacache", "page_type": "doc", "title": "DeleteDataCache - 删除数据缓存", "keywords": "DeleteDataCache,删除数据缓存,查询DeleteDataCache参数,DeleteDataCache API参考,DeleteDataCache请求参数", "last_modified_ms": 1760670003000, "last_modified_iso": "2025-10-17T11:00:03+08:00", "excerpt": "删除一个数据缓存。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DeleteDataCache) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DeleteDataCache)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DeleteDataCache   \n\ndelete   \n\n*DataCache \n\nacs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     DataCacheId   \n\nstring   \n\n 否    \n\n数据缓存 ID。   \n\nedc-bp1a7n7uawwwol******     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n5e74729e-ce21-4c3e-9163-cbaf0f02768e     Bucket   \n\nstring   \n\n 否    \n\n数据缓存 Bucket。默认为 default。   \n\ndefault     Path   \n\nstring   \n\n 否    \n\n数据缓存对应 Virtual Host 的目录。   \n\n/data/models/       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\nC0F8A012-1426-5EB2-96F5-B4416DEB5B78       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"C0F8A012-1426-5EB2-96F5-B4416DEB5B78\"\n}\n\n   \n## 错误码 \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DeleteDataCache#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deleteimagecache", "page_type": "doc", "title": "DeleteImageCache - 删除一个镜像缓存", "keywords": "DeleteImageCache,删除镜像缓存,调用DeleteImageCache接口,DeleteImageCache API参考,DeleteImageCache请求参数", "last_modified_ms": 1760669851000, "last_modified_iso": "2025-10-17T10:57:31+08:00", "excerpt": "调用DeleteImageCache删除一个镜像缓存。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DeleteImageCache) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DeleteImageCache)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DeleteImageCache   \n\ndelete   \n\n*ImageCache \n\nacs:eci:{#regionId}:{#accountId}:imagecache/{#ImageCacheId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ImageCacheId   \n\nstring   \n\n 是    \n\n镜像缓存 ID。   \n\nimc-2zebxkiifuyzzlhl****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n89945DD3-9072-47D0-A218-354284CFC7A2       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A218-354284CFC7A2\"\n}\n\n   \n## 错误码 \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DeleteImageCache#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletevirtualnode", "page_type": "doc", "title": "DeleteVirtualNode - 删除一个虚拟节点", "keywords": "DeleteVirtualNode,调用DeleteVirtualNode接口,查询DeleteVirtualNode参数,排查DeleteVirtualNode报错,DeleteVirtualNode API参考,DeleteVirtualNode错误码,DeleteVirtualNode请求参数", "last_modified_ms": 1761893178000, "last_modified_iso": "2025-10-31T14:46:18+08:00", "excerpt": "调用DeleteVirtualNode删除一个虚拟节点。   \n## 接口说明 \n\n调用本接口删除虚拟节点前，请确保该节点下已经没有 ECI 实例。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DeleteVirtualNode) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DeleteVirtualNode)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DeleteVirtualNode   \n\ndelete   \n\n*VirtualNode \n\nacs:eci:{#regionId}:{#accountId}:virtualnode/{#VirtualNodeId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     VirtualNodeId   \n\nstring   \n\n 是    \n\n虚拟节点 ID。   \n\nvnd-2ze960zkdqrldeaw****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多详情，请参阅[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89945DD3-9072-47D0-A318-353284CFC7B3       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A318-353284CFC7B3\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   Account.Arrearage   Your account has an outstanding payment.   账号已经欠费。     400   DryRunOperation   Request validation has been passed with DryRun flag set.   此次DryRun预检请求合格。     400   InvalidParameter.CPU.Memory   The specified cpu and memory are not allowed        400   InvalidParameter.DuplicatedName   The container group include containers with duplicate names.   容器组内有重复名字的容器。     400   InvalidParameter.DuplicatedVolumeName   The container group includes volumes with duplicate names.   容器组内有重复名字的数据卷。     400   IncorrectStatus   %s   指定的实例状态不正确。     400   ServiceNotEnabled   %s   该次请求所依赖的服务没有开通，请开通后再试。     400   ImageSnapshot.IncorrectStatus   %s   用于镜像缓存的快照状态不正确。     400   ImageSnapshot.NotSupport   %s   基于数据盘快照的镜像缓存功能暂未全网开放，如有需要请联系我们。     400   DiskVolume.NotSupport   The disk volume is not supported.   云盘卷暂不支持，如有需要请联系我们。     400   RamRole.NotSupport   The RAM role is not supported.   ram实例角色不支持。     400   DiskNumber.LimitExceed   The maximum number of disks in an instance is exceeded.   实例下云盘数目超过限制。     400   InvalidPaymentMethod.InsufficientBalance   No payment method is specified for your account. We recommend that you add a payment method or add funds to the prepayment balance.   您的账户暂无有效支付方式，请添加支付方式或保持预付款余额充足。     400   DiskVolume.NotInSameZone   The instance to be created and the disk are not in the same zone.   即将创建的实例和云盘不在同一可用区。     400   NoPermission   You are not authorized to use the \"Product on ECI\" feature.        400   HighCpuMemConfigRequired   You need to apply to be added to the whitelist of the specified CPU and memory.   您需要申请CPU高配白名单。     400   RecommendEmpty.InstanceTypeFamilyNotMatched   The recommended instance type is unavailable in the current zone. Try again later.   当前可用区没有推荐的规格可使用，请稍后重试或者到其他的可用区创建。     400   LocalDiskAmountNotMatch   The number of local volumes does not match the instance type.   本地盘数量跟实例规格不匹配     400   Payfor.CreditPayInsufficientBalance   Your payment credit line is insufficient.   您的付款信用额度不足。     400   InvalidOperation.KMS.InstanceTypeNotSupport   The specified instance is invalid. Only I/O optimized instances support KMS key.   指定的实例无效，只有 I/O 优化类型的实例支持设置“KMS Key”。     400   InvalidParameter.Encrypted.KmsNotEnabled   KMS must be enabled for encrypted disks.   加密磁盘需要启用密钥管理服务。     400   InvalidParameter.KMS.EncryptedIllegal   After configuring the parameter KmsKeyId, you must enable encryption.   设置参数“KmsKeyId”后，您必须开启加密属"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeavailableresource", "page_type": "doc", "title": "DescribeAvailableResource - 查询可用ECS实例规格", "keywords": "DescribeAvailableResource,查询可用ECS规格,查询API请求参数,可用ECS规格查询,API请求参数,API错误码", "last_modified_ms": 1760669887000, "last_modified_iso": "2025-10-17T10:58:07+08:00", "excerpt": "调用DescribeAvailableResource查询指定地域和可用区下可售ECS实例规格族。   \n## 接口说明 \n\n调用 CreateContainerGroup 创建 ECI 实例时支持通过 InstanceType 参数来指定 ECS 规格，以满足特定的规格需求。为保证 ECI 实例能够创建成功，在创建 ECI 实例前，您可以先调用本接口查询指定地域和可用区下支持哪些 ECS 实例规格或实例规格族。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeAvailableResource) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeAvailableResource)   \n## 授权信息 \n\n当前API暂无授权信息透出。   \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。 \n\n您可以调用 [DescribeRegions](https://help.aliyun.com/zh/eci/api-describeregions) 查看最新的阿里云地域列表。   \n\ncn-hangzhou     ZoneId   \n\nstring   \n\n 否    \n\n可用区 ID。 \n\n默认值为空，此时查询指定地域下的所有可用区。   \n\ncn-hangzhou-e      DestinationResource   \n\nobject   \n\n 是    \n\n要查询的资源信息。   \n\n     Category   \n\nstring   \n\n 是    \n\n资源类型。取值范围： \n \n- \n\nInstanceTypeFamily：表示查询实例规格族，配合 Value 使用。 \n- \n\nInstanceType：表示查询实例规格，配合 Value，以及 Cores 和 Memory 使用。 \n   \n\nInstanceTypeFamily     Value   \n\nstring   \n\n 否    \n\n实例规格族或者具体实例规格。 \n \n- \n\n当 Category 取值为 InstanceTypeFamily 时，取值为实例规格族，如 ecs.c5。 \n- \n\n当 Category 取值为 InstanceType 时，取值为具体实例规格。如 ecs.c5.large。 \n   \n\necs.c6     Cores   \n\nnumber   \n\n 否    \n\nvCPU 核数。当 Category 取值为 InstanceType 时，可以设置。   \n\n2     Memory   \n\nnumber   \n\n 否    \n\n内存大小。单位为 GiB。当 Category 取值为 InstanceType 时，可以设置。   \n\n4     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。 \n\n您可以调用 [DescribeRegions](https://help.aliyun.com/zh/eci/api-describeregions) 查看最新的阿里云地域列表。   \n\ncn-hangzhou      SpotResource   \n\nobject   \n\n 否    \n\n要查询的抢占式实例的资源信息。   \n\n     SpotStrategy   \n\nstring   \n\n 否    \n\n实例的抢占策略。取值范围： \n \n- \n\nNoSpot：正常按量付费实例。 \n- \n\nSpotWithPriceLimit：设置上限价格的抢占式实例。 \n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格的抢占式实例。 \n \n\n默认为：NoSpot。 说明  \n\n查询抢占式实例资源信息时，即取值为 SpotWithPriceLimit 或 SpotAsPriceGo 时，Category 取值必须为 InstanceType，同时需指定具体实例规格（Value），或者指定 vCPU 和内存（Cores 和 Memory）。    \n\nSpotAsPriceGo     SpotPriceLimit   \n\nnumber   \n\n 否    \n\n抢占式实例的每小时最高价格，最多精确到小数点后 3 位。当 SpotStrategy 取值为 SpotWithPriceLimit 时，必须设置 SpotPriceLimit。   \n\n0.2     SpotDuration   \n\ninteger   \n\n 否    \n\n抢占式实例的保护期。单位为小时。默认为 1。可设置为 0，表示无保护期。   \n\n1       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject   \n\nSchema of Response   \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n6829735A-FF76-58C6-AECB-27CBF135A7AA      AvailableZones   \n\nobject      \n\n      AvailableZone   \n\narray<object>   \n\n可用区级别的资源信息集合。   \n\n         \n\narray<object>      \n\n     RegionId   \n\nstring   \n\n地域 ID。   \n\ncn-hangzhou     ZoneId   \n\nstring   \n\n可用区 ID。   \n\ncn-hangzhou-e      AvailableResources   \n\nobject      \n\n      AvailableResource   \n\narray<object>   \n\n该可用区支持的资源信息集合。   \n\n         \n\narray<object>      \n\n     Type   \n\nstring   \n\n资源类型。可能值： \n \n- \n\nInstanceTypeFamily：表示实例规格族。 \n- \n\nInstanceType：表示实例规格。 \n   \n\nInstanceTypeFamily      SupportedResources   \n\nobject      \n\n      SupportedResource   \n\narray<object>   \n\n资源信息组成的数组。   \n\n         \n\nobject      \n\n     Value   \n\nstring   \n\n支持的 ECS 实例规格信息。 \n \n- \n\n当 Type 为 InstanceTypeFamily 时，Value 值为实例规格族。 \n- \n\n当 Type 为 InstanceType 时，Value 值为实例规格。 \n   \n\necs.c6     StatusCategory   \n\nstring   \n\n根据库存详细分类资源类别。可能值： \n \n- \n\nWithStock：库存充足。 \n- \n\nClosedWithStock：库存供应保障能力低，建议选用 WithStock 状态的实例规格。 \n- \n\nWithoutStock：库存售罄，将会补充资源，建议选用 WithStock 状态的实例规格。 \n- \n\nClosedWithoutStock：库存售罄，且不补充资源，请选用 WithStock 状态的实例规格。 \n   \n\nWithStock       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"6829735A-FF76-58C6-AECB-27CBF135A7AA\",\n  \"AvailableZones\": {\n    \"AvailableZone\": [\n      {\n        \"RegionId\": \"cn-hangzhou\",\n        \"ZoneId\": \"cn-hangzhou-e\",\n        \"AvailableResources\": {\n          \"AvailableResource\": [\n            {\n              \"Type\": \"InstanceTypeFamily\",\n              \"SupportedResources\": {\n                \"SupportedResource\": [\n                  {\n                    \"Value\": \"ecs.c6\",\n                    \"StatusCategory\": \"WithStock\"\n                  }\n                ]\n              }\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\n\n   \n## 错误码 \n\n[表格]\n     "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecommitcontainertask", "page_type": "doc", "title": "DescribeCommitContainerTask - 查询CommitContainer任务详情", "keywords": "DescribeCommitContainerTask,查询CommitContainer任务,CommitContainer任务API,CommitContainer任务参数", "last_modified_ms": 1760670845000, "last_modified_iso": "2025-10-17T11:14:05+08:00", "excerpt": "调用DescribeCommitContainerTask查询CommitContainer任务的详情。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeCommitContainerTask) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeCommitContainerTask)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeCommitContainerTask   \n\nget   \n\n*CommitContainerTask \n\nacs:eci:{#regionId}:{#accountId}:containergroup/*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     NextToken   \n\nstring   \n\n 否    \n\n查询凭证（Token），取值为上一次 API 调用返回的 NextToken 参数值。   \n\nAAAAAdDWBF2****     MaxResults   \n\ninteger   \n\n 否    \n\n分页查询时每页行数。\n 最大值为 50。\n 默认值为 10。   \n\n20     ContainerGroupId   \n\nstring   \n\n 否    \n\n执行 CommitContainer 任务的 ECI 实例 ID。\n 查询时按实例 ID 或者任务 ID 进行查询，两者至少要填其中一个。   \n\neci-2zelg8vwnlzdhf8hv****     TaskStatus   \n\nstring   \n\n 否    \n\n任务状态。取值范围： \n \n- \n\nRunning：运行中 \n- \n\nSucceeded：成功 \n- \n\nFailed：失败 \n  \n\n枚举值： \n \n- Succeeded : \n\nSucceeded \n- Failed : \n\nFailed \n- Running : \n\nRunning \n    \n\nRunning      TaskId   \n\narray   \n\n 否    \n\n任务 ID。   \n\n        \n\nstring   \n\n 否    \n\n任务 ID。\n 查询时按实例 ID 或者任务 ID 进行查询，两者至少要填其中一个。   \n\nt-2zej6nstkg744qc3****       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     TotalCount   \n\ninteger   \n\n符合查询条件的结果条数。   \n\n5     NextToken   \n\nstring   \n\n本次调用返回的查询凭证值。   \n\nAAAAAdDWBF2****     RequestId   \n\nstring   \n\n请求 ID。   \n\n45D5B0AD-3B00-4A9B-9911-6D5303B06712     MaxResults   \n\nstring   \n\n每页显示行数。   \n\n20      CommitTasks   \n\narray<object>   \n\n任务详细信息。   \n\n         \n\narray<object>   \n\n任务详细信息。   \n\n     TaskId   \n\nstring   \n\n任务 ID。   \n\nt-2zej6nstkg744qc3****     TaskStatus   \n\nstring   \n\n任务状态。可能值： \n \n- \n\nRunning：运行中 \n- \n\nSucceeded：成功 \n- \n\nFailed：失败 \n   \n\nRunning     TaskProgress   \n\nstring   \n\n任务进度（百分比）。   \n\n50%     StatusMessage   \n\nstring   \n\n状态消息。   \n\nCommit container -xxxxxx     ContainerName   \n\nstring   \n\n容器名称。   \n\nworker0      CommitPhaseInfos   \n\narray<object>   \n\n任务阶段信息。   \n\n         \n\nobject   \n\n任务阶段信息。   \n\n     Phase   \n\nstring   \n\n阶段名称。可能值： \n \n- \n\nPullBaseImage：拉取原容器镜像。 \n- \n\nCommitContainer：提交容器生成镜像。 \n- \n\nPushCommittedImage：推送镜像到 ACR。 \n   \n\nPullBaseImage     Status   \n\nstring   \n\n阶段状态。   \n\nSuccess     Message   \n\nstring   \n\n阶段信息。   \n\nPull base image for container container-1 successfully     RecordTime   \n\nstring   \n\n阶段时间。   \n\n2023-01-05T14:06:40.920005316+08:00     TaskCreationTime   \n\nstring   \n\n任务开始时间。   \n\n2023-03-06T08:22:40Z     TaskFinishedTime   \n\nstring   \n\n任务完成时间。   \n\n2023-03-06T08:23:40Z       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"TotalCount\": 5,\n  \"NextToken\": \"AAAAAdDWBF2****\",\n  \"RequestId\": \"45D5B0AD-3B00-4A9B-9911-6D5303B06712\",\n  \"MaxResults\": \"20\",\n  \"CommitTasks\": [\n    {\n      \"TaskId\": \"t-2zej6nstkg744qc3****\",\n      \"TaskStatus\": \"Running\",\n      \"TaskProgress\": \"50%\",\n      \"StatusMessage\": \"Commit container -xxxxxx\",\n      \"ContainerName\": \"worker0\",\n      \"CommitPhaseInfos\": [\n        {\n          \"Phase\": \"PullBaseImage\",\n          \"Status\": \"Success\",\n          \"Message\": \"Pull base image for container container-1 successfully\",\n          \"RecordTime\": \"2023-01-05T14:06:40.920005316+08:00\"\n        }\n      ],\n      \"TaskCreationTime\": \"2023-03-06T08:22:40Z\",\n      \"TaskFinishedTime\": \"2023-03-06T08:23:40Z\"\n    }\n  ]\n}\n\n   \n## 错误码 \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeCommitContainerTask#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupevents", "page_type": "doc", "title": "DescribeContainerGroupEvents - 查询容器组事件列表", "keywords": "DescribeContainerGroupEvents,查询容器组事件列表,调用事件查询API,事件查询API参考,事件查询API请求参数,事件查询API返回参数", "last_modified_ms": 1760669827000, "last_modified_iso": "2025-10-17T10:57:07+08:00", "excerpt": "调用DescribeContainerGroupEvents批量查询ECI实例的事件信息。   \n## 接口说明 \n\n调用本接口可以同时查询多个 ECI 实例的事件信息。默认返回每个 ECI 实例最新的 50 条事件信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupEvents) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupEvents)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeContainerGroupEvents   \n\nget   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ZoneId   \n\nstring   \n\n 否    \n\n可用区 ID。   \n\ncn-hangzhou-k     VSwitchId   \n\nstring   \n\n 否    \n\n交换机 ID。   \n\nvsw-uf6h3rbwbm90urjwa****     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-uf66jeqopgqa9hdn****     ContainerGroupIds   \n\nstring   \n\n 否    \n\nECI 实例 ID 序列。最多 20 个，字符串需按照 JSON 格式传入。   \n\n[\"eci-bp17gw49eu09yiwm****\", \"eci-bp19aq49du01abcm****\", \"eci-2zegym1qhbmdfr1s****\"]      Tag   \n\narray<object>   \n\n 否    \n\nECI 实例绑定的标签。   \n\n         \n\nobject   \n\n 否    \n\nECI 实例绑定的标签。   \n\n     Value   \n\nstring   \n\n 否    \n\nECI 实例的标签值。   \n\nname     Key   \n\nstring   \n\n 否    \n\nECI 实例的标签键。   \n\ntest     NextToken   \n\nstring   \n\n 否    \n\n下一个查询开始的 Token，NextToken 为空表示没有下一个。 \n\n首次查询时无需设置该参数，后续查询的 Token 从返回结果中获取。   \n\nd78f2dd8-5979-42fe-xaee-b16db43be5bc     EventSource   \n\nstring   \n\n 否    \n\n事件源。取值范围： \n \n- \n\nEciService \n- \n\nK8sAgent \n \n\n默认为空，查询所有事件。   \n\nK8sAgent     SinceSecond   \n\ninteger   \n\n 否    \n\n返回最近几秒内新增的事件，用于轮询增量事件。   \n\n60     Limit   \n\ninteger   \n\n 否    \n\n限定此次返回资源（ECI 实例）的数量。默认为 200 个。 说明  \n\n返回结果可能小于指定的数量，但不会多于指定的数量。    \n\n200       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject   \n\nSchema of Response   \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n1340C38D-6189-54D1-86F6-7D5ECF3E0088     TotalCount   \n\ninteger   \n\n返回的事件条数。   \n\n10      Data   \n\narray<object>   \n\n事件信息列表。   \n\n         \n\narray<object>   \n\n事件信息列表。   \n\n     ContainerGroupId   \n\nstring   \n\nECI 实例 ID。   \n\neci-uf6fonnghi50v6nq****     Name   \n\nstring   \n\nECI 实例名称。   \n\ntest     Namespace   \n\nstring   \n\nECI 实例所在命名空间。   \n\nredis     uuid   \n\nstring   \n\nECI 实例的 UUID。   \n\n3fc6b309-****-****     Annotations   \n\nstring   \n\nECI 实例的注解。   \n\n\"{\\\"tenancy.x-k8s.io/namespace\\\":\\\"redis\\\"}\"      Events   \n\narray<object>   \n\n事件列表。   \n\n         \n\narray<object>   \n\n事件列表。   \n\n     Type   \n\nstring   \n\n事件类型。可能值： \n \n- \n\nNormal \n- \n\nWarning \n   \n\nNormal     Count   \n\ninteger   \n\n事件数量。   \n\n10     FirstTimestamp   \n\nstring   \n\n事件第一次出现的时间。   \n\n2021-10-04T09:08:04Z     LastTimestamp   \n\nstring   \n\n事件最后一次出现的时间。   \n\n2021-10-04T09:08:04Z     Message   \n\nstring   \n\n事件信息。   \n\nStarted container     Reason   \n\nstring   \n\n事件原因。   \n\nStarted     ReportingComponent   \n\nstring   \n\n上报事件的组件。   \n\ntest     ReportingInstance   \n\nstring   \n\n上报事件的实例。   \n\ntest      Source   \n\nobject   \n\n来源。   \n\n     Component   \n\nstring   \n\n组件。   \n\nkubelet     Host   \n\nstring   \n\n主机类型。   \n\neci      involvedObject   \n\nobject   \n\n事件关联的资源对象。   \n\n     Kind   \n\nstring   \n\n资源类型。   \n\nPod     Name   \n\nstring   \n\n资源名称。   \n\ntest     Namespace   \n\nstring   \n\n资源所在命名空间。   \n\ndefault     Uid   \n\nstring   \n\n资源 ID。   \n\neci-8vb5nkcq3a5cu0p3****     ApiVersion   \n\nstring   \n\nK8s 版本。   \n\nv1      Metadata   \n\nobject   \n\n事件元数据。   \n\n     Name   \n\nstring   \n\n事件名称。   \n\neci-uto-created-eci-for-ubuntu.167e3fb73cc7f9cb     Namespace   \n\nstring   \n\n命名空间。   \n\ndefault       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"1340C38D-6189-54D1-86F6-7D5ECF3E0088\",\n  \"TotalCount\": 10,\n  \"Data\": [\n    {\n      \"ContainerGroupId\": \"eci-uf6fonnghi50v6nq****\",\n      \"Name\": "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupmetric", "page_type": "doc", "title": "DescribeContainerGroupMetric - 查询一个ECI实例的监控数据", "keywords": "DescribeContainerGroupMetric,查询ECI实例监控,调用DescribeContainerGroupMetric,DescribeContainerGroupMetric API,ECI实例监控", "last_modified_ms": 1760670030000, "last_modified_iso": "2025-10-17T11:00:30+08:00", "excerpt": "调用DescribeContainerGroupMetric查询一个ECI实例的监控数据。   \n## 接口说明 \n \n- \n\n最多支持返回 50 条监控数据，超出 50 条将会报错。 \n- \n\n仅支持分别查询 5 分钟以内的实时数据，或者 5 分钟之前的历史数据。如果查询时间段超出了当前时间点，默认只查询 5 分钟之前的历史数据。 \n- \n\n仅支持查询创建时间晚于北京时间 2019 年 04 月 03 日 15 点的 ECI 实例的监控数据。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupMetric) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupMetric)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeContainerGroupMetric   \n\nget   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\nECI 实例 ID，即容器组 ID。   \n\neci-bp17da5olmkuagfr****     StartTime   \n\nstring   \n\n 否    \n\n查询某个时间段内的监控数据时，设置的开始时间。取值必须为 30 天之内，默认为 EndTime 减去 5 分钟。 \n\n格式为 RFC3339 时间格式。例如：北京时间 2019 年 03 月 12 号上午 9 点整可以表示为 2019-03-12T09:00:00.000+08:00 或者 2019-03-12T01:00:00.000Z   \n\n2019-03-12T01:00:00.000Z     EndTime   \n\nstring   \n\n 否    \n\n查询某个时间段内的监控数据时，设置的结束时间。默认为当前时间。 \n\n格式为 RFC3339 时间格式。   \n\n2019-09-12T01:05:00.000Z      Period   \n\nstring   \n\n 否    \n\n数据聚合周期，单位为秒。目前只支持 15、30、60 和 600 秒。默认为 60 秒。 说明  \n\n如果 StartTime 和 EndTime 均没有设置，则默认获取最新 5 分钟的监控数据，默认聚合周期为 15S，传入的 Period 将被忽略。    \n\n15       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\nD81A4A13-6DCC-4579-AC62-90A6C3EC7BBC     ContainerGroupId   \n\nstring   \n\nECI 实例 ID，即容器组 ID。   \n\neci-bp1dqpye03ke5s6p****      Records   \n\narray<object>   \n\nECI 实例的监控数据详情。   \n\n         \n\narray<object>      \n\n      Network   \n\nobject   \n\n网络数据。   \n\n      Interfaces   \n\narray<object>   \n\n网卡数据。   \n\n         \n\nobject      \n\n     RxErrors   \n\ninteger   \n\n累计接收错误数。   \n\n0     TxDrops   \n\ninteger   \n\n累计发送丢包数。   \n\n0     TxBytes   \n\ninteger   \n\n累计发送字节数。   \n\n1381805699     RxPackets   \n\ninteger   \n\n累计接收包数量。   \n\n4800583     TxPackets   \n\ninteger   \n\n累计发送包数量。   \n\n5158427     Name   \n\nstring   \n\n网卡名称。   \n\neth0     TxErrors   \n\ninteger   \n\n累计发送错误数。   \n\n0     RxBytes   \n\ninteger   \n\n累计接收字节数。   \n\n505001954     RxDrops   \n\ninteger   \n\n累计接收丢包数。   \n\n0      CPU   \n\nobject   \n\nCPU 数据。   \n\n     UsageNanoCores   \n\ninteger   \n\nCPU 在采样窗口内的使用量（纳秒）。   \n\n0     Limit   \n\ninteger   \n\nCPU 使用上限（CPU 核数*1000）。   \n\n2000     UsageCoreNanoSeconds   \n\ninteger   \n\nCPU 历史使用总量。   \n\n70769883     Load   \n\ninteger   \n\n最近 10 秒的平均负载情况。   \n\n0      Disk   \n\narray<object>   \n\n磁盘数据。   \n\n         \n\nobject      \n\n     WriteBytes   \n\ninteger   \n\n磁盘写入的数据量，单位为 Byte。   \n\n1375109120     WriteIO   \n\ninteger   \n\n该参数暂未开放使用。   \n\n123     Device   \n\nstring   \n\n磁盘名称。   \n\n/dev/vda     ReadIO   \n\ninteger   \n\n该参数暂未开放使用。   \n\n123     ReadBytes   \n\ninteger   \n\n磁盘读取的数据量，单位为 Byte。   \n\n210714112     Timestamp   \n\nstring   \n\n每条监控数据对应的统计时间。格式为 RFC3339 时间格式。   \n\n2021-08-25T16:22:00.000+08:00      Memory   \n\nobject   \n\n内存数据。   \n\n     Rss   \n\ninteger   \n\n常驻内存集，即实际使用的物理内存。   \n\n9289728     UsageBytes   \n\ninteger   \n\n已使用内存。   \n\n9289728     WorkingSet   \n\ninteger   \n\n当前内存工作集使用量。   \n\n9289728     AvailableBytes   \n\ninteger   \n\n可用内存。   \n\n4285091840     Cache   \n\ninteger   \n\n缓存。   \n\n9289728      Filesystem   \n\narray<object>   \n\n文件系统分区数据。   \n\n         \n\nobject      \n\n     Capacity   \n\ninteger   \n\n空间总量。   \n\n41610981376     Available   \n\ninteger   \n\n可用空间。   \n\n35319836672     FsName   \n\nstring   \n\n分区名称。   \n\n/dev/root     Usage   \n\ninteger   \n\n已使用空间。   \n\n4368744448     Category   \n\nstring   \n\n分区类型。可能值： \n \n- \n\nSystem \n- \n\nVolume \n- \n\nOther \n   \n\nSystem      Containers   \n\narray<object>   "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupprice", "page_type": "doc", "title": "DescribeContainerGroupPrice - 查询实例价格", "keywords": "DescribeContainerGroupPrice,查询实例价格API,了解API请求参数,查看API返回示例,实例价格API参考,API请求参数说明,API返回参数说明", "last_modified_ms": 1760670083000, "last_modified_iso": "2025-10-17T11:01:23+08:00", "excerpt": "查询ECI实例的价格。   \n## 接口说明 \n \n- \n\n本接口不支持资源组鉴权。 \n- ECI 实例支持指定 vCPU 和内存，或者指定 ECS 规格创建。调用本接口查询价格时，请传入 ECI 支持指定的规格。 \n \n- \n\n[vCPU 和内存规格说明](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-an-elastic-container-instance)。 \n- \n\n[ECI 支持的 ECS 规格说明](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。 \n  \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupPrice) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupPrice)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeContainerGroupPrice   \n\nget   \n\n*全部资源 \n\n*   无   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。您可以调用 [DescribeRegions](https://help.aliyun.com/zh/eci/api-describeregions) 查询最新的地域可用区信息。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。您可以调用 [DescribeRegions](https://help.aliyun.com/zh/eci/api-describeregions) 查询最新的地域可用区信息。   \n\ncn-hangzhou     Cpu   \n\nnumber   \n\n 否    \n\nvCPU 大小。ECI 支持的 vCPU 和内存规格请参见 [vCPU 和内存规格说明](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-an-elastic-container-instance)。   \n\n2.0     Memory   \n\nnumber   \n\n 否    \n\n内存大小。单位为 GiB。ECI 支持的 vCPU 和内存规格请参见 [vCPU 和内存规格说明](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-an-elastic-container-instance)。   \n\n4.0     InstanceType   \n\nstring   \n\n 否    \n\n指定的 ECS 实例规格。ECI 支持指定的 ECS 规格请参见[ECI 支持的 ECS 规格说明](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。 说明  \n\n设置该参数后，将自动忽略传入的 vCPU 和内存值，仅返回 ECS 规格的价格信息。    \n\necs.c5.large     SpotStrategy   \n\nstring   \n\n 否    \n\n实例的抢占策略。取值范围： \n \n- \n\nNoSpot：正常按量付费实例。 \n- \n\nSpotWithPriceLimit：设置上限价格的抢占式实例。 \n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格的抢占式实例。 \n \n\n默认为：NoSpot。   \n\nSpotWithPriceLimit     ZoneId   \n\nstring   \n\n 否    \n\n可用区。您可以调用 [DescribeRegions](https://help.aliyun.com/zh/eci/api-describeregions) 查询最新的地域可用区信息。   \n\ncn-hangzhou-g     SpotPriceLimit   \n\nnumber   \n\n 否    \n\n设置抢占式实例的每小时最高价格，最多精确到小数点后 3 位。当 SpotStrategy 取值为 SpotWithPriceLimit 时，必须设置 SpotPriceLimit。   \n\n0.2     EphemeralStorage   \n\ninteger   \n\n 否    \n\n临时存储空间大小。单位为 GiB.。   \n\n20     SpotDuration   \n\ninteger   \n\n 否    \n\n抢占式实例的保护期。单位为小时。默认为 1。可设置为 0，表示无保护期。   \n\n1     ComputeCategory   \n\nstring   \n\n 否    \n\n算力类别。取值为 economy 时，表示查询经济型规格的价格。   \n\neconomy       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n7A872585-33C7-4D69-AB8E-412E81EBA387      PriceInfo   \n\nobject   \n\n价格信息类型（Price），包括价格和优惠规则。   \n\n      SpotPrices   \n\nobject      \n\n      SpotPrice   \n\narray<object>   \n\n抢占式实例价格信息。   \n\n         \n\nobject      \n\n     ZoneId   \n\nstring   \n\n可用区。   \n\ncn-hangzhou-i     SpotPrice   \n\nnumber   \n\n抢占式实例的价格。   \n\n0.056     InstanceType   \n\nstring   \n\n实例规格。   \n\necs.c5.large     OriginPrice   \n\nnumber   \n\n原价。   \n\n0.622      Price   \n\nobject   \n\n价格。   \n\n     DiscountPrice   \n\nnumber   \n\n折扣价。   \n\n0     TradePrice   \n\nnumber   \n\n最终价，为原价减去折扣。   \n\n0.00012252     OriginalPrice   \n\nnumber   \n\n原价。   \n\n0.00012252      DetailInfos   \n\nobject      \n\n      DetailInfo   \n\narray<object>   \n\n价格的详细信息。   \n\n         \n\narray<object>      \n\n     Resource   \n\nstring   \n\n资源名称。   \n\ncpu     DiscountPrice   \n\nnumber   \n\n折扣价。   \n\n0     TradePrice   \n\nnumber   \n\n成交价。   \n\n0.000098     OriginalPrice   \n\nnumber   \n\n原价。   \n\n0.000098      Rules   \n\nobject      \n\n      Rule   \n\narray<object>   \n\n定价规则子集。   \n\n         \n\nobject      "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups", "page_type": "doc", "title": "DescribeContainerGroups - 批量查询容器组信息", "keywords": "DescribeContainerGroups,查询DescribeContainerGroups参数,调用DescribeContainerGroups,DescribeContainerGroups API参考,DescribeContainerGroups请求参数,DescribeContainerGroups返回参数", "last_modified_ms": 1760670546000, "last_modified_iso": "2025-10-17T11:09:06+08:00", "excerpt": "调用DescribeContainerGroups批量查询ECI实例的信息。   \n## 接口说明 \n \n- \n\n当 ECI 实例运行终止后，底层计算资源将会被回收。随实例一起创建的其它资源（例如 EIP 等）默认随实例一起释放。 \n- 终态（处于 Failed、Succeeded 或 Expired 状态）实例的元数据信息的保留情况如下： \n \n- \n\n1 小时内的实例信息全部保留。 \n- \n\n超出 1 小时的实例仅保留最近的 100 条（单个地域分别计算）。 \n  \n- \n\n如果使用 RAM 用户账号或者 RAM 角色进行查询，当 RAM 用户或者角色缺乏接口权限时，会返回空列表。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroups) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroups)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeContainerGroups   \n\nget   \n\nContainerGroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/* \n\nContainerGroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n实例所属的地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n实例所属的地域 ID。   \n\ncn-hangzhou     ZoneId   \n\nstring   \n\n 否    \n\n实例所属的可用区。如果取值为空，则表示由系统选择。 \n\n默认值为空。   \n\ncn-hangzhou-h     VSwitchId   \n\nstring   \n\n 否    \n\n实例所属的虚拟交换机 ID。   \n\nvsw-bp1jrgfqqy54kg5hc****     NextToken   \n\nstring   \n\n 否    \n\n下一个查询开始的 Token，NextToken 为空表示没有下一个。 说明  \n\n首次查询时无需设置该参数，后续查询的 Token 从返回结果中获取。    \n\nd78f2dd8-5979-42fe-****-b16db43be5bc     Limit   \n\ninteger   \n\n 否    \n\n限定此次返回资源的数量。如果不设置，默认返回 20 个，最大不能超过 20 个。 说明  \n\n返回结果可能小于指定的数量，但不会多于指定的数量。    \n\n20     ContainerGroupIds   \n\nstring   \n\n 否    \n\n实例 ID 序列。最多 20 个，字符串需按照 JSON 格式传入。   \n\n[\"eci-bp17gw49eu09yiwm****\", \"eci-bp19aq49du01abcm****\", \"eci-2zegym1qhbmdfr1s****\"]     ContainerGroupName   \n\nstring   \n\n 否    \n\n实例名称，即容器组名称。   \n\ntest     Status   \n\nstring   \n\n 否    \n\n实例状态。取值范围： \n \n- \n\nPending：启动中 \n- \n\nRunning：运行中 \n- \n\nSucceeded：运行成功 \n- \n\nFailed：运行失败 \n- \n\nScheduling：创建中 \n- \n\nScheduleFailed：创建失败 \n- \n\nRestarting：重启中 \n- \n\nUpdating：更新中 \n- \n\nTerminating：终止中 \n- \n\nExpired：过期 \n   \n\nRunning     ResourceGroupId   \n\nstring   \n\n 否    \n\n实例所属的资源组 ID。   \n\nrg-aekzh43v*****      WithEvent   \n\nboolean   \n\n 否    \n\n是否返回事件信息。   \n\ntrue      Tag   \n\narray<object>   \n\n 否    \n\n实例标签信息。   \n\n         \n\nobject   \n\n 否    \n\n实例标签信息。   \n\n     Key   \n\nstring   \n\n 否    \n\n实例标签键。   \n\nname     Value   \n\nstring   \n\n 否    \n\n实例标签值。   \n\ntest     ComputeCategory   \n\nstring   \n\n 否    \n\n指定算力类别。取值范围： \n \n- \n\neconomy：经济型 \n- \n\ngeneral：通用型 \n   \n\neconomy     SecurityGroupId   \n\nstring   \n\n 否    \n\n实例所属的安全组 ID。   \n\nsg-uf66jeqopgqa9hdn****        \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     TotalCount   \n\ninteger   \n\n实例数量。   \n\n1     NextToken   \n\nstring   \n\n下一个查询开始的 Token。   \n\nd78f2dd8-5979-42fe-****-b16db43be5bc     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n89945DD3-9072-47D0-A318-353284CFC7B3      ContainerGroups   \n\narray<object>   \n\n实例信息列表。   \n\n         \n\narray<object>   \n\n实例信息列表。   \n\n     Status   \n\nstring   \n\n实例状态。可能值： \n \n- \n\nPending：启动中 \n- \n\nRunning：运行中 \n- \n\nSucceeded：运行成功 \n- \n\nFailed：运行失败 \n- \n\nScheduling：创建中 \n- \n\nScheduleFailed：创建失败 \n- \n\nRestarting：重启中 \n- \n\nUpdating：更新中 \n- \n\nTerminating：终止中 \n- \n\nExpired：过期 \n   \n\nRunning     CreationTime   \n\nstring   \n\n接到请求后的系统创建时间。UTC 时间，RFC3339 标准。   \n\n2018-08-02T15:00:00Z     VpcId   \n\nstring   \n\n实例所属的 VPC ID。   \n\nvpc-1vzjjflab6wvjox****     InternetIp   \n\nstring   \n\n公网 IP。   \n\n192.0.XX.XX     TenantSecurityGroupId   \n\nstring   \n\n该参数未开放使用。   \n\nsg-xxx     SecurityGroupId   \n\nstring   \n\n安全组 ID。   \n\nsg-bp12ujq5zpxuyjfo3o8r      HostAliases   \n\narray<object>   \n\n自定义实例内一个容器的 Hostname 映射。   \n\n         \n\nobject   \n\n自定义实例内一个容器的 Hostname 映射。   \n\n      Hostnames   \n\narray   \n\n主机信息。   \n\n        \n\nstring   \n\n主机名。   \n\n['hehe.com', 'haha.com']     Ip   \n\nstring   \n\nIP 地址。   \n\n192.0.XX.XX "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupstatus", "page_type": "doc", "title": "DescribeContainerGroupStatus - 批量查询容器组状态", "keywords": "DescribeContainerGroupStatus,调用DescribeContainerGroupStatus,批量查询容器组状态,DescribeContainerGroupStatus API,DescribeContainerGroupStatus参数", "last_modified_ms": 1760670264000, "last_modified_iso": "2025-10-17T11:04:24+08:00", "excerpt": "调用DescribeContainerGroupStatus批量查询ECI实例的状态。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupStatus) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerGroupStatus)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeContainerGroupStatus   \n\nget   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ZoneId   \n\nstring   \n\n 否    \n\n可用区 ID。   \n\ncn-hangzhou-k     VSwitchId   \n\nstring   \n\n 否    \n\n交换机 ID。   \n\nvsw-uf6h3rbwbm90urjwa****     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-uf66jeqopgqa9hdn****     ContainerGroupIds   \n\nstring   \n\n 否    \n\nECI 实例 ID 序列。最多 20 个，字符串需按照 JSON 格式传入。   \n\n[\"eci-bp17gw49eu09yiwm****\", \"eci-bp19aq49du01abcm****\", \"eci-2zegym1qhbmdfr1s****\"]     SinceSecond   \n\ninteger   \n\n 否    \n\n返回最近几秒内有状态更新的 ECI 实例状态，用于轮询查询状态。   \n\n60      Tag   \n\narray<object>   \n\n 否    \n\nECI 实例绑定的标签。   \n\n         \n\nobject   \n\n 否    \n\nECI 实例绑定的标签。   \n\n     Value   \n\nstring   \n\n 否    \n\nECI 实例的标签值。   \n\ntestValue     Key   \n\nstring   \n\n 否    \n\nECI 实例的标签键。   \n\ntestKey     NextToken   \n\nstring   \n\n 否    \n\n下一个查询开始的 Token，NextToken 为空表示没有下一个。\n 首次查询时无需设置该参数，后续查询的 Token 从返回结果中获取。   \n\nd78f2dd8-5979-42fe-xaee-b16db43be5bc     Limit   \n\ninteger   \n\n 否    \n\n限定此次返回资源（ECI 实例）的数量。默认为 200 个。 说明  \n\n返回结果可能小于指定的数量，但不会多于指定的数量。    \n\n200       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject   \n\nSchema of Response   \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n1340C38D-6189-54D1-86F6-7D5ECF3E0088     NextToken   \n\nstring   \n\n下一个查询开始的 Token。   \n\nd78f2dd8-5979-42fe-****-b16db43be5bc     TotalCount   \n\ninteger   \n\n结果条数。   \n\n1      Data   \n\narray<object>   \n\nECI 实例状态信息集合。   \n\n         \n\narray<object>   \n\nECI 实例状态信息集合。   \n\n     ContainerGroupId   \n\nstring   \n\nECI 实例 ID。   \n\neci-bp1jrgfqqy54kg5hc****     Name   \n\nstring   \n\nECI 实例名称。   \n\nnginx     Namespace   \n\nstring   \n\nECI 实例所在命名空间。   \n\ndefault     Status   \n\nstring   \n\nECI 实例状态。   \n\nRunning     uuid   \n\nstring   \n\nECI 实例 UUID，对应 K8s 的 POD UID。   \n\n78ee0657-987g-b8b2-1f507dic4****     Annotations   \n\nstring   \n\nECI 实例的注解。   \n\n\"{\\\"tenancy.x-k8s.io/namespace\\\":\\\"redis\\\"}\"      PodStatus   \n\nobject   \n\nECI 实例的状态信息。   \n\n      Conditions   \n\narray<object>   \n\nPod conditions 信息。   \n\n         \n\nobject   \n\nPod conditions 信息。   \n\n     type   \n\nstring   \n\ncondition 类型。可能值： \n \n- \n\nPodReadyToStartContainers \n- \n\nInitialized \n- \n\nReady \n- \n\nContainersReady \n- \n\nPodScheduled \n- \n\nContainerHasSufficientDisk \n- \n\nContainerInstanceCreated \n- \n\nUnschedulable \n   \n\nReady     status   \n\nstring   \n\ncondition 状态。   \n\nTrue     Reason   \n\nstring   \n\n事件原因。   \n\nCompleted     Message   \n\nstring   \n\n事件消息。   \n\nCompleted     lastTransitionTime   \n\nstring   \n\n最后一次状态变化时间。   \n\n2021-05-12T07:02:47Z      ContainerStatuses   \n\narray<object>   \n\n容器状态信息。   \n\n         \n\narray<object>   \n\n容器状态信息。   \n\n     Image   \n\nstring   \n\n容器镜像。   \n\nregistry-vpc.cn-zhangjiakou.aliyuncs.com/eci_open/ubuntu:18.04     ImageID   \n\nstring   \n\n镜像 ID。   \n\nregistry-vpc.cn-zhangjiakou.aliyuncs.com/eci_open/ubuntu@sha256:134c7fe821b9d359490cd009ce7ca322453f4f2d018623f849e580a89a685e5d     Name   \n\nstring   \n\n容器名称。   \n\nubuntu     Ready   \n\nboolean   \n\n容器是否 Ready。   \n\ntrue     RestartCount   \n\ninteger   \n\n重启次数。   \n\n1     Started   \n\nboolean   \n\n容器是否启动。   \n\ntrue      State   \n\nobject   \n\n容器状态。包括： \n \n- \n\nWaiting \n- \n\nRunning \n- \n\nTerminated \n   \n\n      Waiting   \n\nobject   \n\n容器正在等待创建，还未开始运行。   \n\n     Reason   \n\nstr"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainerlog", "page_type": "doc", "title": "DescribeContainerLog - 获取容器日志信息", "keywords": "DescribeContainerLog,获取容器日志信息,查询DescribeContainerLog参数,DescribeContainerLog API参考,DescribeContainerLog请求参数", "last_modified_ms": 1753693932000, "last_modified_iso": "2025-07-28T17:12:12+08:00", "excerpt": "调用DescribeContainerLog获取容器组内某个容器的日志信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerLog) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeContainerLog)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeContainerLog   \n\nget   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   eci:tag   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 否    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\nECI 实例 ID，即容器组 ID。   \n\neci-uf6fonnghi50v6nq****     ContainerName   \n\nstring   \n\n 是    \n\n容器名称。   \n\nnginx     StartTime   \n\nstring   \n\n 否    \n\nUTC 时间，RFC3339 标准。   \n\n2018-08-02T15:00:00Z     Tail   \n\ninteger   \n\n 否    \n\n查询最新多少行的日志内容。默认 500 行，最大 2000 行 。\n 日志内容最大返回 1 MB 数据。\n   \n\n500     LastTime   \n\nboolean   \n\n 否    \n\n是否查询上一个容器（如果容器退出重启了）。取值范围： \n \n- \n\ntrue：查询上一个容器。 \n- \n\nfalse：不查询。 \n \n\n默认为 false。   \n\nfalse     SinceSeconds   \n\ninteger   \n\n 否    \n\n查询最近多少秒内的日志。例如：10s、20s、30s。   \n\n10     LimitBytes   \n\ninteger   \n\n 否    \n\n日志总大小的限制。单位为 Byte，取值范围为 1~1048576（1 MB）。   \n\n123798     Timestamps   \n\nboolean   \n\n 否    \n\n是否返回日志时间戳。取值范围： \n \n- \n\ntrue：返回日志时间戳。 \n- \n\nfalse：不返回日志时间戳。 \n \n\n默认为 false。   \n\nfalse       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\nCA850ADA-****-4AC8-****-5B5990EAB7D0     ContainerName   \n\nstring   \n\n容器名称。   \n\nnginx     Content   \n\nstring   \n\n日志内容。   \n\n{}       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"CA850ADA-****-4AC8-****-5B5990EAB7D0\",\n  \"ContainerName\": \"nginx\",\n  \"Content\": \"{}\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       403   Forbidden.Unauthorized   You are not authorized to operate on the specified resource.   您在在未认证的情况下操作该资源     408   Request Timeout   Request timed out, please try again later.        \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeContainerLog#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedatacaches", "page_type": "doc", "title": "DescribeDataCaches - 查询数据缓存", "keywords": "DescribeDataCaches,查询数据缓存信息,查询DescribeDataCaches参数,DescribeDataCaches API参考,DescribeDataCaches请求参数", "last_modified_ms": 1760670311000, "last_modified_iso": "2025-10-17T11:05:11+08:00", "excerpt": "查询数据缓存信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeDataCaches) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeDataCaches)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeDataCaches   \n\nlist   \n\n*DataCache \n\nacs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou      DataCacheId   \n\narray   \n\n 否    \n\n数据缓存 ID。   \n\n        \n\nstring   \n\n 否    \n\n数据缓存 ID。   \n\nedc-bp1a7n7uawwwol******     Bucket   \n\nstring   \n\n 否    \n\n数据缓存 Bucket。默认为 default。   \n\ndefault     Path   \n\nstring   \n\n 否    \n\n数据缓存对应 Virtual Host 的目录。   \n\n/data/models/      Tag   \n\narray<object>   \n\n 否    \n\n标签列表。   \n\n         \n\nobject   \n\n 否    \n\n标签列表   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\ntestkey     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntestvalue     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-acfmzw2jz2z****     Limit   \n\ninteger   \n\n 否    \n\n查询结果条数上限。默认值和最大值为 20。   \n\n20     NextToken   \n\nstring   \n\n 否    \n\n查询凭证（Token），取值为上一次 API 调用返回的 NextToken 参数值。   \n\nd78f2dd8-5979-42fe-****-b16db43be5bc       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\nB8756BA0-6452-419C-9727-37A6209C85E0      DataCaches   \n\narray<object>   \n\n数据缓存信息。   \n\n         \n\narray<object>   \n\n数据缓存信息。   \n\n     DataCacheId   \n\nstring   \n\n数据缓存 ID。   \n\nedc-bp15l4vvys94oo******      CreationTime   \n\nstring   \n\n创建时间。   \n\n2023-06-16T02:43Z     Status   \n\nstring   \n\n数据缓存状态。可能值： \n \n- \n\nLoading：缓存数据中 \n- \n\nCreating：创建中 \n- \n\nAvailable：创建成功 \n- \n\nFailed：创建失败 \n- \n\nUpdating：更新中 \n- \n\nUpdateFailed：更新失败 \n \n\n当状态为 Available 时，即可使用该数据缓存。   \n\nAvailable     Progress   \n\nstring   \n\n创建进度。   \n\n100%     LastMatchedTime   \n\nstring   \n\n最新一次匹配数据缓存的时间。   \n\n2023-06-18T02:43Z     ExpireDateTime   \n\nstring   \n\n到期时间。   \n\n2023-06-26T02:43Z      ContainerGroupId   \n\nstring   \n\n创建数据缓存过程中，生成的 ECI 实例 ID。   \n\neci-8vb1y2w1dv7zeirn****      Tags   \n\narray<object>   \n\n标签列表。   \n\n         \n\nobject   \n\n标签列表。   \n\n     Key   \n\nstring   \n\n标签键。   \n\ntestkey     Value   \n\nstring   \n\n标签值。   \n\ntestvalue      Events   \n\narray<object>   \n\n事件列表。   \n\n         \n\nobject   \n\n事件列表。   \n\n     Type   \n\nstring   \n\n事件类型。可能值： \n \n- \n\nNormal \n- \n\nWarning \n   \n\nNormal     LastTimestamp   \n\nstring   \n\n事件结束时间。   \n\n2021-06-16T02:24:48Z     Message   \n\nstring   \n\n事件信息。   \n\nSuccessfully check data cache resource.     Name   \n\nstring   \n\n事件名称。   \n\ndatacache     Count   \n\ninteger   \n\n事件数。   \n\n1     FirstTimestamp   \n\nstring   \n\n事件开始时间。   \n\n2021-06-16T02:14:48Z     Reason   \n\nstring   \n\n事件原因。   \n\nStarted     RegionId   \n\nstring   \n\n地域 ID。   \n\ncn-hangzhou     SnapshotId   \n\nstring   \n\n快照 ID。   \n\ns-2zec5oj8e1yhxijt****     FlashSnapshotId   \n\nstring   \n\n本地快照 ID。   \n\ns-bp12w3v37sit96t6****      ResourceGroupId   \n\nstring   \n\n资源组 ID。   \n\nrg-aek2hlt3ux4****     Size   \n\ninteger   \n\n数据缓存大小。单位为 GiB。   \n\n20     Name   \n\nstring   \n\n数据缓存名称。   \n\ntest      DataSource   \n\nobject   \n\n数据源信息。   \n\n     Type   \n\nstring   \n\n数据源类型。可能值： \n \n- \n\nNAS \n- \n\nOSS \n- \n\nURL \n- \n\nSNAPSHOT \n   \n\nURL     Options   \n\nstring   \n\n数据源的配置参数。   \n\n{ \"options\": { \"path\": \"/\", \"server\": \"0ce1f4****-or***.cn-hangzhou.nas.aliyuncs.com\", \"vers\": \"3\", \"options\": \"nolock,proto=tcp,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport\" }, \"type\": \"NAS\" }     Bucket   \n\nstring   \n\n数据缓存 Bucket。   \n\ndefault     Path   \n\nstring   \n\n数据缓存对应 Virtual Host 的目录。   \n\n/data/models/     NextToken   \n\nstri"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeimagecaches", "page_type": "doc", "title": "DescribeImageCaches - 批量查询镜像缓存信息", "keywords": "DescribeImageCaches,查询DescribeImageCaches参数,了解DescribeImageCaches用法,DescribeImageCaches API参考,DescribeImageCaches错误码", "last_modified_ms": 1760670150000, "last_modified_iso": "2025-10-17T11:02:30+08:00", "excerpt": "调用DescribeImageCaches批量查询镜像缓存信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeImageCaches) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeImageCaches)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeImageCaches   \n\nget   \n\nImageCache \n\nacs:eci:{#regionId}:{#accountId}:imagecache/* \n\nImageCache \n\nacs:eci:{#regionId}:{#accountId}:imagecache/{#imagecacheId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ImageCacheId   \n\nstring   \n\n 否    \n\n镜像缓存 ID。   \n\nimc-bp195erqe9o2pb09****     ImageCacheName   \n\nstring   \n\n 否    \n\n镜像缓存名称。   \n\ntestcache     SnapshotId   \n\nstring   \n\n 否    \n\n镜像缓存对应的快照 ID。   \n\ns-2zec5oj8e1yhxijt****     Image   \n\nstring   \n\n 否    \n\n容器镜像。   \n\nnginx     ResourceGroupId   \n\nstring   \n\n 否    \n\n所属资源组 ID。   \n\nrg-2df3isufhi38****      Tag   \n\narray<object>   \n\n 否    \n\n镜像缓存绑定的标签信息。   \n\n         \n\nobject   \n\n 否    \n\n镜像缓存绑定的标签信息，最多 20 个。   \n\n     Key   \n\nstring   \n\n 否    \n\n镜像缓存标签键。   \n\nimc     Value   \n\nstring   \n\n 否    \n\n镜像缓存标签值。   \n\ntest      MatchImage   \n\narray   \n\n 否    \n\n指定容器镜像，用于查询最佳匹配的镜像缓存，最多 100 个。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl        \n\nstring   \n\n 否    \n\n指定容器镜像，用于查询最佳匹配的镜像缓存，最多 100 个。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl     Limit   \n\ninteger   \n\n 否    \n\n查询结果条数上限。   \n\n20     NextToken   \n\nstring   \n\n 否    \n\n查询凭证（Token），取值为上一次 API 调用返回的 NextToken 参数值。   \n\nAAAAAdDWBF2****     ImageFullMatch   \n\nboolean   \n\n 否    \n\n是否完全匹配容器镜像。\n 在配置了 MatchImage 取值的情况下，进一步过滤查询结果。   \n\ntrue     ImageMatchCountRequest   \n\ninteger   \n\n 否    \n\n完全匹配容器镜像的镜像缓存个数。\n 在配置了 MatchImage 取值的情况下，进一步过滤查询结果。   \n\n3       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n39FC2E43-3DD7-4CEF-9EF4-E4AD6E635301      ImageCaches   \n\narray<object>   \n\n镜像缓存信息列表。   \n\n         \n\narray<object>   \n\n镜像缓存信息列表。   \n\n      Images   \n\narray   \n\n镜像缓存包含的镜像列表。   \n\n        \n\nstring   \n\n镜像缓存包含的镜像列表。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl     CreationTime   \n\nstring   \n\n创建时间。   \n\n2021-02-09T02:24:07Z     Status   \n\nstring   \n\n镜像缓存状态。可能值： \n \n- \n\nPreparing：准备中 \n- \n\nCreating：创建中 \n- \n\nReady：创建完成 \n- \n\nFailed：创建失败 \n- \n\nUpdating：更新中 \n- \n\nUpdateFailed：更新失败 \n \n\n当状态为 Ready 时，即可使用该镜像缓存。   \n\nReady     Progress   \n\nstring   \n\n镜像缓存对应快照的创建进度。 说明  \n\n如果开启了极速镜像缓存功能，将先创建一份临时使用的本地快照再创建一份标准快照，该进度为标准快照的创建进度。    \n\n100%     ExpireDateTime   \n\nstring   \n\n到期时间。   \n\n2019-11-10T09:00:48Z     LastMatchedTime   \n\nstring   \n\n最新一次匹配到镜像缓存的时间。   \n\n2021-08-18T03:48:10Z     ContainerGroupId   \n\nstring   \n\n容器组 ID。   \n\neci-bp18oq3m15prd9jb****      Tags   \n\narray<object>   \n\n镜像缓存的标签列表信息。   \n\n         \n\nobject   \n\n镜像缓存的标签列表信息。   \n\n     Key   \n\nstring   \n\n标签键。   \n\nimc     Value   \n\nstring   \n\n标签值。   \n\ntest      Events   \n\narray<object>   \n\n镜像缓存拉取镜像事件信息。   \n\n         \n\nobject   \n\n镜像缓存拉取镜像事件信息。   \n\n     Type   \n\nstring   \n\n事件类型。   \n\nNormal     LastTimestamp   \n\nstring   \n\n事件结束时间。   \n\n2021-02-09T02:24:48Z     Message   \n\nstring   \n\n事件消息。   \n\nSuccessfully check image cache resource.     Name   \n\nstring   \n\n事件名称。   \n\nimagetest.1661f31f851a****     Count   \n\ninteger   \n\n事件数。   \n\n1     FirstTimestamp   \n\nstring   \n\n事件开始时间。   \n\n2021-02-09T02:24:48Z     Reason   \n\nstring   \n\n事件原因。   \n\nStarted     ImageCacheId   \n\nstring   \n\n镜像缓存 ID。   \n\nimc-bp195erqe9o2pb09****     RegionId   \n\nstring   \n\n所属地域。   \n\ncn-beijing     SnapshotId   \n\nstring   \n\n镜像缓存对应的快照 ID。 "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeinstanceopsrecords", "page_type": "doc", "title": "DescribeInstanceOpsRecords - 查询运维任务信息", "keywords": "DescribeInstanceOpsRecords,查询运维任务信息,运维任务查询API,运维任务API参数", "last_modified_ms": 1760670871000, "last_modified_iso": "2025-10-17T11:14:31+08:00", "excerpt": "调用DescribeInstanceOpsRecords查询运维任务信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeInstanceOpsRecords) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeInstanceOpsRecords)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeInstanceOpsRecords   \n\nget   \n\n*全部资源 \n\n*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\nECI 实例 ID。   \n\neci-bp1dvysdafbh00t7****     OpsType   \n\nstring   \n\n 是    \n\n运维任务类型。取值范围： \n \n- \n\ncoredump \n- \n\ntcpdump \n   \n\ncoredump       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89945DD3-9072-47D0-A318-353284CFC7B3      Records   \n\narray<object>   \n\n运维任务信息合集。   \n\n         \n\nobject      \n\n     CreateTime   \n\nstring   \n\n运维任务创建时间。   \n\n2024-07-22T09:27:43Z     ExpireTime   \n\nstring   \n\n运维任务过期时间。   \n\n2024-07-22T21:27:43Z     OpsType   \n\nstring   \n\n运维任务类型。   \n\nCoredump     OpsStatus   \n\nstring   \n\n运维任务状态。可能值： \n \n- \n\nReady：开启运维任务。 \n- \n\nFailed：运维任务执行失败。 \n- \n\nExpired：配置下发过期，有效期内未触发运维任务。 \n- \n\nClosed：关闭运维任务。 \n- \n\nSuccess：运维任务执行成功。 \n   \n\nReady     ResultType   \n\nstring   \n\n运维结果类型。当 OpsStatus 为 Success 时返回该参数。\n 目前仅支持返回 Oss，表示运维任务生成的文件将保存到 OSS 中。   \n\nOss     ResultContent   \n\nstring   \n\n运维结果内容，即运维任务所生成文件在的下载地址。当 OpsStatus 为 Success 时返回该参数。   \n\nhttp://eci-******       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A318-353284CFC7B3\",\n  \"Records\": [\n    {\n      \"CreateTime\": \"2024-07-22T09:27:43Z\",\n      \"ExpireTime\": \"2024-07-22T21:27:43Z\",\n      \"OpsType\": \"Coredump\",\n      \"OpsStatus\": \"Ready\",\n      \"ResultType\": \"Oss\",\n      \"ResultContent\": \"http://eci-******\"\n    }\n  ]\n}\n\n   \n## 错误码 \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeInstanceOpsRecords#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describemulticontainergroupmetric", "page_type": "doc", "title": "DescribeMultiContainerGroupMetric - 查询多个ECI实例的监控数据", "keywords": "DescribeMultiContainerGroupMetric,查询ECI多实例监控,调用ECI监控API,ECI监控API参考,监控API请求参数", "last_modified_ms": 1760669937000, "last_modified_iso": "2025-10-17T10:58:57+08:00", "excerpt": "调用DescribeContainerGroupMetric查询一个ECI实例的监控数据。   \n## 接口说明 \n \n- \n\n仅返回每个 ECI 实例最新的一条监控信息。 \n- \n\n仅支持查询创建时间晚于北京时间 2019 年 04 月 03 日 15 时的 ECI 实例的监控数据。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeMultiContainerGroupMetric) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeMultiContainerGroupMetric)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeMultiContainerGroupMetric   \n\nget   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupIds   \n\nstring   \n\n 是    \n\nECI 实例 ID，即容器组 ID。格式为 JSON 数组，一次最多支持 20 个 ID。   \n\n[\"eci-2zegym1qhbmdfr1s****\",\"eci-2ze39w5svzj5ic34****\"]     ResourceGroupId   \n\nstring   \n\n 否    \n\n实例所属的资源组 ID。   \n\nrg-acfmzw2jz2z****     MetricType   \n\nstring   \n\n 否    \n\n监控信息类型。目前仅支持配置为 summary，表示返回 Records。   \n\nsummary       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\nB8756BA0-6452-419C-9727-37A6209C85E0      MonitorDatas   \n\narray<object>   \n\n监控信息集合。   \n\n         \n\narray<object>      \n\n      Records   \n\narray<object>   \n\n监控数据详情。   \n\n         \n\narray<object>      \n\n      Network   \n\nobject   \n\n网络数据。   \n\n      Interfaces   \n\narray<object>   \n\n网卡数据。   \n\n         \n\nobject      \n\n     RxErrors   \n\ninteger   \n\n累计接收错误数。   \n\n0     TxDrops   \n\ninteger   \n\n累计发送丢包数。   \n\n0     TxBytes   \n\ninteger   \n\n累计发送字节数。   \n\n1381805699     RxPackets   \n\ninteger   \n\n累计接收包数量。   \n\n4800583     TxPackets   \n\ninteger   \n\n累计发送包数量。   \n\n5158427     Name   \n\nstring   \n\n网卡名称。   \n\neth0     TxErrors   \n\ninteger   \n\n累计发送错误数。   \n\n0     RxBytes   \n\ninteger   \n\n累计接收字节数。   \n\n505001954     RxDrops   \n\ninteger   \n\n累计接收丢包数。   \n\n0      CPU   \n\nobject   \n\nCPU 数据。   \n\n     UsageNanoCores   \n\ninteger   \n\nCPU 在采样窗口内的使用量（纳秒）。   \n\n0     Limit   \n\ninteger   \n\nCPU 使用上限（CPU 核数*1000）。   \n\n2000     UsageCoreNanoSeconds   \n\ninteger   \n\nCPU 历史使用总量。   \n\n70769883     Load   \n\ninteger   \n\n最近 10 秒的平均负载情况。   \n\n0      Disk   \n\narray<object>   \n\n磁盘数据。   \n\n         \n\nobject      \n\n     WriteBytes   \n\ninteger   \n\n磁盘写入的数据量，单位为 Byte。   \n\n1375109120     Device   \n\nstring   \n\n磁盘名称。   \n\n/dev/vda     WriteIo   \n\ninteger   \n\n该参数暂未开放使用。   \n\n123     ReadBytes   \n\ninteger   \n\n磁盘读取的数据量，单位为 Byte。   \n\n210714112     ReadIo   \n\ninteger   \n\n该参数暂未开放使用。   \n\n123     Timestamp   \n\nstring   \n\n监控数据对应的统计时间。格式为 RFC3339 时间格式。   \n\n2019-12-19T02:31:54Z      Memory   \n\nobject   \n\n内存数据。   \n\n     Rss   \n\ninteger   \n\n常驻内存集，即实际使用的物理内存。   \n\n1593344     UsageBytes   \n\ninteger   \n\n已使用内存。   \n\n11153408     WorkingSet   \n\ninteger   \n\n当前内存工作集使用量。   \n\n5521408     AvailableBytes   \n\ninteger   \n\n可用内存。   \n\n4289445888     Cache   \n\ninteger   \n\n缓存。   \n\n7028736      Containers   \n\narray<object>   \n\n容器的监控数据详情。   \n\n         \n\narray<object>      \n\n      CPU   \n\nobject   \n\n容器的 CPU 数据。   \n\n     UsageNanoCores   \n\ninteger   \n\nCPU 在采样窗口内的使用量（纳秒）。   \n\n0     Limit   \n\ninteger   \n\nCPU 使用上限（CPU 核数*1000）。   \n\n321234     UsageCoreNanoSeconds   \n\ninteger   \n\nCPU 历史使用总量。   \n\n40876694     Load   \n\ninteger   \n\n最近 10 秒的平均负载情况。   \n\n12341      Memory   \n\nobject   \n\n容器的内存数据。   \n\n     Rss   \n\ninteger   \n\n常驻内存集，即实际使用的物理内存。   \n\n9289728     UsageBytes   \n\ninteger   \n\n已使用内存。   \n\n9289728     WorkingSet   \n\ninteger   \n\n当前内存工作集使用量。   \n\n9289728     AvailableBytes   \n\ninteger   \n\n可用内存。   \n\n4285091840     Cache   \n\ninteger   \n\n缓存。   \n\n9289728     Name   \n\nstring   \n\n名称。   \n\ntest1      Filesystem   \n\narray<object>   \n\n文件系统分区数据。   \n\n         \n\nobject      \n\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeregions", "page_type": "doc", "title": "DescribeRegions - 查询可以使用的阿里云地域和可用区", "keywords": "DescribeRegions,查询DescribeRegions参数,DescribeRegions API参考", "last_modified_ms": 1760671624000, "last_modified_iso": "2025-10-17T11:27:04+08:00", "excerpt": "查询弹性容器实例支持的地域和可用区信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeRegions) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeRegions)   \n## 授权信息 \n\n当前API暂无授权信息透出。   \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 否    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 否    \n\n地域 ID。   \n\ncn-hangzhou       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject   \n\n返回信息。   \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n89945DD3-9072-47D0-A318-353284CFC7B3      Regions   \n\narray<object>   \n\n地域信息集合。   \n\n         \n\nobject   \n\n地域信息集合。   \n\n      Zones   \n\narray   \n\n可用区。   \n\n        \n\nstring   \n\n可用区。   \n\ncn-hangzhou-g      RecommendZones   \n\narray   \n\n推荐的可用区列表。   \n\n        \n\nstring   \n\n推荐的可用区。当前地域下，整体库存量相对充足的可用区。   \n\ncn-hangzhou-j     RegionEndpoint   \n\nstring   \n\n地域对应的接入地址（Endpoint）。   \n\neci.aliyuncs.com     RegionId   \n\nstring   \n\n地域 ID。   \n\ncn-hangzhou      UnavailableZones   \n\narray   \n\n不可用的可用区列表。   \n\n        \n\nstring   \n\n不可用的可用区。该可用区可能存在故障，建议使用其他可用区。   \n\ncn-hangzhou-e       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A318-353284CFC7B3\",\n  \"Regions\": [\n    {\n      \"Zones\": [\n        \"cn-hangzhou-g\"\n      ],\n      \"RecommendZones\": [\n        \"cn-hangzhou-j\"\n      ],\n      \"RegionEndpoint\": \"eci.aliyuncs.com\",\n      \"RegionId\": \"cn-hangzhou\",\n      \"UnavailableZones\": [\n        \"cn-hangzhou-e\"\n      ]\n    }\n  ]\n}\n\n   \n## 错误码 \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/DescribeRegions#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describevirtualnodes", "page_type": "doc", "title": "DescribeVirtualNodes - 批量查询虚拟节点信息", "keywords": "DescribeVirtualNodes,查询DescribeVirtualNodes参数,调用DescribeVirtualNodes接口,DescribeVirtualNodes API参考,DescribeVirtualNodes错误码", "last_modified_ms": 1761893424000, "last_modified_iso": "2025-10-31T14:50:24+08:00", "excerpt": "调用DescribeVirtualNodes批量查询虚拟节点的详细信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/DescribeVirtualNodes) [调试](https://api.aliyun.com/api/Eci/2018-08-08/DescribeVirtualNodes)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:DescribeVirtualNodes   \n\nget   \n\n*VirtualNode \n\nacs:eci:{#regionId}:{#accountId}:virtualnode/{#virtualnodeId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     VirtualNodeName   \n\nstring   \n\n 否    \n\n虚拟节点名称。   \n\ntestNode     VirtualNodeIds   \n\nstring   \n\n 否    \n\n虚拟节点 ID 序列。最多 20 个，字符串需按照 JSON 格式传入。   \n\n[\"vnd-2ze960zkdqrldeaw****\",\"vnd-3ebzcviqbwt25dsz****\"]     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多详情，请参阅[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000     Status   \n\nstring   \n\n 否    \n\n虚拟节点状态。取值范围： \n \n- \n\nPending \n- \n\nReady \n- \n\nFailed \n   \n\nReady     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-uf66jeqopgqa9hdn****     NextToken   \n\nstring   \n\n 否    \n\n下一个查询开始的 Token，NextToken 为空表示没有下一个。 \n\n首次查询时无需设置该参数，后续查询的 Token 从返回结果中获取。   \n\nd78f2dd8-5979-42fe-****-b16db43be5bc     Limit   \n\ninteger   \n\n 否    \n\n限制本次查询返回的资源数量。默认返回 20 个，最大不能超过 20 个。 说明  \n\n返回结果可能小于指定的数量，但不会多于指定的数量。    \n\n20      Tag   \n\narray<object>   \n\n 否    \n\n虚拟节点绑定的标签列表。   \n\n         \n\nobject   \n\n 否    \n\n虚拟节点绑定的标签列表。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\nname     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntest       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     TotalCount   \n\ninteger   \n\n查询到的虚拟节点数量。   \n\n1     NextToken   \n\nstring   \n\n下一个查询开始的 Token。   \n\nd78f2dd8-5979-42fe-****-b16db43be5bc     RequestId   \n\nstring   \n\n请求 ID。   \n\n9C9B9917-ED22-50D5-ADE6-9FA9D58AD05F      VirtualNodes   \n\narray<object>   \n\n虚拟节点信息集合。   \n\n         \n\narray<object>   \n\n虚拟节点信息集合。   \n\n     Status   \n\nstring   \n\n虚拟节点状态。可能值： \n \n- \n\nPending \n- \n\nReady \n- \n\nFailed \n   \n\nReady     CreationTime   \n\nstring   \n\n虚拟节点创建时间。UTC 时间，RFC 3339 标准。   \n\n2021-09-08T15:00:00Z     VpcId   \n\nstring   \n\n虚拟节点所属的 VPC ID。   \n\nvpc-1vzjjflab6wvjox****     InternetIp   \n\nstring   \n\n虚拟节点的公网 IP。   \n\n192.0.XX.XX      Tags   \n\narray<object>   \n\n虚拟节点绑定的标签信息。   \n\n         \n\nobject   \n\n标签信息。   \n\n     Key   \n\nstring   \n\n标签键。   \n\nname     Value   \n\nstring   \n\n标签值。   \n\ntest      Events   \n\narray<object>   \n\n事件信息。   \n\n         \n\nobject   \n\n事件信息。   \n\n     Type   \n\nstring   \n\n事件类型。可能值： \n \n- \n\nNormal \n- \n\nWarning \n   \n\nNormal     LastTimestamp   \n\nstring   \n\n事件结束时间。   \n\n2021-09-08T02:24:52Z     Message   \n\nstring   \n\n事件消息。   \n\nSuccessfully     Name   \n\nstring   \n\n事件的归属对象名。   \n\ntest     Reason   \n\nstring   \n\n事件名。   \n\nCreated     Count   \n\ninteger   \n\n事件数。   \n\n1     FirstTimestamp   \n\nstring   \n\n事件开始时间。   \n\n2021-09-08T02:24:48Z     VirtualNodeId   \n\nstring   \n\n虚拟节点 ID。   \n\nvnd-2ze960zkdqrldeaw****     IntranetIp   \n\nstring   \n\n虚拟节点的内网 IP。   \n\n10.19.XX.XX     RegionId   \n\nstring   \n\n虚拟节点所属的地域 ID。   \n\ncn-hangzhou     VirtualNodeVSwitchId   \n\nstring   \n\n虚拟节点所属的交换机 ID。   \n\nvsw-2ze23nqzig8inprou****     VirtualNodeSecurityGroupId   \n\nstring   \n\n虚拟节点所属的安全组 ID。   \n\nsg-2zeeyaaxlkq9sppl****     ResourceGroupId   \n\nstring   \n\n虚拟节点所属的资源组 ID。   \n\nrg-uf66jeqopgqa9hdn****     VirtualNodeName   \n\nstring   \n\n虚拟节点的名称。   \n\ntestNode       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"TotalCount\": 1,\n  \"NextToken\": \"d78f2dd8-5979-42fe-****-b16db43be5bc\",\n  \"RequestId\": \"9C9B9917-ED22-50D5-ADE6-9FA9D58AD05F\",\n  \"VirtualNodes\": [\n    {\n      \"Status\": \"Ready\",\n "}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-endpoint", "page_type": "doc", "title": "服务接入点", "keywords": "查询ECI服务接入点,ECI服务接入点列表,ECI地域与Endpoint", "last_modified_ms": 1760081725000, "last_modified_iso": "2025-10-10T15:35:25+08:00", "excerpt": "## 亚太 \n\n[表格]\n        \n\n地域名称   \n\n地域ID   \n\n公网接入地址   \n\nVPC接入地址     华北6（乌兰察布）   cn-wulanchabu   eci.cn-wulanchabu.aliyuncs.com   eci-vpc.cn-wulanchabu.aliyuncs.com     华北2（北京）   cn-beijing   eci.cn-beijing.aliyuncs.com   eci-vpc.cn-beijing.aliyuncs.com     郑州（联通合营）   cn-zhengzhou-jva   eci.cn-zhengzhou-jva.aliyuncs.com   eci-vpc.cn-zhengzhou-jva.aliyuncs.com     华北1（青岛）   cn-qingdao   eci.cn-qingdao.aliyuncs.com   eci-vpc.cn-qingdao.aliyuncs.com     华中1（武汉-本地地域）   cn-wuhan-lr   eci.cn-wuhan-lr.aliyuncs.com   eci-vpc.cn-wuhan-lr.aliyuncs.com     华东2（上海）   cn-shanghai   eci.cn-shanghai.aliyuncs.com   eci-vpc.cn-shanghai.aliyuncs.com     中国香港   cn-hongkong   eci.cn-hongkong.aliyuncs.com   eci-vpc.cn-hongkong.aliyuncs.com     华南2（河源）   cn-heyuan   eci.cn-heyuan.aliyuncs.com   eci-vpc.cn-heyuan.aliyuncs.com     华北3（张家口）   cn-zhangjiakou   eci.cn-zhangjiakou.aliyuncs.com   eci-vpc.cn-zhangjiakou.aliyuncs.com     华南1（深圳）   cn-shenzhen   eci.cn-shenzhen.aliyuncs.com   eci-vpc.cn-shenzhen.aliyuncs.com     华东5（南京-本地地域）   cn-nanjing   eci.cn-nanjing.aliyuncs.com   eci-vpc.cn-nanjing.aliyuncs.com     韩国（首尔）   ap-northeast-2   eci.ap-northeast-2.aliyuncs.com   eci-vpc.ap-northeast-2.aliyuncs.com     日本（东京）   ap-northeast-1   eci.ap-northeast-1.aliyuncs.com   eci-vpc.ap-northeast-1.aliyuncs.com     华东6（福州-本地地域）   cn-fuzhou   eci.cn-fuzhou.aliyuncs.com   eci-vpc.cn-fuzhou.aliyuncs.com     西南1（成都）   cn-chengdu   eci.cn-chengdu.aliyuncs.com   eci-vpc.cn-chengdu.aliyuncs.com     华南3（广州）   cn-guangzhou   eci.cn-guangzhou.aliyuncs.com   eci-vpc.cn-guangzhou.aliyuncs.com     新加坡   ap-southeast-1   eci.ap-southeast-1.aliyuncs.com   eci-vpc.ap-southeast-1.aliyuncs.com     澳大利亚（悉尼）   ap-southeast-2   eci.ap-southeast-2.aliyuncs.com   eci-vpc.ap-southeast-2.aliyuncs.com     马来西亚（吉隆坡）   ap-southeast-3   eci.ap-southeast-3.aliyuncs.com   eci-vpc.ap-southeast-3.aliyuncs.com     华北5（呼和浩特）   cn-huhehaote   eci.cn-huhehaote.aliyuncs.com   eci-vpc.cn-huhehaote.aliyuncs.com     印度尼西亚（雅加达）   ap-southeast-5   eci.ap-southeast-5.aliyuncs.com   eci-vpc.ap-southeast-5.aliyuncs.com     菲律宾（马尼拉）   ap-southeast-6   eci.ap-southeast-6.aliyuncs.com   eci-vpc.ap-southeast-6.aliyuncs.com     泰国（曼谷）   ap-southeast-7   eci.ap-southeast-7.aliyuncs.com   eci-vpc.ap-southeast-7.aliyuncs.com     华东1（杭州）   cn-hangzhou   eci.cn-hangzhou.aliyuncs.com   eci-vpc.cn-hangzhou.aliyuncs.com     \n## 欧洲与美洲 \n\n[表格]\n        \n\n地域名称   \n\n地域ID   \n\n公网接入地址   \n\nVPC接入地址     美国（弗吉尼亚）   us-east-1   eci.us-east-1.aliyuncs.com   eci-vpc.us-east-1.aliyuncs.com     英国（伦敦）   eu-west-1   eci.eu-west-1.aliyuncs.com   eci-vpc.eu-west-1.aliyuncs.com     美国（硅谷）   us-west-1   eci.us-west-1.aliyuncs.com   eci-vpc.us-west-1.aliyuncs.com     德国（法兰克福）   eu-central-1   eci.eu-central-1.aliyuncs.com   eci-vpc.eu-central-1.aliyuncs.com     \n## 中东与印度 \n\n[表格]\n        \n\n地域名称   \n\n地域ID   \n\n公网接入地址   \n\nVPC接入地址     阿联酋（迪拜）   me-east-1   eci.me-east-1.aliyuncs.com   eci-vpc.me-east-1.aliyuncs.com     沙特（利雅得）   me-central-1   eci.me-central-1.aliyuncs.com   eci-vpc.me-central-1.aliyuncs.com     印度（孟买）   ap-south-1   eci.ap-south-1.aliyuncs.com   eci-vpc.ap-south-1.aliyuncs.com     \n## 行业云 \n\n[表格]\n        \n\n地域名称   \n\n地域ID   \n\n公网接入地址   \n\nVPC接入地址     华南1 金融云   cn-shenzhen-finance-1   eci.cn-shenzhen-finance.aliyuncs.com   eci-vpc.cn-shenzhen-finance-1.aliyuncs.com     华北2 金融云（邀测）   cn-beijing-finance-1   eci.cn-beijing-finance-1.aliyuncs.com   eci-vpc.cn-beijing-finance-1.aliyuncs.com     华东2 金融云   cn-shanghai-finance-1   eci.cn-shanghai-finance.aliyuncs.com   eci-vpc.cn-shanghai-finance-1.aliyuncs.com     华东1 金融云   cn-hangzhou-finance   eci.cn-hangzhou-finance.aliyuncs.com\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-errorcodes", "page_type": "doc", "title": "公共错误码", "keywords": "查询公共错误码含义,公共错误码参考,公共错误码大全", "last_modified_ms": 1767081651000, "last_modified_iso": "2025-12-30T16:00:51+08:00", "excerpt": "## 错误码 \n\n[表格]\n         \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述   \n\n操作     400   Account.Arrearage   Your account has an outstanding payment.   账号已经欠费。   [诊断](https://api.aliyun.com/troubleshoot?q=Account.Arrearage)     403   BatchCreateNotSupportExistingCloudDisk   The batch create API does not support the mounting of existing disks.   批量创建不支持挂载已有云盘。   [诊断](https://api.aliyun.com/troubleshoot?q=BatchCreateNotSupportExistingCloudDisk)     400   CloudDisk.NotInSameZone   %s.   请求中声明的云盘没有在同一可用区内。   [诊断](https://api.aliyun.com/troubleshoot?q=CloudDisk.NotInSameZone)     503   containerRepositoryAuthorizationFailed   An error occurred while authenticating the container image repository. Make sure that you have activated ACR, and try again later.   容器镜像仓库认证失败，请确认是否开通了阿里云容器镜像服务（ACR）。   [诊断](https://api.aliyun.com/troubleshoot?q=containerRepositoryAuthorizationFailed)     400   CorePattern.UpdateFail   Update coredump settings fail, please try again later.   更新Coredump设置失败，请重试。   [诊断](https://api.aliyun.com/troubleshoot?q=CorePattern.UpdateFail)     403   CreateServiceLinkedRole.Denied   Please make sure the account has ram:CreateServiceLinkedRole permission.   请确保账号拥有ram:CreateServiceLinkedRole权限。   [诊断](https://api.aliyun.com/troubleshoot?q=CreateServiceLinkedRole.Denied)     400   DedicatedHostQuotaExceeded   The quota of DedicatedHost is exceeded.   专有宿主机的quota超过限制   [诊断](https://api.aliyun.com/troubleshoot?q=DedicatedHostQuotaExceeded)     400   Degrade.Api   The request was denied due to API flow control. The system has been downgraded.   您这个时段的流量已经超限。如果不能满足现有业务要求可以提工单进行申请。系统降级。   [诊断](https://api.aliyun.com/troubleshoot?q=Degrade.Api)     400   DiskNumber.LimitExceed   The maximum number of disks in an instance is exceeded.   实例下云盘数目超过限制。   [诊断](https://api.aliyun.com/troubleshoot?q=DiskNumber.LimitExceed)     400   DiskVolume.NotInSameZone   The instance to be created and the disk are not in the same zone.   即将创建的实例和云盘不在同一可用区。   [诊断](https://api.aliyun.com/troubleshoot?q=DiskVolume.NotInSameZone)     400   DiskVolume.NotSupport   The disk volume is not supported.   云盘卷暂不支持，如有需要请联系我们。   [诊断](https://api.aliyun.com/troubleshoot?q=DiskVolume.NotSupport)     400   DryRun.Success   This request is a dryrun request with successful result.   该dryrun请求校验已经通过。   [诊断](https://api.aliyun.com/troubleshoot?q=DryRun.Success)     400   DryRunOperation   Request validation has been passed with DryRun flag set.   此次DryRun预检请求合格。   [诊断](https://api.aliyun.com/troubleshoot?q=DryRunOperation)     400   EipAddressPoolIpNotEnough   The ip address of specified PublicIpAddressPool is not enough.   指定的eip公网地址池地址资源不足。   [诊断](https://api.aliyun.com/troubleshoot?q=EipAddressPoolIpNotEnough)     400   EipPayInsufficientBalance   Your account does not have enough balance to purchase eip.   当前账户余额不足以购买eip。   [诊断](https://api.aliyun.com/troubleshoot?q=EipPayInsufficientBalance)     400   EipPurchaseFlowControl   Request was denied due to eip frequent purchase.   当前购买eip过于频繁，请稍后重试。   [诊断](https://api.aliyun.com/troubleshoot?q=EipPurchaseFlowControl)     403   FeatureAccessRestricted   Access to this feature:[%s] is restricted. Please contact Alibaba Cloud ECI support to request access.   使用该特性需要申请白名单，请联系阿里云ECI团队申请加白。   [诊断](https://api.aliyun.com/troubleshoot?q=FeatureAccessRestricted)     400   FeatureBasedConstraintConflict   A conflict occurs in specified feature constraints: [%s].   指定的规格特性约束发生冲突   [诊断](https://api.aliyun.com/troubleshoot?q=FeatureBasedConstraintConflict)     403   Forbidden.AccessKeyDisabled   The Access Key is disabled.   Access Key无效   [诊断](https://api.aliyun.com/troubleshoot?q=Forbidden.AccessKeyDisabled)     403   Forbidden.AccountClosed   The operation is forbidden. Your account has been closed.   操作被禁止，因为用户账户已注销。   [诊断](https://api.aliyun.com/troubleshoot?q=Forbidden.AccountClosed)     403   Forbidden.NotSupportRAM   This action does not support access in RAM mode.   RAM模式不支持的操作   [诊断](https://api.aliyun.com/troubleshoot?q=Forbi"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-execcontainercommand", "page_type": "doc", "title": "ExecContainerCommand - 在容器内部执行命令", "keywords": "ExecContainerCommand,调用ExecContainerCommand,查询ExecContainerCommand参数,ExecContainerCommand API参考,ExecContainerCommand请求参数", "last_modified_ms": 1760670570000, "last_modified_iso": "2025-10-17T11:09:30+08:00", "excerpt": "调用ExecContainerCommand在容器内部执行命令。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/ExecContainerCommand) [调试](https://api.aliyun.com/api/Eci/2018-08-08/ExecContainerCommand)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:ExecContainerCommand   \n\nupdate   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n实例所属的地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n实例所属的地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\n实例 ID，即容器组 ID。   \n\neci-2zebxkiifulhl****     ContainerName   \n\nstring   \n\n 是    \n\n容器名称。   \n\nnginx     Command   \n\nstring   \n\n 是    \n\n要在容器内执行的命令序列。最多 20 个命令，单个命令最长 256 个字符。\n 执行多个命令时，字符串需按照 JSON 格式传入，例如：[\"/bin/sh\", \"-c\", \"ls -a\"]。   \n\n[\"/bin/sh\", \"-c\", \"ls -a\"]     TTY   \n\nboolean   \n\n 否    \n\n是否开启交互。默认为 false。\n 当 Command 为/bin/bash命令时，需要设置为 true。   \n\nfalse     Stdin   \n\nboolean   \n\n 否    \n\n是否标准输入。默认为 true。   \n\ntrue     Sync   \n\nboolean   \n\n 否    \n\n是否立即执行命令并同步返回结果。默认为 false。\n 如果设置为 true，TTY 只能设置为 false（即 Command 不是/bin/bash命令）。   \n\nfalse       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n28B583A8-313D-4383-7817-B5A9F7E0****     WebSocketUri   \n\nstring   \n\nWebSocket URL。您可以利用 WebSocket URL 建立与容器的连接。   \n\nwss://eci-cn-shanghai.aliyun.com/exec/?s=ktHPx****     HttpUrl   \n\nstring   \n\nHTTP URL。在 30 秒内访问该地址可以进入到容器。更多信息，请参见[使用并集成 ECI Terminal](https://help.aliyun.com/zh/eci/use-cases/use-and-integrate-the-elastic-container-instance-terminal)。   \n\nhttps://eci.console.aliyun.com/terminal?param=X32a****     SyncResponse   \n\nstring   \n\n命令的返回结果。当 Sync 设置为 true 时返回该参数。   \n\nHello       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"28B583A8-313D-4383-7817-B5A9F7E0****\",\n  \"WebSocketUri\": \"wss://eci-cn-shanghai.aliyun.com/exec/?s=ktHPx****\",\n  \"HttpUrl\": \"https://eci.console.aliyun.com/terminal?param=X32a****\",\n  \"SyncResponse\": \"Hello\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   InvalidParameter.ValueExceeded   %s   参数值超过规定范围     400   IncorrectStatus   %s   指定的实例状态不正确。     \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/ExecContainerCommand#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listtagresources", "page_type": "doc", "title": "ListTagResources - 查询ECI资源绑定的标签信息", "keywords": "ListTagResources,查询ECI资源标签,查询ListTagResources参数,ListTagResources API参考,ListTagResources请求参数", "last_modified_ms": 1760669896000, "last_modified_iso": "2025-10-17T10:58:16+08:00", "excerpt": "调用ListTagResources查询ECI资源绑定的标签信息。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/ListTagResources) [调试](https://api.aliyun.com/api/Eci/2018-08-08/ListTagResources)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:ListTagResources   \n\nlist   \n\n*全部资源 \n\n*   无   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n资源所属的地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n资源所属的地域 ID。   \n\ncn-hangzhou      ResourceId   \n\narray   \n\n 否    \n\n资源 ID 列表。   \n\n        \n\nstring   \n\n 否    \n\n资源 ID。根据 ResourceType 取值填写对应资源 ID。   \n\neci-2zelg8vwnlzdhf8hv***      Tag   \n\narray<object>   \n\n 否    \n\n标签列表。   \n\n         \n\nobject   \n\n 否    \n\n标签列表。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\ntestkey     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntestvalue     ResourceType   \n\nstring   \n\n 是    \n\n资源类型。取值范围： \n \n- \n\nContainerGroup：ECI 实例 \n- \n\nImageCache：镜像缓存 \n- \n\nDataCache：数据缓存 \n- \n\nVirtualNode：虚拟节点 \n   \n\nContainerGroup     Limit   \n\nstring   \n\n 否    \n\n查询结果条数上限。   \n\n20     NextToken   \n\nstring   \n\n 否    \n\n查询凭证（Token），取值为上一次 API 调用返回的 NextToken 参数值。   \n\nAAAAAdDWBF2****        \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     NextToken   \n\nstring   \n\n本次调用返回的查询凭证值。   \n\nAAAAAdDWBF2****     RequestId   \n\nstring   \n\n请求 ID。   \n\n1340C38D-6189-54D1-86F6-7D5ECF3E0088      TagResources   \n\narray<object>   \n\n资源列表。   \n\n         \n\nobject   \n\n资源列表。   \n\n     ResourceType   \n\nstring   \n\n资源类型。可能值： \n \n- \n\nContainerGroup：ECI 实例 \n- \n\nImageCache：镜像缓存 \n- \n\nDataCache：数据缓存 \n- \n\nVirtualNode：虚拟节点 \n   \n\nContainerGroup     TagValue   \n\nstring   \n\n资源绑定标签的标签值。   \n\ntestvalue     ResourceId   \n\nstring   \n\n资源 ID。   \n\neci-2zelg8vwnlzdhf8hv****      TagKey   \n\nstring   \n\n资源绑定标签的标签键。   \n\ntestkey       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"NextToken\": \"AAAAAdDWBF2****\",\n  \"RequestId\": \"1340C38D-6189-54D1-86F6-7D5ECF3E0088\",\n  \"TagResources\": [\n    {\n      \"ResourceType\": \"ContainerGroup\",\n      \"TagValue\": \"testvalue\",\n      \"ResourceId\": \"eci-2zelg8vwnlzdhf8hv****\\n\",\n      \"TagKey\": \"testkey\"\n    }\n  ]\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   NoPermission.Tag   No permissions to operate tags.   您无操作tag的权限。     400   NumberExceed.Tags   The length of tags exceeded limit: 20.   tag的数量超过20的限制。     \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/ListTagResources#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listusage", "page_type": "doc", "title": "ListUsage - 查询权益配额", "keywords": "ListUsage,查询权益配额,调用ListUsage接口,ListUsage API参考,权益配额查询", "last_modified_ms": 1760670304000, "last_modified_iso": "2025-10-17T11:05:04+08:00", "excerpt": "调用ListUsage查询指定地域的权益配额，包括已使用量和使用上限。   \n## 接口说明 \n\n本接口不支持资源组鉴权。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/ListUsage) [调试](https://api.aliyun.com/api/Eci/2018-08-08/ListUsage)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:ListUsage   \n\nget   \n\n*全部资源 \n\n*   无   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 否    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89164E78-FC82-4684-BE97-DCDD85D26546     Attributes   \n\nobject   \n\n指定地域权益配额的已使用量和使用上限的信息集合。包含以下几项： \n \n- \n\nUsedCpu：已有 vCPU 数。 \n- \n\nMaxCpu：vCPU 上限。 \n- \n\nMaxImageCacheCount：手动创建的镜像缓存数量上限。 \n- \n\nUsedImageCacheCount：已有的手动创建的镜像缓存数量。 \n- \n\nMaxAutoImageCacheCount：自动创建的镜像缓存数量上限。 \n- \n\nUsedAutoImageCacheCount：已有的自动创建的镜像缓存数量。 \n- \n\nMaxDataCacheCount：数据缓存数量上限。 \n- \n\nUsedDataCacheCount：已有的数据缓存数量。 \n   \n\n{ \"UsedAutoImageCacheCount\": 4, \"UsedDataCacheCount\": 3, \"MaxDataCacheCount\": 100, \"UsedCpu\": 16.5, \"MaxCpu\": 1000, \"MaxAutoImageCacheCount\": 25, \"MaxImageCacheCount\": 500, \"UsedImageCacheCount\": 0 }       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89164E78-FC82-4684-BE97-DCDD85D26546\",\n  \"Attributes\": {\n    \"UsedAutoImageCacheCount\": 4,\n    \"UsedDataCacheCount\": 3,\n    \"MaxDataCacheCount\": 100,\n    \"UsedCpu\": 16.5,\n    \"MaxCpu\": 1000,\n    \"MaxAutoImageCacheCount\": 25,\n    \"MaxImageCacheCount\": 500,\n    \"UsedImageCacheCount\": 0\n  }\n}\n\n   \n## 错误码 \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/ListUsage#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-overview", "page_type": "doc", "title": "API概览", "keywords": "查询ECI API列表,了解ECI API功能,ECI API参考,ECI API列表", "last_modified_ms": 1761880662000, "last_modified_iso": "2025-10-31T11:17:42+08:00", "excerpt": "本产品（Eci/2018-08-08）的OpenAPI采用[RPC](https://help.aliyun.com/zh/sdk/product-overview/v3-request-structure-and-signature)签名风格，签名细节参见[签名机制说明](https://help.aliyun.com/zh/sdk/product-overview/roa-mechanism)。我们已经为开发者封装了常见编程语言的SDK，开发者可通过[下载SDK](https://api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08)直接调用本产品OpenAPI而无需关心技术细节。如果现有SDK不能满足使用需求，可通过签名机制进行自签名对接。由于自签名细节非常复杂，需花费 5个工作日左右。因此建议加入我们的服务钉钉群（147535001692），在专家指导下进行签名对接。\n\n在使用API前，您需要准备好身份账号及访问密钥（AccessKey），才能有效通过客户端工具（SDK、CLI等）访问API。细节请参见[获取AccessKey](https://help.aliyun.com/zh/ram/user-guide/create-an-accesskey-pair)。  \n## 地域 \n\n[表格]\n       \n\nAPI   \n\n标题   \n\nAPI概述     [DescribeRegions](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeregions)   查询可以使用的阿里云地域和可用区   查询弹性容器实例支持的地域和可用区信息。       \n## 容器组 \n\n[表格]\n       \n\nAPI   \n\n标题   \n\nAPI概述     [CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)   创建一个容器组   调用CreateContainerGroup创建一个ECI实例（即容器组）。     [UpdateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updatecontainergroup)   更新一个容器组   更新实例。     [DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)   批量查询容器组信息   调用DescribeContainerGroups批量查询ECI实例的信息。     [DescribeContainerGroupStatus](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupstatus)   批量查询容器组状态   调用DescribeContainerGroupStatus批量查询ECI实例的状态。     [DescribeContainerGroupEvents](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupevents)   查询容器组事件列表   调用DescribeContainerGroupEvents批量查询ECI实例的事件信息。     [ResizeContainerGroupVolume](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-resizecontainergroupvolume)   扩容容器组的数据卷   调用ResizeContainerGroupVolume扩容指定ECI实例挂载的云盘数据卷。     [RestartContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-restartcontainergroup)   重启一个容器组   调用RestartContainerGroup重启一个ECI实例。     [DeleteContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletecontainergroup)   删除一个容器组   调用DeleteContainerGroup删除一个ECI实例。       \n## 容器 \n\n[表格]\n       \n\nAPI   \n\n标题   \n\nAPI概述     [ExecContainerCommand](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-execcontainercommand)   在容器内部执行命令   调用ExecContainerCommand在容器内部执行命令。     [DescribeContainerLog](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainerlog)   获取容器日志信息   调用DescribeContainerLog获取容器组内某个容器的日志信息。     [CommitContainer](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-commitcontainer)   创建CommitContainer任务   调用CommitContainer接口创建异步任务，将ECI实例中的指定容器保存为镜像，并推送至阿里云ACR的镜像仓库中。     [DescribeCommitContainerTask](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecommitcontainertask)   查询CommitContainer任务详情   调用DescribeCommitContainerTask查询CommitContainer任务的详情。       \n## 镜像缓存 \n\n[表格]\n       \n\nAPI   \n\n标题   \n\nAPI概述     [CreateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createimagecache)   创建一个镜像缓存   调用CreateImageCache接口创建一个镜像缓存，以便后续创建ECI实例可以加速镜像拉取，减少实例启动耗时。     [DeleteImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deleteimagecache)   删除一个镜像缓存   调用DeleteImageCache删除一个镜像缓存。     [UpdateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updateimagecache)   更新一个镜像缓存   调用UpdateImageCache更新一个镜像缓存。     [DescribeImageCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeimagecaches)   批量查询镜像缓存信息   调用DescribeImageCaches批量查询镜像缓存信息。       \n## 数据缓存 \n\n[表格]\n       \n\nAPI   \n\n标题   \n\nAPI概述     [CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)   创建数据缓存   创建一个数据缓存。     [DescribeDataCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedata", "aliases": ["https://help.aliyun.com/document_detail/479590.html"]}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-ram", "page_type": "doc", "title": "授权信息", "keywords": "查询ECI权限列表,配置ECI RAM策略,ECI RAM授权参考,ECI Action列表", "last_modified_ms": 1749713786000, "last_modified_iso": "2025-06-12T15:36:26+08:00", "excerpt": "访问控制（RAM）是阿里云提供的管理用户身份与资源访问权限的服务。使用 RAM 可以让您避免与其他用户共享阿里云账号密钥，并可按需为用户授予最小权限。RAM 中使用权限策略描述授权的具体内容。\n\n本文为您介绍 弹性容器实例 为 RAM 权限策略定义的操作（Action）、资源（Resource）和条件（Condition）。 弹性容器实例 的 RAM 代码（RamCode）为 eci ，支持的授权粒度为 资源级 。 \n## 权限策略通用结构\n\n权限策略支持 JSON 格式，其通用结构如下：\n\n{\n  \"Version\": \"1\",\n  \"Statement\": [\n    {\n      \"Effect\": \"<Effect>\",\n      \"Action\": \"<Action>\",\n      \"Resource\": \"<Resource>\",\n      \"Condition\": {\n        \"<Condition_operator>\": {\n          \"<Condition_key>\": [\n            \"<Condition_value>\"\n          ]\n        }\n      }\n    }\n  ]\n}        \n\n\n 各字段含义如下：\n\n- \n\nEffect：权限策略效果。取值：Allow（允许）、Deny（拒绝）。\n- \n\nAction：授予允许或拒绝权限的具体操作。具体信息，请参见[操作（Action）](#title-auth-detail-2)。\n- \n\nResource：受操作影响的具体对象，您可以使用资源 ARN 来描述指定资源。具体信息，请参见[资源（Resource）](#title-auth-detail-3)。\n- \n\nCondition：指授权生效的条件。可选字段。具体信息，请参见[条件（Condition）](#title-auth-detail-4)。\n\n- \n\nCondition_operator：条件运算符，不同类型的条件对应不同的条件运算符。具体信息，请参见[权限策略基本元素](https://help.aliyun.com/zh/ram/policy-elements)。\n- \n\nCondition_key：条件关键字。\n- \n\nCondition_value：条件关键字对应的值。\n\n  \n## 操作（Action） \n\n下表是弹性容器实例定义的操作，这些操作可以在 RAM 权限策略语句的Action元素中使用，用来授予执行该操作的权限。下面对表中的具体项提供说明： \n\n- \n\n操作：是指具体的权限点。\n- \n\nAPI：是指操作对应的 API 接口。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下： \n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。该列不体现适用于任何操作的[通用条件关键字](https://help.aliyun.com/zh/ram/policy-elements)。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n          \n\n操作   \n\nAPI   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     eci:DescribeCommitContainerTask   DescribeCommitContainerTask   get    *CommitContainerTask acs:eci:{#regionId}:{#accountId}:containergroup/*    eci:tag   无     eci:UpdateImageCache   UpdateImageCache   update    *ImageCache acs:eci:{#regionId}:{#accountId}:imagecache/{#ImageCacheId}    eci:tag   无     eci:CommitContainer   CommitContainer   create    *CommitContainerTask acs:eci:{#regionId}:{#accountId}:containergroup/*    eci:tag   无     eci:DescribeContainerGroupStatus   DescribeContainerGroupStatus   get    *containergroup acs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}    eci:tag   无     eci:CreateContainerGroupFromTemplate   CreateContainerGroupFromTemplate   create    *ContainerGroup acs:eci:{#regionId}:{#accountId}:containergroup/*    eci:tag   无     eci:ExportContainerGroupTemplate   ExportContainerGroupTemplate   get    *全部资源 *    eci:tag   无     eci:ListTagResources   ListTagResources   list    *全部资源 *    无   无     eci:UpdateConfigMap   UpdateConfigMap       *全部资源 *    无   无     eci:RestartContainer   RestartContainer   update    *containergroup acs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}    eci:tag   无     eci:CreateLaunchTemplate   CreateLaunchTemplate       *LaunchTemplate acs:eci:{#regionId}:{#accountId}:launchtemplate/*    无   无     eci:ResizeContainerGroupVolume   ResizeContainerGroupVolume   update    *全部资源 *    eci:tag   无     eci:DeleteContainerGroups   DeleteContainerGroups   delete    *ContainerGroup acs:eci:{#regionId}:{#accountId}:containergroup/{#ContainerGroupId}    eci:tag   无     eci:DescribeDataCaches   DescribeDataCaches   list    *DataCache acs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}    eci:tag   无     eci:DeleteDataCache   DeleteDataCache   delete    *DataCache acs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}    eci:tag   无     eci:UpdateVirtualNode   UpdateVirtualNode   update    *VirtualNode acs:eci:{#regionId}:{#accountId}:virtualnode/{#VirtualNodeId}    eci:tag   无     eci:DescribeUpdateConfigMapTask   DescribeUpdateConfigMapTask   none    *全部资源 *    无   无     eci:DescribeVirtualNodes   DescribeVirtualNodes   get    *VirtualNode acs:eci:{#regionId}:{#accountId}:virtualnode/{#virtualnodeId}    eci:tag   无     eci:DescribeImageCacheMetrics   DescribeImageCacheMetrics   none    *全部资源 *    eci:tag   无     eci:DeleteContainerGroup   DeleteContainerGroup   delete    *containergroup acs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}    ec"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-resizecontainergroupvolume", "page_type": "doc", "title": "ResizeContainerGroupVolume - 扩容容器组的数据卷", "keywords": "ResizeContainerGroupVolume,扩容容器组数据卷,了解ResizeContainerGroupVolume,ResizeContainerGroupVolume参考,ResizeContainerGroupVolume参数", "last_modified_ms": 1760670131000, "last_modified_iso": "2025-10-17T11:02:11+08:00", "excerpt": "调用ResizeContainerGroupVolume扩容指定ECI实例挂载的云盘数据卷。   \n## 接口说明 \n## 接口说明 \n \n- \n\n该接口仅支持扩容数据卷，不支持缩容数据卷。 \n- \n\n目前仅支持扩容云盘类型的数据卷，暂不支持扩容其他类型的数据卷。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/ResizeContainerGroupVolume) [调试](https://api.aliyun.com/api/Eci/2018-08-08/ResizeContainerGroupVolume)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:ResizeContainerGroupVolume   \n\nupdate   \n\n*全部资源 \n\n*   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\n要扩容数据卷的 ECI 实例 ID，即容器组 ID。   \n\neci-2zelg8vwnlzdhf8hv****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。ClientToken 只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000     VolumeName   \n\nstring   \n\n 是    \n\nECI 实例挂载的数据卷名称。目前仅支持扩容云盘。   \n\ndefault-volume1     NewSize   \n\ninteger   \n\n 是    \n\n扩容后的云盘容量大小。单位为 GiB。取值范围： \n \n- \n\n高效云盘（cloud_efficiency）：20~32768 \n- \n\nSSD 云盘（cloud_ssd）：20~32768 \n- \n\nESSD 云盘（cloud_essd）：20~32768 \n- \n\n普通云盘（cloud）：5~2000 \n 说明  \n\n扩容后的云盘容量必须大于原有云盘容量。如果扩容指定的容量与原有云盘容量一致，则仅扩容文件系统。    \n\n100       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89945DD3-9072-47D0-A318-353284CFC7B3       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A318-353284CFC7B3\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   InvalidParameter   %s   不合法的参数     403   InvalidVolumeType   The specified volumeName is invalid, only volume of cloud disk support capacity resize        403   IncorrectStatusDetail   %s        403   InvalidAction   The specified action is invalid         \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/ResizeContainerGroupVolume#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-restartcontainergroup", "page_type": "doc", "title": "RestartContainerGroup - 重启一个容器组", "keywords": "RestartContainerGroup,重启容器组,RestartContainerGroup参考,容器组重启条件", "last_modified_ms": 1760671652000, "last_modified_iso": "2025-10-17T11:27:32+08:00", "excerpt": "调用RestartContainerGroup重启一个ECI实例。   \n## 接口说明 \n \n- \n\n仅状态为启动中（Pending）或者运行中（Running）的 ECI 实例支持重启，已经运行完成的 ECI 实例不支持重启。 \n- \n\n创建时间早于 2019-03-07 15:00:00 的 ECI 实例不支持重启。 \n- \n\n重启中的 ECI 实例状态将变更为 Restarting。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/RestartContainerGroup) [调试](https://api.aliyun.com/api/Eci/2018-08-08/RestartContainerGroup)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:RestartContainerGroup   \n\nupdate   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\nECI 实例 ID，即容器组 ID。   \n\neci-2zelg8vwnlzdhf8hv****     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID，唯一标识。   \n\n45D5B0AD-3B00-4A9B-9911-6D5303B06712       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"45D5B0AD-3B00-4A9B-9911-6D5303B06712\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   IncorrectStatus   %s   指定的实例状态不正确。     400   InvalidParameter   %s   不合法的参数     403   InvalidAction   The specified action is invalid   不合法的操作     \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/RestartContainerGroup#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-tagresources", "page_type": "doc", "title": "TagResources - 为ECI资源绑定标签", "keywords": "TagResources,绑定ECI资源标签,调用TagResources接口,查询TagResources参数,TagResources API参考,TagResources请求参数,TagResources错误码", "last_modified_ms": 1760670330000, "last_modified_iso": "2025-10-17T11:05:30+08:00", "excerpt": "调用TagResources为指定的ECI资源绑定标签。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/TagResources) [调试](https://api.aliyun.com/api/Eci/2018-08-08/TagResources)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:TagResources   \n\n   \n\nContainerGroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#ContainerGroupId} \n\nImageCache \n\nacs:eci:{#regionId}:{#accountId}:imagecache/{#ImageCacheId} \n\nVirtualNode \n\nacs:eci:{#regionId}:{#accountId}:virtualnode/{#VirtualNodeId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n资源所属的地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n资源所属的地域 ID。   \n\ncn-hangzhou      ResourceId   \n\narray   \n\n 是    \n\n资源 ID 列表。   \n\n        \n\nstring   \n\n 否    \n\n资源 ID。根据 ResourceType 取值填写对应资源 ID。   \n\neci-2zelg8vwnlzdhf8hv****      Tag   \n\narray<object>   \n\n 是    \n\n标签列表。一个资源最多可以绑定 20 个标签。   \n\n         \n\nobject   \n\n 否    \n\n标签列表。一个资源最多可以绑定 20 个标签。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。一旦传入该值，则不允许为空字符串。最多支持 128 个字符，不能以aliyun和acs:开头，不能包含http://或者https://。   \n\ntestkey     Value   \n\nstring   \n\n 否    \n\n标签键。一旦传入该值，可以为空字符串。最多支持 128 个字符，不能以aliyun和acs:开头，不能包含http://或者https://。   \n\ntestvalue     ResourceType   \n\nstring   \n\n 是    \n\n资源类型。取值范围： \n \n- \n\nContainerGroup：ECI 实例 \n- \n\nImageCache：镜像缓存 \n- \n\nDataCache：数据缓存 \n- \n\nVirtualNode：虚拟节点 \n   \n\nContainerGroup       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n0E234675-3465-4CC3-9D0F-9A864BC391DD       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"0E234675-3465-4CC3-9D0F-9A864BC391DD\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   IncorrectStatus   %s   指定的实例状态不正确。     400   OperationConflict   Request was denied due to conflict with a previous request.   该请求被禁止，因为与之前的请求冲突     400   NoPermission.Tag   No permissions to operate tags.   您无操作tag的权限。     400   NumberExceed.Tags   The length of tags exceeded limit: 20.   tag的数量超过20的限制。     \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/TagResources#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-untagresources", "page_type": "doc", "title": "UntagResources - 为ECI资源解绑标签", "keywords": "UntagResources,解绑ECI资源标签,查询UntagResources参数,UntagResources API参考,UntagResources请求参数", "last_modified_ms": 1760669929000, "last_modified_iso": "2025-10-17T10:58:49+08:00", "excerpt": "调用UntagResources为指定的ECI资源解绑标签。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/UntagResources) [调试](https://api.aliyun.com/api/Eci/2018-08-08/UntagResources)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:UntagResources   \n\n   \n\nContainerGroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#ContainerGroupId} \n\nImageCache \n\nacs:eci:{#regionId}:{#accountId}:imagecache/{#ImageCacheId} \n\nVirtualNode \n\nacs:eci:{#regionId}:{#accountId}:virtualnode/{#VirtualNodeId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n资源所属的地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n资源所属的地域 ID。   \n\ncn-hangzhou      ResourceId   \n\narray   \n\n 是    \n\n资源 ID 列表。   \n\n        \n\nstring   \n\n 否    \n\n资源 ID。根据 ResourceType 取值填写对应资源 ID。   \n\neci-2zelg8vwnlzdhf8hv****      TagKey   \n\narray   \n\n 否    \n\n要解绑的标签键列表。最多可输入 20 个标签键。   \n\n        \n\nstring   \n\n 否    \n\n要解绑的标签键。   \n\ntestkey     ResourceType   \n\nstring   \n\n 是    \n\n资源类型。取值范围： \n \n- \n\nContainerGroup：ECI 实例 \n- \n\nImageCache：镜像缓存 \n- \n\nDataCache：数据缓存 \n- \n\nVirtualNode：虚拟节点 \n   \n\nContainerGroup     All   \n\nboolean   \n\n 否    \n\n是否解绑资源上全部的标签。当请求中未设置 TagKey时，该参数才有效。取值范围： \n \n- \n\ntrue \n- \n\nfalse \n \n\n默认值：false   \n\nfalse     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-xxx-xxx-xxxx-42665544xxxx       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89945DD3-9072-47D0-A318-353284CFC7B       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A318-353284CFC7B\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   IncorrectStatus   %s   指定的实例状态不正确。     400   OperationConflict   Request was denied due to conflict with a previous request.   该请求被禁止，因为与之前的请求冲突     400   NoPermission.Tag   No permissions to operate tags.   您无操作tag的权限。     400   NumberExceed.Tags   The length of tags exceeded limit: 20.   tag的数量超过20的限制。     \n\n访问[错误中心](https://api.aliyun.com/document/Eci/2018-08-08/errorCode)查看更多错误码。   \n## 变更历史 \n\n更多信息，参考[变更详情](https://api.aliyun.com/document/Eci/2018-08-08/UntagResources#workbench-doc-change-demo)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updatecontainergroup", "page_type": "doc", "title": "UpdateContainerGroup - 更新一个容器组", "keywords": "UpdateContainerGroup,查询UpdateContainerGroup参数,解决UpdateContainerGroup报错,UpdateContainerGroup API参考,UpdateContainerGroup请求参数,UpdateContainerGroup错误码", "last_modified_ms": 1760670503000, "last_modified_iso": "2025-10-17T11:08:23+08:00", "excerpt": "更新实例。   \n## 接口说明 \n \n- \n\n仅支持处于启动中（Pending）或运行中（Running）状态的 ECI 实例进行更新。更新操作后，ECI 实例状态将变更为更新中（Updating）。 \n- \n\n更新 RestartPolicy 配置为 Never 的 ECI 实例可能会有容器 Failed 的风险，请慎重更新。 \n   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/UpdateContainerGroup) [调试](https://api.aliyun.com/api/Eci/2018-08-08/UpdateContainerGroup)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:UpdateContainerGroup   \n\nupdate   \n\n*containergroup \n\nacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     ContainerGroupId   \n\nstring   \n\n 是    \n\n指定需要更新的 ECI 实例 ID，即容器组 ID。   \n\neci-2zelg8vwnlzdhf8hv****     RestartPolicy   \n\nstring   \n\n 否    \n\n实例重启策略。取值范围： \n \n- \n\nAlways：总是重启 \n- \n\nNever：从不重启 \n- \n\nOnFailure：失败时重启 \n   \n\nAlways     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多详情，请参阅[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000      Cpu   \n\nnumber   \n\n 否    \n\n实例级别（容器组）的 vCPU 数。   \n\n2.0     Memory   \n\nnumber   \n\n 否    \n\n实例级别的（容器组）的内存数。单位为 GiB。   \n\n4.0     ResourceGroupId   \n\nstring   \n\n 否    \n\n所属资源组 ID。   \n\nrg-2df3isufhi38****       Tag   \n\narray<object>   \n\n 否    \n\n实例绑定的标签列表。   \n\n         \n\nobject   \n\n 否    \n\n实例绑定的标签列表。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\nname     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\nhxh      Volume   \n\narray<object>   \n\n 否    \n\n数据卷列表。   \n\n         \n\narray<object>   \n\n 否    \n\n数据卷列表。   \n\n     Name   \n\nstring   \n\n 否    \n\n数据卷名称。   \n\ntest-empty     Type   \n\nstring   \n\n 否    \n\n数据卷类型。取值范围： \n \n- \n\nEmptyDirVolume：EmptyDir 类型的数据卷，表示临时目录。 \n- \n\nConfigFileVolume：ConfigFile 类型的数据卷，表示配置文件。 \n- \n\nNFSVolume：NFS 类型的数据卷，表示网络文件系统，例如 NAS。 \n- \n\nFlexVolume：使用 FlexVolume 插件扩展存储类型，支持挂载云盘、NAS 和 OSS。 \n- \n\nHostPathVolume：HostPath 类型的数据卷，表示宿主机上的文件或目录。该取值暂未开放使用。 \n   \n\nEmptyDirVolume     NFSVolume.Path   \n\nstring   \n\n 否    \n\nNFS 数据卷要挂载的路径。   \n\n/     NFSVolume.Server   \n\nstring   \n\n 否    \n\nNFS 数据卷的挂载点地址。   \n\n071e349b04-bsd39.cn-hangzhou.nas.aliyuncs.com     NFSVolume.ReadOnly   \n\nboolean   \n\n 否    \n\nNFS 数据卷的读取权限。取值范围： \n \n- \n\ntrue：NFS Volume 具有只读权限。 \n- \n\nfalse：NFS Volume 具有可读可写权限。 \n   \n\nfalse      ConfigFileVolume.ConfigFileToPath   \n\narray<object>   \n\n 否    \n\nConfigFile 数据卷对应的配置文件信息。   \n\n         \n\nobject   \n\n 否    \n\nConfigFile 数据卷对应的配置文件信息。   \n\n     Path   \n\nstring   \n\n 否    \n\n配置文件的相对文件路径。   \n\njin/test     Content   \n\nstring   \n\n 否    \n\n配置文件的内容。采用 Base64 编码。   \n\nbGl1bWk=     EmptyDirVolume.Medium   \n\nstring   \n\n 否    \n\nEmptyDir 数据卷的存储媒介，默认为空，使用 node 文件系统；支持配置为 Memory，表示使用内存。   \n\nMemory     EmptyDirVolume.SizeLimit   \n\nstring   \n\n 否    \n\nEmptyDir 数据卷的大小。取值请带上单位，建议使用 Gi 或 Mi。   \n\n256Mi     FlexVolume.FsType   \n\nstring   \n\n 否    \n\n使用 FlexVolume 插件挂载云盘时，云盘的文件系统类型。支持的类型包括 ext4、ext3、xfs、vfat。默认为 ext4。   \n\next4     FlexVolume.Driver   \n\nstring   \n\n 否    \n\n使用 FlexVolume 插件挂载数据卷时的驱动类型。取值范围如下： \n \n- \n\nalicloud/disk：挂载云盘。 \n- \n\nalicloud/nas：挂载 NAS。 \n- \n\nalicloud/oss：挂载 OSS。 \n   \n\nalicloud/disk     FlexVolume.Options   \n\nstring   \n\n 否    \n\nFlexVolume 对象选项列表。为 KV 形式，采用 JSON 传递。例如通过 FlexVolume 挂载云盘时，Options 表示云盘的配置参数。更多信息，请参见[数据卷概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-volumes)。   \n\n{\"volumeId\":\"d-2zehdahrwoa7srg****\",\"performanceLevel\": \"PL2\"}     HostPathVolume.Path   \n\nstring   \n\n 否    \n\nHostPath 数据卷在宿主机上的路径。 说明  \n\n该参数暂未开放使用。    \n\n/tmp     HostPathVolume.Type   \n\nstring   \n\n 否    \n\nHostPath 数据卷的类型。取值范围： \n \n- \n\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updatedatacache", "page_type": "doc", "title": "UpdateDataCache - 更新数据缓存", "keywords": "UpdateDataCache,查询UpdateDataCache参数,调用UpdateDataCache API,解决UpdateDataCache报错,UpdateDataCache API参考,UpdateDataCache请求参数,UpdateDataCache错误码", "last_modified_ms": 1760670056000, "last_modified_iso": "2025-10-17T11:00:56+08:00", "excerpt": "更新一个数据缓存。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/UpdateDataCache) [调试](https://api.aliyun.com/api/Eci/2018-08-08/UpdateDataCache)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:UpdateDataCache   \n\nupdate   \n\n*DataCache \n\nacs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     DataCacheId   \n\nstring   \n\n 否    \n\n数据缓存 ID。   \n\nedc-bp1a7n7uawwwol******     SecurityGroupId   \n\nstring   \n\n 否    \n\n安全组 ID。   \n\nsg-2ze81zoc3yl7a3we****     VSwitchId   \n\nstring   \n\n 否    \n\n交换机 ID。   \n\nvsw-2ze23nqzig8inprou****     Bucket   \n\nstring   \n\n 否    \n\n数据缓存 Bucket。默认为 default。   \n\ndefault     Name   \n\nstring   \n\n 否    \n\n数据缓存名称。   \n\ntest     Size   \n\ninteger   \n\n 否    \n\n数据缓存大小。   \n\n20      DataSource   \n\nobject   \n\n 否    \n\n数据源信息。   \n\n     Type   \n\nstring   \n\n 否    \n\n数据源类型。取值范围： \n \n- \n\nURL \n- \n\nNAS \n- \n\nOSS \n- \n\nSNAPSHOT \n   \n\nURL      Options   \n\nobject   \n\n 否    \n\n数据源的配置参数。   \n\n        \n\nstring   \n\n 否    \n\n数据源的配置参数。不同类型数据源要传入的参数不同。各类型数据源及其配置参数说明，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches)。   \n\n{ \"#10#repoSource\": \"HuggingFace/Model\", \"#6#repoId\": \"stabilityai/stable-diffusion-2-1\" }     RetentionDays   \n\ninteger   \n\n 否    \n\n保留天数。过期会被清理。默认不过期。   \n\n7     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-acfmzw2jz2z****      Tag   \n\narray<object>   \n\n 否    \n\n标签列表。   \n\n         \n\nobject   \n\n 否    \n\n标签列表。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\ntestkey     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntestvalue     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n2f22dc16-cad0-4d3f-87e5-91e604756547     EipInstanceId   \n\nstring   \n\n 否    \n\n弹性公网 IP。如果 VPC 没有配置 NAT 网关，可以绑定弹性公网 IP，以便拉取公网数据。   \n\neip-2zedsm5mfl3uhdj2d****      EipCreateParam   \n\nobject   \n\n 否    \n\n创建一个弹性公网 IP（EIP）并绑定。 如果 VPC 没有配置 NAT 网关，可以绑定 EIP，以便拉取公网数据。   \n\n     Bandwidth   \n\ninteger   \n\n 否    \n\nEIP 带宽。单位为 Mbps。默认为 5 Mbps。   \n\n10     CommonBandwidthPackage   \n\nstring   \n\n 否    \n\n绑定已有的共享带宽包。   \n\ncbwp-2zeukbj916scmj51m****     InternetChargeType   \n\nstring   \n\n 否    \n\nEIP 的计量方式。取值范围： \n \n- \n\nPayByBandwidth：按带宽计费 \n- \n\nPayByTraffic：按流量计费 \n   \n\nPayByTraffic     PublicIpAddressPoolId   \n\nstring   \n\n 否    \n\nIP 地址池 ID。 EIP 将从该 IP 地址池中分配。 IP 地址池功能默认不开放。如需使用，请在配额中心申请 IP 地址池功能权益配额。   \n\npippool-bp187arfugi543y1s****     ISP   \n\nstring   \n\n 否    \n\nEIP 的线路类型。取值范围： \n \n- \n\nBGP（默认值）：BGP（多线）线路 \n- \n\nBGP_PRO：BGP（多线）精品线路 \n   \n\nBGP       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\nBD8BBB43-8E05-5F46-89A9-2512D8A324A2       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"BD8BBB43-8E05-5F46-89A9-2512D8A324A2\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   Account.Arrearage   Your account has an outstanding payment.   账号已经欠费。     400   DryRunOperation   Request validation has been passed with DryRun flag set.   此次DryRun预检请求合格。     400   InvalidParameter.CPU.Memory   The specified cpu and memory are not allowed        400   IncorrectStatus   %s   指定的实例状态不正确。     400   ServiceNotEnabled   %s   该次请求所依赖的服务没有开通，请开通后再试。     400   DiskVolume.NotSupport   The disk volume is not supported.   云盘卷暂不支持，如有需要请联系我们。     400   RamRole.NotSupport   The RAM role is not supported.   ram实例角色不支持。     400   Im"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updateimagecache", "page_type": "doc", "title": "UpdateImageCache - 更新一个镜像缓存", "keywords": "UpdateImageCache,查询UpdateImageCache参数,调用UpdateImageCache接口,UpdateImageCache API参考,UpdateImageCache错误码", "last_modified_ms": 1760669969000, "last_modified_iso": "2025-10-17T10:59:29+08:00", "excerpt": "调用UpdateImageCache更新一个镜像缓存。   \n## 接口说明 \n\n仅支持更新状态为 Ready（创建完成）或者 UpdateFailed（更新失败）的镜像缓存。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/UpdateImageCache) [调试](https://api.aliyun.com/api/Eci/2018-08-08/UpdateImageCache)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:UpdateImageCache   \n\nupdate   \n\n*ImageCache \n\nacs:eci:{#regionId}:{#accountId}:imagecache/{#ImageCacheId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou      RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou      ImageCacheId   \n\nstring   \n\n 是    \n\n镜像缓存 ID。   \n\nimc-bp195erqe9o2pb09****      SecurityGroupId   \n\nstring   \n\n 否    \n\n安全组 ID。   \n\nsg-uf66jeqopgqa9hdn****      VSwitchId   \n\nstring   \n\n 否    \n\n交换机 ID。   \n\nvsw-uf6h3rbwbm90urjwa****      ImageCacheName   \n\nstring   \n\n 否    \n\n镜像缓存名称。   \n\ntestcache     EipInstanceId   \n\nstring   \n\n 否    \n\n弹性公网 IP。如果需要拉取公网镜像，需要确保 ECI 实例能够访问公网，您可以配置 EIP 或者 NAT 网关实现公网访问。   \n\neip-2zedsm5mfl3uhdj2d****     ResourceGroupId   \n\nstring   \n\n 否    \n\n资源组 ID。   \n\nrg-aekzh43v*****      ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多信息，请参见[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-xxx-xxx-xxxx-42665544xxxx     ImageCacheSize   \n\ninteger   \n\n 否    \n\n镜像缓存的大小。默认为 20 GiB。   \n\n20     RetentionDays   \n\ninteger   \n\n 否    \n\n镜像缓存保留时间，过期将会被清理，默认永不过期。 说明  \n\n创建失败的镜像缓存仅保留一天。    \n\n7     AutoMatchImageCache   \n\nboolean   \n\n 否    \n\n是否开启镜像缓存复用。开启后，新创建的镜像缓存可以复用已有镜像缓存的镜像层，加快镜像缓存的制作速度。取值范围： \n \n- \n\ntrue：开启 \n- \n\nfalse：不开启 \n \n\n默认为 false。   \n\ntrue      ImageRegistryCredential   \n\narray<object>   \n\n 否    \n\n镜像仓库信息。   \n\n         \n\nobject   \n\n 否    \n\n镜像仓库信息。   \n\n     Password   \n\nstring   \n\n 否    \n\n镜像仓库密码。   \n\npassword     Server   \n\nstring   \n\n 否    \n\n不带 http:// 或 https:// 前缀的镜像仓库地址。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com     UserName   \n\nstring   \n\n 否    \n\n镜像仓库用户名。   \n\nusername      Image   \n\narray   \n\n 否    \n\n用于制作镜像缓存的容器镜像列表。 说明  \n\n如果您希望触发一次镜像缓存的原地升级，而不需要更新缓存镜像列表，仍然需要传入缓存镜像列表，否则镜像数据不会更新到最新版本，只会刷新 meta 数据。    \n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl        \n\nstring   \n\n 否    \n\n用于制作镜像缓存的容器镜像。   \n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl      Tag   \n\narray<object>   \n\n 否    \n\n镜像缓存绑定的标签信息，最多 20 个。   \n\n         \n\nobject   \n\n 否    \n\n镜像缓存绑定的标签信息，最多 20 个。   \n\n     Key   \n\nstring   \n\n 否    \n\n镜像缓存标签键。   \n\nimc     Value   \n\nstring   \n\n 否    \n\n镜像缓存标签值。   \n\ntest     Flash   \n\nboolean   \n\n 否    \n\n是否开启极速镜像缓存功能，开启后，可以加速镜像缓存创建。取值范围： \n \n- \n\ntrue：开启 \n- \n\nfalse：不开启 \n \n\n默认为 false。   \n\ntrue      AcrRegistryInfo   \n\narray<object>   \n\n 否    \n\nACR 企业版实例信息。   \n\n         \n\nobject   \n\n 否    \n\nACR 企业版实例信息。   \n\n      Domain   \n\narray   \n\n 否    \n\nACR 企业版实例的域名。默认为相应实例的所有域名。支持指定个别域名，多个以半角逗号分隔。   \n\ntest****-registry.cn-hangzhou.cr.aliyuncs.com        \n\nstring   \n\n 否    \n\nACR 企业版实例的域名。默认为相应实例的所有域名。支持指定个别域名，多个以半角逗号分隔。   \n\ntest****-registry.cn-hangzhou.cr.aliyuncs.com     InstanceName   \n\nstring   \n\n 否    \n\nACR 企业版实例的名称。   \n\ntest****     InstanceId   \n\nstring   \n\n 否    \n\nACR 企业版实例 ID。   \n\ncri-nwj395hgf6f3****      RegionId   \n\nstring   \n\n 否    \n\nACR 企业版实例所属地域。   \n\ncn-hangzhou     StandardCopyCount   \n\ninteger   \n\n 否    \n\n标准快照副本数。默认情况下，一个镜像缓存对应一个快照。如果该镜像缓存将用于批量创建多个 ECI 实例，建议您配置该参数实现快照多副本。推荐每 1000 个 ECI 实例增加一个快照副本。 说明  \n\n未开启极速镜像缓存功能（Flash 取值为 false）时，创镜像缓存的过程中仅生成标准快照。    \n\n7     FlashCopyCount   \n\ninteger   \n\n 否    \n\n本地快照副本数。默认情况下，一个镜像缓存对应一个快照。如果该镜像缓存将用于批量创建多个 ECI 实例，建议您配置该参数实现快照多副本。推荐每 1000 个 ECI 实例增加一个快照副本。 说明  \n\n开启极速镜像缓"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updatevirtualnode", "page_type": "doc", "title": "UpdateVirtualNode - 更新一个虚拟节点", "keywords": "UpdateVirtualNode,调用UpdateVirtualNode接口,查询UpdateVirtualNode参数,解决UpdateVirtualNode报错,UpdateVirtualNode API参考,UpdateVirtualNode请求参数,UpdateVirtualNode错误码", "last_modified_ms": 1761893311000, "last_modified_iso": "2025-10-31T14:48:31+08:00", "excerpt": "调用UpdateVirtualNode更新一个虚拟节点的属性。   \n## 接口说明 \n## 接口说明 \n\n仅支持更新状态为 Ready 的虚拟节点。   \n## 调试\n\n[您可以在OpenAPI Explorer中直接运行该接口，免去您计算签名的困扰。运行成功后，OpenAPI Explorer可以自动生成SDK代码示例。](https://api.aliyun.com/api/Eci/2018-08-08/UpdateVirtualNode) [调试](https://api.aliyun.com/api/Eci/2018-08-08/UpdateVirtualNode)   \n## 授权信息 \n\n下表是API对应的授权信息，可以在RAM权限策略语句的Action元素中使用，用来给RAM用户或RAM角色授予调用此API的权限。具体说明如下：\n\n- \n\n操作：是指具体的权限点。\n- \n\n访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- \n\n资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- \n\n对于必选的资源类型，用前面加 * 表示。\n- \n\n对于不支持资源级授权的操作，用全部资源表示。\n\n- \n\n条件关键字：是指云产品自身定义的条件关键字。\n- \n\n关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n \n\n[表格]\n         \n\n操作   \n\n访问级别   \n\n资源类型   \n\n条件关键字   \n\n关联操作     \n\neci:UpdateVirtualNode   \n\nupdate   \n\n*VirtualNode \n\nacs:eci:{#regionId}:{#accountId}:virtualnode/{#VirtualNodeId}   \n \n- eci:tag \n   无       \n## 请求参数 \n\n[表格]\n         \n\n名称   \n\n类型   \n\n必填   \n\n描述   \n\n示例值     RegionId   \n\nstring   \n\n 是    \n\n地域 ID。   \n\ncn-hangzhou     VirtualNodeId   \n\nstring   \n\n 是    \n\n虚拟节点 ID。   \n\nvnd-2ze960zkdqrldeaw****     VirtualNodeName   \n\nstring   \n\n 否    \n\n虚拟节点名称。   \n\ntestNode     CustomResources   \n\nstring   \n\n 否    \n\n虚拟节点支持的自定义资源。如果 ECI Pod 的 request 中声明了相应的自定义资源，则该 Pod 会被调度到 VNode。 格式为资源名称=资源数量，多个资源之间使用半角逗号间隔。   \n\nexample1.com=100,example2.com=200     ClusterDomain   \n\nstring   \n\n 否    \n\n集群的域名。配置后，除了主机的搜索域外，Kubelet 会配置所有容器来搜索该域名。   \n\nexample.com     ClusterDNS   \n\nstring   \n\n 否    \n\nDNS 服务器的 IP 地址。如果 ECI Pod 中设置了dnsPolicy=ClusterFirst，则使用该配置值为容器提供 DNS 服务。 支持配置多个 IP 地址，多个 IP 地址之间使用半角逗号间隔。   \n\n100.1.XX.XX     ClientToken   \n\nstring   \n\n 否    \n\n保证请求幂等性。从您的客户端生成一个参数值，确保不同请求间该参数值唯一。只支持 ASCII 字符，且不能超过 64 个字符。更多详情，请参阅[如何保证幂等性](https://help.aliyun.com/zh/ecs/developer-reference/how-to-ensure-idempotence)。   \n\n123e4567-e89b-12d3-a456-426655440000      Tag   \n\narray<object>   \n\n 否    \n\n虚拟节点标签信息。   \n\n         \n\nobject   \n\n 否    \n\n虚拟节点标签信息。   \n\n     Key   \n\nstring   \n\n 否    \n\n标签键。   \n\nname     Value   \n\nstring   \n\n 否    \n\n标签值。   \n\ntest       \n## 返回参数 \n\n[表格]\n        \n\n名称   \n\n类型   \n\n描述   \n\n示例值         \n\nobject      \n\n     RequestId   \n\nstring   \n\n请求 ID。   \n\n89945DD3-9072-47D0-A318-353284CFC7B3       \n## 示例 \n\n正常返回示例 \n\nJSON格式 \n\n{\n  \"RequestId\": \"89945DD3-9072-47D0-A318-353284CFC7B3\"\n}\n\n   \n## 错误码 \n\n[表格]\n          \n\nHTTP status code   \n\n错误码   \n\n错误信息   \n\n描述       400   Account.Arrearage   Your account has an outstanding payment.   账号已经欠费。     400   DryRunOperation   Request validation has been passed with DryRun flag set.   此次DryRun预检请求合格。     400   InvalidParameter.CPU.Memory   The specified cpu and memory are not allowed        400   InvalidParameter.DuplicatedName   The container group include containers with duplicate names.   容器组内有重复名字的容器。     400   InvalidParameter.DuplicatedVolumeName   The container group includes volumes with duplicate names.   容器组内有重复名字的数据卷。     400   IncorrectStatus   %s   指定的实例状态不正确。     400   ServiceNotEnabled   %s   该次请求所依赖的服务没有开通，请开通后再试。     400   ImageSnapshot.IncorrectStatus   %s   用于镜像缓存的快照状态不正确。     400   ImageSnapshot.NotSupport   %s   基于数据盘快照的镜像缓存功能暂未全网开放，如有需要请联系我们。     400   DiskVolume.NotSupport   The disk volume is not supported.   云盘卷暂不支持，如有需要请联系我们。     400   RamRole.NotSupport   The RAM role is not supported.   ram实例角色不支持。     400   DiskNumber.LimitExceed   The maximum number of disks in an instance is exceeded.   实例下云盘数目超过限制。     400   InvalidPaymentMethod.InsufficientBalance   No payment method is specified for your account. We recommend that you add a payment method or add funds to the prepayment balance.   您的账户暂无有效支付方式，请添加支付方式或保持预付款余额充足。     400   DiskVolume.NotInSameZone   The instance to be created and the disk are not in the same zone.   即将创建的实例和云盘不在同一可用区。     400   NoPermission   You are not authorized to use the \"Product on ECI\" feature.        400   HighCpuMemConfigRequired   You need to apply to be added to the whitelist of the specified CPU and memory.   您需要申请CPU高配白名单。     400   RecommendEmpty.InstanceTypeFamilyNotMatched   The recommended instance type is unavailable in the current zone. Try again la"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/getting-started", "page_type": "doc", "title": "快速开始", "keywords": "快速上手ECI-Client,ECI-Client快速入门", "last_modified_ms": 1667385141000, "last_modified_iso": "2022-11-02T18:32:21+08:00", "excerpt": "ECI-Client是一个基于阿里云SDK开发的命令行客户端，通过它您可以快速创建、查看和释放您的ECI实例。本文介绍如何使用ECI-Client，通过命令行管理ECI实例。\n## 安装\n\nECI-Client目前支持Linux系统和macOS系统， 暂不支持Windows系统。\n\n打开本地终端窗口，执行以下命令来安装ECI-Client。\n\nsudo bash -c \"$(curl -s https://eci-docs.oss-cn-beijing.aliyuncs.com/eci-client/1.0/install.sh)\"\n\n\n## 配置\n\n使用ECI-Client，需要预先配置阿里云密钥，以便让ECI-Client有权限连接到阿里云，命令语法如下：\n\neci config set-context \\\n--access-key-id xxxxxx \\\n--access-secret xxxxxx \\\n--region-id cn-beijing \\\n--security-group-id sg-xxx \\\n--v-switch-id vsw-xxx\n\n说明 \n\n- \n\n如果需要VPC网络访问公网，请绑定NAT网关。具体操作，请参见[连接公网](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access#topic-1860106)。\n- \n\n如果需要公网访问ECI实例，需要添加相应的入方向安全组规则。具体操作，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n\n如果您除了阿里云密钥之外，没有任何VPC、虚拟交换机、安全组等必要的网络资源，可以使用以下命令自动初始化网络资源。\n\neci config set-context \\\n--access-key-id xxxxxx \\\n--access-secret xxxxxx \\\n--init\n\n\n## 使用\n\n大多数情况下，您可以使用与Docker相同语法的命令来管理ECI实例，只需要把命令行开头的docker改为eci。示例如下：\n\n- \n\n使用Centos镜像创建一个ECI实例，命令执行成功后将返回ECI实例ID。\n\neci run -t centos bash -c \"while true; do sleep 5; date; done\"\n\n\n- \n\n列出所有ECI实例，以下命令可以打印每个实例的ID、名字、创建时间、状态等信息。\n\neci ps\n\n\n更多使用方式请参见[ECI-CLI](https://github.com/aliyuneci/eci-client-doc#eci)。\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/overview-2", "page_type": "doc", "title": "SDK概览", "keywords": "了解ECI V2.0 SDK,下载ECI V2.0 SDK,ECI V2.0 SDK概览,ECI V2.0 SDK下载地址", "last_modified_ms": 1754898788000, "last_modified_iso": "2025-08-11T15:53:08+08:00", "excerpt": "弹性容器实例提供的SDK包括Go、Python和Java等多种语言版本。本文介绍弹性容器实例的SDK，并提供最新版本SDK的获取地址。\n## SDK代系\n\n阿里云SDK包含V2.0 SDK和V1.0 SDK两个代系。V2.0 SDK为最新发布的代系，相较于V1.0 SDK，它支持更多的编程语言，解决了V1.0 SDK中存在的单Client线程安全问题，同时具备更强的健壮性和易用性，从而为开发者在开发过程中提供更优质的使用体验。说明 \n\n推荐使用V2.0 SDK。若您使用的是V1.0 SDK，建议升级到V2.0 SDK，详细信息请参见[升级V1.0 SDK指南](https://help.aliyun.com/zh/sdk/developer-reference/upgrade-v1-sdk-guide)。\n\nECI V2.0 SDK封装了2018-08-08版本API，通过访问密钥（AccessKey）识别调用者身份，提供自动签名等功能，方便您通过API创建和管理资源。\n## SDK下载地址\n\nECI V2.0 SDK支持多种编程语言。您可以在OpenAPI门户获取SDK的安装方式，也可以在开源平台GitHub中查看源码及相关安装指引。建议使用各编程语言主流的依赖管理工具进行安装。\n\n[表格]\n\n编程语言\n\n安装SDK\n\nGitHub地址\n\n快速入门\n\nJava\n\n- \n\n[SDK for Java](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=java-tea&tab=primer-doc)\n- \n\n[SDK for Java（异步）](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=java-async-tea&tab=primer-doc)\n\n- \n\n[alibabacloud-java-sdk/eci-20180808](https://github.com/aliyun/alibabacloud-java-sdk/tree/master/eci-20180808)\n- \n\n[alibabacloud-java-async-sdk/eci-20180808](https://github.com/aliyun/alibabacloud-java-async-sdk/tree/master/eci-20180808)\n\n[通过IDE使用阿里云Java SDK](https://help.aliyun.com/zh/sdk/developer-reference/use-the-alibaba-cloud-sdk-through-the-ide)\n\nGo\n\n[SDK for Go](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=go-tea&tab=primer-doc)\n\n[alibabacloud-go/eci-20180808](https://github.com/alibabacloud-go/eci-20180808/)\n\n[通过IDE使用阿里云Go SDK](https://help.aliyun.com/zh/sdk/developer-reference/use-alibaba-cloud-go-sdk-through-ide)\n\nPython\n\n[SDK for Python](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=python-tea&tab=primer-doc)\n\n[alibabacloud-python-sdk/eci-20180808](https://github.com/aliyun/alibabacloud-python-sdk/tree/master/eci-20180808)\n\n[通过IDE使用阿里云Python SDK](https://help.aliyun.com/zh/sdk/developer-reference/use-the-alibaba-cloud-python-sdk-through-the-ide)\n\nNode.js\n\n[SDK for TypeScript](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=typescript-tea&tab=primer-doc)\n\n[alibabacloud-typescript-sdk/eci-20180808](https://github.com/aliyun/alibabacloud-typescript-sdk/tree/master/eci-20180808)\n\n[通过IDE使用阿里云Node.js SDK](https://help.aliyun.com/zh/sdk/developer-reference/use-the-alibaba-cloud-node-js-sdk-through-the-ide)\n\nC#\n\n[SDK for C#](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=csharp-tea&tab=primer-doc)\n\n[alibabacloud-csharp-sdk/eci-20180808](https://github.com/aliyun/alibabacloud-csharp-sdk/tree/master/eci-20180808)\n\n[通过IDE使用阿里云.NET SDK](https://help.aliyun.com/zh/sdk/developer-reference/use-the-alibaba-cloud-net-sdk-through-ide)\n\nPHP\n\n[SDK for PHP](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=php-tea&tab=primer-doc)\n\n[alibabacloud-sdk-php/eci-20180808](https://github.com/alibabacloud-sdk-php/eci-20180808)\n\n[通过IDE使用阿里云PHP SDK](https://help.aliyun.com/zh/sdk/developer-reference/use-the-alibaba-cloud-php-sdk-through-the-ide)\n\nC++\n\n[SDK for C++](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=cpp-tea&tab=primer-doc)\n\n[alibabacloud-sdk-cpp/eci-20180808](https://github.com/alibabacloud-sdk-cpp/eci-20180808)\n\n/\n\nSwift\n\n[SDK for Swift](https://next.api.aliyun.com/api-tools/sdk/Eci?version=2018-08-08&language=swift-tea&tab=primer-doc)\n\n[alibabacloud-sdk-swift/eci-20180808](https://github.com/alibabacloud-sdk-swift/eci-20180808)\n\n/\n"}
{"url": "https://help.aliyun.com/zh/eci/developer-reference/usage-scenarios", "page_type": "doc", "title": "使用场景", "keywords": "了解ECI-Client使用场景,使用ECI-Client部署应用,ECI-Client使用场景,ECI-Client命令示例", "last_modified_ms": 1700043258000, "last_modified_iso": "2023-11-15T18:14:18+08:00", "excerpt": "本文介绍ECI命令行客户端（ECI-Client）的使用场景。\n## 背景信息\n\n对于需要构建集群服务的用户而言，推荐您通过ACK集群或ACK Serverless集群来使用ECI，这能充分发挥ECI的优势。但如果您的业务规模较小，或者您只需要部署几个单机应用，则通过ECI-Client可以更加便捷地使用ECI。\n\nECI-Client提供了与Docker相同的语法来管理ECI实例，如果您熟悉Docker命令行，则可以快速上手使用ECI，本文介绍几个典型的使用场景。\n## 测试容器应用\n\n如果您正在基于ECI开发自己的应用，那您可能需要频繁地部署ECI实例，以便验证应用是否符合预期。此时，使用ECI-Client来部署ECI实例，可以更加方便快捷。\n\n假设构建了一个镜像centos:8.1.1911，并已经上传到了Docker Hub的镜像仓库中，此时，如果要测试它是否按预期工作，在ECI-Client中执行以下命令，即可快速部署ECI实例。\n\neci run -w 5 centos:8.1.1911 sleep 3600\n\n\nECI实例启动完成后，可以通过exec命令登录到实例容器中。假设实例ID为eci-uf60grb03kz2nlm2****，则命令如下：\n\neci exec -ti eci-uf60grb03kz2nlm2**** bash\n\n\n## 训练简易模型\n\n以下示例中，准备了一个示例镜像，它内部包含了一个Python程序，容器启动后，该程序会从网上下载一些数据，然后使用TensorFlow来训练这些数据，训练后的数据保存在/tmp/imagenet。\n\neci run --name test-tensor \\\n--type ecs.gn6i-c4g1.xlarge \\\n--gpu 1 \\\n-w 5 \\\n--volume /tmp/imagenet \\\nregistry.cn-hangzhou.aliyuncs.com/eci_open/tensorflow:1.0 \\\npython /home/classify_image/classify_image.py \n\n说明 \n\n- \n\n由于TensorFlow程序会依赖GPU，因此需要通过--type选项为ECI实例指定一个ECS GPU规格，--gpu用于为实例中的容器分配GPU，--volume用于挂载一个云盘到实例中，用于保存训练后的结果数据。\n- \n\n该镜像较大，ECI需要一定的时间来下载镜像。您可以通过eci ps命令查看实例ID、名称和运行状态等。\n\n等待ECI实例启动成功后，可以通过eci logs命令查看程序的日志输出，假设实例ID为eci-uf60grb03kz2nlm2****，则命令如下：\n\neci logs eci-uf60grb03kz2nlm2****\n\n\n## 部署个人网站\n\n以下示例使用ECI-Client部署一个WordPress网站，该网站依赖一个MySQL数据库。示例镜像来源于DockerHub官网镜像仓库：\n\n- \n\nWordPress：[wordpress:4.9.8-php5.6-apache](https://hub.docker.com/_/wordpress)\n- \n\nMySQL：[mysql:5.7](https://hub.docker.com/_/mysql)\n\n- \n\n部署MySQL数据库，并指定根用户密码。\n\neci run -w 5 --name mysql -e MYSQL_ROOT_PASSWORD=passwd*** -tid mysql:5.7\n\n\n命令执行成功后会输出实例ID。您可以通过eci ps命令检查实例状态，直至实例状态变为Running，则表示部署成功。返回示例如下：\n\nCG_ID                      FIRST_IMAGE   COMMAND     CREATED                     STATUS    PUBLIC_IP        NAME     \neci-2zecsa60voctfzr2****   mysql:5.7                 2023-02-17T16:33:22+08:00   Running   101.200.XX.XX    mysql  \n\n\n- \n\n获取数据库的内网IP地址。\n\n以下使用jq命令，如果本地没有jq命令，请先安装。\n\neci inspect eci-2zecsa60voctfzr2**** | jq -r .ContainerGroups[0].IntranetIp\n\n\n预期返回：\n\n172.16.XX.XX\n\n\n- \n\n部署WordPress。\n\n部署时，可以通过环境变量-e传入数据库地址、用户名和密码，通过-w为网站分配一个公网IP并指定带宽为5 MB。\n\neci run --name wordpress \\\n-e WORDPRESS_DB_HOST=172.16.XX.XX \\\n-e WORDPRESS_DB_USER=root \\\n-e WORDPRESS_DB_PASSWORD=passwd*** \\\n-w 5 \\\n-tid wordpress:4.9.8-php5.6-apache\n\n\n命令执行成功后会输出实例ID。您可以通过eci ps命令检查实例状态，直至实例状态变为Running，则表示部署成功。返回示例如下：\n\nCG_ID                      FIRST_IMAGE                     COMMAND   CREATED                     STATUS    PUBLIC_IP        NAME     \neci-2zeedp8bxor356b7****   wordpress:4.9.8-php5.6-apache             2023-02-17T16:39:51+08:00   Running   101.200.XX.XX    wordpress\neci-2zecsa60voctfzr2****   mysql:5.7                                 2023-02-17T16:33:22+08:00   Running   101.200.XX.XX    mysql\n\n\n此时可以看到WordPress实例的公网IP，本示例中为101.200.XX.XX。在浏览器中输入http://100.100.XX.XX即可访问WordPress。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/automatically-match-an-image-cache-to-create-an-elastic-container-instance", "page_type": "doc", "title": "自动匹配镜像缓存创建ECI实例", "keywords": "加速创建ECI实例,开启自动匹配镜像缓存,ECI实例创建方法,镜像缓存自动匹配", "last_modified_ms": 1706863253000, "last_modified_iso": "2024-02-02T16:40:53+08:00", "excerpt": "在创建ECI实例时，如果开启了自动匹配镜像缓存，系统会自动匹配使用最优的镜像缓存，以此来避免或减少镜像层的下载，提升实例创建速度。本文介绍如何开启自动匹配镜像缓存来加速创建ECI实例。\n## 背景信息\n\n镜像缓存功能用于加速实例创建。开启自动匹配镜像缓存后，如果匹配到了镜像缓存，则可以加速ECI实例创建，如果没有完全匹配的镜像缓存，则系统会自动创建一个镜像缓存，该镜像缓存不收取创建费用，可用于后续创建同类镜像的ECI实例。更多信息，请参见[镜像缓存概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2)。\n## 前提条件\n\n- \n\n已开通弹性容器实例服务、访问控制（RAM）服务，并完成了相关的RAM角色授权。说明 \n\n如果您使用RAM用户创建ECI实例，需要进行授权才能操作。具体操作，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users)。\n- \n\n已在合适的地域下创建专有网络VPC和交换机。\n\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n- \n\n关于如何创建专有网络和交换机，请参见[创建专有网络](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-a-vpc#task-1012575)和[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。说明 \n\n建议创建多个交换机，以便后续创建ECI实例时可以选择多个交换机来实现多可用区功能，从而提高实例创建的成功率。\n\n- \n\n已创建安全组。具体操作，请参见[创建安全组](https://help.aliyun.com/zh/ecs/user-guide/create-a-security-group-1)。\n\n安全组是一种虚拟防火墙，具备状态检测和数据包过滤功能，用于在云端划分安全域。一个ECI实例必须属于一个安全组。更多信息，请参见[配置ECI实例所属安全组](https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-2)。\n\n## 操作步骤\n\n下文主要介绍创建ECI实例并开启自动匹配镜像缓存时需要注意的配置和步骤，部分配置采用默认或者最简配置。\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/image)。\n- \n\n在镜像缓存页面，查看已有的镜像缓存。说明 \n\n镜像缓存的创建分为手动创建和自动创建两种方式。\n\n- \n\n手动创建：适用于首次创建就需要加速创建ECI实例的场景。具体操作，请参见[创建镜像缓存](https://help.aliyun.com/zh/eci/user-guide/manage-an-image-cache#section-1ew-818-c6p)。\n- \n\n自动创建：开启了自动匹配镜像缓存且没有完全匹配的情况下，系统会自动创建相应的镜像缓存。\n\n- \n\n切换到容器组页面，然后单击创建弹性容器组。\n- \n\n配置实例基本信息。\n\n- \n\n选择付费模式和实例类型。\n\n此处保持默认选择即可。付费模式为按量付费，实例类型为普通实例。\n- \n\n选择地域。\n- \n\n选择专有网络VPC和对应的交换机。\n\n建议选择多个交换机实现多可用区功能，系统将根据库存情况优先在资源充足的可用区下创建实例。\n- \n\n选择安全组。 通过配置安全组规则，可以允许或禁止安全组内的ECI实例对公网或私网的访问，以及IP间的访问。说明 \n\n如果需要从公网访问VPC内的ECI实例，需要在安全组中开放对应的端口。具体操作，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n\n- \n\n配置容器组。\n\n- \n\n选择容器组的规格。\n\n本文以直接选择vCPU和内存规格为例，该方式可以提供更好的弹性和资源供应能力。如果您的业务需要有特殊的规格需求，例如GPU等，您可以指定特定的ECS规格。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。\n- \n\n输入容器组名称。\n- \n\n单击高级配置，确认已选中自动匹配镜像缓存。\n- \n\n设置购买数量。\n\n购买多台时，将按照数量自动在名称后增加有序后缀。例如：名称配置为test，购买数量为3台，则购买成功后，三台实例的名称分别为：test001、test002、test003。\n\n- \n\n配置容器。\n\n- \n\n输入容器名称。\n- \n\n选择镜像和对应的镜像版本。\n\n当选择的镜像和版本与镜像缓存对应的镜像信息相同时，会自动使用匹配上的镜像缓存。\n\n- \n\n单击配置确认。\n- \n\n确认实例配置信息，并选中服务协议，然后单击确认订单。\n\n创建成功后，您可以在容器组页面查看该实例，单击实例ID可以查看详情。\n\n## 查看结果\n\n单击实例ID可以查看详情，在事件页签下，您可以查看镜像缓存的匹配情况。\n\n- \n\n如果匹配到了镜像缓存，您可以看到实例的创建时间很短。\n\n- \n\n如果没有完全匹配的镜像缓存，系统会自动创建一个镜像缓存，您可以在镜像缓存页面查看。\n\n说明 \n\n如果匹配到了镜像缓存，但该镜像缓存与需求的并不完全一致，则系统仍会自动创建一个镜像缓存。\n\n## 相关文档\n\n- \n\n[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches)\n- \n\n[管理镜像缓存](https://help.aliyun.com/zh/eci/user-guide/manage-an-image-cache)\n- \n\n[使用镜像缓存加速创建ECI实例](https://help.aliyun.com/zh/eci/user-guide/use-the-image-cache-feature-to-accelerate-the-creation-of-an-elastic-container-instance)\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/connect-to-an-elastic-container-instance", "page_type": "doc", "title": "通过Workbench连接ECI实例", "keywords": "连接ECI实例,使用Workbench连接ECI,ECI实例连接方法,Workbench连接ECI", "last_modified_ms": 1758534267000, "last_modified_iso": "2025-09-22T17:44:27+08:00", "excerpt": "部署容器后，可通过弹性容器实例控制台，使用Workbench连接ECI实例中的容器，执行命令进行调试。本文介绍如何连接ECI实例。\n## 前提条件\n\n实例中的容器处于运行中状态。\n## 操作步骤\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在容器组页面，找到目标实例，单击ID。\n- \n\n在实例详情页面，单击Workbench远程连接页签。\n- \n\n在弹出的对话框中选择容器、命令类型等，然后单击登录。\n\n相关说明如下：\n\n- \n\n选择容器时，仅支持选择运行中的容器。\n- \n\n选择Shell命令类型时，除常用的/bin/sh和/bin/bash外，也可根据需要选择自定义命令并输入命令类型，如：/sbin/nologin。\n说明 \n\n- \n\n默认情况下系统已自动选择当前实例，也可切换选择其他实例。\n- \n\n单击完整选项可以显示更多配置项，支持选择资源组和地域以进一步筛选实例。\n\n- \n\n根据需要输入并执行命令。\n\n说明 \n\nWorkbench的远程连接会话默认维持6个小时，如超过6小时没有任何操作，连接会自动断开，需重新连接实例。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/create-an-instance-and-mount-a-nas-volume", "page_type": "doc", "title": "创建ECI实例并挂载NAS数据卷", "keywords": "创建ECI并挂载NAS,ECI实例持久化存储,ECI挂载NAS操作指南", "last_modified_ms": 1716255449000, "last_modified_iso": "2024-05-21T09:37:29+08:00", "excerpt": "容器中的数据在磁盘中是临时存放的，会随着容器释放而删除，并且容器之间不支持共享数据。如果您有持久化存储或者共享数据的需求，可以为容器挂载数据卷来管理容器中的数据。本文以NAS文件系统作为数据卷为例，介绍在创建ECI实例时如何挂载NAS数据卷，以此来保存实例运行产生的数据，以及和其他容器或者实例共享数据。\n## 前提条件\n\n- \n\n已开通弹性容器实例服务、访问控制（RAM）服务，并完成了相关的RAM角色授权。说明 \n\n如果您使用RAM用户创建ECI实例，需要进行授权才能操作。具体操作，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users)。\n- \n\n已在合适的地域下创建专有网络VPC和交换机。\n\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n- \n\n关于如何创建专有网络和交换机，请参见[创建专有网络](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-a-vpc#task-1012575)和[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。说明 \n\n建议创建多个交换机，以便后续创建ECI实例时可以选择多个交换机来实现多可用区功能，从而提高实例创建的成功率。\n\n- \n\n已创建安全组。具体操作，请参见[创建安全组](https://help.aliyun.com/zh/ecs/user-guide/create-a-security-group-1)。\n\n安全组是一种虚拟防火墙，具备状态检测和数据包过滤功能，用于在云端划分安全域。一个ECI实例必须属于一个安全组。更多信息，请参见[配置ECI实例所属安全组](https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-2)。\n\n## 操作步骤\n\n下文主要介绍创建实例并挂载NAS数据卷时需要注意的配置和步骤，部分配置采用默认或者最简配置。\n\n- \n\n登录[文件存储NAS控制台](https://nasnext.console.aliyun.com/overview)\n- \n\n创建NAS文件系统和挂载点。具体操作，请参见[创建文件系统](https://help.aliyun.com/zh/nas/user-guide/create-a-file-system)和[管理挂载点](https://help.aliyun.com/zh/nas/user-guide/manage-mount-targets)。\n- \n\n打开[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)。\n- \n\n配置实例基本信息。\n\n- \n\n选择付费模式和实例类型。\n\n此处保持默认选择即可。付费模式为按量付费，实例类型为普通实例。\n- \n\n选择地域。\n- \n\n选择专有网络VPC和对应的交换机。\n\n建议选择多个交换机实现多可用区功能，系统将根据库存情况优先在资源充足的可用区下创建实例。\n- \n\n选择安全组。 通过配置安全组规则，可以允许或禁止安全组内的ECI实例对公网或私网的访问，以及IP间的访问。说明 \n\n如果需要从公网访问VPC内的ECI实例，需要在安全组中开放对应的端口。具体操作，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n\n- \n\n配置容器组。\n\n- \n\n选择容器组的规格。\n\n本文以直接选择vCPU和内存规格为例，该方式可以提供更好的弹性和资源供应能力。如果您的业务需要有特殊的规格需求，例如GPU等，您可以指定特定的ECS规格。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。\n- \n\n输入容器组名称。\n- \n\n单击高级配置。\n- \n\n在存储处单击NAS持久化存储页签。\n- \n\n单击添加，配置NAS数据卷信息。\n\n- \n\n名称：NAS数据卷的名称。\n- \n\n挂载点：NAS文件系统的挂载点。\n- \n\nPath：NAS文件系统中要挂载的路径。\n- \n\n只读：数据读取权限。默认可读可写，可按需选中只读。\n\n- \n\n配置容器。\n\n- \n\n输入容器名称。\n- \n\n选择镜像和对应的镜像版本。\n\n在常用镜像页签下选择eci_open/nginx，版本选择1.14.2。说明 \n\n- \n\n镜像拉取策略（imagePullPolicy）默认为按需拉取（IfNotPresent），即优先使用本地镜像，本地没有时则拉取镜像。\n- \n\n来源为ALI_HUB的镜像为阿里云镜像仓库中的镜像，默认通过专有网络VPC（私网）拉取。\n\n- \n\n展开该容器的高级配置。\n- \n\n打开存储开关，然后单击添加。\n- \n\n选择容器组中已添加的NAS数据卷，并输入容器内挂载路径。\n\n- \n\n单击配置确认。\n- \n\n确认实例配置信息，并选中服务协议，然后单击确认订单。\n\n创建成功后，您可以在容器组页面查看该实例，单击实例ID可以查看详情。\n\n## 查看结果\n\n- \n\n单击实例ID可以查看详情，在数据卷页签下，可以看到挂载的NAS数据卷信息。\n\n- \n\n单击Workbench远程连接页签，配置登录信息连接实例后，可以访问挂载路径。\n\n## 相关文档\n\n- \n\n[数据卷概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-volumes)\n- \n\n[挂载NAS数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-nas-volume)\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/delete-elastic-container-instances", "page_type": "doc", "title": "删除ECI实例", "keywords": "删除ECI实例,停止ECI实例计费,ECI实例操作指南,ECI实例控制台操作", "last_modified_ms": 1712133244000, "last_modified_iso": "2024-04-03T16:34:04+08:00", "excerpt": "对于不再使用的ECI实例，您可以在弹性容器实例控制台进行删除。删除后，该实例不再计费。\n## 背景信息\n\n在ECI实例的生命周期中，不同的阶段有其固有的状态。更多信息，请参见[ECI实例生命周期介绍](https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-1)。\n## 操作步骤\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在容器组页面，找到想要删除的实例，选择以下一种方式进行删除。 \n\n- \n\n单击要删除的实例对应操作列中的删除。\n- \n\n选中一台或多台实例，单击底部的删除弹性容器组。\n\n- \n\n在弹出的对话框中，单击确定。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/illustrate-elastic-container-instances", "page_type": "doc", "title": "图说ECI实例", "keywords": null, "last_modified_ms": 1693274788000, "last_modified_iso": "2023-08-29T10:06:28+08:00", "excerpt": "\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/illustrate-image-caches", "page_type": "doc", "title": "图说镜像缓存", "keywords": null, "last_modified_ms": 1672307159000, "last_modified_iso": "2022-12-29T17:45:59+08:00", "excerpt": "\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/pull-an-image-from-docker-hub-to-create-an-elastic-container-instance", "page_type": "doc", "title": "从Docker Hub拉取镜像创建实例", "keywords": "创建ECI实例,拉取Docker Hub镜像,为ECI绑定EIP,ECI创建教程,ECI拉取公网镜像", "last_modified_ms": 1767146298000, "last_modified_iso": "2025-12-31T09:58:18+08:00", "excerpt": "ECI默认不提供外部公网链路进行公网镜像的拉取，因此从Docker Hub等外部镜像仓库拉取镜像来创建ECI实例时，需要实例具备公网访问能力。本文介绍如何从Docker官方镜像仓库（Docker Hub）中拉取镜像来创建一台ECI实例。\n## 前提条件\n\n- \n\n已开通弹性容器实例服务、访问控制（RAM）服务，并完成了相关的RAM角色授权。说明 \n\n如果您使用RAM用户创建ECI实例，需要进行授权才能操作。具体操作，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users)。\n- \n\n已在合适的地域下创建专有网络VPC和交换机。\n\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n- \n\n关于如何创建专有网络和交换机，请参见[创建专有网络](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-a-vpc#task-1012575)和[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。说明 \n\n建议创建多个交换机，以便后续创建ECI实例时可以选择多个交换机来实现多可用区功能，从而提高实例创建的成功率。\n\n- \n\n已创建安全组。具体操作，请参见[创建安全组](https://help.aliyun.com/zh/ecs/user-guide/create-a-security-group-1)。\n\n安全组是一种虚拟防火墙，具备状态检测和数据包过滤功能，用于在云端划分安全域。一个ECI实例必须属于一个安全组。更多信息，请参见[配置ECI实例所属安全组](https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-2)。\n\n## 操作步骤\n\n下文主要介绍从Docker Hub拉取镜像（以busybox镜像为例）创建ECI实例时需要注意的配置和步骤，部分配置采用默认或者最简配置。\n\n- \n\n打开[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)。\n- \n\n配置实例基本信息。\n\n- \n\n选择付费模式和实例类型。\n\n此处保持默认选择即可。付费模式为按量付费，实例类型为普通实例。\n- \n\n选择地域。\n- \n\n选择专有网络VPC和对应的交换机。\n\n建议选择多个交换机实现多可用区功能，系统将根据库存情况优先在资源充足的可用区下创建实例。\n- \n\n选择安全组。 通过配置安全组规则，可以允许或禁止安全组内的ECI实例对公网或私网的访问，以及IP间的访问。说明 \n\n如果需要从公网访问VPC内的ECI实例，需要在安全组中开放对应的端口。具体操作，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n\n- \n\n配置容器组。 \n\n- \n\n选择容器组的规格。\n\n本文以直接选择vCPU和内存规格为例，该方式可以提供更好的弹性和资源供应能力。如果您的业务需要有特殊的规格需求，例如GPU等，您可以指定特定的ECS规格。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。\n- \n\n输入容器组名称。\n- \n\n选择重启策略。\n\n默认为总是重启（Always），即当容器运行退出后，将自动重启该容器。\n\n- \n\n配置容器。\n\n- \n\n输入容器名称。\n- \n\n选择镜像和对应的镜像版本。\n\n在Docker官方镜像页签下选择busybox，版本选择latest。说明 \n\n- \n\n镜像拉取策略（imagePullPolicy）默认为按需拉取（IfNotPresent），即优先使用本地镜像，本地没有时则拉取镜像。\n- \n\n来源为DOCKER_HUB的镜像为Docker官方镜像仓库（Docker Hub）中的镜像，需要通过公网拉取。\n\n- \n\n设置启动命令。\n\n为了保证Busybox容器能够正常运行，必须要设置启动命令。本文以sleep 999999为例。\n\n- \n\n如果所选的VPC没有创建NAT网关的情况下，单击下一步：其他设置，然后为实例绑定EIP。\n\n在弹性公网IP处，根据自身情况选择自动创建或使用已有EIP。绑定EIP后，实例可以通过该IP访问公网，在公网也可以通过该IP访问实例。\n\n- \n\n自动创建：自动创建的EIP将采用按量付费，支持使用共享带宽包抵扣，您需要配置带宽峰值。\n- \n\n使用已有：您可以在下拉列表中选择之前已创建的处于未绑定状态的EIP。\n重要 \n\nECI默认不提供外部公网链路进行公网镜像的拉取，如果您需要从Docker Hub或者其他外部镜像仓库拉取镜像，需要在VPC中创建NAT网关并配置SNAT，或者为ECI实例绑定EIP，否则镜像将拉取失败。更多信息，请参见[配置外网访问](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access#topic-1860106)。\n- \n\n单击配置确认。\n- \n\n确认实例配置信息，并选中服务协议，然后单击确认订单。\n\n创建成功后，您可以在容器组页面查看该实例，单击实例ID可以查看详情。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/use-a-centos-image-to-create-an-elastic-container-instance", "page_type": "doc", "title": "使用CentOS镜像创建ECI实例", "keywords": "创建CentOS ECI实例,解决ECI实例启动中,ECI实例创建教程,ECI实例启动问题", "last_modified_ms": 1723181163000, "last_modified_iso": "2024-08-09T13:26:03+08:00", "excerpt": "使用ECI提供的CentOS、Busybox等镜像创建ECI实例时，必须要设置启动命令，否则可能会出现实例一直处于启动中状态。本文介绍如何使用ECI提供的CentOS镜像（通过私网拉取）创建一台ECI实例。\n## 前提条件\n\n- \n\n已开通弹性容器实例服务、访问控制（RAM）服务，并完成了相关的RAM角色授权。说明 \n\n如果您使用RAM用户创建ECI实例，需要进行授权才能操作。具体操作，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users)。\n- \n\n已在合适的地域下创建专有网络VPC和交换机。\n\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n- \n\n关于如何创建专有网络和交换机，请参见[创建专有网络](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-a-vpc#task-1012575)和[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。说明 \n\n建议创建多个交换机，以便后续创建ECI实例时可以选择多个交换机来实现多可用区功能，从而提高实例创建的成功率。\n\n- \n\n已创建安全组。具体操作，请参见[创建安全组](https://help.aliyun.com/zh/ecs/user-guide/create-a-security-group-1)。\n\n安全组是一种虚拟防火墙，具备状态检测和数据包过滤功能，用于在云端划分安全域。一个ECI实例必须属于一个安全组。更多信息，请参见[配置ECI实例所属安全组](https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-2)。\n\n## 操作步骤\n\n下文主要介绍使用CentOS镜像创建ECI实例时需要注意的配置和步骤，部分配置采用默认或者最简配置。\n\n- \n\n打开[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)。\n- \n\n配置实例基本信息。\n\n- \n\n选择付费模式和实例类型。\n\n此处保持默认选择即可。付费模式为按量付费，实例类型为普通实例。\n- \n\n选择地域。\n- \n\n选择专有网络VPC和对应的交换机。\n\n建议选择多个交换机实现多可用区功能，系统将根据库存情况优先在资源充足的可用区下创建实例。\n- \n\n选择安全组。 通过配置安全组规则，可以允许或禁止安全组内的ECI实例对公网或私网的访问，以及IP间的访问。说明 \n\n如果需要从公网访问VPC内的ECI实例，需要在安全组中开放对应的端口。具体操作，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n\n- \n\n配置容器组。 \n\n- \n\n选择容器组的规格。\n\n本文以直接选择vCPU和内存规格为例，该方式可以提供更好的弹性和资源供应能力。如果您的业务需要有特殊的规格需求，例如GPU等，您可以指定特定的ECS规格。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。\n- \n\n输入容器组名称。\n- \n\n选择重启策略。\n\n默认为总是重启（Always），即当容器运行退出后，将自动重启该容器。\n\n- \n\n配置容器。\n\n- \n\n输入容器名称。\n- \n\n选择镜像和对应的镜像版本。\n\n在常用镜像页签下选择eci_open/centos，版本选择7。说明 \n\n- \n\n镜像拉取策略（imagePullPolicy）默认为按需拉取（IfNotPresent），即优先使用本地镜像，本地没有时则拉取镜像。\n- \n\n来源为ALI_HUB的镜像为阿里云镜像仓库中的镜像，默认通过专有网络VPC（私网）拉取。\n\n- \n\n设置启动命令。\n\n为了保证CentOS容器能够正常运行，必须要设置启动命令。本文以sleep 999999为例。\n\n- \n\n单击配置确认。\n- \n\n确认实例配置信息，并选中服务协议，然后单击确认订单。\n\n创建成功后，您可以在容器组页面查看该实例，单击实例ID可以查看详情。\n\n## 常见问题\n\n如果没有给CentOS容器配置启动命令，由于容器内部没有常驻进程，会导致容器启动成功后立即退出。在实例重启策略为总是重启的情况下，会一直尝试重启，导致容器一直处于启动中状态。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/use-an-nginx-image-to-create-an-elastic-container-instance", "page_type": "doc", "title": "使用Nginx镜像创建ECI实例", "keywords": "创建ECI实例,快速体验ECI,ECI实例创建教程,ECI实例快速入门", "last_modified_ms": 1706858823000, "last_modified_iso": "2024-02-02T15:27:03+08:00", "excerpt": "如果您想要体验测试ECI的产品能力，可以使用ECI提供的Nginx等常用镜像。本文介绍如何使用ECI提供的Nginx镜像（通过私网拉取）来创建一台ECI实例。\n\n## 视频教程\n\n您可以观看以下视频，了解如何通过控制台快速创建ECI实例。\n## 前提条件\n\n- \n\n已开通弹性容器实例服务、访问控制（RAM）服务，并完成了相关的RAM角色授权。说明 \n\n如果您使用RAM用户创建ECI实例，需要进行授权才能操作。具体操作，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users)。\n- \n\n已在合适的地域下创建专有网络VPC和交换机。\n\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n- \n\n关于如何创建专有网络和交换机，请参见[创建专有网络](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-a-vpc#task-1012575)和[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。说明 \n\n建议创建多个交换机，以便后续创建ECI实例时可以选择多个交换机来实现多可用区功能，从而提高实例创建的成功率。\n\n- \n\n已创建安全组。具体操作，请参见[创建安全组](https://help.aliyun.com/zh/ecs/user-guide/create-a-security-group-1)。\n\n安全组是一种虚拟防火墙，具备状态检测和数据包过滤功能，用于在云端划分安全域。一个ECI实例必须属于一个安全组。更多信息，请参见[配置ECI实例所属安全组](https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-2)。\n\n## 操作步骤\n\n下文主要介绍拉取Nginx镜像创建ECI实例时需要注意的配置和步骤，部分配置采用默认或者最简配置。\n\n- \n\n打开[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)。\n- \n\n配置实例基本信息。\n\n- \n\n选择付费模式和实例类型。\n\n此处保持默认选择即可。付费模式为按量付费，实例类型为普通实例。\n- \n\n选择地域。\n- \n\n选择专有网络VPC和对应的交换机。\n\n建议选择多个交换机实现多可用区功能，系统将根据库存情况优先在资源充足的可用区下创建实例。\n- \n\n选择安全组。 通过配置安全组规则，可以允许或禁止安全组内的ECI实例对公网或私网的访问，以及IP间的访问。说明 \n\n如果需要从公网访问VPC内的ECI实例，需要在安全组中开放对应的端口。具体操作，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n\n- \n\n配置容器组。 \n\n- \n\n选择容器组的规格。\n\n本文以直接选择vCPU和内存规格为例，该方式可以提供更好的弹性和资源供应能力。如果您的业务需要有特殊的规格需求，例如GPU等，您可以指定特定的ECS规格。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。\n- \n\n输入容器组名称。\n- \n\n选择重启策略。\n\n默认为总是重启（Always），即当容器运行退出后，将自动重启该容器。\n\n- \n\n设置购买数量。\n\n购买多台时，将按照数量自动在名称后增加有序后缀。例如：名称配置为test，购买数量为3台，则购买成功后，三台实例的名称分别为：test001、test002、test003。\n- \n\n配置容器。\n\n- \n\n输入容器名称。\n- \n\n选择镜像和对应的镜像版本。\n\n在常用镜像页签下选择eci_open/nginx，版本选择1.14.2。说明 \n\n- \n\n镜像拉取策略（imagePullPolicy）默认为按需拉取（IfNotPresent），即优先使用本地镜像，本地没有时则拉取镜像。\n- \n\n来源为ALI_HUB的镜像为阿里云镜像仓库中的镜像，默认通过专有网络VPC（私网）拉取。\n\n重要 \n\nECI不支持端口映射，实例对外开放容器默认暴露的端口。上述示例中选择的Nginx镜像默认开放80端口，在安全组开放80端口访问的情况下，可以直接通过实例IP+Port的形式访问Nginx容器。\n- \n\n单击配置确认。\n- \n\n确认实例配置信息，并选中服务协议，然后单击确认订单。\n\n创建成功后，您可以在容器组页面查看该实例，单击实例ID可以查看详情。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/use-coredump-to-analyze-instance-program-exceptions-2", "page_type": "doc", "title": "使用coredump分析实例程序异常", "keywords": "开启ECI coredump,分析ECI程序异常,下载ECI core文件,ECI coredump操作步骤,ECI异常排查方法", "last_modified_ms": 1761135856000, "last_modified_iso": "2025-10-22T20:24:16+08:00", "excerpt": "coredump是指在程序运行过程中发生异常终止或崩溃时，操作系统将程序的内存内容转储到一个特殊的文件中，以便于后续的调试和分析。本文介绍如何通过控制台为ECI实例开启coredump，以便在容器异常终止时可以查看分析coredump生成的文件，从而定位问题原因，修复程序异常。\n## 背景信息\n\nECI默认关闭coredump，避免磁盘占用过多而导致业务不可用。您可以手动开启coredump，开启后会生成一个运维任务。在容器运行异常终止或者退出时，触发coredump生成的core文件将自动保存到OSS中。\n## 使用限制\n\n- \n\n生成的运维任务为一次性任务，执行成功获取到一次core文件后，将会关闭coredump，并且运维任务有一定的期限（12小时），超出时间后任务将会失效。\n- \n\n不支持以下地域：华北6（乌兰察布）、华南2（河源）、华南3（广州）、华东5（南京-本地地域）、菲律宾（马尼拉）、韩国（首尔）、泰国（曼谷）。\n\n## 操作步骤\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/list)。\n- \n\n为ECI实例开启coredump。\n\n- \n\n单击目标实例ID，打开实例详情页面。\n- \n\n单击运维页签，然后选择Coredump页签，单击开启。\n\n开启coredump后，系统将生成一个运维任务，未触发coredump时，任务状态为等待中。\n\n- \n\n触发coredump。\n\n连接ECI实例，在容器内执行sleep 100命令后按Ctrl+\\键，触发coredump，生成的core文件将自动保存到OSS中。\n- \n\n下载core文件。\n\n触发coredump生成core文件后，运维任务的状态将变为成功，此时单击对应结果列中的下载即可下载core文件到本地。\n\n说明 \n\n如果下载没有反应，请检查浏览器的网站权限设置。\n\n## 相关文档\n\n除了手动开启coredump运维任务外，还可以通过自定义设置core文件保存路径的方式来开启coredump。更多信息，请参见[自定义设置core文件保存路径](https://help.aliyun.com/zh/eci/user-guide/use-coredump-to-analyze-instance-program-exceptions-1#section-veu-syd-eur)。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/use-elastic-container-instance-in-ask-and-ack", "page_type": "doc", "title": "通过ACK Serverless集群使用ECI", "keywords": "在ACK Serverless使用ECI,创建ACK Serverless集群,部署应用到ACK Serverless,ACK Serverless ECI快速入门,ACK Serverless集群创建,ACK Serverless应用部署", "last_modified_ms": 1716255494000, "last_modified_iso": "2024-05-21T09:38:14+08:00", "excerpt": "ECI已经无缝集成到阿里云容器服务Kubernetes版，您可以通过ACK Serverless集群或者ACK集群，快速体验ECI的容器运行能力。本文以ACK Serverless集群为例，介绍如何通过阿里云容器服务如何使用ECI。\n## 准备工作\n\n首次操作时，需完成服务开通和相关授权操作：\n\n- \n\n开通容器服务Kubernetes版，并授权默认角色和开通相关云产品。具体操作，请参见[首次使用容器服务Kubernetes版](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/getting-started/quick-start-for-first-time-users)。\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/welcome)，根据提示开通ECI服务。\n\n## 创建ACK Serverless集群\n\n以下步骤仅介绍创建ACK Serverless集群时的基本配置，实际操作时，请根据业务需要设置相关参数和安装相应组件。更多信息，请参见[创建集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/create-an-ask-cluster-2)。\n\n- \n\n打开创建集群页面。\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/#/next/overview)。\n- \n\n在左侧导航栏，单击集群。\n- \n\n在集群列表页面的右上角，单击创建集群。\n\n- \n\n在上方单击ACK Serverless集群页签，完成集群配置，然后单击下一步：组件配置。\n\n需要注意的配置项说明如下，未提及的配置项请根据自身需求设置。\n\n[表格]\n\n配置项\n\n示例\n\n说明\n\n集群名称\n\ntest\n\n根据页面提示填写集群名称。\n\n地域\n\n华北2（北京）\n\n选择集群所属地域。\n\n专有网络\n\n自动创建\n\n设置集群所属的专有网络。\n\n- \n\n自动创建：您需要选择可用区，系统会自动创建一个VPC和一个属于该可用区的交换机，且会在VPC中自动创建NAT网关并配置SNAT规则。\n- \n\n使用已有：选择已有的VPC和交换机。\n\n配置 SNAT\n\n为专有网络配置SNAT\n\n当集群需要公网访问能力时，需配置SNAT。\n\n- \n\n如果使用自动创建的专有网络，则会自动配置SNAT。\n- \n\n如果使用已有专有网络，请根据需要选择是否配置SNAT。\n\nService CIDR\n\n172.21.0.0/20\n\n您需要指定Service CIDR，网段不能与VPC及VPC内已有Kubernetes集群使用的网段重复，创建成功后不能修改。更多信息，请参见[Kubernetes集群网络规划](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/kubernetes-cluster-network-planning)。\n\nAPI server 访问\n\n使用EIP暴露API Server\n\n请根据需要设置是否使用EIP暴露API Server。API Server提供了各类资源对象（Pod，Service等）的增删改查及Watch等HTTP Rest接口。\n\n- \n\n如果开启，会创建一个EIP，并挂载到SLB上。此时，Kubernetes API服务（即API Server）会通过EIP的6443端口暴露出来，您可以在外网通过kubeconfig连接并操作集群。\n- \n\n如果不开启，则不会创建EIP，您只能在VPC内部用kubeconfig连接并操作集群。\n\n- \n\n完成组件配置，然后单击下一步：确认配置。\n\n请根据自身需求配置需要的组件。使用组件会产生相关费用，本文作为体验教程，不使用任何组件。\n- \n\n确认配置信息，选中服务协议，单击创建集群。\n\n返回集群列表页面，当集群状态为运行中时，表示集群创建完成。\n\n## 在ACK Serverless集群中部署应用\n\n以下步骤以Nginx为例，介绍如何在ACK Serverless集群中创建ECI实例来部署应用。\n\n- \n\n在集群列表页面，找到目标ACK Serverless集群的名称，进入集群管理页面。\n- \n\n创建Deployment，用于部署Nginx应用。\n\n- \n\n在左侧导航栏，选择工作负载>无状态。\n- \n\n单击右上角的使用YAML创建资源。\n- \n\n根据需要修改模板中的YAML内容，然后单击创建。\n\n默认选择了Resource-basic Deployment示例模板，该模板YAML声明创建的Deployment包含2个Pod，每个Pod带有app: nginx的Label，运行一个部署了Nginx应用的容器。说明 \n\n示例模板中的image: nginx:1.7.9表示从Docker Hub拉取Nginx 1.7.9版本的镜像。如果您的集群没有配置公网访问，则无法拉取该镜像，请替换为VPC网络内的镜像，例如image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2。\n\n- \n\n确认Deployment创建结果。\n\n- \n\n在无状态页面可以查看Deployment信息。\n\n容器组数量对应的2/2表示Deployment创建成功，包含的2个Pod已在运行中。\n\n- \n\n在无状态页面，单击Deployment名称可以查看Deployment详细信息。\n\n在容器组页签下可以看到2个Pod的状态均为运行中。单击Pod名称，可以查看Pod详细信息。\n\n- \n\n每个Pod对应一个ECI实例，在[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/welcome)的容器组页面，您可以看到相应的ECI实例。\n\n- \n\n创建Service，配置Nginx应用的访问方式。\n\n- \n\n在左侧导航栏，选择网络>服务。\n- \n\n单击右上角的使用YAML创建资源。\n- \n\n拷贝以下YAML，单击创建。\n\n以下YAML创建了一个类型为LoadBalancer的Service，对外开放80端口，后端为带有app: nginx的Label的Pod（即上一步创建的Deployment中的Pod）。\n\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-service\nspec:\n  ports:\n  - port: 80\n    protocol: TCP\n  selector:\n    app: nginx\n  type: LoadBalancer\n\n\n- \n\n确认Service的创建结果。\n\n在服务页面，单击Service名称可以查看Service详细信息。该Service已自动关联上一步创建的Deployment，后端端点为该Deployment中包含的2个Pod。\n\n- \n\n访问Nginx应用。\n\n单击Service外部端点对应的IP地址:端口，即可访问Nginx应用。\n"}
{"url": "https://help.aliyun.com/zh/eci/getting-started/use-elastic-container-instances", "page_type": "doc", "title": "一图看懂ECI使用流程", "keywords": null, "last_modified_ms": 1693274759000, "last_modified_iso": "2023-08-29T10:05:59+08:00", "excerpt": "\n", "aliases": ["https://help.aliyun.com/document_detail/90728.html"]}
{"url": "https://help.aliyun.com/zh/eci/getting-started/view-events-and-logs-of-an-elastic-container-instance", "page_type": "doc", "title": "查看ECI实例的事件、日志和监控信息", "keywords": "查看ECI实例事件,查看ECI实例日志,查看ECI实例监控,ECI实例事件,ECI实例日志,ECI实例监控", "last_modified_ms": 1688538559000, "last_modified_iso": "2023-07-05T14:29:19+08:00", "excerpt": "在实例详情页面，您可以查看事件和日志来排查问题，也可以查看CPU利用率等监控信息了解实例运行情况。本文介绍如何查看ECI实例的事件、日志和监控信息。\n## 操作步骤\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在容器组页面，找到想要查看的实例，单击ID。\n- \n\n在实例详情页面，选择对应的页签可以查看事件、日志或监控信息。\n\n- \n\n查看事件\n\n可以查看当前实例对应的最近50条事件。常见的事件以及对应的解决方案，请参见[ECI自定义事件](https://help.aliyun.com/zh/eci/user-guide/custom-events-of-elastic-container-instance#topic-1915324)。\n- \n\n查看日志\n\n支持筛选容器和开始时间查询日志。更多信息，请参见[自定义配置ECI日志采集](https://help.aliyun.com/zh/eci/user-guide/configure-log-collection-for-an-elastic-container-instance)。\n- \n\n查看监控信息\n\n可以查看CPU利用率、内存利用率、网络流量、磁盘使用情况等信息。更多信息，请参见[查看ECI实例监控指标](https://help.aliyun.com/zh/eci/user-guide/view-the-monitoring-metrics-of-an-elastic-container-instance)。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/benefits", "page_type": "doc", "title": "产品优势", "keywords": "了解ECI优势,ECI产品优势,ECI服务对比", "last_modified_ms": 1693362205000, "last_modified_iso": "2023-08-30T10:23:25+08:00", "excerpt": "弹性容器实例为您提供免运维、弹性、低成本、高效的容器运行环境。\n## 核心优势\n\n弹性容器实例的核心优势主要体现在以下几方面：\n\n- \n\n免运维\n\n采用Serverless架构，基础设施托管。您无需关心底层服务器，只需要提交容器镜像；无需预先创建集群和维护集群，无需关注运行过程中的容量规划，可以专注业务领域创新。\n- \n\n灵活部署\n\n以阿里云全球计算基础设施作为资源池，提供海量、高并发、多种资源类型（CPU、高主频、GPU等）的容器计算资源，您可以根据需要灵活部署。\n- \n\n低成本\n\n按实例启动到结束时间段内消耗的资源计费，时长精确到秒。配合Kubernetes或者您自建的调度系统，ECI可根据业务流量自动弹性伸缩，减少空置费用。\n- \n\n高弹性\n\n支持快速秒级启动实例，您无需提前预估集群容量和业务流量，可以按需扩容，轻松应对百倍的业务突发流量。\n- \n\n兼容性\n\n兼容Kubernetes，Kubernetes集群上的Pod能直接调度至ECI。支持无缝集成至阿里云容器服务Kubernetes版，同时支持通过virtual kubelet对接您自建的Kubernetes集群。\n- \n\n集成\n\n自动集成阿里云的其它服务，可快速实现网络访问、日志采集、数据持久化存储、服务监控等功能。例如：日志服务SLS、文件存储NAS、监控服务ARMS等。\n\n## 优势对比\n\nECI的核心是容器组，它的概念与Kubernetes的Pod概念完全兼容。使用ECI作为容器运行环境，可以为您的业务系统提供更高的弹性和安全性，同时降低使用和运维成本。\n\n阿里云各类容器服务运行环境的对比如下表所示。\n\n[表格]\n\n对比项\n\n弹性容器实例\n\n云服务器ECS\n\n弹性裸金属服务器\n\n成本\n\n只为Pod付费，节约成本。\n\n为ECS整体付费。\n\n为裸金属服务器整体付费。\n\n运维\n\n无需管理节点，运维简单，成本低。\n\n需要自行管理节点，运维ECS。\n\n需要自行管理节点，运维裸金属服务器。\n\n性能\n\n小幅虚拟化损耗。秒级启动，无需预留资源。\n\n小幅虚拟化损耗。\n\n无虚拟化损耗。\n\n弹性\n\n最好。支持小规格，提供更多库存。\n\n相对好。\n\n相对一般。\n\n安全\n\nPod之间强隔离，安全性更高。\n\nECS之间强隔离，Pod之间弱隔离。\n\n服务器之间强隔离，Pod之间弱隔离。\n\n宕机率\n\n极低。影响单个Pod，对业务基本无影响。\n\n极低。影响单台ECS，包括部署在该ECS的Pod。\n\n极低。影响单台服务器，包括部署在该服务器的Pod。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/billing-overview", "page_type": "doc", "title": "计费概述", "keywords": "了解ECI计费,查询ECI计费项,ECI计费概述,ECI计费项,ECI计费方式", "last_modified_ms": 1754277590000, "last_modified_iso": "2025-08-04T11:19:50+08:00", "excerpt": "本文介绍弹性容器实例ECI相关的计费资源及对应的计费方式。\n## 计费项\n\n使用弹性容器实例ECI时，涉及收费的资源如下：\n\n[表格]\n\n资源\n\n计费说明\n\n相关文档\n\nECI实例（计算资源）\n\n根据您创建ECI实例的方式，支持两种计费模式：\n\n- \n\n按vCPU和内存\n- \n\n按ECS规格\n\n[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances#topic-2240704)\n\n镜像缓存\n\n- \n\n创建镜像缓存：手动创建需支付临时资源费用和快照费用；自动创建无需付费。\n- \n\n使用镜像缓存：根据镜像缓存类型和大小，可能需要额外支付云盘或临时存储空间费用。\n\n[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches#topic-2240706)\n\n数据缓存\n\n- \n\n创建数据缓存：需支付临时资源费用和快照费用。\n- \n\n使用数据缓存：需要额外支付云盘费用。\n\n[数据缓存计费](https://help.aliyun.com/zh/eci/product-overview/data-cache-billing)\n\n临时存储空间\n\n创建ECI实例时，如果增加了临时存储空间大小，需为其付费。\n\n[临时存储空间计费](https://help.aliyun.com/zh/eci/product-overview/temporary-storage-space#topic-2241359)\n\n虚拟节点（VNode）\n\n自建集群可通过虚拟节点（VNode）接入ECI。VNode本身会产生ECI实例费用（每个VNode会有一个常驻节点，相当于2 vCPU，8 GiB的ECI实例）。\n\n[虚拟节点（VNode）计费](https://help.aliyun.com/zh/eci/product-overview/virtual-node-billing)说明 \n\n查看账单时，ECI实例费用和临时存储空间费用计入弹性容器实例产品账单，云盘费用和快照费用计入块存储产品账单。关于如何查看账单，请参见[账单查询](https://help.aliyun.com/zh/eci/product-overview/view-your-bills#topic-1880922)。\n\n根据业务需要，您可能需要使用阿里云的网络、存储等其他服务。相关说明如下：\n\n[表格]\n\n资源\n\n计费说明\n\n相关文档\n\n网络\n\n如果您的ECI实例需要公网通信，则需要配置弹性公网IP（EIP）或NAT网关，支付相应的网络费用。说明 \n\n创建镜像缓存和数据缓存的过程中，如果拉取公网镜像和数据，也需要配置EIP或NAT网关。\n\n- \n\n[EIP计费说明](https://help.aliyun.com/zh/eip/product-overview/billing-overview/#concept-645525)\n- \n\n[NAT网关计费说明](https://help.aliyun.com/zh/nat-gateway/nat-gateway-billing#concept-z13-hty-ydb)\n\n存储\n\n如果您的ECI实例需要持久化存储。支持挂载阿里云云盘、NAS文件系统等。根据您使用的存储资源，支付相应的存储费用。\n\n- \n\n[云盘计费说明](https://help.aliyun.com/zh/ecs/block-storage-devices#concept-1937442)\n- \n\n[通用型NAS计费说明](https://help.aliyun.com/zh/nas/product-overview/billing-of-general-purpose-nas-file-systems#task-2567548)\n- \n\n[OSS计费说明](https://help.aliyun.com/zh/oss/billing-overview#concept-n4t-mwg-tdb)\n\n## 计费方式\n\nECI涉及的计费资源（实例、镜像缓存、数据缓存、临时存储空间）默认均采用按量付费，即先使用再付费。说明 \n\n您也可以结合使用其他计费方式进行优化成本，例如：\n\n- \n\n对于ECI实例费用，可以使用节省计划、预留实例券和抢占式实例来节约实例费用。\n- \n\n对于快照费用，可以使用OSS存储包和存储容量单位包SCU进行抵扣。\n\n按量付费的规则如下：\n\n- \n\n计费周期：按秒计费，即每次计入1秒的费用。各资源小时价格除以3600即可得到每秒价格。\n- \n\n结算周期：按小时出账，即每一个小时整点结算一次账单。\n\n例如：您创建了一台ECI实例，创建时指定2 vCPU和4 GiB内存，没有使用镜像缓存。该实例于10:49:30进入Pending状态，于11:20:05释放。则该实例会产生两个账单：\n\n- \n\n账单1：结算周期为10~11点，该实例在10:49:30~11:00:00间产生计费，计费时长为630秒。\n- \n\n账单2：结算周期为11~12点，该实例在11:00:00~11:20:05间产生计费，计费时长为1205秒。\n\n## 欠费说明\n\n结算账单时，如果您账户的可用额度（含阿里云账户余额、代金券等）不足，则会被判定为账户欠费。欠费会导致ECI实例释放。在使用期间，请您确保额度充足，以免因为资源释放而影响业务。\n\n如果您开启了延停，则在延停额度使用完后再释放资源。说明 \n\n阿里云提供延停权益，即当按量付费的资源发生欠费后，提供一定额度或时长继续使用云服务的权益。延停期间正常计费。延停的权益额度不是欠费总额的上限。您延停的额度或时长根据您在阿里云的历史消费等因素，每个月自动计算并更新。更多信息，请参见[延期免停权益](https://help.aliyun.com/zh/user-center/exemption-of-suspension-after-delinquency)。\n", "aliases": ["https://help.aliyun.com/document_detail/89142.html"]}
{"url": "https://help.aliyun.com/zh/eci/product-overview/data-cache-billing", "page_type": "doc", "title": "数据缓存计费", "keywords": "了解数据缓存计费,计算数据缓存费用,数据缓存计费规则,数据缓存计费项", "last_modified_ms": 1692251807000, "last_modified_iso": "2023-08-17T13:56:47+08:00", "excerpt": "本文介绍数据缓存的计费规则，并给出计费示例。\n## 计费说明\n\n数据缓存用于提前拉取业务所需的大量数据（例如训练模型等），以便在创建ECI实例时可以直接挂载使用数据。一个数据缓存对应一个快照，创建和使用数据缓存涉及的计费项及其计费规则说明如下。更多关于数据缓存的信息，请参见[数据缓存概述](https://help.aliyun.com/zh/eci/user-guide/data-caching-overview)。\n\n- \n\n创建数据缓存\n\n[表格]\n\n计费项\n\n计费说明\n\n相关文档\n\n临时资源（ECI实例和云盘）费用\n\n系统会自动创建一个ECI实例（2 vCPU、4 GiB内存）和一块云盘（默认为ESSD PL1类型），用于中转创建数据缓存。在数据缓存创建完成后，该实例和云盘会自动释放并停止计费。\n\n- \n\n计费方式：按量付费。\n- \n\n计费公式：费用=（vCPU单价*2+内存单价*4+云盘单价*云盘容量）*实例运行时长。\n- \n\n公式说明：\n\n- \n\n资源单价\n\n- \n\nvCPU（vCPU）：0.000049 元/秒。\n- \n\n内存（GiB）： 0.00000613 元/秒。\n- \n\n云盘：参见[块存储价格页](https://www.aliyun.com/price/product?#/disk/detail)。\n\n- \n\n云盘容量：等于数据缓存大小。\n- \n\n实例运行时长：时长受数据大小影响，数据量大相对耗时长。\n\n- \n\n[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances#topic-2240704)\n- \n\n[块存储计费](https://help.aliyun.com/zh/ecs/block-storage-devices#concept-1937442)\n\n快照费用\n\n一个数据缓存对应一个快照。该快照的生命周期与数据缓存的生命周期一致，保留数据缓存需支付快照存储费用。\n\n[快照计费](https://help.aliyun.com/zh/ecs/snapshots-1#concept-rq2-pcx-ydb)\n- \n\n使用数据缓存\n\n[表格]\n\n计费项\n\n计费说明\n\n相关文档\n\n云盘费用\n\n使用数据缓存创建ECI实例时，会为实例挂载一块按量付费的（默认为ESSD PL1类型，可自定义PL等级）云盘。该云盘的容量等于数据缓存大小，随实例一起创建和释放。即：除ECI实例费用外，还需额外支付云盘费用。\n\n[块存储计费](https://help.aliyun.com/zh/ecs/block-storage-devices#concept-1937442)\n\n## 计费示例说明 \n\n以下价格计算仅用作示例，实际费用以账单显示为准。\n\n假设您在华东1（杭州）创建了一个大小为20 GiB的数据缓存，保留时间为3天。创建过程中，临时实例（含云盘）运行了5分钟（300秒），该数据缓存对应快照的容量为15 GiB。\n\n创建该数据缓存涉及的费用为：\n\n- \n\n临时资源费用：（0.000049*2+0.00000613*4+0.0021/3600*20）* 300=0.040256元。\n- \n\n快照费用：0.12/30*15*3=0.18元。\n\n则创建总费用=临时资源+快照费用=0.040256+0.18=0.220256元\n\n如果使用该数据缓存创建一台ECI实例，该ECI实例运行了3小时，则除实例费用外，还需支付云盘费用（即数据缓存使用费用），费用=0.0021*20*3=0.126元。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances", "page_type": "doc", "title": "ECI实例计费", "keywords": "了解ECI实例计费,计算ECI实例费用,优化ECI实例成本,ECI实例计费规则,ECI实例计费方式,ECI实例成本优化", "last_modified_ms": 1732695305000, "last_modified_iso": "2024-11-27T16:15:05+08:00", "excerpt": "本文介绍ECI实例（计算资源）的计费规则，并给出计费示例。说明 \n\n本文主要介绍ECI实例包含的计算资源的计费。如果您在创建ECI实例时，使用了镜像缓存、增加了临时存储空间、或者配置了EIP等，则需要额外支付对应的费用。\n## 计费说明\n\nECI实例支持以下两种计费模式：\n\n[表格]\n\n计费规则\n\n按vCPU和内存\n\n按ECS规格\n\n计费说明\n\n根据您创建时指定的vCPU和内存进行计费。针对不支持的vCPU和内存规格，系统将自动进行规整，并按自动规整后的规格进行计费。\n\n根据您创建时指定的ECS规格进行计费。\n\n根据业务需要，您可以指定ECI实例底层使用ECS规格，来获取相应规格的指定能力，例如：指定使用ecs.gn5i-c4g1.xlarge规格，以使用GPU。\n\n计费方式\n\n以实例为单位，按量付费（按秒计费，按小时出账）\n\n以实例为单位，按量付费（按秒计费，按小时出账）\n\n成本优化\n\n节省计划（通用型）\n\n- \n\n节省计划（通用型或ECS计算型）\n- \n\n预留实例券\n- \n\n抢占式实例说明 \n\n抢占式实例既支持指定ECS规格创建，也支持指定vCPU和内存创建。其中，指定vCPU和内存创建时，系统会自动匹配满足规格和价格要求的ECS规格，并以此规格的市场价格作为计费的原始市场价格，即折扣是基于该ECS规格的市场价，而非对应ECI的vCPU和内存的按量价格。\n\n计费公式\n\n单个实例费用=（vCPU数*vCPU单价+内存大小*内存单价）*计费时长。说明 \n\n如果实例费用不足0.01元，将按照四舍五入进行规整，即0.005元及以上按0.01元收取，不足0.005元不收取费用。\n\n单个实例费用=ECS规格单价*计费时长。\n\n资源价格\n\n- \n\nvCPU单价（vCPU）：0.000049 元/秒（0.1764 元/小时）\n- \n\n内存单价（GiB）： 0.00000613 元/秒（0.0221 元/小时）\n说明 \n\n- \n\n如果使用经济型规格，则vCPU单价更低，为0.000027 元/秒（0.0972 元/小时）。\n- \n\n具体价格以购买页面和实际账单显示为准。\n\n同一ECS规格在不同地域的价格可能不同，具体价格请参见[ECS定价页](https://www.aliyun.com/price/product#/ecs/detail)。\n\n计费时长\n\n计费时长为实例运行时长，从下载容器镜像（Pending状态）开始至实例停止运行（进入Succeeded或Failed状态）。创建或启动失败的ECI实例不会收取费用。更多信息，请参见[ECI实例的生命周期](https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-1#topic700)。\n\n大部分场景下，如果没有特殊的规格需求（如GPU、本地盘等），推荐您使用按vCPU和内存模式创建ECI实例，该模式下会尝试使用ECS的多个规格族，进行ECI实例的创建，以保障资源的交付。例如：您想要创建2 vCPU、4 GiB内存的ECI实例，系统会尝试使用ECS的ecs.c6.large、ecs.c5.large、ecs.sn1ne.large等规格进行资源的交付。重要 \n\n每个ECI实例以您申请的资源作为计费单元，而不是业务在运行过程中实际使用的vCPU使用率和内存使用率。例如：您申请一个2 vCPU、4 GiB的ECI实例，运行过程中平均vCPU使用率为20%，内存使用率为60%，该实例会按照2 vCPU、4 GiB作为计量计费单位，而不是2 vCPU*20%和4 GiB*60%。\n## 计费示例\n\n根据您创建ECI实例的方式，ECI实例的计费项不同，费用计算示例如下：说明 \n\n以下价格计算仅用作示例，实际费用以账单显示为准。\n### 示例一：按vCPU和内存计费\n\n指定vCPU和内存创建一台2 vCPU、4 GiB内存的ECI实例，则每小时该ECI实例的费用为：\n\n- \n\nvCPU：0.000049*3600*2=0.3528元\n- \n\n内存：0.00000613*3600*4=0.088272元\n\n查看账单明细时，对应的计费项为vCPU（cpu）和内存（mem），示例如下：\n### 示例二：按ECS规格计费\n\n在华东1（杭州）地域指定ECS规格（如ecs.c5.large）创建一台ECI实例，由于ecs.c5.large的单价为0.62元/小时，则每小时该ECI实例的费用为0.62元。\n\n查看账单明细时，对应的计费项为实例规格（instance_type），示例如下：\n## 成本优化\n\n针对不同的业务负载，您可以结合使用节省计划、预留实例券和抢占式实例来优化您的实例使用成本。\n\n各方式相关说明如下表所示。\n\n[表格]\n\n计费方式\n\n说明\n\n相关文档\n\n节省计划\n\n一种折扣权益计划，搭配按量付费实例使用，适用于长期运行的7 * 24小时稳定服务。成本相比预留实例券稍高，使用时不受地域、规格族等限制，更加灵活。\n\n购买时根据每小时承诺消费、付费方式、购买时长等决定购买费用。使用时从资金维度（承诺消费金额）抵扣实例账单。说明 \n\n节省计划分为通用型和ECS计算型，其中ECS计算型仅支持抵扣指定ECS规格创建的ECI实例，通用型不受限制。\n\n- \n\n[什么是节省计划](https://help.aliyun.com/zh/ecs/user-guide/what-is-savings-plan#concept-1950740)\n- \n\n[使用节省计划](https://help.aliyun.com/zh/eci/user-guide/apply-savings-plans-2#topic-2044352)\n\n预留实例券\n\n一种抵扣券，搭配按量付费实例使用，适用于需要明确的资源保障并长期运行的7 * 24小时稳定服务。成本与对应规格的包年包月ECS接近，使用时需遵循一定的匹配规则。\n\n购买时根据选择的地域、实例规格、操作系统、付费方式、有效期等决定购买费用。使用时从资源维度（承诺使用指定资源）抵扣实例账单。说明 \n\n仅支持抵扣指定ECS规格创建的ECI实例，当券和实例匹配时才能抵扣。\n\n- \n\n[预留实例券概述](https://help.aliyun.com/zh/ecs/user-guide/overview-6#concept-tc4-zhq-dgb)\n- \n\n[使用预留实例券](https://help.aliyun.com/zh/eci/user-guide/use-reserved-instances#topic649)\n\n抢占式实例\n\n一种按需实例，适用于运行时长短的任务型计算场景。成本相比按量付费有较大折扣，但价格不固定，随市场供需关系波动，在超出保护期后可能会因库存不足或出价低于市场价而释放实例。\n\n- \n\n[抢占式实例概述](https://help.aliyun.com/zh/ecs/user-guide/what-is-a-spot-instance#concept-t3p-gv2-5db)\n- \n\n[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance#topic-2445170)\n说明 \n\n节省计划和预留实例券可以同时购买，抵扣账单时优先使用预留实例券，再使用节省计划。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/features", "page_type": "doc", "title": "功能特性", "keywords": "了解ECI功能特性,评估ECI产品能力,ECI功能特性,ECI服务集成", "last_modified_ms": 1693879397000, "last_modified_iso": "2023-09-05T10:03:17+08:00", "excerpt": "本文介绍弹性容器实例的功能特性。\n## 容器运行服务\n\n弹性容器实例是敏捷安全的Serverless容器运行服务。一个ECI实例对应一个容器组（即一个Pod），包含vCPU、内存、操作系统、容器运行时、网络、临时存储等基础组件。更多信息，请参见[实例概述](https://help.aliyun.com/zh/eci/user-guide/overview#topic-1860128)。\n### Serverless\n\n使用ECI实例，您无需管理底层服务器，也无需关心运行过程中的容量规划，只需提供打包好的镜像，即可运行容器应用。\n### 自定义规格\n\n支持多种类型的计算资源来运行容器，可以自定义规格，包括：\n\n- \n\n指定ECI规格：支持指定实例级别或者容器级别的vCPU和内存。\n- \n\n指定ECS规格：支持指定ECS规格来满足特殊业务需求，例如GPU、AMD规格等。\n\n### 按量按秒收费\n\n支持一站式管理ECI实例的生命周期，按您实际使用时长收费；以小时为单位，按秒收费。\n### 秒级弹性伸缩\n\nECI实例支持秒级启动，可快速完成扩缩容，满足业务的实时响应需求。\n### 镜像缓存\n\n支持镜像缓存功能加速ECI实例创建，减少实例启动耗时。更多信息，请参见[镜像缓存概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2#topic-2131957)。\n## 兼容Kubernetes\n\n基于Kubernetes社区的Virtual Kubelet技术，ECI可以通过虚拟节点的方式接入到Kubernetes集群中，使得集群可以轻松获得极大的弹性能力，而不必受限于集群的节点计算容量。ECI在接管Pod容器底层基础设施的管理工作后，Kubernetes不再需要直接负责单个Pod的放置、启动等工作，也不再需要关心底层虚拟机的资源情况，通过ECI即可确保Pod需要的资源随时可用。\n\nECI对接Kubernetes分为以下几种：\n\n- \n\n对接阿里云容器服务Kubernetes版\n\n如果您正在进行Kubernetes集群的选型，推荐您使用阿里云容器服务Kubernetes版。目前ECI已无缝集成到ACK集群（混合使用ECS和ECI）和ACK Serverless集群（完全基于ECI）中。您可以通过ACK集群或者ACK Serverless集群，快速体验ECI的容器运行能力。更多信息，请参见[对接阿里云容器服务](https://help.aliyun.com/zh/eci/user-guide/connection-overview#topic-1860138)。\n- \n\n对接自建Kubernetes集群\n\n如果您已经在本地IDC，或者阿里云的ECS上自建了Kubernetes集群，可以通过部署虚拟节点的方式来使用ECI。更多信息，请参见[对接自建Kubernetes集群](https://help.aliyun.com/zh/eci/user-guide/overview-3#topic-2148389)。\n\n## 集成云上服务\n\nECI支持与阿里云其他服务紧密集成，您可以使用一体化控制台进行高效操作。除无缝集成到阿里云容器服务（ACK和ACK Serverless集群）外，ECI还支持集成以下云服务：\n\n- \n\n镜像：支持使用容器镜像服务ACR。\n- \n\n网络：支持接入负载均衡SLB实现；可以通过NAT网关和弹性公网IP连接公网。\n- \n\n存储：可配合使用云盘、文件存储NAS、对象存储OSS实现容器数据的持久化存储。\n- \n\n日志：支持采集日志到日志服务SLS。\n- \n\n安全：可配合访问控制RAM实现ECI资源的访问权限控制。\n- \n\n弹性伸缩：可配合使用弹性伸缩实现自动扩缩容ECI实例。\n\n更多信息，请参见[支持的云服务](https://help.aliyun.com/zh/eci/product-overview/supported-alibaba-cloud-services#topic-2214764)。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/function-offline-stop-supporting-the-startup-template-function", "page_type": "doc", "title": "【功能下线】停止支持启动模板功能", "keywords": "功能下线,启动模板功能,阿里云,2023年12月31日,停止支持,停止使用,影响", "last_modified_ms": 1693216213000, "last_modified_iso": "2023-08-28T17:50:13+08:00", "excerpt": "弹性容器实例将于2023年12月31日起停止支持启动模板功能。功能下线对正在运行的ECI实例没有影响，但您无法继续使用启动模板功能。\n## 下线内容\n\n从2023年12月31日起，弹性容器实例停止支持启动模板功能。\n## 下线时间\n\n2023年12月31日\n## 下线影响\n\n- \n\n下线启动模板功能，对正在运行的ECI实例没有影响。\n- \n\n启动模板功能下线后，您无法使用相关功能，包括无法创建启动模板，无法通过启动模板创建ECI实例等。说明 \n\n如果您通过阿里云容器服务ACK使用ECI，可以在容器服务管理控制台以YAML方式将实例配置信息保存为模板。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/function-release-online-data-cache-function", "page_type": "doc", "title": "【功能发布】数据缓存", "keywords": "数据缓存, DataCache, 新功能发布, 缓存模型, AIGC", "last_modified_ms": 1702001709000, "last_modified_iso": "2023-12-08T10:15:09+08:00", "excerpt": "弹性容器实例于2023年8月21日上线数据缓存（DataCache）功能。对于一些数据量较大的业务数据，例如训练模型等，ECI支持创建数据缓存（DataCache）来提前拉取数据，将数据缓存到本地，以便在创建ECI实例时可以直接挂载使用，从而减少实例启动耗时，避免数据重复下载，节约使用成本。\n## 功能介绍\n\n为了解决数据加载与容器镜像加载解耦的问题，ECI提供了数据缓存的功能。在创建业务应用前，您可以提前创建数据缓存，将业务应用所需的数据缓存到本地。在创建业务应用时，可以直接挂载使用缓存好的数据。\n\n通过数据缓存功能，您无需将数据打包进应用镜像，从而避免因数据变更而频繁更新镜像；也无需从远端的仓库下载数据，避免因下载数据导致应用启动过慢。\n\n更多信息，请参见[数据缓存概述](https://help.aliyun.com/zh/eci/user-guide/data-cache-overview)。\n## 发布时间\n\n2023年8月21日\n## 适用场景\n\n适合数据量大，或者数据频繁更新的场景。例如AIGC场景。\n## 使用方式\n\n在创建业务应用前，您可以提前创建数据缓存，将业务应用所需的数据缓存到本地。在创建业务应用时，您可以通过指定数据缓存Bucket，以HostPath的方式直接挂载数据存储路径。\n\n根据使用ECI方式的差异，相关文档参考如下：\n\n[表格]\n\n功能\n\nECI控制台或OpenAPI\n\nKubernetes集群\n\n创建数据缓存\n\n[创建和管理数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches)\n\n[创建和管理DataCache](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-datacache)\n\n使用数据缓存\n\n[使用数据缓存创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-using-the-data-cache)\n\n[使用DataCache创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-using-datacache)\n\n实践教程\n\n[数据缓存实践教程](https://help.aliyun.com/zh/eci/user-guide/data-caching-practice-tutorial/)\n\n[DataCache实践教程](https://help.aliyun.com/zh/eci/user-guide/datacache-practice-tutorial/)\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/function-release-record", "page_type": "doc", "title": "功能发布记录", "keywords": "弹性容器实例,新功能,发布记录", "last_modified_ms": 1729231092000, "last_modified_iso": "2024-10-18T13:58:12+08:00", "excerpt": "本文介绍弹性容器实例ECI的产品功能和对应的文档动态。说明 \n\n本文记录2023年及之后的ECI功能发布。更多有关阿里云最新产品动态，请参见[产品动态](https://www.aliyun.com/product/news)。\n## 2024年\n### 2024年7月\n\n[表格]\n\n功能名称\n\n功能概述\n\n发布时间\n\n相关文档\n\n（ECI控制台和API）\n\n相关文档\n\n（Kubernetes）\n\n支持强制删除ECI实例\n\n删除ECI实例时，支持不等待graceful termination超时时间，强制清理资源。\n\n2024-07-01\n\n[DeleteContainerGroup - 删除一个容器组](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletecontainergroup)\n\n不涉及\n\n自定义设置最大Pending时长\n\n默认情况下，ECI实例的最大Pending时长为4小时，您可以根据实际业务情况自定义设置最大Pending时长，系统会自动终止超时的ECI实例，可以在一定程度上规避因没有及时处理异常Pod而造成的费用损失。\n\n2024-07-01\n\n暂不支持\n\n[自定义设置ECI Pod的最大Pending时长](https://help.aliyun.com/zh/eci/user-guide/customize-the-maximum-pending-duration-of-the-eci-pod)\n### 2024年6月\n\n[表格]\n\n功能名称\n\n功能概述\n\n发布时间\n\n相关文档\n\n（ECI控制台和API）\n\n相关文档\n\n（Kubernetes）\n\n自定义DNS\n\n混合云场景下，如果需要使用内网的镜像仓库来拉取镜像，或者容器需要访问内网中的域名，支持配置ECI Pod使用内网DNS，以便解析内网域名。\n\n2024-06-28\n\n暂不支持\n\n[为ECI Pod配置自定义DNS](https://help.aliyun.com/zh/eci/user-guide/configure-custom-dns-for-eci-pods)\n\n使用标签管理ECI资源\n\n新增TagResources、ListTagResources和UntagResources接口，可以统一为ECI资源绑定和解绑标签。\n\n2024-06-20\n\n[标签](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-dir-tags/)\n\n不涉及\n\n规格族过滤和规格代数过滤功能新增支持8代规格族\n\n指定或排除ECS规格族，以及指定或排除ECS规格代数创建ECI Pod时，支持指定或排除8代规格族。\n\n2024-06-20\n\n暂不支持\n\n- \n\n[指定或排除ECS规格族创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod-1)\n- \n\n[指定或排除ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod)\n\n不再支持ecs.t6和ecs.t5规格族\n\n指定ECS规格创建ECI实例时，不再支持突发性能型规格（即ecs.t6和ecs.t5规格族）。\n\n2024-06-04\n\n[指定x86规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-of-the-specified-x86-type)\n\n[指定x86规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specifying-the-x86-specification-to-create-a-pod)\n### 2024年5月\n\n[表格]\n\n功能名称\n\n功能概述\n\n发布时间\n\n相关文档\n\n（ECI控制台和API）\n\n相关文档\n\n（Kubernetes）\n\n新增通用型实例\n\n指定vCPU和内存来创建ECI实例时，可以进一步指定算力类别。对于性能需求较高的业务场景，可以选择通用型规格\n\n2024-05-31\n\n[指定算力类别创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-an-instance)\n\n[指定算力类别创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-a-pod)\n\n新增支持GPU、Volume等云监控指标\n\n通过云监控来监控ECI实例时，新增支持GPU、Volume相关监控指标。\n\n2024-05-23\n\n[使用云监控对ECI实例进行监控](https://help.aliyun.com/zh/eci/user-guide/use-cloud-monitoring-to-monitor-eci-instances-1693991084267)\n\n[使用云监控对ECI实例进行监控](https://help.aliyun.com/zh/eci/user-guide/use-cloud-monitoring-to-monitor-eci-instances)\n### 2024年4月\n\n[表格]\n\n功能名称\n\n功能概述\n\n发布时间\n\n相关文档\n\n（ECI控制台和API）\n\n相关文档\n\n（Kubernetes）\n\nSecurity Context已支持修改kernel.shm_rmid_forced\n\n配置Security Context时，支持修改的sysctl参数包括kernel.shm_rmid_forced。\n\n2024-04-23\n\n[配置Security Context](https://help.aliyun.com/zh/eci/user-guide/configure-a-security-context-for-an-elastic-container-instance-or-a-container)\n\n[配置Security Context](https://help.aliyun.com/zh/eci/user-guide/configure-a-security-context-for-a-pod-or-container-1)\n\n切换GPU驱动版本\n\n通过OpenAPI创建ECI GPU实例时，支持切换GPU驱动版本。\n\n2024-04-15\n\n[指定GPU规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-the-gpu-type)\n\n之前已支持，本次不涉及\n\n规格族过滤和规格代数过滤功能新增支持g5ne规格族\n\n指定或排除ECS规格族，以及指定或排除ECS规格代数创建ECI Pod时，支持指定或排除g5ne规格族。\n\n2024-04-08\n\n暂不支持\n\n- \n\n[指定或排除ECS规格族创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod-1)\n- \n\n[指定或排除ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod)\n\n### 2024年1月\n\n[表格]\n\n功能名称\n\n功能概述\n\n发布时间\n\n相关文档\n\n（ECI控制台和API）\n\n相关文档\n\n（Kubernetes）\n\n支持ecs.c8i、ecs.c8a、ecs.g8i规格族\n\n指定ECS规格创建ECI实例时，新增支持ecs.c8i、ecs.c8a、ecs.g8i规格族。\n\n2024-01-25\n\n[指定x86规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-of-the-specified-x86-type)\n\n[指定x86规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specifying-the-x86-specification-to-create-a-pod)\n## 2023年\n### 2023年12月\n\n[表格]\n\n功能名称\n\n功能概述\n\n发布时间\n\n相关文档\n\n（ECI控制台和API）\n\n相关文档\n\n（Kubernetes）\n\n新增经济型实例\n\n指定vCPU和内存来创建ECI实例时，对于0.25~8 vCPU的规格需求，您可以进一步指定算力"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/how-to-disable-eci-services-or-stop-billing", "page_type": "doc", "title": "如何关闭ECI服务或停止计费", "keywords": "关闭ECI服务,停止ECI计费,ECI计费管理", "last_modified_ms": 1713236942000, "last_modified_iso": "2024-04-16T11:09:02+08:00", "excerpt": "如果您不想继续使用ECI服务，请删除所有相关的ECI资源来确保已停止计费。相关参考如下：\n\n[表格]\n\n操作\n\n通过ECI控制台或OpenAPI操作\n\n在Kubernetes集群中操作\n\n删除ECI实例\n\n- \n\n[删除ECI实例](https://help.aliyun.com/zh/eci/getting-started/delete-elastic-container-instances)\n- \n\n[DeleteContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletecontainergroup)\n\n在Kubernetes集群中执行kubectl delete命令删除ECI Pod。\n\n如果ECI Pod由Deployment等上层控制器管理，请确保已删除Deployment等上层控制器。\n\n删除镜像缓存\n\n- \n\n[删除镜像缓存](https://help.aliyun.com/zh/eci/user-guide/manage-an-image-cache#section-dh0-hkv-u8d)\n- \n\n[DeleteImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deleteimagecache)\n\n[删除ImageCache](https://help.aliyun.com/zh/eci/user-guide/manage-image-caches-1#section-vgs-fvu-o2r)\n\n删除数据缓存\n\n- \n\n[删除数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches#fe3c78b036t86)\n- \n\n[DeleteDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletedatacache)\n\n[删除DataCache](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-datacache#04e51fa027mop)重要 \n\n- \n\n如果仅是开通ECI服务，并未创建相关ECI资源，则并不会产生计费。\n- \n\n为了避免误操作导致业务受到影响，如果您想要一键关闭ECI服务，请提交工单申请。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/image-caches", "page_type": "doc", "title": "镜像缓存计费", "keywords": "了解镜像缓存计费,计算镜像缓存费用,镜像缓存计费规则,镜像缓存计费项", "last_modified_ms": 1729586379000, "last_modified_iso": "2024-10-22T16:39:39+08:00", "excerpt": "本文介绍镜像缓存的计费规则，并给出计费示例。\n## 计费说明\n\n镜像缓存可以加速拉取镜像，减少ECI实例启动的耗时。创建镜像缓存的方式分为手动创建和自动创建两种，两者的计费规则不同。\n\n[表格]\n\n操作阶段\n\n手动创建的镜像缓存\n\n自动创建的镜像缓存\n\n创建镜像缓存\n\n涉及以下计费项：\n\n- \n\n临时资源（ECI实例和云盘）费用\n- \n\n快照费用\n\n不收费\n\n使用镜像缓存\n\n云盘费用\n\n如果镜像缓存大于30 GiB，需增加临时存储空间并为其付费。说明 \n\n镜像缓存创建完成后，您可以在镜像缓存的制作事件信息中查看镜像缓存大小。更多信息，请参见[镜像缓存概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2#topic-2131957)。\n### 手动创建的镜像缓存\n\n- \n\n创建镜像缓存\n\n[表格]\n\n计费项\n\n计费说明\n\n相关文档\n\n临时资源（ECI实例和云盘）费用\n\n系统会自动创建一个ECI实例（2 vCPU、4 GiB内存）和一块ESSD PL1类型的云盘，用于中转创建镜像缓存。在镜像缓存创建完成后，该实例和云盘会自动释放并停止计费。\n\n- \n\n计费方式：按量付费。\n- \n\n计费公式：费用=（vCPU单价*2+内存单价*4+云盘单价*云盘容量）* 实例运行时长。\n- \n\n公式说明：\n\n- \n\n资源单价\n\n- \n\nvCPU（vCPU）：0.000049 元/秒。\n- \n\n内存（GiB）： 0.00000613 元/秒。\n- \n\n云盘：参见[块存储价格页](https://www.aliyun.com/price/product?#/disk/detail)。\n\n- \n\n云盘容量：等于镜像缓存大小。\n- \n\n实例运行时长：时长受镜像大小影响，大的镜像相对耗时长。\n\n- \n\n[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances#topic-2240704)\n- \n\n[块存储计费](https://help.aliyun.com/zh/ecs/block-storage-devices#concept-1937442)\n\n快照费用\n\n一个镜像缓存对应一个快照。该快照的生命周期与镜像缓存的生命周期一致，保留镜像缓存需支付快照存储费用。\n\n[快照计费](https://help.aliyun.com/zh/ecs/snapshots-1#concept-rq2-pcx-ydb)\n- \n\n使用镜像缓存\n\n[表格]\n\n计费项\n\n计费说明\n\n相关文档\n\n云盘费用\n\n使用手动创建的镜像缓存创建ECI实例时，会为实例挂载一块按量付费的（默认ESSD PL1类型）云盘。该云盘的容量等于镜像缓存大小，随实例一起创建和释放。即：除ECI实例费用外，还需额外支付云盘费用。\n\n[块存储计费](https://help.aliyun.com/zh/ecs/block-storage-devices#concept-1937442)\n\n### 自动创建的镜像缓存\n\n创建ECI实例时，如果开启了自动匹配镜像缓存，则在未匹配到镜像缓存的情况下，系统会在创建ECI实例的同时，自动创建一个镜像缓存。\n\n使用自动创建的镜像缓存创建ECI实例时，根据镜像缓存大小决定是否需要额外支付临时存储空间费用。\n\n[表格]\n\n计费项\n\n计费说明\n\n临时存储空间费用\n\n如果镜像缓存的大小超出了30 GiB，则表示创建的ECI实例需要增加临时存储空间。即：除ECI实例费用外，还需额外支付临时存储空间费用。\n\n[临时存储空间计费](https://help.aliyun.com/zh/eci/product-overview/temporary-storage-space#topic-2241359)\n## 计费示例说明 \n\n以下价格计算仅用作示例，实际费用以账单显示为准。\n### 示例一：创建并使用手动创建的镜像缓存\n\n假设您在华东1（杭州）手动创建了一个镜像缓存，大小为40 GiB，保留时间为3天，创建时没有开启极速镜像缓存功能，临时实例运行了5分钟（300秒），该镜像缓存对应的快照容量为2 GiB。\n\n创建该镜像缓存涉及的费用为：\n\n- \n\n临时资源费用：（0.000049*2+0.00000613*4+0.0021/3600*40）* 300=0.043756元。\n- \n\n快照费用：0.12/30*2*3=0.024元。\n\n则创建总费用=临时资源费用+快照费用=0.043756+0.024=0.067756。\n\n如果使用该镜像缓存创建了一台ECI实例，该ECI实例运行了3小时，则除实例费用外，需额外支付云盘费用（即镜像缓存的使用费用）。费用=0.0021*40*3=0.252元。\n### 示例二：使用自动创建的镜像缓存\n\n假设您在华东1（杭州）创建了一台ECI实例A，创建时使用的镜像大小没有超过30 GiB，且开启了自动匹配镜像缓存，则系统会自动创建一个镜像缓存，您无需支付镜像缓存的创建费用。\n\n如果使用该镜像缓存创建一台ECI实例B，除实例费用外，您无需额外付费。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/limits", "page_type": "doc", "title": "使用限制", "keywords": "了解ECI使用限制,查询ECI配额限制,ECI使用限制,ECI API限流,ECI实例限制", "last_modified_ms": 1729231009000, "last_modified_iso": "2024-10-18T13:56:49+08:00", "excerpt": "本文介绍ECI相关的使用限制，以便您更好地使用ECI。\n## ECI实例限制\n\n下表为ECI实例相关的使用限制。\n\n[表格]\n\n限制项\n\n限制描述\n\n例外申请方式\n\n创建ECI实例的用户账户限制\n\n已通过实名认证。\n\n无\n\n每个Region可创建的vCPU数量\n\n根据账号的历史使用行为，每个账号的配额上限不同，您可以在ECI控制台上[查看权益配额](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/privilegeQuota)。\n\n可以在[配额中心](https://quotas.console.aliyun.com/products/eci/quotas)申请提升配额。\n\n单个ECI实例的vCPU数量\n\n64 vCPU\n\n无\n\n单个ECI实例的数据卷数量\n\n20\n\n无\n\n单个ECI实例内支持最大的容器数\n\n20\n\n无\n\nECI实例的网络类型\n\n仅支持VPC网络。\n\n无\n## API限流\n\n下表为各API每分钟调用次数上限，如果无法满足业务需求，您可以提交工单申请提升限额。\n\n[表格]\n\nAPI接口\n\n每分钟最高调用次数\n\n提升限额方式\n\nDescribeContainerGroups\n\n2000\n\n提交工单\n\nDescribeContainerGroupMetric\n\n2000\n\n提交工单\n\nCreateContainerGroup\n\n1000\n\n提交工单\n\nDeleteContainerGroup\n\n1000\n\n提交工单\n\nDescribeContainerGroupPrice\n\n1000\n\n提交工单\n\nExportContainerGroupTemplate\n\n1000\n\n提交工单\n\nExecContainerCommand\n\n500\n\n提交工单\n\nDescribeContainerLog\n\n500\n\n提交工单\n\nRestartContainerGroup\n\n500\n\n提交工单\n\nUpdateContainerGroup\n\n500\n\n提交工单\n\nDescribeMultiContainerGroupMetric\n\n500\n\n提交工单\n\nCreateImageCache\n\n200\n\n提交工单\n## Kubernetes应用限制\n\n基于Kubernetes社区的Virtual Kubelet技术，ECI通过虚拟节点与Kubernetes实现无缝对接，因此ECI实例并不会运行在一个集中式的真实节点上，而是打散分布在整个阿里云的资源池中。\n\n基于公有云的安全性和虚拟节点本身带来的限制，ECI目前还不支持Kubernetes中HostPath、DaemonSet等功能，具体如下表所示。\n\n[表格]\n\n不支持的功能\n\n说明\n\n推荐替代方案\n\nHostPath\n\n挂载本地宿主机文件到容器中\n\n使用emptyDir、云盘或者NAS文件系统\n\nHostNetwork\n\n将宿主机端口映射到容器上\n\n使用type=LoadBalancer的负载均衡\n\nDaemonSet\n\n在容器所在宿主机上部署Static Pod\n\n通过sidecar形式在Pod中部署多个镜像\n\ntype=NodePort的Service\n\n将宿主机端口映射到容器上\n\n使用type=LoadBalancer的负载均衡\n## ulimit使用限制\n\nECI目前不支持修改ulimit，您可以在容器内执行ulimit -a命令查询默认的ulimit。说明 \n\n如果您有特殊需求需要修改ulimit，请提交工单。\n## 端口占用说明\n\n下表为ECI及相关产品占用的端口情况，在部署服务时，请您避免使用以下端口。\n\n[表格]\n\n端口\n\n说明\n\n111、10250、10255\n\nECI系统使用端口。exec、logs、metrics等接口使用。\n\n998\n\n阿里云文件存储CPFS占用端口。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/query-split-bills-of-elastic-container-instances-based-on-tags", "page_type": "doc", "title": "基于标签查询ECI分账账单", "keywords": "查询ECI分账账单,实现ECI分账管理,ECI分账账单查询,ECI标签分账方法", "last_modified_ms": 1758534363000, "last_modified_iso": "2025-09-22T17:46:03+08:00", "excerpt": "ECI实例、镜像缓存、虚拟节点等ECI资源均支持绑定标签，可按需为各类资源绑定标签，基于标签分类实现企业分账管理。本文介绍如何通过标签按需查看企业的分账费用信息。\n## 为ECI资源绑定标签\n\n标签功能类似于Kubernetes的Label，用于标记有相同管理或者业务需求的ECI资源，便于后续分类管理和筛选操作。可按需为各类ECI资源绑定标签，相关参考如下：\n\n[表格]\n\n操作场景\n\n资源类型\n\n相关文档\n\n通过ECI控制台或OpenAPI操作\n\nECI实例\n\n[使用标签管理ECI实例](https://help.aliyun.com/zh/eci/user-guide/use-tags-to-manage-elastic-container-instances)\n\n镜像缓存\n\n[管理镜像缓存](https://help.aliyun.com/zh/eci/user-guide/manage-an-image-cache)\n\n虚拟节点\n\n[自建Kubernetes集群对接VNode](https://help.aliyun.com/zh/eci/user-guide/manually-connect-a-vnode-to-a-self-managed-kubernetes-cluster)\n\nKubernetes集群，通过添加Annotation实现\n\nECI实例\n\n[为ECI Pod绑定自定义标签](https://help.aliyun.com/zh/eci/user-guide/bind-custom-tags-to-a-pod)\n\n通过阿里云容器服务 Kubernetes 版创建的ECI实例默认带有以下标签：\n\n- \n\nManagedBy：集群类型。\n- \n\nClusterId：集群ID。\n- \n\nNameSpace：集群的命名空间。\n- \n\nOwnerReferenceKind：集群下创建的负载类型，例如Deployment、Job等。\n- \n\nOwnerReferenceName：集群下创建的负载名称，例如Deployment name、Job name等。\n- \n\nPodName：Pod名称。\n\n## 基于标签查询分账账单\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/welcome)。\n- \n\n单击顶部导航栏的费用，进入费用与成本页面。\n- \n\n在左侧导航栏，选择成本分摊 > 费用标签。\n- \n\n启用费用标签。\n## 首次启用\n\n- \n\n在费用标签页面，阅读页面说明，单击下一步。\n- \n\n选择要启用的标签，移动到右侧已选择启用标签列表，单击下一步。\n- \n\n单击确认启用，完成后续操作。\n\n## 之前已启用\n\n- \n\n单个操作：在标签列表中，找到要启用的标签，单击对应操作列中的启用。\n- \n\n批量操作：在标签列表中，选中多个要启用的标签，单击批量启用。\n说明 \n\n标签区分英文大小写，如果列表中标签过多，可模糊搜索标签Key，筛选出想要启用的标签。\n- \n\n在左侧导航栏，选择成本分摊 > 财务单元，根据标签分配财务单元。\n\n- \n\n新增财务单元。\n\n- \n\n在财务单元页面的左侧导航栏，单击财务单元右侧的加号图标。\n- \n\n在弹出的对话框中，输入财务单元名称，单击确定。\n\n- \n\n分配财务单元。\n\n- \n\n在财务单元页面的左侧导航栏，选择所有资源。\n- \n\n在右侧资源列表的标签列，单击筛选图标，在弹出框中选中已启用的标签，然后单击确定。\n- \n\n在筛选结果中选中ECI资源，单击分配，然后在弹出的对话框中选择财务单元，单击确定。\n\n- \n\n在左侧导航栏，选择成本分摊 > 分账明细，按照财务单元筛选查看分账账单。说明 \n\n首次使用时，请按页面提示开通分账账单功能。\n- \n\n在左侧导航栏，选择成本分析，按照财务单元和标签筛选查看费用分析。说明 \n\n首次使用时，请按页面提示开通成本分析功能。\n\n在成本分析页面，顶部的分类维度等条件可设置图表展示方式，右侧的筛选条件可筛选出要展示的数据。例如：分类维度选择实例标签，筛选条件中设置要筛选的标签，即可按标签维度，筛选查看绑定这些标签的资源费用详情。\n\n## 相关文档\n\n更多关于分账管理的信息，请参见以下文档：\n\n- \n\n[财务单元](https://help.aliyun.com/zh/user-center/cost-center-overview)\n- \n\n[分账账单](https://help.aliyun.com/zh/user-center/user-guide/split-bills-1)\n- \n\n[费用标签](https://help.aliyun.com/zh/user-center/cost-allocation-tags)\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/regions-and-zones", "page_type": "doc", "title": "地域和可用区", "keywords": "查询ECI地域可用区,ECI地域和可用区", "last_modified_ms": 1766113847000, "last_modified_iso": "2025-12-19T11:10:47+08:00", "excerpt": "本文汇总了ECI当前支持的地域和可用区，您也可以调用[DescribeRegions](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeregions)获取ECI支持的地域，以及支持和推荐的可用区。\n\n以下为ECI当前支持的地域和可用区列表。更多信息，请参见[阿里云地域和可用区](https://help.aliyun.com/document_detail/40654.html#concept-2459516)。说明 \n\n标注了推荐的可用区表示在该地域下，相比其他可用区，该可用区的库存充足，推荐您优先选择。\n\n- \n\n中国地区（包含中国香港、中国澳门，不包含中国台湾）\n\n[表格]\n\n地域\n\n可用区\n\n备注\n\n华东1（杭州）\n\n可用区B\n\ncn-hangzhou-b\n\n可用区E\n\ncn-hangzhou-e\n\n可用区F\n\ncn-hangzhou-f\n\n可用区G\n\ncn-hangzhou-g\n\n可用区H（推荐）\n\ncn-hangzhou-h\n\n可用区I（推荐）\n\ncn-hangzhou-i\n\n可用区J（推荐）\n\ncn-hangzhou-j\n\n可用区K\n\ncn-hangzhou-k\n\n华东2（上海）\n\n可用区A\n\ncn-shanghai-a\n\n可用区B\n\ncn-shanghai-b\n\n可用区C\n\ncn-shanghai-c\n\n可用区D\n\ncn-shanghai-d\n\n可用区E\n\ncn-shanghai-e\n\n可用区F\n\ncn-shanghai-f\n\n可用区G\n\ncn-shanghai-g\n\n可用区K\n\ncn-shanghai-k\n\n可用区L（推荐）\n\ncn-shanghai-l\n\n可用区M（推荐）\n\ncn-shanghai-m\n\n可用区N（推荐）\n\ncn-shanghai-n\n\n华北1（青岛）\n\n可用区B（推荐）\n\ncn-qingdao-b\n\n可用区C\n\ncn-qingdao-c\n\n华北2（北京）\n\n可用区C\n\ncn-beijing-c\n\n可用区D\n\ncn-beijing-d\n\n可用区E\n\ncn-beijing-e\n\n可用区F\n\ncn-beijing-f\n\n可用区G\n\ncn-beijing-g\n\n可用区H（推荐）\n\ncn-beijing-h\n\n可用区I（推荐）\n\ncn-beijing-i\n\n可用区J（推荐）\n\ncn-beijing-j\n\n可用区K\n\ncn-beijing-k\n\n可用区L\n\ncn-beijing-l\n\n华北3（张家口）\n\n可用区A\n\ncn-zhangjiakou-a\n\n可用区B\n\ncn-zhangjiakou-b\n\n可用区C\n\ncn-zhangjiakou-c\n\n华北5（呼和浩特）\n\n可用区A\n\ncn-huhehaote-a\n\n可用区B\n\ncn-huhehaote-b\n\n华北6（乌兰察布）\n\n可用区A\n\ncn-wulanchabu-a\n\n可用区B\n\ncn-wulanchabu-b\n\n可用区C\n\ncn-wulanchabu-c\n\n华南1（深圳）\n\n可用区A\n\ncn-shenzhen-a\n\n可用区B\n\ncn-shenzhen-b\n\n可用区C\n\ncn-shenzhen-c\n\n可用区D（推荐）\n\ncn-shenzhen-d\n\n可用区E（推荐）\n\ncn-shenzhen-e\n\n可用区F（推荐）\n\ncn-shenzhen-f\n\n华南2（河源）\n\n可用区A\n\ncn-heyuan-a\n\n可用区B\n\ncn-heyuan-b\n\n华南3（广州）\n\n可用区A\n\ncn-guangzhou-a\n\n可用区B\n\ncn-guangzhou-b\n\n西南1（成都）\n\n可用区A\n\ncn-chengdu-a\n\n可用区B\n\ncn-chengdu-b\n\n华东5 （南京-本地地域-关停中）\n\n可用区A\n\ncn-nanjing-a\n\n华东6（福州-本地地域-关停中）\n\n可用区A\n\ncn-fuzhou-a\n\n华中1（武汉-本地地域）\n\n可用区A\n\ncn-wuhan-lr-a\n\n中国香港\n\n可用区B（推荐）\n\ncn-hongkong-b\n\n可用区C\n\ncn-hongkong-c\n\n可用区D（推荐）\n\ncn-hongkong-d说明 \n\n更多关于本地地域的信息，请参见[本地地域](https://www.aliyun.com/page-source/website/infrastructure/local-regions)。\n- \n\n其他国家和地区\n\n[表格]\n\n地域\n\n可用区\n\n备注\n\n日本（东京）\n\n可用区A\n\nap-northeast-1a\n\n可用区B\n\nap-northeast-1b\n\n可用区C\n\nap-northeast-1c\n\n新加坡\n\n可用区A\n\nap-southeast-1a\n\n可用区B\n\nap-southeast-1b\n\n可用区C\n\nap-southeast-1c\n\n马来西亚（吉隆坡）\n\n可用区A\n\nap-southeast-3a\n\n可用区B\n\nap-southeast-3b\n\n印度尼西亚（雅加达）\n\n可用区A\n\nap-southeast-5a\n\n可用区B\n\nap-southeast-5b\n\n可用区C\n\nap-southeast-5c\n\n菲律宾（马尼拉）\n\n可用区A\n\nap-southeast-6a\n\n韩国（首尔）\n\n可用区A\n\nap-northeast-2a\n\n泰国（曼谷）\n\n可用区A\n\nap-southeast-7a\n\n美国（硅谷）\n\n可用区A（推荐）\n\nus-west-1a\n\n可用区B\n\nus-west-1b\n\n美国（弗吉尼亚）\n\n可用区A\n\nus-east-1a\n\n可用区B\n\nus-east-1b\n\n德国（法兰克福）\n\n可用区A\n\neu-central-1a\n\n可用区B\n\neu-central-1b\n\n可用区C\n\neu-central-1c\n\n英国（伦敦）\n\n可用区A\n\neu-west-1a\n\n可用区B\n\neu-west-1b\n\n阿联酋（迪拜）\n\n可用区A\n\nme-east-1a\n\n墨西哥\n\n可用区A\n\nna-south-1a\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/runtime-update-records", "page_type": "doc", "title": "运行时变更记录", "keywords": "ECI,运行时,版本记录", "last_modified_ms": 1750225363000, "last_modified_iso": "2025-06-18T13:42:43+08:00", "excerpt": "ECI是敏捷安全的Serverless容器运行服务，您无需维护底层节点的操作系统及运行时组件。但随着底层运行时版本的持续演进，为支持新功能、修复缺陷以及升级内核安全漏洞，运行时版本可能会发生重要变更。本文提供ECI运行时版本的变更记录，帮助您了解相关更新内容。重要 \n\n为了确保您的应用程序能够获得最新的功能更新和安全漏洞修复，请及时执行滚动更新以重新创建Pod。\n## 2025年05月\n\n[表格]\n\n变更时间\n\n变更内容\n\n变更影响\n\n2025年05月31日\n\n- \n\n支持LoadBalancer类型的Service。\n- \n\n修复Fluid场景容器启动慢的问题。\n- \n\n修复频繁exec容器的过程中发生容器退出而导致shim状态不正确的问题。\n- \n\n升级nvidia-container-toolkit版本至1.17.4。\n\n此处升级不会对业务造成影响。\n## 2025年03月\n\n[表格]\n\n变更时间\n\n变更内容\n\n变更影响\n\n2025年03月01日\n\n- \n\n支持Logtail收集完最后的日志，再释放Pod。\n- \n\n非SLS官方支持插件不再维护。\n- \n\nOSS支持RSSA认证方式。\n- \n\nNAS支持AccessPoint方式挂载。\n- \n\n支持GPU驱动550版本。\n- \n\n修复subpathExpr日志采集失效的问题。\n\n影响使用非官方Logtail插件将日志投递到Kafka集群的用户，请使用开源版Logtail和kafka_v2插件进行替换。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/scenarios", "page_type": "doc", "title": "应用场景", "keywords": "了解ECI应用场景,ECI应用场景,ECI产品简介", "last_modified_ms": 1693879406000, "last_modified_iso": "2023-09-05T10:03:26+08:00", "excerpt": "弹性容器实例适用于容器形态下大部分业务场景，从弹性及成本角度，特别适用于在线业务的免运维托管、大数据计算任务（Spark、Presto）、事件驱动型业务和Job型业务，以及DevOps、机器学习、在线测试等各类场景。\n## 概述\n\n弹性容器实例可以通过以下方式对接您的业务系统：\n\n- \n\n无缝接入阿里云ACK Serverless集群\n- \n\n以Virtual Node的方式接入Kubernetes集群（阿里云ACK集群、ECS上或者线下IDC自建的Kubernetes集群）\n- \n\n通过OpenAPI接入\n\n基于ECI在Serverless、弹性、成本、效率和兼容等方面的优势，ECI特别适用于弹性和并发场景的业务，主要应用场景如下图所示。\n## 在线业务弹性扩容\n\n根据业务流量自动对业务进行扩容（基于Kubernetes HPA），无需人工干预，避免流量激增扩容不及时导致系统故障，以及平时大量闲置资源造成的浪费。在使用阿里云容器服务ACK场景下，支持将一个应用按比例部署到ECS或ECI上，提供更高效的资源利用率、更快的扩容速度、更健壮的系统可靠性和更低成本。\n\n- \n\n高弹性\n\n快速秒级扩容，可轻松应对百倍突发流量，同时支持HPA及CronHPA。\n- \n\n低成本\n\n根据流量动态使用资源，按需付费。\n- \n\n高可用\n\n精细化应用伸缩，扩容时保留固定N个副本在ECS上运行，第N+1个以上副本调度到ECI；缩容时优先回收ECI上的Pod副本。\n\n## 在线业务托管\n\n基于阿里云容器服务Kubernetes版提供完全托管的Kubernetes集群和免运维的基础设施，您不再需要配置单独的运维人员，只需要关注业务应用的定义，由阿里云负责Kubernetes集群及底层基础设施的运维和管理。同时，通过配置弹性伸缩，能够根据流量自动扩缩容，降低运行成本。\n\n- \n\n免运维\n\n不需要管理集群，也不需要管理工作节点，只需要定义应用、服务和任务。\n- \n\n低成本\n\n根据流量动态使用资源，按需付费。\n- \n\n兼容性\n\n支持有状态StatefulSet 、无状态Deployment 、任务Job和定时任务CronJob。\n\n## 数据处理任务\n\n在处理大批量的在线数据并发任务时，可以不再因为成本原因受限于底层资源，导致数据处理任务并发度受限。能够在短时间内快速创建大量工作节点，满足业务的大数据及AI在线处理诉求。在使用阿里云容器服务Kubernetes版的场景下，已经无缝支持在Kubernetes上部署Spark或Presto。\n\n- \n\n兼容性\n\n完全兼容Spark/Kubernetes生态，无需做业务改造。\n- \n\n低成本\n\n提交作业前无需预留资源，所有资源随作业提交自动申请，在作业结束后释放。\n- \n\n高并发\n\n提供作业的快速启动和大规模并发能力，无需关心集群的扩缩容和资源。\n\n## 事件驱动型业务\n\nECI作为Serverless的容器基础设施，通过事件触发，提供高并发、低成本的容器实例调度及事件处理能力。例如：在线教育行业的录制和转码。\n\n- \n\n高并发\n\n提供大规模的资源供应能力。\n- \n\n高弹性\n\n秒级启动和弹性伸缩，提供高并发事件和任务处理能力。\n- \n\n低成本\n\n容器实例根据资源规格及使用时长付费，在事件和任务处理结束后停止收费。\n\n## CI/CD测试环境\n\n对接CI/CD流程，自动完成容器部署、应用打包和测试用例执行。支持随时创建和释放容器实例，能够提供低成本的大规模资源供应，应对在CI/CD过程中的批量测试任务，例如：自动驾驶行业在开发测试阶段的全量自动驾驶仿真模拟。\n\n- \n\n高弹性\n\n支持高并发，支持CPU、GPU；适合CI打包、压力测试、仿真测试。\n- \n\n低成本\n\n按需使用，按秒计费，测试完成释放资源，降低CI/CD成本。\n- \n\n深度整合\n\n与CI流程整合，提交待发布版本后，直接触发压力测试和仿真测试；支持Kubernetes标准OpenAPI。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/supported-alibaba-cloud-services", "page_type": "doc", "title": "支持的云服务", "keywords": "了解ECI支持的云服务,ECI关联云服务,ECI产品集成", "last_modified_ms": 1693879058000, "last_modified_iso": "2023-09-05T09:57:38+08:00", "excerpt": "本文介绍弹性容器实例关联的其他阿里云服务，包括容器、网络、存储等。\n## 概述\n\n使用ECI的同时，您可能会使用阿里云容器、网络、存储、日志等服务。ECI与其他云服务的关系如下：\n## 容器\n\n[表格]\n\n服务\n\n说明\n\n相关文档\n\n容器服务Kubernetes版\n\n容器服务Kubernetes是阿里云提供的兼容Kubernetes的容器应用管理服务。ECI支持无缝集成到ACK集群和ACK Serverless集群，为集群提供方便快捷的计算能力和海量的弹性资源。\n\n[什么是容器服务Kubernetes版](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/product-overview/what-is-ack#concept-cbm-1zc-l2b)\n\n容器镜像服务ACR\n\n容器镜像服务ACR是面向容器镜像、Helm Chart等符合OCI标准的云原生制品安全托管及高效分发平台。您可以使用ACR来管理容器镜像，拉取ACR中的镜像来创建ECI实例。\n\n[什么是容器镜像服务ACR](https://help.aliyun.com/zh/acr/product-overview/what-is-container-registry#concept-2058233)\n## 网络\n\n[表格]\n\n服务\n\n说明\n\n相关文档\n\n弹性公网IP\n\n弹性公网IP是一种可独立购买和持有的公网IP地址资源。如果您的ECI实例需要公网访问，可以为其配置。\n\n[什么是弹性公网IP](https://help.aliyun.com/zh/eip/product-overview/what-is-eip#concept-zmv-hd3-vdb)\n\nNAT网关\n\nNAT网关是一款企业级的公网网关，绑定弹性公网IP后，可以提供NAT代理功能。如果您在某一专有网络下的ECI实例均需要公网访问，可以进行配置。\n\n[什么是NAT网关](https://help.aliyun.com/zh/nat-gateway/product-overview/what-is-nat-gateway#concept-wpm-kfy-ydb)\n\n负载均衡SLB\n\n负载均衡SLB是一种根据转发策略将访问流量分发到后端服务的流量分发控制服务。将ECI实例添加到SLB后端，可以提升应用的服务能力和可用性。\n\n[负载均衡SLB产品家族介绍](https://help.aliyun.com/zh/slb/product-overview/slb-overview)\n## 存储\n\n[表格]\n\n服务\n\n说明\n\n相关文档\n\n云盘\n\n云盘是一种数据块级别的块存储产品，采用分布式多副本机制，您可以使用云盘作为容器的持久化存储，在创建ECI实例时将其挂载到容器上。\n\n[云盘概述](https://help.aliyun.com/zh/ecs/user-guide/disks-2#concept-n1s-rzb-wdb)\n\n文件存储NAS\n\n文件存储NAS是一个可共享访问、弹性扩展的分布式文件系统，通过NFS等标准文件访问协议进行访问。您可以使用NAS作为容器的持久化存储，在创建ECI实例时将其挂载到容器上。\n\n[什么是文件存储NAS](https://help.aliyun.com/zh/nas/product-overview/what-is-nas#concept-qpg-wrt-1fb)\n\n对象存储OSS\n\n对象存储OSS是一个海量的存储空间，适合存储互联网上产生的图片、视频等数据，不支持文件随机读写，您可以使用OSS作为容器的持久化存储，在创建ECI实例时将其挂载到容器上。\n\n[什么是对象存储OSS](https://help.aliyun.com/zh/oss/user-guide/what-is-oss#concept-ybr-fg1-tdb)\n## 其它\n\n[表格]\n\n服务\n\n说明\n\n相关文档\n\n日志服务SLS\n\n日志服务SLS是针对日志数据的一站式服务，您无需开发就能快捷完成日志数据采集、消费、投递以及查询分析等功能。ECI支持对接SLS，将ECI日志采集到SLS中。\n\n[什么是日志服务](https://help.aliyun.com/zh/sls/what-is-log-service#concept-mt2-ykn-vdb)\n\n访问控制RAM\n\n访问控制RAM是一种管理用户身份和资源访问权限的服务。配合使用RAM来控制不同用户的操作权限，可以实现ECI资源的精细化权限管理。\n\n[什么是访问控制](https://help.aliyun.com/zh/ram/product-overview/what-is-ram/#concept-oyr-zzv-tdb)\n\n弹性伸缩Auto Scaling\n\n弹性伸缩Auto Scaling是根据业务需求和策略自动调整计算能力（即实例数量）的服务。非Kubernetes场景下，配合使用弹性伸缩来管理ECI实例，可以实现自动扩缩容ECI实例。\n\n[什么是弹性伸缩Auto Scaling](https://help.aliyun.com/zh/auto-scaling/product-overview/what-is-auto-scaling#concept-25857-zh)\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/temporary-storage-space", "page_type": "doc", "title": "临时存储空间计费", "keywords": "了解临时存储空间计费,计算临时存储空间费用,临时存储空间计费规则,临时存储空间计费示例", "last_modified_ms": 1682572753000, "last_modified_iso": "2023-04-27T13:19:13+08:00", "excerpt": "本文介绍临时存储空间的计费规则，并给出计费示例。\n## 计费说明\n\n每个ECI实例默认提供30 GiB免费的临时存储空间，如果该存储空间大小无法满足您的业务需求，您可以自定义增加临时存储空间大小。重要 \n\nECI实例启动所使用的容器镜像会占用该30 GiB空间。容器镜像需要占用的空间大小至少为容器镜像大小*2，具体大小视镜像的压缩率决定。\n\n- \n\n计费公式\n\n费用=单价*增加的临时存储空间容量*使用时长。\n- \n\n公式说明\n\n- \n\n单价：0.00000059元/GiB/秒。\n- \n\n增加的临时存储空间容量：自行声明增加的容量，单位为GiB。\n- \n\n使用时长：按秒计算。临时存储空间随ECI实例一起创建和释放，使用时长与实例运行时长一致。\n\n## 计费示例说明 \n\n以下价格计算仅用作示例，实际费用以账单显示为准。\n\n在华东1（杭州）指定vCPU和内存创建一台2 vCPU、4 GiB内存的ECI实例，声明增加20 GiB的临时存储空间，则除实例费用外，每小时临时存储空间的费用为：0.00000059*3600*20=0.04248元。\n\n查看账单明细时，临时存储空间对应的计费项为系统盘，计费项Code为systemdisk，示例如下：\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/terms", "page_type": "doc", "title": "基本概念", "keywords": "了解ECI基本概念,入门弹性容器实例,ECI基本概念,Kubernetes基本概念", "last_modified_ms": 1733367890000, "last_modified_iso": "2024-12-05T11:04:50+08:00", "excerpt": "使用ECI前，建议您先了解相关概念，以便更好地使用产品。\n## ECI相关概念\n\n使用ECI涉及的相关概念如下表所示。\n\n[表格]\n\n概念\n\n说明\n\n容器（Container）\n\n容器是轻量的、可执行的独立软件包，是镜像运行的实体。\n\n容器组（Container Group）\n\n容器组是一组可以被调度到同一台宿主机上的容器集合。这些容器共同构成了容器组的生命周期，并共享容器组的网络和存储资源。\n\n一个容器组即一个ECI实例，其概念与Kubernetes的Pod概念类似。\n\n镜像（Image）\n\n镜像是一个特殊的文件系统，包含容器应用运行所需的程序、库文件、配置等。Docker镜像是容器应用打包的标准格式，在部署容器化应用时，您需要指定镜像，该镜像可以来自于Docker Hub、阿里云镜像服务ACR或者您的私有Registry。\n\n镜像缓存（ImageCache）\n\n镜像缓存用于加速拉取镜像，减少ECI实例启动耗时。受网络、镜像大小等因素影响，镜像拉取是ECI实例启动的主要耗时，提前制作镜像缓存可以加速拉取镜像。\n\n数据卷（Volume）\n\n数据卷是容器组的共享存储资源。您可以将外部数据卷挂载到指定的容器组，容器组中声明的数据卷由容器组中的所有容器共享。\n\n标签（Tag）\n\n标签是附加在容器组上的一系列Key/Value键值对。标签需要在创建容器组时赋予，每个容器组最多可以拥有10个标签，其中key值必须唯一。\n\n标签的概念与Kubernetes的Label概念类似。\n\n虚拟节点（Virtual Node）\n\n基于Kubernetes社区的Virtual Kubelet技术，ECI可以通过虚拟节点的方式接入到Kubernetes集群中，即ECI实例并不会运行在一个集中式的真实节点上，而是会被打散分布在整个阿里云的资源池中。\n## Kubernetes相关概念\n\n如果您使用Kubernetes来管理您的ECI实例，您需要了解Kubernetes的相关概念。主要概念如下表所示。\n\n[表格]\n\n 概念\n\n说明\n\nMaster\n\nKubernetes集群中的控制节点，负责整个集群的管理和调度。\n\nNode\n\nKubernetes集群中真正运行工作负载的工作节点。当某个Node宕机时，其上的工作负载会被Master自动转移到其他Node上。\n\nPod\n\nKubernetes中创建或部署的最小单元。一个Pod代表集群上正在运行的一个进程，封装了一个或多个紧密相关的容器。\n\nDeployment\n\n无状态工作负载。Pod上的一个抽象，可以定义一组Pod的副本数、版本等。\n\nStatefulSet\n\n有状态工作负载。和Deployment类似，用于管理一组Pod，不同的是StatefulSet可以为这些Pod提供持久化存储和持久标识符。\n\nService\n\n用于为一组Pod提供一个统一的、稳定的访问地址。\n\nConfigMap\n\n用于保存配置数据的键值对，可以用来保存单个属性，也可以用来保存配置文件。\n\nNamespace\n\n集群内部的逻辑隔离，用于划分、管理资源对象。\n\nLabel\n\n可以附加在各种资源对象上的一系列Key/Value键值对。为指定的资源对象绑定一个或多个不同的Label，可以实现多维度的资源分组管理。\n\nVolume\n\nPod中能够被多个容器访问的文件目录。一个数据卷可以挂载在Pod中的一个或多个容器的指定路径下。\n\nPersistentVolume\n\nPV，存储卷。集群中由管理员配置的存储资源。\n\nPersistentVolumeClaim\n\nPVC，存储声明。用于表达用户对存储资源的请求。\n\n更多信息，请参见[Kubernetes官方文档](https://kubernetes.io/docs/concepts/)。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/view-your-bills", "page_type": "doc", "title": "账单查询", "keywords": "查询ECI账单,查看ECI消费明细,ECI账单查询方法,ECI产品计费", "last_modified_ms": 1758534569000, "last_modified_iso": "2025-09-22T17:49:29+08:00", "excerpt": "可在费用与成本页面，查看弹性容器实例相关的费用账单和消费明细。\n## 通过控制台查询费用账单\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/welcome)。\n- \n\n单击顶部导航栏的费用，打开费用与成本页面。\n- \n\n在左侧导航栏选择账单 > 账单详情。\n- \n\n根据需要，单击相应页签查看账单。\n\n[表格]\n\n页签\n\n说明\n\n明细账单\n\n账单明细支持按照不同的统计项和统计周期进行筛选，可查看的明细包括产品的计费项、用量、价格及抵扣情况等。\n\n查询ECI账单时，可筛选产品名称，或者指定实例进行精确查询。相关计费项说明如下：\n\n- \n\nvCPU、内存：按vCPU和内存计费的ECI实例账单。\n- \n\n实例规格：按ECS规格计费的ECI实例账单。\n- \n\n系统盘：ECI实例增加的临时存储空间账单。\n\n查看用量明细\n\n用量明细需导出为CSV文件才可以查看，配置时产品选择eci。单击导出CSV后将自动打开导出记录页面，当状态变为导出成功时，在操作列单击下载，即可将用量明细文件导出至本地。\n\n## 通过API查询费用账单\n\n可调用API查询费用账单，相关接口如下表所示。调用时，请根据需要设置BillingCycle（账期），并将ProductCode（产品代码）设置为eci。\n\n[表格]\n\nAPI\n\n说明\n\n[账单总览查询服务](https://help.aliyun.com/zh/user-center/developer-reference/api-bssopenapi-2017-12-14-querybilloverview)\n\n查询账单总览信息，即整体消费汇总。\n\n[账单查询服务](https://help.aliyun.com/zh/user-center/developer-reference/api-bssopenapi-2017-12-14-querybill)\n\n查询账单信息，包括每一笔订单和每个结算周期的消费信息。\n\n[实例账单查询服务](https://help.aliyun.com/zh/user-center/developer-reference/api-bssopenapi-2017-12-14-queryinstancebill)\n\n按实例或者计费项等维度，查询消费明细。\n\n[分账账单服务](https://help.aliyun.com/zh/user-center/developer-reference/api-bssopenapi-2017-12-14-describesplititembill)\n\n查询分账账单，查看分拆项费用明细。\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/virtual-node-billing", "page_type": "doc", "title": "虚拟节点（VNode）计费", "keywords": "了解VNode计费方式,计算VNode费用,VNode计费规则,VNode价格说明", "last_modified_ms": 1754277575000, "last_modified_iso": "2025-08-04T11:19:35+08:00", "excerpt": "如果您在本地IDC，或者阿里云的ECS上自建了Kubernetes集群，可通过虚拟节点（VNode）接入ECI。本文介绍虚拟节点（VNode）如何计费。说明 \n\n如果您通过阿里云容器服务Kubernetes版（简称ACK）使用ECI，部署ack-virtual-node组件生成的虚拟节点（基于VK）不收费。\n## 计费说明\n\nVNode按个数计费。每个VNode会有一个常驻节点，相当于2 vCPU，8 GiB的ECI实例，收取相关实例费用。说明 \n\nVNode支持标签功能，您可以为VNode绑定特定标签，以便区分VNode实例费用和普通ECI实例费用。\n\n费用计算公式为：单个VNode费用=（2*vCPU单价+8*内存单价）*运行时长。\n\n- \n\nvCPU单价为0.000049 元/秒（0.1764 元/小时），内存单价为0.00000613 元/秒（0.0221 元/小时）。\n\n具体价格以实际账单显示为准。更多信息，请参见[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances)。\n- \n\n运行时长从VNode常驻节点Ready后开始计时。\n\nVNode常驻节点的状态并不等同于集群中的Node状态。您可以在[弹性容器实例控制台的虚拟节点页面](https://eci.console.aliyun.com/#/eci/cn-shanghai/vnode)确认VNode常驻节点的状态。\n\n## 相关文档\n\n- \n\n[自建Kubernetes集群对接ECI](https://help.aliyun.com/zh/eci/user-guide/overview-3)\n- \n\n[接入VNode（VNodectl工具）](https://help.aliyun.com/zh/eci/user-guide/use-vnodectl-to-connect-a-vnode-to-a-self-managed-kubernetes-cluster)\n"}
{"url": "https://help.aliyun.com/zh/eci/product-overview/what-is-elastic-container-instance", "page_type": "doc", "title": "什么是弹性容器实例", "keywords": "了解弹性容器实例,了解ECI计费模式,弹性容器实例产品简介,ECI产品架构", "last_modified_ms": 1739929940000, "last_modified_iso": "2025-02-19T09:52:20+08:00", "excerpt": "阿里云弹性容器实例（Elastic Container Instance）是敏捷安全的Serverless容器运行服务。您无需管理底层服务器，也无需关心运行过程中的容量规划，只需要提供打包好的Docker镜像，即可运行容器，并仅为容器实际运行消耗的资源付费。\n## 前置概念\n\n阅读本文前，您可能需要了解如下概念：\n\n- \n\n[什么是容器？](https://www.aliyun.com/getting-started/what-is/what-is-container)\n- \n\n[什么是Kubernetes（K8s）？](https://www.aliyun.com/getting-started/what-is/what-is-kubernetes)\n\n## 产品概述\n\n弹性容器实例（简称ECI）是阿里云结合容器和Serverless技术为您提供的容器运行服务。通过使用ECI，在阿里云上部署容器时，您无需购买和管理云服务器ECS，只需提供打包好的Docker镜像，即可在阿里云上运行容器。\n\n从购买配置ECS再部署容器（ECS模式）到直接部署容器（ECI模式），ECI为您省去了底层服务器的运维和管理工作，让您专注于业务开发，提升开发效率。同时，您仅需要为容器实际运行消耗的资源付费，可以节约使用成本。\n\n使用ECI时，您既可以借助OpenAPI将ECI接入到您已有的业务系统中，通过OpenAPI和控制台直接快速部署容器应用；也可以通过Virtual Kubelet对接Kubernetes集群，借助ECI的弹性能力轻松应对突发业务流量。\n\n如上图所示，ECI与您业务系统的对接方式包括：\n\n- \n\n（推荐）通过阿里云ACK Serverless集群部署业务，支持基于Kubernetes的容器服务全托管，提供无需运维的Kubernetes集群能力，底层Pod资源全部使用ECI承载。\n- \n\n（推荐）通过阿里云ACK集群部署业务，为您的ACK集群提供额外的海量弹性能力。\n- \n\n通过Virtual Kubelet对接您在ECS上或者线下IDC自建的Kubernetes集群，提供方便快捷的计算资源。\n- \n\n通过OpenAPI对接您的业务系统，您可以根据需要，低成本地随时创建或释放ECI容器，无需担心并发和容量。\n重要 \n\n运行在ECI上的Pod和容器，需要您负责Pod及容器的运行监控，以及容器中业务的运行监控。例如：CPU利用率、磁盘空间利用率、业务健康状况等。\n## 产品架构\n\nECI底层使用基于阿里云CIPU的自研安全沙箱容器，提供虚拟机级别的安全和资源隔离能力，同时针对容器运行环境进行深度优化，提供比虚拟机更快的启动速度和运行效率。其架构如下图所示。\n\nECI支持无缝集成Kubernetes，可以为Kubernetes提供一种层次化的解决方案：即ECI负责底层Pod容器资源的调度和管理工作，Kubernetes在ECI之上作为[PaaS](https://www.aliyun.com/getting-started/what-is/what-is-paas)层来管理业务负载。推荐您使用阿里云容器服务Kubernetes版来快速体验ECI的容器运行能力。阿里云容器服务产品的整体架构如下图所示。\n\n## 产品计费\n\n使用弹性容器实例时，涉及收费的资源如下：\n\n[表格]\n\n资源\n\n计费说明\n\n相关文档\n\nECI实例（计算资源）\n\n根据您创建ECI实例的方式，支持两种计费模式：\n\n- \n\n按vCPU和内存\n- \n\n按ECS规格\n\n[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances#topic-2240704)\n\n镜像缓存\n\n- \n\n创建镜像缓存：手动创建需支付临时资源费用和快照费用；自动创建无需付费。\n- \n\n使用镜像缓存：根据镜像缓存类型和大小，可能需要额外支付云盘或临时存储空间费用。\n\n[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches#topic-2240706)\n\n数据缓存\n\n- \n\n创建数据缓存：需支付临时资源费用和快照费用。\n- \n\n使用数据缓存：需要额外支付云盘费用。\n\n[数据缓存计费](https://help.aliyun.com/zh/eci/product-overview/data-cache-billing)\n\n临时存储空间\n\n创建ECI实例时，如果增加了临时存储空间大小，需为其付费。\n\n[临时存储空间计费](https://help.aliyun.com/zh/eci/product-overview/temporary-storage-space#topic-2241359)\n\n更多信息，请参见[计费概述](https://help.aliyun.com/zh/eci/product-overview/billing-overview#topic4606)。\n## 联系我们\n\n您在使用ECI的过程中遇到任何需求或问题时，欢迎使用钉钉搜索群号30390760，加入Serverless容器体验交流群。\n"}
{"url": "https://help.aliyun.com/zh/eci/security-and-compliance/api-eci-2018-08-08-ram", "page_type": "doc", "title": "授权信息", "keywords": "查询ECI RAM权限,编写ECI权限策略,ECI RAM权限列表,ECI权限策略元素,ECI Action参考", "last_modified_ms": 1707188389000, "last_modified_iso": "2024-02-06T10:59:49+08:00", "excerpt": "访问控制（RAM）是阿里云提供的管理用户身份与资源访问权限的服务。使用RAM可以让您避免与其他用户共享阿里云账号密钥，并可按需为用户授予最小权限。RAM中使用权限策略描述授权的具体内容。本文为您介绍弹性容器实例（ECI）为RAM权限策略定义的操作（Action）、资源（Resource）和条件（Condition）。弹性容器实例（ECI）的RAM代码（RamCode）为eci，支持的授权粒度为RESOURCE。\n## 权限策略通用结构权限策略支持JSON格式，其通用结构如下：\n\n{\n  \"Version\": \"1\",\n  \"Statement\": [\n    {\n      \"Effect\": \"<Effect>\",\n      \"Action\": \"<Action>\",\n      \"Resource\": \"<Resource>\",\n      \"Condition\": {\n        \"<Condition_operator>\": {\n          \"<Condition_key>\": [\n            \"<Condition_value>\"\n          ]\n        }\n      }\n    }\n  ]\n}\n\n各字段含义如下：\n\n- Effect：权限策略效果。取值：Allow（允许）、Deny（拒绝）。\n- Action：授予允许或拒绝权限的具体操作。具体信息，请参见[操作（Action）](#title-auth-detail-2)。\n- Resource：受操作影响的具体对象，您可以使用资源ARN来描述指定资源。具体信息，请参见[资源（Resource）](#title-auth-detail-3)。\n- Condition：指授权生效的条件。可选字段。具体信息，请参见[条件（Condition）](#title-auth-detail-4)。\n\n- Condition_operator：条件运算符，不同类型的条件对应不同的条件运算符。具体信息，请参见[权限策略基本元素](https://help.aliyun.com/zh/ram/policy-elements)。\n- Condition_key：条件关键字。\n-  Condition_value：条件关键字对应的值。\n\n## 操作（Action）下表是弹性容器实例（ECI）定义的操作，这些操作可以在RAM权限策略语句的Action元素中使用，用来授予执行该操作的权限。下面对表中的具体项提供说明：\n\n- 操作：是指具体的权限点。\n- API：是指操作对应的API接口。\n- 访问级别：是指每个操作的访问级别，取值为写入（Write）、读取（Read）或列出（List）。\n- 资源类型：是指操作中支持授权的资源类型。具体说明如下：\n\n- 对于必选的资源类型，用背景高亮的方式表示。\n- 对于不支持资源级授权的操作，用全部资源表示。\n\n- 条件关键字：是指云产品自身定义的条件关键字。该列不体现适用于任何操作的[通用条件关键字](https://help.aliyun.com/zh/ram/policy-elements)。\n- 关联操作：是指成功执行操作所需要的其他权限。操作者必须同时具备关联操作的权限，操作才能成功。\n\n[表格]\n操作API访问级别资源类型条件关键字关联操作eci:CommitContainer[CommitContainer](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-commitcontainer)WriteCommitContainerTaskacs:eci:{#regionId}:{#accountId}:containergroup/*eci:tag无eci:CopyDataCache[CopyDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-copydatacache)WriteDataCacheacs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}eci:tag无eci:CreateContainerGroup[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)WriteContainerGroupacs:eci:{#regionId}:{#accountId}:containergroup/*eci:tag无eci:CreateDataCache[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)WriteDataCacheacs:eci:{#regionId}:{#accountId}:datacache/*eci:tag无eci:CreateImageCache[CreateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createimagecache)WriteImageCacheacs:eci:{#regionId}:{#accountId}:imagecache/*eci:tag无eci:CreateInstanceOpsTask[CreateInstanceOpsTask](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createinstanceopstask)Write全部资源*eci:tag无eci:CreateVirtualNode[CreateVirtualNode](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createvirtualnode)WriteVirtualNodeacs:eci:{#regionId}:{#accountId}:virtualnode/*eci:tag无eci:DeleteContainerGroup[DeleteContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletecontainergroup)Writecontainergroupacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}eci:tag无eci:DeleteDataCache[DeleteDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletedatacache)WriteDataCacheacs:eci:{#regionId}:{#accountId}:datacache/{#datacacheId}eci:tag无eci:DeleteImageCache[DeleteImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deleteimagecache)Write全部资源*eci:tag无eci:DeleteVirtualNode[DeleteVirtualNode](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deletevirtualnode)Write全部资源*eci:tag无eci:DescribeCommitContainerTask[DescribeCommitContainerTask](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecommitcontainertask)ReadCommitContainerTaskacs:eci:{#regionId}:{#accountId}:containergroup/*eci:tag无eci:DescribeContainerGroupEvents[DescribeContainerGroupEvents](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupevents)Readcontainergroupacs:eci:{#regionId}:{#accountId}:containergroup/{#containergroupId}eci:tag无eci:DescribeConta"}
{"url": "https://help.aliyun.com/zh/eci/security-and-compliance/eci", "page_type": "doc", "title": "弹性容器实例系统权限策略参考", "keywords": "了解ECI系统权限策略,ECI系统权限策略参考,ECI RAM权限", "last_modified_ms": 1719468613000, "last_modified_iso": "2024-06-27T14:10:13+08:00", "excerpt": "本文描述弹性容器实例支持的所有系统权限策略及其对应的权限描述，供您授权 RAM 身份时参考。\n## 什么是系统权限策略\n\n权限策略是用语法结构描述的一组权限的集合，可以精确地描述被授权的资源集、操作集以及授权条件。阿里云访问控制（RAM）产品提供了两种类型的权限策略：系统策略和自定义策略。系统策略统一由阿里云创建，策略的版本更新由阿里云维护，用户只能使用不能修改。自定义策略由用户管理，策略的版本更新由用户维护。用户可以自主创建、更新和删除自定义策略。在产品迭代过程中，弹性容器实例会向系统策略中添加新的权限，用来支持新的功能和能力。系统策略的更新将会影响所有授予了该策略的 RAM 身份，包括 RAM 用户、RAM 用户组和 RAM 角色。有关 RAM 权限策略的更多信息，请参阅[权限策略概览](https://help.aliyun.com/zh/ram/policy-overview)。说明 \n\n产品系统策略旨在帮助用户快速入门，仅需简单配置即可通过控制台访问该产品及其依赖产品。虽然系统策略包含的权限同样适用于 OpenAPI 或 CLI 等访问方式，但为了提高安全性，我们推荐您在这些场景下使用自定义策略，按需授予人员及应用特定 API 的访问权限。\n\n系统策略可进一步细分为产品系统策略、服务角色策略和服务关联角色策略三类。部分云产品仅提供三类策略中的一类或两类，请以本文实际展示的策略类型为准。\n## 产品系统策略\n### AliyunECIFullAccess\n\n您可以将 AliyunECIFullAccess 策略授权给RAM身份。本策略定义了管理弹性容器实例（ECI）的权限。\n\n[查看策略详情](https://help.aliyun.com/zh/ram/developer-reference/aliyunecifullaccess)\n### AliyunECIReadOnlyAccess\n\n您可以将 AliyunECIReadOnlyAccess 策略授权给RAM身份。本策略定义了只读访问弹性容器实例（ECI）的权限。\n\n[查看策略详情](https://help.aliyun.com/zh/ram/developer-reference/aliyunecireadonlyaccess)\n## 服务关联角色策略\n### AliyunServiceRolePolicyForWorkshop\n\n弹性容器实例使用服务关联角色 AliyunServiceRoleForWorkshop 来访问您在其他云产品中的资源。AliyunServiceRolePolicyForWorkshop 是 AliyunServiceRoleForWorkshop 专用的授权策略。本策略由弹性容器实例定义和使用，您不能修改或删除，请勿将其授权给服务关联角色之外的RAM身份。\n\n[查看策略详情](https://help.aliyun.com/zh/ram/developer-reference/aliyunservicerolepolicyforworkshop)\n## 授权操作参考\n\nRAM 身份默认没有任何权限，需要由阿里云账号管理员为其授权后才能访问阿里云账号下的资源。为保证资源的数据安全，建议您遵循最小授权原则为允许访问云资源的身份授予恰好够用的权限。授权的详细操作请参见：\n\n- \n\n[为RAM用户授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-the-ram-user)\n- \n\n[为RAM用户组授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-user-group)\n- \n\n[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role)\n"}
{"url": "https://help.aliyun.com/zh/eci/security-and-compliance/eci-custom-permission-policy-reference", "page_type": "doc", "title": "弹性容器实例自定义权限策略参考", "keywords": "创建ECI自定义策略,了解ECI自定义策略,ECI自定义策略参考,ECI自定义策略示例", "last_modified_ms": 1748314488000, "last_modified_iso": "2025-05-27T10:54:48+08:00", "excerpt": "如果系统权限策略不能满足您的要求，您可以创建自定义权限策略实现最小授权。使用自定义权限策略有助于实现权限的精细化管控，是提升资源访问安全的有效手段。本文介绍ECI使用自定义权限策略的场景和策略示例。\n## 什么是自定义权限策略\n\n在基于RAM的访问控制体系中，自定义权限策略是指在系统权限策略之外，您可以自主创建、更新和删除的权限策略。自定义权限策略的版本更新需由您来维护。\n\n- \n\n创建自定义权限策略后，需为RAM用户、用户组或RAM角色绑定权限策略，这些RAM身份才能获得权限策略中指定的访问权限。\n- \n\n已创建的权限策略支持删除，但删除前需确保该策略未被引用。如果该权限策略已被引用，您需要在该权限策略的引用记录中移除授权。\n- \n\n自定义权限策略支持版本控制，您可以按照RAM规定的版本管理机制来管理您创建的自定义权限策略版本。\n\n## 操作文档\n\n- \n\n[创建自定义权限策略](https://help.aliyun.com/zh/ram/create-a-custom-policy)\n- \n\n[修改自定义权限策略内容和备注](https://help.aliyun.com/zh/ram/modify-the-document-and-description-of-a-custom-policy)\n- \n\n[删除自定义权限策略](https://help.aliyun.com/zh/ram/delete-a-custom-policy)\n- \n\n[管理权限策略授权](https://help.aliyun.com/zh/ram/manage-policy-references#task-221551)\n- \n\n[管理自定义权限策略版本](https://help.aliyun.com/zh/ram/manage-custom-policy-versions)\n\n## 常见自定义权限策略场景及示例\n\n如果您使用RAM用户在弹性容器实例控制台操作ECI资源，除了系统权限策略AliyunECIFullAccess外，还需要为RAM用户授权以下自定义权限策略。\n\n{\n    \"Statement\": [\n        {\n            \"Action\": \"ram:ListRoles\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": \"nas:DescribeFileSystems\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": \"oss:ListBuckets\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": \"vpc:DescribeCommonBandwidthPackages\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": [\n                \"cr:GetRepoList\",\n                \"cr:GetRepoTags\",\n                \"cr:GetImageManifest\",\n                \"cr:SearchRepo\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        }\n    ],\n    \"Version\": \"1\"\n}\n\n\n## 授权信息参考\n\n使用自定义权限策略，您需要了解业务的权限管控需求，并了解ECI的授权信息。详细内容请参见[授权信息](https://help.aliyun.com/zh/eci/security-and-compliance/api-eci-2018-08-08-ram)。\n"}
{"url": "https://help.aliyun.com/zh/eci/security-and-compliance/elastic-container-instance-service-linked-role", "page_type": "doc", "title": "AliyunServiceRoleForECI", "keywords": "AliyunServiceRoleForECI,了解AliyunServiceRoleForECI,查询AliyunServiceRoleForECI权限,删除AliyunServiceRoleForECI,AliyunServiceRoleForECI介绍,AliyunServiceRoleForECI权限,AliyunServiceRoleForECI应用场景", "last_modified_ms": 1707188396000, "last_modified_iso": "2024-02-06T10:59:56+08:00", "excerpt": "本文为您介绍弹性容器实例服务关联角色AliyunServiceRoleForECI以及如何删除服务关联角色。\n## 背景信息\n\n弹性容器实例服务关联角色AliyunServiceRoleForECI是ECI在某些情况下，为了完成自身的某个功能，需要获取其他云服务的访问权限而提供的RAM角色。更多关于服务关联角色的信息，请参见[服务关联角色](https://help.aliyun.com/zh/ram/user-guide/service-linked-roles#concept-2448621)。\n## AliyunServiceRoleForECI应用场景\n\n在创建ECI实例和镜像缓存的过程中，ECI需要访问云服务器ECS、专有网络VPC、容器镜像服务ACR、日志服务SLS和负载均衡SLB的资源时，可以通过自动创建的弹性容器实例服务关联角色AliyunServiceRoleForECI获取访问权限。\n## AliyunServiceRoleForECI权限说明\n\n弹性容器实例服务关联角色AliyunServiceRoleForECI对应的角色权限策略为AliyunServiceRolePolicyForECI，包含的云服务访问权限如下：\n\n{\n    \"Version\": \"1\",\n    \"Statement\": [\n        {\n            \"Action\": [\n                \"ecs:CreateNetworkInterfacePermission\",\n                \"ecs:DeleteNetworkInterfacePermission\",\n                \"ecs:DescribeNetworkInterfacePermissions\",\n                \"ecs:CreateNetworkInterface\",\n                \"ecs:DescribeNetworkInterfaces\",\n                \"ecs:AttachNetworkInterface\",\n                \"ecs:DetachNetworkInterface\",\n                \"ecs:DeleteNetworkInterface\",\n                \"ecs:DescribeSecurityGroups\",\n                \"ecs:TagResources\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": [\n                \"vpc:DescribeVSwitches\",\n                \"vpc:DescribeVSwitchAttributes\",\n                \"vpc:DescribeVpcs\",\n                \"vpc:AssociateEipAddress\",\n                \"vpc:UnassociateEipAddress\",\n                \"vpc:DescribeEipAddresses\",\n                \"vpc:AllocateEipAddress\",\n                \"vpc:ReleaseEipAddress\",\n                \"vpc:AddCommonBandwidthPackageIp\",\n                \"vpc:RemoveCommonBandwidthPackageIp\",\n                \"vpc:DescribeIpv6Addresses\",\n                \"vpc:DescribeIpv6Gateways\",\n                \"vpc:AllocateIpv6InternetBandwidth\",\n                \"vpc:TagResources\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": [\n                \"cr:PullRepository\",\n                \"cr:GetAuthorizationToken\",\n                \"cr:GetRepositoryLayers\",\n                \"cr:GetRepositoryManifest\",\n                \"cr:GetRepositoryTag\",\n                \"cr:GetRepository\",\n                \"cr:ListInstance\",\n                \"cr:ListInstanceEndpoint\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": [\n                \"log:CreateProject\",\n                \"log:GetProject\",\n                \"log:CreateLogStore\",\n                \"log:GetLogStore\",\n                \"log:CreateMachineGroup\",\n                \"log:CreateConfig\",\n                \"log:GetConfig\",\n                \"log:ApplyConfigToGroup\",\n                \"log:GetAppliedConfigs\",\n                \"log:CreateIndex\",\n                \"log:TagResources\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": [\n                \"slb:DescribeLoadBalancers\",\n                \"slb:RemoveBackendServers\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": \"ram:DeleteServiceLinkedRole\",\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"ram:ServiceName\": \"eci.aliyuncs.com\"\n                }\n            }\n        }\n    ]\n}\n\n\n## 删除AliyunServiceRoleForECI\n\n如果您需要删除弹性容器实例服务关联角色AliyunServiceRoleForECI，请先通过控制台或者OpenAPI删除依赖该服务关联角色的ECI资源，包括ECI实例和镜像缓存。删除ECI实例和镜像缓存后，您可以删除AliyunServiceRoleForECI。具体操作，请参见[删除RAM角色](https://help.aliyun.com/zh/ram/user-guide/delete-a-ram-role#task-188137)。\n"}
{"url": "https://help.aliyun.com/zh/eci/security-and-compliance/identity-management", "page_type": "doc", "title": "身份管理", "keywords": "了解RAM身份管理,管理RAM用户与角色,使用RAM访问控制,RAM身份管理,RAM用户与角色,RAM访问控制", "last_modified_ms": 1741058294000, "last_modified_iso": "2025-03-04T11:18:14+08:00", "excerpt": "为确保您的阿里云账号及云资源使用安全，如非必要都应避免直接使用阿里云账号（即主账号）来访问ECI。推荐的做法是使用RAM身份（即RAM用户和RAM角色）来访问ECI。\n## RAM用户\n\nRAM用户需要由阿里云账号（即主账号）或拥有管理员权限的RAM用户、RAM角色来创建，且必须在获得授权后才能登录控制台或使用API访问阿里云账号下的资源。\n\n对于RAM用户的使用，建议您：\n\n- \n\n使用阿里云账号创建一个RAM用户，并为RAM用户授予管理员权限，后续使用有管理员权限的RAM用户创建并管理其他RAM用户。\n- \n\n将人员用户和程序用户分离。\n\n创建RAM用户时，支持设置控制台访问和使用永久AccessKey访问两种访问方式。\n\n控制台用户使用账号和密码访问云产品控制台，API用户使用访问密钥AK（AccessKey）调用API访问云资源。建议您将两个不同的使用场景分离，避免误操作导致服务受到影响。对于通过控制台访问的用户，推荐为其开启MFA多因素认证。\n- \n\n按需为RAM用户分配最小权限。\n\n最小权限是指授予用户执行某项任务所需的权限，不授予其他无需用到的权限。最小授权可以避免用户操作权限过大，提高数据安全性，减少因权限滥用导致的安全风险。\n- \n\n不要把RAM用户的AccessKey ID和AccessKey Secret保存在工程代码中，否则可能导致AK泄露，威胁您账号下所有资源的安全。建议您使用STS或环境变量等方式获取访问授权。\n- \n\n满足条件时对RAM用户设置SSO单点登录功能，实现直接使用企业自有的身份登录并访问阿里云资源。\n\n### RAM用户相关操作\n\n- \n\n[RAM用户管理](https://help.aliyun.com/zh/ram/user-guide/overview-of-ram-users)\n- \n\n[AK安全方案](https://help.aliyun.com/zh/openapi/accesskey-security-solution)\n- \n\n[RAM用户SSO管理](https://help.aliyun.com/zh/ram/overview-of-user-based-sso)\n\n## RAM用户组\n\n当您的阿里云账号下有多个RAM用户时，可以通过创建用户组对职责相同的RAM用户进行分组管理和批量授权，高效地管理RAM用户及其权限。\n\n对于RAM用户组的使用，建议您：\n\n- \n\n在对RAM用户组授权时遵循最小权限策略原则。\n- \n\n在RAM用户职责发生变化时将其从不再归属的用户组中移除，避免权限滥用。\n- \n\n在某个用户组不再需要某些权限时移除用户组对应的权限。\n\n## RAM用户组相关操作\n\n- \n\n[RAM用户组](https://help.aliyun.com/zh/ram/user-guide/overview-of-a-ram-user-group)\n\n## RAM角色\n\nRAM角色是一种虚拟用户，可以被授予一组权限策略。与RAM用户不同，RAM角色没有永久身份凭证（登录密码或访问密钥），需要被一个可信实体扮演。扮演成功后，可信实体将获得RAM角色的临时身份凭证，即安全令牌（STS Token），使用该安全令牌就能以RAM角色身份访问被授权的资源。\n\n以下是使用RAM角色的安全建议：\n\n- \n\n创建RAM角色后，请勿随意变更RAM角色的可信实体。修改RAM角色信任策略中的可信实体，可能会导致原受信对象权限缺失，影响业务正常运行。也可能会因增加受信对象，带来过度授权的风险。特殊情况必须修改时请务必在测试账号充分测试，确保功能正常使用后，再应用到正式生产账号。\n- \n\n可信实体的RAM用户获得相关授权后即可以调用[AssumeRole - 获取扮演角色的临时身份凭证](https://help.aliyun.com/zh/ram/developer-reference/api-sts-2015-04-01-assumerole)接口获取RAM角色的STS Token。STS Token自颁发后将在一段时间内有效，建议您设置合理的Token有效期，避免有效期过长带来安全风险。说明 \n\nSTS Token有效期的最大值为角色的最大会话时间。从安全的角度考虑，应将角色最大会话时间也设置在合理范围。\n- \n\n满足条件时对RAM角色设置SSO单点登录功能，实现直接使用企业自有的身份登录并访问阿里云资源。\n\n### RAM角色相关操作\n\n- \n\n[RAM角色管理](https://help.aliyun.com/zh/ram/user-guide/ram-role-overview)\n- \n\n[扮演RAM角色](https://help.aliyun.com/zh/ram/user-guide/assume-a-ram-role)\n- \n\n[设置RAM角色最大会话时间](https://help.aliyun.com/zh/ram/user-guide/specify-the-maximum-session-duration-for-a-ram-role)\n- \n\n[角色SSO管理](https://help.aliyun.com/zh/ram/role-based-sso/)\n"}
{"url": "https://help.aliyun.com/zh/eci/security-and-compliance/service-linked-role-for-virtual-nodes", "page_type": "doc", "title": "AliyunServiceRoleForECIVnode", "keywords": "AliyunServiceRoleForECIVnode,理解ECIVnode角色,查询ECIVnode角色权限,删除ECIVnode角色,ECIVnode角色介绍,ECIVnode角色权限,ECIVnode角色删除", "last_modified_ms": 1707188404000, "last_modified_iso": "2024-02-06T11:00:04+08:00", "excerpt": "本文为您介绍虚拟节点服务关联角色AliyunServiceRoleForECIVnode以及如何删除该服务关联角色。\n## 背景信息\n\n虚拟节点服务关联角色AliyunServiceRoleForECIVnode是ECI为了实现虚拟节点功能，需要获取其他云服务的访问权限而提供的RAM角色。更多关于服务关联角色的信息，请参见[服务关联角色](https://help.aliyun.com/zh/ram/user-guide/service-linked-roles#concept-2448621)。\n## AliyunServiceRoleForECIVnode应用场景\n\n在创建虚拟节点（VNode）的过程中，系统需要访问弹性容器实例ECI、云服务器ECS、专有网络VPC的资源时，可以通过自动创建的虚拟节点服务关联角色AliyunServiceRoleForECIVnode获取访问权限。\n## AliyunServiceRoleForECIVnode权限说明\n\n虚拟节点服务关联角色AliyunServiceRoleForECIVnode对应的角色权限策略为AliyunServiceRolePolicyForECIVnode，包含的云服务访问权限如下：\n\n{\n    \"Version\": \"1\",\n    \"Statement\": [\n        {\n            \"Action\": [\n                \"eci:CreateContainerGroup\",\n                \"eci:CreateContainerGroupFromTemplate\",\n                \"eci:UpdateContainerGroup\",\n                \"eci:UpdateContainerGroupByTemplate\",\n                \"eci:RestartContainerGroup\",\n                \"eci:DeleteContainerGroup\",\n                \"eci:DescribeContainerGroups\",\n                \"eci:ExportContainerGroupTemplate\",\n                \"eci:ExecContainerCommand\",\n                \"eci:CreateImageCache\",\n                \"eci:DeleteImageCache\",\n                \"eci:UpdateImageCache\",\n                \"eci:DescribeImageCaches\",\n                \"eci:DescribeContainerGroupMetric\",\n                \"eci:DescribeMultiContainerGroupMetric\",\n                \"eci:DescribeContainerLog\",\n                \"eci:DescribeContainerGroupPrice\",\n                \"eci:DescribeRegions\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": [\n                \"vpc:DescribeVSwitches\",\n                \"vpc:DescribeVpcs\",\n                \"vpc:DescribeEipAddresses\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": [\n                \"ecs:CreateNetworkInterfacePermission\",\n                \"ecs:DeleteNetworkInterfacePermission\",\n                \"ecs:CreateNetworkInterface\",\n                \"ecs:DescribeNetworkInterfaces\",\n                \"ecs:DescribeSecurityGroups\"\n            ],\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\"\n        },\n        {\n            \"Action\": \"ram:DeleteServiceLinkedRole\",\n            \"Resource\": \"*\",\n            \"Effect\": \"Allow\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"ram:ServiceName\": \"vnode.eci.aliyuncs.com\"\n                }\n            }\n        }\n    ]\n}\n\n\n## 删除AliyunServiceRoleForECIVnode\n\n如果您需要删除虚拟节点服务关联角色AliyunServiceRoleForECIVnode，请先通过openAPI删除依赖该服务关联角色的虚拟节点资源。删除虚拟节点后，您可以删除AliyunServiceRoleForECIVnode。具体操作，请参见[删除RAM角色](https://help.aliyun.com/zh/ram/user-guide/delete-a-ram-role#task-188137)。\n"}
{"url": "https://help.aliyun.com/zh/eci/support/eci-service-level-agreement", "page_type": "doc", "title": "弹性容器实例服务等级协议（SLA）", "keywords": "弹性,服务,实例,使用,SLA,协议,参见", "last_modified_ms": 1611240355000, "last_modified_iso": "2021-01-21T22:45:55+08:00", "excerpt": "欢迎您使用弹性容器实例。关于弹性容器实例的服务等级协议（SLA），请参见[服务等级协议](http://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201812141108_51987.html?spm=a2c4g.11186623.2.30.54d9761dllwEuI)。\n"}
{"url": "https://help.aliyun.com/zh/eci/support/eci-terms-of-service", "page_type": "doc", "title": "弹性容器实例服务协议", "keywords": "了解ECI服务协议,ECI服务协议", "last_modified_ms": 1611240348000, "last_modified_iso": "2021-01-21T22:45:48+08:00", "excerpt": "欢迎您使用弹性容器实例，关于弹性容器实例的相关服务条款，请参见[服务协议](http://terms.aliyun.com/legal-agreement/terms/suit_bu1_ali_cloud/suit_bu1_ali_cloud201802281451_77479.html)。\n"}
{"url": "https://help.aliyun.com/zh/eci/use-an-sdk-to-create-an-elastic-container-instance", "page_type": "doc", "title": "通过SDK使用ECI", "keywords": null, "last_modified_ms": 1671516631000, "last_modified_iso": "2022-12-20T14:10:31+08:00", "excerpt": "弹性容器实例提供的SDK包括Go、Python和Java三个语言版本。本文以Java为例，介绍如何通过SDK创建一个ECI实例。\n## 安装Java SDK\n\n推荐您通过Apache Maven的方式来安装Java SDK，在Maven项目的pom.xml中添加以下依赖：说明 \n\n如果之前已有VPC、交换机和安全组，无需通过SDK创建，则可以不安装专有网络aliyun-java-sdk-vpc、云服务器aliyun-java-sdk-ecs及fastjson依赖。\n\n- \n\n阿里云核心库aliyun-java-sdk-core\n- \n\n弹性容器实例aliyun-java-sdk-eci及gson依赖\n- \n\n（可选）专有网络aliyun-java-sdk-vpc\n- \n\n（可选）云服务器aliyun-java-sdk-ecs及fastjson依赖\n\n示例如下：重要 \n\n请及时更新各依赖的版本，以便使用新功能。具体请访问[Maven](https://search.maven.org/artifact/com.aliyun/aliyun-java-sdk-eci)。\n\n<dependencies>\n        <dependency>\n            <groupId>com.aliyun</groupId>\n            <artifactId>aliyun-java-sdk-core</artifactId>\n            <optional>true</optional>\n            <version>4.6.3</version>\n        </dependency>\n        <dependency>\n            <groupId>com.google.code.gson</groupId>\n            <artifactId>gson</artifactId>\n            <version>2.10</version>\n        </dependency>\n        <dependency>\n            <groupId>com.aliyun</groupId>\n            <artifactId>aliyun-java-sdk-eci</artifactId>\n            <version>1.3.3</version>\n        </dependency>\n          <dependency>\n            <groupId>com.aliyun</groupId>\n            <artifactId>aliyun-java-sdk-ecs</artifactId>\n            <version>4.24.42</version>\n        </dependency>\n        <dependency>\n            <groupId>com.alibaba</groupId>\n            <artifactId>fastjson</artifactId>\n            <version>2.0.19</version>\n        </dependency>\n        <dependency>\n            <groupId>com.aliyun</groupId>\n            <artifactId>aliyun-java-sdk-vpc</artifactId>\n            <version>3.2.9</version>\n        </dependency>\n</dependencies>\n\n\n以Java开发工具为IntelliJ IDEA为例，操作步骤如下：\n\n- \n\n打开IDEA，选择以下一种方式创建Maven项目。\n\n- \n\n方式一：在IDEA中新建一个Maven项目\n\n- \n\n在顶部菜单栏，选择File>New>Project...。\n- \n\n在弹出的对话框中选择Maven，并完成项目配置。\n\n- \n\n方式二：将已有的项目转换为Maven项目\n\n- \n\n右键单击要转换的项目，在弹出菜单中选择Add Framework Support...。\n- \n\n在弹出的对话框中选择Maven，然后单击OK。\n\n- \n\n打开Maven项目目录下的pom.xml文件，添加依赖。\n\n添加依赖后，Maven项目管理工具会自动下载相关jar包。\n\n## 获取AccessKey信息\n\n在调用阿里云API时您需要使用AccessKey完成身份验证。为避免主账号泄露AccessKey带来的安全风险，建议您创建RAM用户，授予RAM用户ECI相关的访问权限，再使用RAM用户的AccessKey调用SDK。\n\n相关操作参考如下：\n\n- \n\n关于如何创建RAM用户，请参见[创建RAM用户](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-user)。\n- \n\n关于如何为RAM用户授权，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users)。\n- \n\n关于如何创建AccessKey，请参见[创建AccessKey](https://help.aliyun.com/zh/ram/user-guide/create-an-accesskey-pair)。\n\n## 创建ECI实例所需资源\n\n创建ECI实例前，需要先创建专有网络VPC、交换机和安全组。说明 \n\n如果已有VPC、交换机和安全组，您也可以获取交换机ID和安全组ID，直接创建ECI实例。\n\n- \n\n创建VPC。\n\n示例采用以下参数，更多信息，请参见[CreateVpc](https://help.aliyun.com/zh/vpc/api-createvpc)。\n\n[表格]\n\n参数\n\n示例值\n\n描述\n\nRegionId\n\ncn-shanghai\n\nVPC所属地域。\n\n请选择ECI支持的地域，具体请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones)。\n\nCidrBlock\n\n192.168.0.0/16\n\nVPC网段。\n\n建议您使用192.168.0.0/16、172.16.0.0/12、10.0.0.0/8三个RFC标准私网网段及其子网网段，网段掩码有效范围为8~28位。\n\n代码示例如下：\n\nimport com.aliyuncs.DefaultAcsClient;\nimport com.aliyuncs.IAcsClient;\nimport com.aliyuncs.exceptions.ClientException;\nimport com.aliyuncs.exceptions.ServerException;\nimport com.aliyuncs.profile.DefaultProfile;\nimport com.google.gson.Gson;\nimport com.aliyuncs.vpc.model.v20160428.*;\n\npublic class CreateVpc {\n\n    public static void main(String[] args) {\n        DefaultProfile profile = DefaultProfile.getProfile(\"cn-shanghai\",\"<accessKeyId>\", \"<accessSecret>\");\n        IAcsClient client = new DefaultAcsClient(profile);\n\n        CreateVpcRequest request = new CreateVpcRequest();\n        request.setSysRegionId(\"cn-shanghai\");\n        request.setCidrBlock(\"192.168.0.0/16\");\n\n        try {\n            CreateVpcResponse response = client.getAcsResponse(request);\n            System.out.println(new Gson().toJson(response));\n        } catch (ServerException e) {\n            e.printStackTrace();\n        } catch (ClientException e) {\n            System.out.println(\"ErrCode:\" + e.getErrCode());\n            System.out.println(\"ErrMsg:\" + e.getErrMsg());\n            System.out.println(\"RequestId:\" + e.getRequestId());\n        }\n\n    }\n}\n\n\n创建成功会返回"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/access-data-in-an-oss-bucket-from-elastic-container-instance", "page_type": "doc", "title": "在ECI中访问OSS数据", "keywords": "在ECI中访问OSS数据,Spark应用访问OSS,ECI访问OSS实践教程,ECI访问OSS配置方法", "last_modified_ms": 1666581545000, "last_modified_iso": "2022-10-24T11:19:05+08:00", "excerpt": "使用Hadoop、Spark等运行批处理作业时，可以选择对象存储OSS作为存储。本文以Spark为例，演示如何上传文件到OSS中，并在Spark中进行访问。\n\n## 准备数据并上传到OSS\n\n- \n\n登录[OSS管理控制台](https://oss.console.aliyun.com/overview)。\n- \n\n创建Bucket。具体操作，请参见[创建存储空间](https://help.aliyun.com/zh/oss/user-guide/create-a-bucket-4)。\n- \n\n上传文件到OSS。具体操作，请参见[简单上传](https://help.aliyun.com/zh/oss/user-guide/simple-upload)。\n\n上传文件后，记录该文件在OSS Bucket的地址（例如oss://test***-hust/test.txt）和OSS endpoint（例如oss-cn-hangzhou-internal.aliyuncs.com）。\n\n## 在Spark应用中读取OSS数据\n\n- \n\n开发应用。\n\nSparkConf conf = new SparkConf().setAppName(WordCount.class.getSimpleName());\nJavaRDD<String> lines = sc.textFile(\"oss://test***-hust/test.txt\", 250);\n...\nwordsCountResult.saveAsTextFile(\"oss://test***-hust/test-result\");\nsc.close();   \n\n\n- \n\n在应用中配置OSS信息。说明 \n\n请根据实际替换OSS endpoint、AccessKey ID和AccessKey Secret。\n\n- \n\n方式一：使用静态配置文件\n\n修改core-site.xml，然后将其放入到应用项目的resources目录下。\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?>\n<!--\n  Licensed under the Apache License, Version 2.0 (the \"License\");\n  you may not use this file except in compliance with the License.\n  You may obtain a copy of the License at\n    http://www.apache.org/licenses/LICENSE-2.0\n  Unless required by applicable law or agreed to in writing, software\n  distributed under the License is distributed on an \"AS IS\" BASIS,\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  See the License for the specific language governing permissions and\n  limitations under the License. See accompanying LICENSE file.\n-->\n<!-- Put site-specific property overrides in this file. -->\n<configuration>\n    <!-- OSS配置 -->\n    <property>\n        <name>fs.oss.impl</name>\n        <value>org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystem</value>\n    </property>\n    <property>\n        <name>fs.oss.endpoint</name>\n        <value>oss-cn-hangzhou-internal.aliyuncs.com</value>\n    </property>\n    <property>\n        <name>fs.oss.accessKeyId</name>\n        <value>{your AccessKey ID}</value>\n    </property>\n    <property>\n        <name>fs.oss.accessKeySecret</name>\n        <value>{your AccessKey Secret}</value>\n    </property>\n    <property>\n        <name>fs.oss.buffer.dir</name>\n        <value>/tmp/oss</value>\n    </property>\n    <property>\n        <name>fs.oss.connection.secure.enabled</name>\n        <value>false</value>\n    </property>\n    <property>\n        <name>fs.oss.connection.maximum</name>\n        <value>2048</value>\n    </property>\n</configuration>\n\n\n- \n\n方式二：提交应用时进行动态设置\n\n以Spark为例，在提交应用时进行设置，示例如下：\n\nhadoopConf:\n    # OSS\n    \"fs.oss.impl\": \"org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystem\"\n    \"fs.oss.endpoint\": \"oss-cn-hangzhou-internal.aliyuncs.com\"\n    \"fs.oss.accessKeyId\": \"your AccessKey ID\"\n    \"fs.oss.accessKeySecret\": \"your AccessKey Secret\"\n\n\n- \n\n打包JAR文件。\n\n打包的JAR文件中需包含所有依赖。应用的pom.xml如下：\n\n 1<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n 2<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n 3         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n 4         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n 5    <modelVersion>4.0.0</modelVersion>\n 6\n 7    <groupId>com.aliyun.liumi.spark</groupId>\n 8    <artifactId>SparkExampleJava</artifactId>\n 9    <version>1.0-SNAPSHOT</version>\n10\n11    <dependencies>\n12        <dependency>\n13            <groupId>org.apache.spark</groupId>\n14            <artifactId>spark-core_2.12</artifactId>\n15            <version>2.4.3</version>\n16        </dependency>\n17\n18        <dependency>\n19            <groupId>com.aliyun.dfs</groupId>\n20            <artifactId>aliyun-sdk-dfs</artifactId>\n21            <version>1.0.3</version>\n22        </dependency>\n23\n24    </dependencies>\n25\n26    <build>\n27    <plugins>\n28        <plugin>\n29            <groupId>org.apache.maven.plugins</groupId>\n30            <artifactId>maven-assembly-plugin</artifactId>\n31            <version>2.6</version>\n32            <configuration>\n33                <appendAssemblyId>false</appendAssemblyId>"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/access-data-in-apsara-file-storage-for-hdfs-from-eci", "page_type": "doc", "title": "在ECI中访问HDFS数据", "keywords": "实现ECI访问HDFS,Spark应用读取HDFS,ECI访问HDFS实践,HDFS客户端配置", "last_modified_ms": 1672886737000, "last_modified_iso": "2023-01-05T10:45:37+08:00", "excerpt": "使用Hadoop、Spark等运行批处理作业时，可以选择文件存储HDFS作为存储。本文以Spark为例，演示如何上传文件到在HDFS中，并在Spark中进行访问。\n\n## 准备数据并上传到HDFS\n\n- \n\n开通HDFS。具体操作，请参见[开通文件存储HDFS版服务](https://help.aliyun.com/zh/hdfs/opening-service)。\n- \n\n创建文件系统。具体操作，请参见[创建文件系统](https://help.aliyun.com/zh/hdfs/user-guide/create-a-file-system)。\n- \n\n（可选）创建权限组，并设置规则。具体操作，请参见[管理权限组](https://help.aliyun.com/zh/hdfs/user-guide/manage-permission-groups)。\n- \n\n创建挂载点。具体操作，请参见[管理挂载点](https://help.aliyun.com/zh/hdfs/user-guide/manage-mount-points)。\n- \n\n安装Apache Hadoop。\n\n- \n\n下载Apache Hadoop。\n\nApache Hadoop下载地址请参见[Hadoop下载](https://archive.apache.org/dist/hadoop/common/)，建议选用的Apache Hadoop版本不低于2.7.2，本文档中使用的Apache Hadoop版本为Apache Hadoop 2.7.2。\n- \n\n解压Apache Hadoop压缩包到指定文件夹。\n\ntar -zxvf hadoop-2.7.2.tar.gz -C /usr/local/\n\n\n- \n\n修改core-site.xml配置文件。\n\nvim /usr/local/hadoop-2.7.2/etc/hadoop/core-site.xml\n\n\n修改core-site.xml配置文件如下：\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?>\n<!--\n  Licensed under the Apache License, Version 2.0 (the \"License\");\n  you may not use this file except in compliance with the License.\n  You may obtain a copy of the License at\n    http://www.apache.org/licenses/LICENSE-2.0\n  Unless required by applicable law or agreed to in writing, software\n  distributed under the License is distributed on an \"AS IS\" BASIS,\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  See the License for the specific language governing permissions and\n  limitations under the License. See accompanying LICENSE file.\n-->\n<!-- Put site-specific property overrides in this file. -->\n<configuration>\n    <property>\n        <name>fs.defaultFS</name>\n        <value>dfs://f-4b1fcae5dv***.cn-hangzhou.dfs.aliyuncs.com:10290</value>\n        <!-- 该地址填写您的HDFS挂载点地址 -->\n    </property>\n    <property>\n        <name>fs.dfs.impl</name>\n        <value>com.alibaba.dfs.DistributedFileSystem</value>\n    </property>\n    <property>\n        <name>fs.AbstractFileSystem.dfs.impl</name>\n        <value>com.alibaba.dfs.DFS</value>\n    </property>\n    <property>\n        <name>io.file.buffer.size</name>\n        <value>8388608</value>\n    </property>\n    <property>\n        <name>alidfs.use.buffer.size.setting</name>\n        <value>false</value>\n        <!-- 建议不开启，开启后会降低iosize，进而影响数据吞吐 -->\n    </property>\n    <property>\n        <name>dfs.usergroupservice.impl</name>\n        <value>com.alibaba.dfs.security.LinuxUserGroupService.class</value>\n    </property>\n    <property>\n        <name>dfs.connection.count</name>\n        <value>256</value>\n    </property>\n</configuration>\t\n\n说明 \n\n配置时，只需配置HDFS相关的几个配置项，修改后的core-site.xml文件在配置应用时将会用到。\n- \n\n修改/etc/profile配置文件，并使其生效。\n\nvim /etc/profile\n\n\n添加环境变量如下：\n\nexport HADOOP_HOME=/usr/local/hadoop-2.7.2\nexport HADOOP_CLASSPATH=/usr/local/hadoop-2.7.2/etc/hadoop:/usr/local/hadoop-2.7.2/share/hadoop/common/lib/*:/usr/local/hadoop-2.7.2/share/hadoop/common/*:/usr/local/hadoop-2.7.2/share/hadoop/hdfs:/usr/local/hadoop-2.7.2/share/hadoop/hdfs/lib/*:/usr/local/hadoop-2.7.2/share/hadoop/hdfs/*:/usr/local/hadoop-2.7.2/share/hadoop/yarn/lib/*:/usr/local/hadoop-2.7.2/share/hadoop/yarn/*:/usr/local/hadoop-2.7.2/share/hadoop/mapreduce/lib/*:/usr/local/hadoop-2.7.2/share/hadoop/mapreduce/*:/usr/local/hadoop-2.7.2/contrib/capacity-scheduler/*.jar\nexport HADOOP_CONF_DIR=/usr/local/hadoop-2.7.2/etc/hadoop\n\n\n修改完成后，执行以下命令使其生效。\n\nsource /etc/profile\n\n\n- \n\n添加阿里云HDFS依赖。\n\ncp aliyun-sdk-dfs-1.0.3.jar  /usr/local/hadoop-2.7.2/share/hadoop/hdfs\n\n\nHDFS SDK的下载地址为[HDFS SDK](https://mvnrepository.com/artifact/com.aliyun.dfs/aliyun-sdk-dfs)。只需部署HDFS Client，无需部署HDFS集群。\n- \n\n上传数据到HDFS。\n\n- \n\n创建数据目录。\n\n$HADOOP_HOME/bin/hadoop fs -mkdir -p /pod/data\n\n\n- \n\n将本地文件上传到HDFS。\n\n以下命令使用本地准备的一本书作为示例，请根据实际替换。\n\n$HADOOP_HOME/bin/hadoop fs -put ./A-Game-of-Thrones.txt /pod/data/A-Game-of-Thrones.txt\n\n\n- \n\n确认文件信息。\n\n$HADOOP_HOME/bin/hadoop fs -ls /pod/data\n\n\n## 在Spark应用中读取HDFS的数据\n\n- \n\n开发应用。\n\nSparkConf conf = new SparkConf().setAppName(WordCount.class.getSimpleName());\nJavaRDD<String> lines = sc.textFi"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/build-a-redis-cluster", "page_type": "doc", "title": "使用ECI搭建Redis集群", "keywords": "搭建Redis集群,扩缩容Redis集群,ECI搭建Redis集群,Redis集群运维", "last_modified_ms": 1708652553000, "last_modified_iso": "2024-02-23T09:42:33+08:00", "excerpt": "使用容器化方式搭建Redis集群具有简化部署、灵活扩展、资源隔离等优势，可以提高Redis集群的部署、管理、扩展和维护效率，降低运维成本。本文介绍如何基于ACK Serverless集群，使用ECI来搭建Redis集群。\n## 背景信息\n\nRedis支持以集群模式运行，在该模式下，Redis将所有存储空间分为16384个哈希槽，集群中的每个Master节点负责N个哈希槽（一个数据分片），当用户写入一条数据时，Redis计算其哈希槽，然后将数据写在负责该哈希槽的节点上。且每个Master节点可以添加一个或多个Slave节点，当某个Master节点不可用时，其Slave节点自动代替Master节点继续工作。\n\n由此可见，在Redis集群模式下，可以获得更高的吞吐量和一定程度的可用性。需要注意的是，在集群模式下，Redis仍不能保证数据零丢失，更多信息，请参见[Redis官方文档](https://redis.io/topics/cluster-tutorial)。\n## 前提条件\n\n已创建ACK Serverless集群，且集群满足以下条件：\n\n- \n\n集群具备公网环境，可以通过公网拉取镜像。\n- \n\n集群中已部署存储插件。\n\n建议使用CSI插件，确保集群已部署阿里云CSI-Provisioner组件。\n- \n\n集群中已部署CoreDNS。\n\n## 搭建Redis集群\n\n本文以Redis官方镜像6.0.8版本作为示例，创建一个6个节点的Redis集群，其中3个Master节点，3个Slave节点。因为每个节点有自己的状态和标识，所以使用Statefulset来创建Pod，此外需要为每个节点挂载一个云盘，用于持久化存储节点数据。说明 \n\n建议选择较新Redis版本，如果Redis版本低于5.0，则初始化集群所用的命令可能会有所不同。\n\n- \n\n创建一个ConfigMap，用来存储和管理Redis集群的配置。\n\nkubectl create -f redis-config.yaml\n\n\nredis-config.yaml的内容示例如下：\n\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: redis-cluster\ndata:\n  redis.conf: |\n    bind 0.0.0.0\n    port 6379\n    cluster-announce-bus-port 16379\n    cluster-enabled yes\n    appendonly yes\n    cluster-node-timeout 5000\n    dir /data\n    cluster-config-file /data/nodes.conf\n    requirepass pass123\n    masterauth pass123\n\n\n- \n\n字段dir为Redis节点数据的持久化存储目录，所以Pod的/data目录应当是一个持久化存储目录。\n- \n\n字段cluster-config-file是Redis集群的节点信息，由Redis节点自动生成和修改，该配置也应当是一个持久化存储目录，以便节点宕机恢复后能够找到集群中的其他节点，并继续工作。\n\n- \n\n创建一个headless类型的Service。\n\nkubectl create -f redis-service.yaml\n\n\nredis-service.yaml的内容示例如下：\n\napiVersion: v1\nkind: Service\nmetadata:\n  name: redis-cluster-svc\nspec:\n  clusterIP: None\n  selector:\n    app: redis-cluster\n\n\n- \n\n创建一个Statefulset，用于部署Redis。\n\n创建Statefulset时引用之前创建的Service，将ConfigMap挂载到每一个Pod的/config，并且为每一个Pod创建一个PVC，挂载到/data。\n\nkubectl create -f redis.yaml\n\n\nredis.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-cluster\nspec:\n  selector:\n    matchLabels:\n      app: redis-cluster\n  serviceName: redis-cluster-svc\n  replicas: 6\n  template:\n    metadata:\n      labels:\n        app: redis-cluster\n        alibabacloud.com/eci: \"true\"\n    spec:\n      terminationGracePeriodSeconds: 10\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: app\n                  operator: In\n                  values:\n                  - redis-cluster\n              topologyKey: kubernetes.io/hostname\n            weight: 100\n      containers:\n      - name: redis\n        image: redis:6.0.8\n        command: [\"redis-server\", \"/config/redis.conf\"]\n        ports:\n        - name: redis\n          containerPort: 6379\n          protocol: TCP\n        - name: election\n          containerPort: 16379\n          protocol: TCP\n        volumeMounts:\n        - name: redis-conf\n          mountPath: /config\n        - name: pvc-essd-redis-data\n          mountPath: /data\n      volumes:\n      - name: redis-conf\n        configMap:\n          name: redis-cluster\n          items:\n          - key: redis.conf\n            path: redis.conf\n  volumeClaimTemplates:\n  - metadata:\n      name: pvc-essd-redis-data\n    spec:\n      accessModes: [ \"ReadWriteOnce\" ]\n      storageClassName: alicloud-disk-essd\n      resources:\n        requests:\n          storage: 20Gi\n\n\n创建后，等待Statefulset中的所有Pod达到Ready状态。\n\nkubectl get statefulset redis-cluster -o wide\n\n\n预期返回：\n\nNAME            READY   AGE     CONTAINERS   IMAGES\nredis-cluster   6/6     8m52s   redis        redis:6.0.8\n\n\n- \n\n初始化集群。\n\n- \n\n获取每个节点的IP地址。\n\n目前Redis还不支持以hostname方式初始化集群，所以需要先获取每个节点的IP地址。\n\nkubectl get pods -l app=redis-cluster -o wide\n\n\n返回类似以下信息：\n\nNAME              READY   STATUS    RESTARTS   AGE     IP             NODE                           NOMINATED NODE   READINESS GATES\nredis-cluster-0   1/1     Running   0          9m37s   172.16.55.6    virtual-kubelet-cn-beijing-k   <none>           <none>\nredis-cluster-1   1/1     Running   0          9m5s    172.16.55.7    virtual-kubelet-cn-beijing-k   <none>     "}
{"url": "https://help.aliyun.com/zh/eci/use-cases/build-wordpress", "page_type": "doc", "title": "使用ECI搭建WordPress应用", "keywords": "使用ECI搭建WordPress,部署WordPress应用,ECI搭建WordPress教程,ECI应用实践", "last_modified_ms": 1708507684000, "last_modified_iso": "2024-02-21T17:28:04+08:00", "excerpt": "ECI支持使用Cloud Shell来管理。本文以搭建WordPress应用为例，介绍如何使用Cloud Shell来创建ACK Serverless集群，并快速创建ECI实例来部署容器应用。\n## 背景信息\n\nWordPress是使用PHP语言开发的博客平台，在支持PHP和MySQL数据库的服务器上，您可以用WordPress架设网站，也可以用作内容管理系统（CMS）。\n\nCloud Shell是阿里云提供的命令行工具，您可以在浏览器上使用Cloud Shell运行云命令行来管理阿里云资源。更多关于Cloud Shell的信息，请参见[Cloud Shell](https://help.aliyun.com/zh/cloud-shell/what-is-the-cloud-command-line#concept-90256-zh)。\n## 创建ACK Serverless集群\n\n- \n\n[打开Cloud Shell](https://shell.aliyun.com/?action=git_open&git_repo=https://github.com/aliyuneci/BestPractice-Serverless-Kubernetes.git&tutorial=eci-wordpress/README.md)，确认弹出的提示克隆教程脚本到Cloud Shell。\n- \n\n进入WordPress教程所在目录。\n\ncd eci-wordpress\n\n\n- \n\n（可选）修改集群配置文件。\n\nvim create.json\n\n\ncreate.json文件保存了创建ACK Serverless集群的参数，默认配置如下：\n\n{\n\t\"cluster_type\": \"ManagedKubernetes\",\n\t\"profile\": \"Serverless\",\n\t\"name\": \"wordpress-demo\",\n\t\"region_id\": \"cn-hangzhou\",\n\t\"endpoint_public_access\": true,\n\t\"snat_entry\": true,\n\t\"addons\": [{\n\t\t\"name\": \"csi-provisioner\",\n\t\t\"config\": \"\"\n\t}],\n\t\"zoneid\": \"cn-hangzhou-j\"\n}\n\n\n可修改的参数如下：\n\n- \n\nname：集群名称。\n- \n\nregion_id：集群所在地域ID。\n- \n\nendpoint_public_access：是否开启公网API Server。\n- \n\nsnat_entry：是否创建NAT网关并配置SNAT规则。\n- \n\nzoneid：集群所属地域的可用区ID。\n\n- \n\n执行以下命令创建ACK Serverless集群。\n\naliyun cs POST /clusters --header \"Content-Type=application/json\" --body \"$(cat create.json)\"\n\n\n创建成功后会返回类似以下信息，其中cluster_id为您创建的集群的ID。\n\n{\n\t\"cluster_id\": \"c5789a864e71848ab9fa57013********\",\n\t\"instanceId\": \"c5789a864e71848ab9fa57013********\",\n\t\"request_id\": \"C5044E47-7AAD-5D6F-A8D9-2249F1******\",\n\t\"task_id\": \"T-6528e986ba8151096d******\"\n}\n\n\n- \n\n查看集群属性。\n\naliyun cs GET /clusters/<YOUR-CLUSTER-ID>\n\n\n## 部署WordPress应用重要 \n\n请确保创建的ACK Serverless集群已完成初始化（一般需要3~5分钟），然后开始安装WordPress。\n\n- \n\n管理ACK Serverless集群。\n\nsource use-k8s-cluster ${集群ID}\n\n\n请根据实际替换上述命令的集群ID，命令示例如下：\n\nsource use-k8s-cluster c5789a864e71848ab9fa57013********\n\n\n- \n\n部署WordPress应用。重要 \n\n使用wordpress-all-in-one-pod.yaml部署WordPress应用会自动创建一个EIP，并挂载到应用对应的ECI Pod上。\n\nkubectl apply -f wordpress-all-in-one-pod.yaml\n\n说明 \n\n[打开Cloud Shell](https://shell.aliyun.com/?action=git_open&git_repo=https://github.com/aliyuneci/BestPractice-Serverless-Kubernetes.git&tutorial=eci-wordpress/README.md)时会提示您克隆脚本到Cloud Shell内，在eci-wordpress目录下包含wordpress-all-in-one-pod.yaml。\n- \n\n查看进度。\n\nkubectl get pods\n\n\n预期返回如下，当Pod的状态为Running时，表示部署成功。\n\nNAME        READY   STATUS    RESTARTS   AGE\nwordpress   2/2     Running   0          5m59s\n\n\n- \n\n查看WordPress应用的EIP地址。\n\nkubectl get -o json pod wordpress |grep \"k8s.aliyun.com/allocated-eipAddress\"\n\n\n预期返回如下：\n\n\"k8s.aliyun.com/allocated-eipAddress\": \"47.99.XX.XX\"\n\n\n- \n\n配置WordPress应用的安全组。\n\n- \n\n获取安全组ID。\n\nkubectl get -o json pod wordpress |grep \"k8s.aliyun.com/eci-security-group\"\n\n\n预期返回：\n\n\"k8s.aliyun.com/eci-security-group\": \"sg-bp1fw6ecxb0obm******\"\n\n\n- \n\n配置安全组开放80端口。\n\naliyun ecs AuthorizeSecurityGroup --RegionId ${Region ID} --SecurityGroupId ${安全组ID} --IpProtocol tcp --PortRange 80/80 --SourceCidrIp 0.0.0.0/0 --Priority 100\n\n\n请根据实际替换上述命令的Region ID和安全组ID。命令示例如下：\n\naliyun ecs AuthorizeSecurityGroup --RegionId cn-hangzhou --SecurityGroupId sg-bp1fw6ecxb0obm******  --IpProtocol tcp --PortRange 80/80 --SourceCidrIp 0.0.0.0/0 --Priority 100\n\n\n## 安装并登录WordPress应用\n\n- \n\n访问WordPress应用。\n\n在浏览器中输入WordPress应用的EIP地址，例如http://47.99.XX.XX。\n- \n\n选择语言单击继续，然后填写网站基本信息，单击安装WordPress。\n\n需要填写的基本信息说明如下：\n\n- \n\n站点标题：WordPress网站的名称。\n- \n\n用户名：登录WordPress时所需的用户名，请注意安全性。\n- \n\n密码：登录WordPress时所需的密码，建议您设置安全性高的密码。\n- \n\n您的电子邮件：用于接收通知的电子邮件。\n\n- \n\n单击登录。\n- \n\n输入在安装WordPress时设置的用户名和密码，然后单击登录。\n\n登录成功后，即可打开WordPress。\n"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/connect-an-apsaradb-rds-database-to-elastic-container-instance", "page_type": "doc", "title": "配置ECI连接RDS", "keywords": "配置ECI连接RDS,排查ECI连接RDS问题,ECI连接RDS实践教程,ECI连接RDS网络配置", "last_modified_ms": 1708914676000, "last_modified_iso": "2024-02-26T10:31:16+08:00", "excerpt": "如果您的容器应用需要连接数据库（以RDS MySQL实例为例），您需要设置RDS白名单，并在创建ECI Pod时传入数据库连接信息。本文介绍在ACK Serverless集群中创建ECI Pod时，如何连接RDS。\n## 背景信息\n\n阿里云关系型数据库RDS（Relational Database Service）是一种稳定可靠、可弹性伸缩的在线数据库服务。基于阿里云分布式文件系统和SSD盘高性能存储，RDS支持MySQL、SQL Server、PostgreSQL等多种数据库引擎，本文使用RDS MySQL实例为例。您可以根据业务需求来选择。更多信息，请参见[数据库引擎介绍](https://help.aliyun.com/zh/rds/getting-started#concept-rrc-tdh-wdb)。\n## 前提条件\n\n- \n\n已创建RDS MySQL实例，并且在实例上配置数据库用户账号。具体操作，请参见[创建RDS MySQL实例](https://help.aliyun.com/zh/rds/create-an-apsaradb-rds-for-mysql-instance#concept-wzp-ncf-vdb)和[创建数据库和账号](https://help.aliyun.com/zh/rds/create-databases-and-accounts-for-an-apsaradb-rds-for-mysql-instance)。\n- \n\n已创建ACK Serverless集群。具体操作，请参见[创建集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/create-an-ask-cluster-2)。说明 \n\n本文以ACK Serverless集群为例，如果您使用其他类型的Kubernetes集群，请确保集群中已部署虚拟节点来对接ECI。\n- \n\n确保DS实例与Kubernetes集群的网络互通。\n\n建议RDS实例与Kubernetes集群属于同一VPC网络下，可以直接使用内网进行通信；如果跨VPC创建RDS实例和Kubernetes集群，则需要配置公网。\n\n## 设置RDS白名单并获取数据库访问地址\n### 通过内网访问RDS\n\n如果您的Kubernetes集群和RDS实例在同一VPC下，则集群中的应用可以通过内网访问RDS，您需要设置RDS白名单并获取数据库内网访问地址。\n\n- \n\n设置RDS白名单。\n\n内网访问时，白名单可以设置IP地址或安全组：\n\n- \n\nIP地址\n\n在RDS白名单中添加IP地址网段（VPC或交换机网段），属于该网段的ECI实例均可访问该RDS实例。具体操作，请参见[设置IP白名单](https://help.aliyun.com/zh/rds/apsaradb-rds-for-mysql/configure-an-ip-address-whitelist-for-an-apsaradb-rds-for-mysql-instance)。\n- \n\n安全组\n\n在RDS白名单中添加安全组后，该安全组中的ECI实例均可以访问该RDS实例。具体操作，请参见[设置安全组](https://help.aliyun.com/zh/rds/apsaradb-rds-for-mysql/set-security-group)。\n\n- \n\n在RDS实例的数据库连接页面，记录数据库内网访问地址。\n\n### 通过公网访问RDS\n\n如果您的Kubernetes集群和RDS实例在不同的VPC下，则集群中的应用需要通过公网访问RDS。您需要设置RDS白名单并申请数据库外网访问地址。重要 \n\n- \n\n外网地址会降低实例的安全性，请谨慎使用。\n- \n\n为了获得更快的传输速率和更高的安全性，建议您将应用迁移到与您的RDS实例在同一地域且网络类型相同的ECI实例，然后使用内网地址。\n\n- \n\n设置RDS白名单。\n\n公网访问时，需要设置IP白名单，具体操作，请参见[设置IP白名单](https://help.aliyun.com/zh/rds/apsaradb-rds-for-mysql/configure-an-ip-address-whitelist-for-an-apsaradb-rds-for-mysql-instance)。\n\n- \n\n如果ECI实例使用NAT网关访问公网，则IP白名单中需添加NAT网关绑定的EIP地址。\n- \n\n如果ECI实例使用EIP访问公网，则IP白名单中需添加该ECI实例绑定的EIP地址。\n\n- \n\n申请并记录数据库外网访问地址。具体操作，请参见[申请或释放外网地址](https://help.aliyun.com/zh/rds/apsaradb-rds-for-mysql/apply-for-or-release-a-public-endpoint-for-an-apsaradb-rds-for-mysql-instance)。\n\n## 配置应用连接RDS实例\n\n以ACK Serverless集群使用内网连接RDS实例为例，操作如下：\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.0.0.63bf19c6uIDveb&accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)。\n- \n\n在集群页面，找到目标集群，单击集群名称，进入集群管理页面。\n- \n\n创建ConfigMap，配置RDS连接信息。说明 \n\nConfigMap可以将您的环境配置信息和容器镜像解耦，便于应用配置的修改。\n\n- \n\n在左侧导航栏，选择配置管理>配置项。\n- \n\n单击创建。\n- \n\n填写ConfigMap配置，然后单击确定。\n\n名称为rds-config，要添加的配置如下：\n\n[表格]\n\n名称\n\n示例值\n\n说明\n\nhost\n\nrm-2zem97a62s9******.mysql.rds.aliyuncs.com\n\n数据库连接地址，在RDS实例的数据库连接页面可以获取。\n\nport\n\n3306\n\n数据库连接端口，在RDS实例的数据库连接页面可以获取。\n\ndatabase\n\ntest-db\n\n数据库名称，在RDS实例的数据库管理页面可以获取。\n\n- \n\n创建Secret，添加数据库用户名和密码。说明 \n\n使用Secret可以将数据库用户名和密码等机密信息安全地传递给应用。\n\n- \n\n在左侧导航栏，选择配置管理>保密字典。\n- \n\n单击创建。\n- \n\n填写Secret配置，然后单击确定。\n\n名称为rds-secret，要添加的配置如下：\n\n[表格]\n\n名称\n\n示例值\n\n说明\n\nusername\n\ntest\n\n数据库用户名称。在RDS实例的账号管理页面可以获取。\n\npassword\n\npwd******\n\n数据库密码。如果您忘记了密码，在RDS实例的账号管理页面可以进行重置。\n\n- \n\n创建ECI Pod，测试能否连接RDS。\n\n- \n\n在左侧导航栏，选择工作负载>容器组。\n- \n\n单击使用YAML创建资源。\n- \n\n填写YAML，单击创建。\n\n由于RDS与原生的数据库服务完全兼容，因此您可以使用任何通用的数据库客户端连接到RDS实例，且连接方法类似。配置示例如下：说明 \n\n如果采用配置示例进行测试，请先在RDS实例中创建username表，表中增加一个user列。\n\n如下YAML示例通过环境变量传入数据库连接信息（包括数据库连接地址、端口、名称，以及用户名和密码），使用的镜像包含了一个Python脚本，可以连接数据库并插入数据。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    name: rds-test\n  name: rds-test\nspec:\n  containers:\n  - name: test-rds\n    image: registry.cn-hangzhou.aliyuncs.com/eci_open/sqlclient:1.0.1  #一个Python Job用来连接云数据库的镜像\n    imagePullPolicy: IfNotPresent\n    command: [\"/bin/bash\",\"-c\",\"python3 /testapp/mysqlclient.py\"]\n    env:\n    - name: MYSQL_HOST \n      valueFrom:\n        configMapKeyRef:\n          name: rds-config  #ConfigMap的名称\n          key: host  #ConfigMap中的Key\n    - name: MYSQL_PORT\n      valueFrom:\n        configMapKeyRef:\n          name: rds-config #ConfigMap的名称\n          key: port #ConfigMap中的Key\n    - name: MYSQL_DB\n      valueFrom:\n        configMapKeyRef:\n          name: rds-config  #ConfigMap的名称\n          key: database #"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/deploy-a-spark-application", "page_type": "doc", "title": "使用ECI运行Spark作业", "keywords": "ECI运行Spark作业,安装Spark Operator,ECI运行Spark作业实践,Spark作业配置", "last_modified_ms": 1708914555000, "last_modified_iso": "2024-02-26T10:29:15+08:00", "excerpt": "在Kubernetes集群中使用ECI来运行Spark作业具有弹性伸缩、自动化部署、高可用性等优势，可以提高Spark作业的运行效率和稳定性。本文介绍如何在ACK Serverless集群中安装Spark Operator，使用ECI来运行Spark作业。\n## 背景信息\n\nApache Spark是一个在数据分析领域广泛使用的开源项目，它常被应用于众所周知的大数据和机器学习工作负载中。从Apache Spark 2.3.0版本开始，您可以在Kubernetes上运行和管理Spark资源。\n\nSpark Operator是专门针对Spark on Kubernetes设计的Operator，开发者可以通过使用CRD的方式，提交Spark任务到Kubernetes集群中。使用Spark Operator有以下优势：\n\n- \n\n能够弥补原生Spark对Kubernetes支持不足的部分。\n- \n\n能够快速和Kubernetes生态中的存储、监控、日志等组件对接。 \n- \n\n支持故障恢复、弹性伸缩、调度优化等高阶Kubernetes特性。\n\n## 准备工作\n\n- \n\n创建ACK Serverless集群。\n\n在[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.2.16.61a036c8iieu29&amp;accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)上创建ACK Serverless集群。具体操作，请参见[创建ACK Serverless集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/getting-started/ask-quick-start#task-e3c-311-ydb)。重要 \n\n如果您需要通过公网拉取镜像，或者训练任务需要访问公网，请配置公网NAT网关。\n\n您可以通过kubectl管理和访问ACK Serverless集群，相关操作如下：\n\n- \n\n如果您需要通过本地计算机管理集群，请安装并配置kubectl客户端。具体操作，请参见[通过kubectl连接Kubernetes集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/connect-to-an-ack-cluster-by-using-kubectl#task-msl-bc1-ydb)。\n- \n\n您也可以在CloudShell上通过kubect管理集群。具体操作，请参见[在CloudShell上通过kubectl管理Kubernetes集群](https://help.aliyun.com/zh/ack/use-kubectl-on-cloud-shell-to-manage-ack-clusters#task-1962399)。\n\n- \n\n创建OSS存储空间。\n\n您需要创建一个OSS存储空间（Bucket）用来存放测试数据、测试结果和测试过程中的日志等。关于如何创建OSS Bucket，请参见[创建存储空间](https://help.aliyun.com/zh/oss/getting-started/create-buckets-6#task-u3p-3n4-tdb)。\n\n## 安装Spark Operator\n\n- \n\n安装Spark Operator。\n\n- \n\n在[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.2.16.61a036c8iieu29&amp;accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)的左侧导航栏，选择市场>应用市场。\n- \n\n在应用目录页签，找到并单击ack-spark-operator。\n- \n\n单击右上角的一键部署。\n- \n\n在弹出面板中选择目标集群，按照页面提示完成配置。\n\n- \n\n创建ServiceAccount、Role和Rolebinding。\n\nSpark作业需要一个ServiceAccount来获取创建Pod的权限，因此需要创建ServiceAccount、Role和Rolebinding。YAML示例如下，请根据需要修改三者的Namespace。\n\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: spark\n  namespace: default\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  namespace: default\n  name: spark-role\nrules:\n- apiGroups: [\"\"]\n  resources: [\"pods\"]\n  verbs: [\"*\"]\n- apiGroups: [\"\"]\n  resources: [\"services\"]\n  verbs: [\"*\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: spark-role-binding\n  namespace: default\nsubjects:\n- kind: ServiceAccount\n  name: spark\n  namespace: default\nroleRef:\n  kind: Role\n  name: spark-role\n  apiGroup: rbac.authorization.k8s.io\n\n\n## 构建Spark作业镜像\n\n您需要编译Spark作业的JAR包，使用Dockerfile打包镜像。\n\n以阿里云容器服务的Spark基础镜像为例，设置Dockerfile内容如下：\n\nFROM registry.aliyuncs.com/acs/spark:ack-2.4.5-latest\nRUN mkdir -p /opt/spark/jars\n# 如果需要使用OSS（读取OSS数据或者离线Event到OSS)，可以添加以下JAR包到镜像中\nADD https://repo1.maven.org/maven2/com/aliyun/odps/hadoop-fs-oss/3.3.8-public/hadoop-fs-oss-3.3.8-public.jar $SPARK_HOME/jars\nADD https://repo1.maven.org/maven2/com/aliyun/oss/aliyun-sdk-oss/3.8.1/aliyun-sdk-oss-3.8.1.jar $SPARK_HOME/jars\nADD https://repo1.maven.org/maven2/org/aspectj/aspectjweaver/1.9.5/aspectjweaver-1.9.5.jar $SPARK_HOME/jars\nADD https://repo1.maven.org/maven2/org/jdom/jdom/1.1.3/jdom-1.1.3.jar $SPARK_HOME/jars\nCOPY SparkExampleScala-assembly-0.1.jar /opt/spark/jars\n\n重要 \n\nSpark镜像如果较大，则拉取需要较长时间，您可以通过ImageCache加速镜像拉取。更多信息，请参见[管理ImageCache](https://help.aliyun.com/zh/eci/user-guide/manage-image-caches-1#topic-2133536)和[使用ImageCache加速创建Pod](https://help.aliyun.com/zh/eci/user-guide/use-imagecache-to-accelerate-the-creation-of-pods#topic-1860150)。\n\n您也使用阿里云Spark基础镜像。阿里云提供了Spark2.4.5的基础镜像，针对Kubernetes场景（调度、弹性）进行了优化，能够极大提升调度速度和启动速度。您可以通过设置Helm Chart的变量enableAlibabaCloudFeatureGates: true的方式开启，如果想要达到更快的启动速度，可以设置enableWebhook: false。\n## 编写作业模板并提交作业\n\n创建一个Spark作业的YMAL配置文件，并进行部署。\n\n- \n\n创建spark-pi.yaml文件。\n\n一个典型的作业模板示例如下。更多信息，请参见[spark-on-k8s-operator](https://github.com/GoogleCloudPlatform/spark-on-k8s-operator/blob/master/docs/api-docs.md?spm=a2c4g.11186623.0.0.65d95b297Q1wAO&file=api-docs.md)。\n\napiVersion: \"sparkoperator.k8s.io/v1beta2\"\nkind: SparkApplication\nmeta"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/deploy-jenkins-in-an-ask-cluster-and-then-create-and-deploy-an-application", "page_type": "doc", "title": "在ACK Serverless集群中部署Jenkins并完成应用构建和部署", "keywords": "ACK Serverless部署Jenkins,创建Jenkins流水线,使用Jenkins构建应用,Jenkins部署教程,Jenkins与ACK Serverless", "last_modified_ms": 1692869072000, "last_modified_iso": "2023-08-24T17:24:32+08:00", "excerpt": "本文介绍如何在阿里云ACK Serverless集群中部署Jenkins并通过简单的应用示例演示其构建和部署的过程。\n## 前提条件\n\n- \n\n已创建ACK Serverless集群。具体操作，请参见[创建ACK Serverless集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/create-an-ask-cluster-2#task-e3c-311-ydb)。\n- \n\n已通过kubectl连接Kubernetes集群。具体操作，请参见[通过kubectl连接Kubernetes集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/connect-to-an-ack-cluster-by-using-kubectl#task-msl-bc1-ydb)。\n\n## 注意事项\n\nJenkins系统的维护由开发者自行负责，此部分不提供企业级的技术支持。\n## 步骤一：部署Jenkins\n\n- \n\n执行以下命令，配置Jenkins Helm Repo。\n\nhelm repo add jenkins https://charts.jenkins.io\nhelm repo update\n\n\n预期输出：\n\nHang tight while we grab the latest from your chart repositories...\n...Successfully got an update from the \"jenkins\" chart repository\nUpdate Complete. ⎈Happy Helming!⎈\n\n说明 \n\n由于以上仓库属于海外Helm仓库，ACK Serverless集群在中国内地配置该Helm Repo时会稍微慢些，请您耐心等待。\n- \n\n安装Jenkins。\n\n- \n\n执行以下命令，创建命名空间cicd。\n\nkubectl create ns cicd\n\n\n- \n\n创建NAS共享存储卷。\n\n共享存储卷用于保存Jenkins home中的数据，否则Jenkins Master Pod重启后，Jenkins的所有配置将会丢失。\n\n- \n\n当您选择CSI插件时，创建具体操作，请参见[使用NAS静态存储卷](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/mount-a-statically-provisioned-nas-volume#task-2022002)。\n- \n\n当您选择Flexvolume插件时，创建具体操作，请参见[使用NAS静态存储卷](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/mount-a-statically-provisioned-nas-volume-1#task-1715570)。\n\n- \n\n执行以下命令，将Jenkins部署至cicd命名空间中。\n\nhelm -n cicd install jenkins jenkins/jenkins \\\n  --set persistence.existingClaim=pvc-nas \\\n  --set controller.serviceType=\"LoadBalancer\"   \\\n  --set controller.adminPassword=\"admin\"\n\n\n- \n\npersistence.existingClaim=pvc-nas：必选项，在cicd命名空间下创建的NAS存储卷的PVC名称为pvc-nas。\n- \n\ncontroller.serviceType=\"LoadBalancer\"：可选项，默认为ClusterIP类型。\n- \n\ncontroller.adminPassword=\"admin\"：可选项，默认将生成随机密码。随机密码获取方式请参见[如何通过LoadBalancer访问Jenkins服务以及获取默认随机密码](#section-win-wlh-gvo)。\n\n更多部署相关参数，请参见[helm-charts](https://github.com/jenkinsci/helm-charts)。\n- \n\n执行以下命令，查看并等待Jenkins Pod运行正常。\n\nkubectl -n cicd get po\n\n\n预期输出：\n\nNAME        READY   STATUS    RESTARTS   AGE\njenkins-0   2/2     Running   0          3m3s\n\n\n- \n\n浏览器访问Jenkins服务，并输入用户名和密码登录。\n\n更多信息，请参见[如何通过LoadBalancer访问Jenkins服务以及获取默认随机密码](#section-win-wlh-gvo)。\n\n## 步骤二：创建流水线任务\n\n以创建first-pipeline流水线任务为例，在构建流水线时，Jenkins会默认从当前ACK Serverless集群中动态启动一个Slave Pod并执行构建任务，构建任务执行完毕后会立即释放该Slave Pod。更多Jenkins配置信息，请参见[Jenkins](https://www.jenkins.io/doc/)。\n\n- \n\n登录Jenkins，在左侧导航栏单击New Item。\n- \n\n在Enter an item name区域，输入名称first-pipeline，选择Pipeline类型，然后单击OK。\n- \n\n在页面顶部单击Pipeline页签，选择Hello World模板，然后单击Save。\n- \n\n在页面左侧导航栏中，单击Build Now执行构建。\n- \n\n在页面左侧导航栏中，单击Build History，然后单击1#进入该流水线详情页面，然后单击Console Output即可查看流水线构建结果。\n\n## 如何通过LoadBalancer访问Jenkins服务以及获取默认随机密码\n\n- \n\nJenkins的默认服务类型是ClusterIP类型，如需使用LoadBalancer暴露服务，请执行以下命令。\n\nkubectl -n cicd patch svc jenkins -p '{\"spec\": {\"type\": \"LoadBalancer\"}}'\n\n\n- \n\n如果您在部署Jenkins时未指定登录密码，请执行以下命令，获取Jenkins默认随机密码。\n\nkubectl -n cicd exec  -it svc/jenkins -c jenkins -- /bin/cat /run/secrets/additional/chart-admin-password && echo\n"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/deploy-the-bookinfo-application-in-istio", "page_type": "doc", "title": "在Istio中部署Bookinfo应用", "keywords": "部署Bookinfo应用,验证Bookinfo部署,Bookinfo部署教程,Istio实践教程", "last_modified_ms": 1708914657000, "last_modified_iso": "2024-02-26T10:30:57+08:00", "excerpt": "Istio是一个开源的服务网格，提供流量管理、可观测性，以及安全和策略等能力。在Kubernetes中配合使用Istio，可以帮助您更好地管理和控制容器应用，提高应用程序的性能、安全性和可靠性。本文以Bookinfo应用为例，介绍自建Kubernetes集群通过VNode对接ECI的场景下，如何使用Istio。\n## 背景信息\n\nIstio是一个开源的服务网格（Service Mesh）平台，用于管理微服务之间的流量以及处理各种网络通信和安全问题。Istio可以与Kubernetes集成，提供标准、安全的流量管理，简化部署和运维工作。\n\nBookinfo是一个样例应用，它模仿在线书店的一个目录，可以显示一本书的信息，包括书籍描述，书籍详细信息（ISBN、页数等），以及关于这本书的一些评论。Bookinfo是一个异构应用，由四个使用不同语言编写的微服务组成，可以演示多种Istio特性。Bookinfo包含的四个微服务如下：\n\n- \n\nProductpage：为Python服务，会调用Details和Reviews两个服务，用来生成页面。同时，Productpage还包含登录和登出功能。\n- \n\nDetails：为Ruby服务，包含了书籍的信息。\n- \n\nReviews：为Java服务，包含了书籍相关的评论。Reviews包含3个版本：\n\n- \n\nv1版本不会调用Ratings服务。\n- \n\nv2版本会调用Ratings服务，并使用1到5个黑色星形图标来显示评分信息。\n- \n\nv3版本会调用Ratings服务，并使用1到5个红色星形图标来显示评分信息。\n\n- \n\nRatings：为Node.js服务，包含了由书籍评价组成的评级信息。\n\n更多信息，请参见[Istio Bookinfo](https://istio.io/latest/docs/examples/bookinfo/)。\n## 前提条件\n\n本文适用于自建Kubernetes集群，请确保您的集群满足以下条件：\n\n- \n\n自建Kubernetes集群中已部署VNode。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已打通IDC与阿里云的网络。\n- \n\n如果您的Kubernetes集群部署在ECS上，且使用的网络插件为Flannel，请确保已在集群中部署CCM，保证ECI与标准节点上的Pod可以正常通信。具体操作，请参见[部署CCM](https://help.aliyun.com/zh/eci/user-guide/deploy-the-ccm)。\n\n## 准备工作\n\n- \n\n安装Istio。具体操作，请参见[Istio快速入门](https://istio.io/latest/docs/setup/getting-started/)。\n- \n\n创建Namespace并配置Label。\n\nkubectl create namespace istio-test\nkubectl label namespace istio-test istio-injection=enabled\n\n\n## 操作步骤\n### 部署Bookinfo应用\n\n- \n\n将以下内容保存为bookinfo.yaml。说明 \n\n下述YAML示例中已增加nodeSelector实现将Pod调度到VNode，您也可以配置eci-profile来实现。更多信息，请参见[将Pod调度到VNode](https://help.aliyun.com/zh/eci/user-guide/schedule-pods-to-a-vnode)和[使用eci-profile调度Pod到VNode](https://help.aliyun.com/zh/eci/user-guide/use-eci-profile-to-schedule-pods-to-a-vnode)。\n\n展开查看bookinfo.yaml\n\n# Copyright Istio Authors\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\n\n##################################################################################################\n# This file defines the services, service accounts, and deployments for the Bookinfo sample.\n#\n# To apply all 4 Bookinfo services, their corresponding service accounts, and deployments:\n#\n#   kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml\n#\n# Alternatively, you can deploy any resource separately:\n#\n#   kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml -l service=reviews # reviews Service\n#   kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml -l account=reviews # reviews ServiceAccount\n#   kubectl apply -f samples/bookinfo/platform/kube/bookinfo.yaml -l app=reviews,version=v3 # reviews-v3 Deployment\n##################################################################################################\n\n##################################################################################################\n# Details service\n##################################################################################################\napiVersion: v1\nkind: Service\nmetadata:\n  name: details\n  labels:\n    app: details\n    service: details\nspec:\n  ports:\n  - port: 9080\n    name: http\n  selector:\n    app: details\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: bookinfo-details\n  labels:\n    account: details\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: details-v1\n  labels:\n    app: details\n    version: v1\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: details\n      version: v1\n  template:\n    metadata:\n      labels:\n        app: details\n        version: v1\n    spec:\n      nodeSelector:     #配置特定的nodeSelector\n        k8s.aliyun.com/vnode: \"true\"\n      tolerations:      #配置特定的tolerations\n      - key: "}
{"url": "https://help.aliyun.com/zh/eci/use-cases/obtain-timely-information-about-instances-with-insufficient-storage-space-through-cloud-monitoring", "page_type": "doc", "title": "通过云监控及时获取存储空间不足的实例信息", "keywords": "设置ECI存储空间报警,监控ECI存储空间,ECI存储空间监控,云监控报警规则配置", "last_modified_ms": 1716441494000, "last_modified_iso": "2024-05-23T13:18:14+08:00", "excerpt": "本教程以监控ECI实例的临时存储空间的利用率为例，介绍如何设置云监控的报警规则，以便及时获取临时存储空间不足的实例信息，进而可以及时创建新的实例来替换，避免因存储空间不足而导致数据无法写入，影响业务运行。\n## 背景信息\n\n云监控支持监控ECI实例的CPU利用率、内存利用率、存储空间容量等指标。基于这些指标，您可以设置报警规则，以便及时感知ECI实例的运行情况，并对异常实例进行处理。更多关于云监控支持的ECI监控指标，请参见[使用云监控对ECI实例进行监控](https://help.aliyun.com/zh/eci/user-guide/use-cloud-monitoring-to-monitor-eci-instances)。\n## 操作步骤\n\n- \n\n登录[云监控控制台](https://cloudmonitornext.console.aliyun.com/)。\n- \n\n在左侧导航栏，选择报警服务 > 报警规则。\n- \n\n单击创建报警规则。\n- \n\n在弹出面板完成报警规则配置，然后单击确认。\n\n需要注意的参数如下，未提及的参数可保持默认配置。更多关于报警规则的配置说明，请参见[创建报警规则](https://help.aliyun.com/zh/cms/cloudmonitor-1-0/user-guide/create-an-alert-rule)。\n\n[表格]\n\n参数\n\n说明\n\n产品\n\n选择弹性容器实例ECI。\n\n资源范围\n\n报警规则作用的资源范围。本教程选择实例。\n\n- \n\n全部资源：报警规则作用于指定云产品的全部资源上，对于新加入的资源生效。\n- \n\n应用分组：报警规则作用于指定云产品的指定应用分组内的全部资源上，对于新加入的资源生效。\n- \n\n实例：报警规则作用于指定云产品的指定资源上。\n\n关联资源\n\n当资源范围选择实例时，可指定具体的ECI实例。\n\n单击添加实例，在弹出的对话框中选择要监控的ECI实例。\n\n规则描述\n\n单击添加规则，选择简单指标，在弹出面板完成规则配置。\n\n本教程采用的规则示例如下：\n\n- \n\n规则名称：test\n- \n\n指标类型：简单指标\n- \n\n监控指标：volume/存储卷空间利用率\n- \n\n阈值及报警级别\n\n- \n\n紧急：连续3个周期（1周期=1分钟），平均值≥90\n- \n\n警告：连续3个周期（1周期=1分钟），平均值≥80\n- \n\n普通：连续3个周期（1周期=1分钟），平均值≥70\n\n- \n\n维度：EphemeralVolume\n\n关于如何设置复杂的报警条件，请参见[报警规则表达式说明](https://help.aliyun.com/zh/cms/cloudmonitor-1-0/user-guide/alert-rule-expressions#concept-2276873)。\n\n报警联系人组\n\n云监控默认将您的阿里云账号添加为报警联系人，并自动为其创建报警联系组。\n\n您也可以前往[报警联系人](https://cloudmonitornext.console.aliyun.com/alert/contact)页面创建新的报警联系人和报警联系人组。更多信息，请参见[创建报警联系人或报警联系人组](https://help.aliyun.com/zh/cms/cloudmonitor-1-0/user-guide/create-an-alert-contact-or-alert-contact-group#task-2514452)。\n\n## 后续操作\n\n创建报警规则后，如果规则中设置的监控指标达到了报警阈值，系统会自动给设置的联系人发送通知。\n\n短信通知示例如下：\n\n您也可以在报警规则页面找到目标规则，单击报警历史来查看报警情况。\n\n收到报警通知后，请根据实际业务需求进行处理，例如：创建新的ECI实例并增加临时存储空间，以此来替换旧的存储空间不足的ECI实例。\n## 相关文档\n\n如果您通过Kubernetes集群使用ECI，可以为ECI Pod添加k8s.aliyun.com/eci-eviction-enable: \"true\"的Annotation，实现在某一ECI Pod的临时存储空间不足（低于100 MiB）时，自动驱逐该Pod。具体操作，请参见[设置自动驱逐临时存储空间不足的Pod](https://help.aliyun.com/zh/eci/automatically-evict-pods-whose-temporary-storage-spaces-are-insufficient)。\n"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/query-the-creation-and-deletion-information-of-elastic-container-instances-in-actiontrail", "page_type": "doc", "title": "通过操作审计服务查询实例创建和删除信息", "keywords": "查询ECI实例创建删除,审计ECI实例操作记录,ECI实例操作审计", "last_modified_ms": 1729579406000, "last_modified_iso": "2024-10-22T14:43:26+08:00", "excerpt": "通过操作审计的事件查询功能，您可以按照事件类型（例如创建实例、删除实例等）、资源名称（ECI实例ID）等条件查询关于ECI实例的操作事件。本文介绍如何通过操作审计服务查询ECI实例的创建、删除等信息。\n\n## 背景信息\n\n操作审计（ActionTrail）是阿里云提供的云账号资源操作记录的查询和投递服务，可用于安全分析、资源变更追踪以及合规性审计等场景。更多信息，请参见[什么是操作审计](https://help.aliyun.com/zh/actiontrail/product-overview/what-is-actiontrail)。\n\n## 操作步骤\n\n- \n\n登录[操作审计控制台](https://actiontrail.console.aliyun.com/)。\n- \n\n在左侧导航栏，选择事件 > 事件查询。\n- \n\n在顶部菜单栏，选择地域。\n- \n\n设置查询条件，查询操作事件。\n\n例如，如果您想要了解某个ECI实例创建和删除的具体时间，可按如下条件查询关于该实例的所有操作事件。\n\n- \n\n查询类型选择关联资源名称，然后输入ECI实例ID。说明 \n\n您可以至[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/list)的容器组页面获取实例ID。对于已经删除的ECI实例，如果您不知道实例ID，可先按事件名称查询ECI实例删除事件（DeleteContainerGroup），然后在查询结果的资源名称列获取ECI实例ID。\n- \n\n根据ECI实例存在的时间段，设置查询时间范围。说明 \n\n事件查询功能支持查询90天内的操作事件。如果您想要查询90天以上的操作事件，可使用事件高级查询功能。更多信息，请参见[高级查询事件](https://help.aliyun.com/zh/actiontrail/use-advanced-event-query-feature-to-query-events)。\n\n- \n\n查看事件信息。\n\n事件相关说明如下：\n\n- \n\n每条事件默认显示以下信息：\n\n- \n\n事件发生时间：该操作发生的时间。\n- \n\n操作者名称：发起该操作的对象，可以是阿里云账号、RAM用户或者阿里云服务。\n- \n\n云服务名称：阿里云服务名称。\n- \n\n事件名称：对应操作行为，例如：CreateContainerGroup表示创建ECI实例，DeleteContainerGroup表示删除ECI实例。\n- \n\n关联资源：被操作资源信息。\n\n- \n\n单击查看事件详情可以查看更多事件信息，包括事件源、错误码、API请求ID、事件记录等。如\n说明 \n\n关于事件中各字段的更多信息，请参见[管控事件结构定义](https://help.aliyun.com/zh/actiontrail/user-guide/management-event-structure)。\n"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/release-and-deployment-management-of-container-service-based-on-auto", "page_type": "doc", "title": "基于弹性伸缩和云效实现容器服务的发布部署管理", "keywords": "实现容器服务发布部署,集成云效与弹性伸缩,容器服务发布部署实践,容器服务CI/CD", "last_modified_ms": 1736851104000, "last_modified_iso": "2025-01-14T18:38:24+08:00", "excerpt": "对于容器服务构建的应用场景，例如不依赖K8s、OpenShift等容器编排的场景，您可以通过基于弹性伸缩和云效来实现容器服务发布部署管理。\n## 前提条件\n\n- \n\n已注册阿里云账号。如果还未注册，请先[注册阿里云账号](https://account.aliyun.com/register/register.htm?)。说明 \n\n如果您使用RAM用户，您还需要为RAM用户授予镜像服务的权限。具体操作，请参见[RAM授权信息](https://help.aliyun.com/zh/acr/user-guide/ram-authorization-information#task-2092160)。\n- \n\n已开通容器镜像服务ACR企业版。更多信息，请参见[创建企业版实例](https://help.aliyun.com/zh/acr/user-guide/create-a-container-registry-enterprise-edition-instance#task488)。\n- \n\n已开通弹性伸缩服务。更多信息，请参见[管理弹性伸缩服务关联角色](https://help.aliyun.com/zh/auto-scaling/getting-started/manage-the-service-linked-role-for-auto-scaling#task-1961226)。\n- \n\n已开通云效服务功能。更多信息，请参见[快速登录/创建组织](https://help.aliyun.com/zh/yunxiao/getting-started/quick-login-create-enterprise#topic-2081585)。\n\n## 背景信息\n\n您可以通过弹性伸缩和云效对容器服务进行发布部署管理。其中，弹性伸缩和云效产品分别提供以下不同能力，具体说明如下：\n\n- \n\n弹性伸缩提供了弹性管理能力。\n\n例如，使用该产品可以实现容器实例的分组管理、弹性伸缩、滚动升级等功能，方便您弹性管理容器服务场景的应用。\n- \n\n云效提供了一站式管理服务能力。\n\n例如，使用该产品可以一键进行代码编译、测试、镜像构建、镜像上传、伸缩配置镜像更新等，方便您快捷地管理容器服务场景的应用。\n\n## 概念介绍\n\n[表格]\n\n概念\n\n说明\n\n[云效](https://help.aliyun.com/zh/yunxiao/product-overview/what-is-cloud-effect#b3a83f905e9f1)\n\n是云原生时代一站式BizDevOps平台，产研数字化同行者，支持公共云、专有云和混合云多种部署形态，通过云原生新技术和研发新模式，助力数字化转型企业快速实现产研数字化能力。\n\n[云效流水线](https://help.aliyun.com/zh/yunxiao/user-guide/what-is-the-pipeline#main-2277561)\n\n是一款企业级、自动化的持续集成和持续交付工具，通过构建自动化、集成自动化、验证自动化、部署自动化，完成从开发到上线的CI/CD全流程。\n\n[弹性容器实例ECI](https://help.aliyun.com/zh/eci/product-overview/what-is-elastic-container-instance#topic-1860079)\n\n是敏捷安全的Serverless容器运行服务。您无需管理底层服务器，也无需关心运行过程中的容量规划，只需要提供打包好的Docker镜像，即可运行容器，并仅为容器实际运行消耗的资源付费。\n\n[容器镜像服务ACR](https://help.aliyun.com/zh/acr/product-overview/what-is-container-registry#concept-2058233)\n\n是面向容器镜像、Helm Chart等符合OCI标准的云原生制品安全托管及高效分发平台。\n## 步骤一：创建阿里云容器镜像仓库\n\n- \n\n登录[容器镜像服务控制台](https://cr.console.aliyun.com/cn-hangzhou/instances)。\n- \n\n创建容器镜像实例。\n\n- \n\n在顶部菜单栏，选择地域。\n- \n\n在实例列表页面，单击创建企业版实例。说明 \n\n本步骤以创建企业版实例为例，关于企业版实例与个人版实例的区别，更多信息，请参见[个人版和企业版实例差异化说明](https://help.aliyun.com/zh/acr/product-overview/differences-between-personal-edition-instances-and-enterprise-edition-instances#task-2273273)。\n- \n\n在容器镜像服务页面，完成参数配置，然后单击立即购买。\n\n主要配置项参数说明如下所示，其他参数保持默认值。\n\n[表格]\n\n配置项\n\n说明\n\n示例\n\n实例规格\n\n选择实例规格。\n\n基础版\n\n实例名称\n\n输入实例名称。\n\neci-autoscaling\n\n购买时长\n\n目前支持选择1个月、2个月、3个月、6个月和1~5年。说明 \n\n您还可以设置是否到期自动续费。\n\n1个月\n- \n\n在确认订单页面，确认订单并选中我已阅读并同意容器镜像服务服务协议，单击去支付。\n- \n\n在支付页面底部查看实例的总费用，如无疑问，根据提示完成支付。\n\n返回管理控制台后，在实例列表页面，您可以看到新建企业版实例的运行状态为启动中。说明 \n\n首次购买企业版实例时，请您耐心等待大约2到3分钟后，待企业版实例启动完成（即状态变为运行中）后，再进行后续操作。\n\n- \n\n单击已创建的企业版实例（eci-autoscaling），进入实例概览页面。\n- \n\n在左侧导航栏，选择仓库管理 > 镜像仓库，然后单击创建镜像仓库。\n- \n\n在创建镜像仓库页面的仓库信息区域，完成相关参数配置，单击下一步。\n\n主要参数配置项说明如下所示，其余参数项保持默认即可。\n\n[表格]\n\n配置项\n\n说明\n\n示例\n\n命名空间\n\n如果未创建命名空间，先创建后再选择该命名空间。具体操作，请参见[步骤二：创建命名空间](https://help.aliyun.com/zh/acr/getting-started/build-images-on-container-registry-enterprise-edition-instances#section-m0h-3y9-s89)。\n\neci_autoscaling_namespace\n\n仓库名称\n\n长度为2~120个字符，由小写英文字母、数字、分隔符、下划线（_）、短划线（-）、半角句号（.）、正斜线（/）组成。\n\neci_autoscaling_repo\n\n仓库类型\n\n支持公开和私有两种仓库类型。\n\n私有\n\n摘要\n\n简要描述创建镜像仓库的用途即可。\n\ntest\n- \n\n在代码源区域，代码源选择本地仓库，然后单击创建镜像仓库。\n- \n\n在镜像仓库的基本信息页面，单击公网地址后的请先开启访问控制的网络入口。\n- \n\n在实例的访问控制页面，单击公网页签，开启访问入口，然后单击确定。\n\n开启公网访问入口默认会添加一条白名单，且仅白名单内地址能够访问实例的公网域名。\n- \n\n在默认添加的白名单的操作列，单击删除。\n\n删除该默认白名单后，公网下的服务器均可以通过凭证访问企业版实例。例如，后续云效通过访问该地址来构建上传镜像。\n\n## 步骤二：通过云效服务创建流水线\n\n- \n\n登录[云效流水线控制台](https://flow.aliyun.com/my?page=1)。\n\n首次登录控制台时，根据页面提示创建企业（企业名称以eci_autoscaling_example为例）。\n- \n\n在我的流水线页面，单击新建流水线。说明 \n\n首次登录云效流水线控制台时，您也可以在弹出的流水线对话框，单击立即新建来新创建流水线。\n- \n\n在选择流水线模板页面，根据您的开发语言和部署场景，选择合适的流水线模板，单击创建完成一条流水线创建。\n\n本步骤以选择Java · 测试、构建镜像为例。\n\n- \n\n在页面左上方，设置流水线名称为构建镜像流水线，再单击添加流水线源并完成代码源相关参数，然后单击添加。\n\n本步骤以代码源选择示例代码源，代码类型选择JAVA为例。\n\n- \n\n在构建镜像区域，单击阿里云镜像构建，单击编辑面板中的图标，然后单击确定。\n\n在构建镜像区域，阿里云镜像构建默认为阿里云镜像构建个人版。因为[步骤一：创建阿里云容器镜像仓库](#section-8ps-iip-zgp)中创建的镜像为企业版，所以您需要先删除阿里云镜像构建个人版，然后再创建阿里云镜像构建企业版。\n- \n\n在新阶段区域，单击新的任务，在弹出的面板左侧，选择镜像构建 > 阿里云镜像构建企业版，在编辑面板的任务步骤区域，单击镜像构建并推送至阿里云镜像仓库企业版，配置如下参数。\n\n参数示例如下图所示：\n\n- \n\n单击保存并运行，在弹出的运行配置对话框，单击运行。\n\n运行大约需要2~3分钟时间，请您耐心等待。阿里云镜像企业版构建完成后，如下图所示：\n- \n\n进入已创建的企业版实例（eci-autoscaling）页面，选择仓库管理 > 镜像仓库，单击镜像仓库（eci_autoscaling_repo）对应操作列的管理。\n- \n\n在左侧导航栏，单击镜像版本，确认镜像已构建成功。\n\n## 步骤三：基于构建镜像创建ECI类型伸缩组\n\n- \n\n登录[弹性伸缩控"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/run-a-gpu-based-tensorflow-training-job", "page_type": "doc", "title": "使用ECI运行TensorFlow任务", "keywords": "在ECI上运行TensorFlow,用ECI加速AI训练,ECI运行TensorFlow实践,ECI的AI应用场景", "last_modified_ms": 1707184642000, "last_modified_iso": "2024-02-06T09:57:22+08:00", "excerpt": "您可以将AI训练任务所需的软件环境容器化，然后在ECI上执行训练任务，在解决环境搭建复杂问题的同时，可以只为运行时间付费，从而降低成本，提升效率。本文以一个Github上基于GPU的TensorFlow训练任务为例，介绍如何基于ACK Serverless集群，使用ECI来运行训练任务。\n## 背景信息\n\n近些年来，人工智能与机器学习已经被广泛应用到各个领域，各种各样的训练模型被提出，更多的训练任务运行到云上。然而上云之后，想要轻松、持久地运行训练任务，仍有一些痛点，例如：\n\n- \n\n环境搭建麻烦：需要购买GPU实例并安装GPU驱动，即使已经把训练任务容器化，仍需要安装GPU Runtime Hook 。\n- \n\n使用缺乏弹性：运行完任务后，为了节约成本一般需要释放资源，但在下次启动任务时需要重新创建实例并配置环境；或者在计算节点资源不足的情况下，需要手动扩容并重新创建实例并配置环境。\n\n针对上述痛点，推荐您使用ACK Serverless集群+ECI的方案来运行训练任务。该方案具备以下优势：\n\n- \n\n按需付费，免运维。\n- \n\n一次配置，无限次复用。\n- \n\n镜像缓存功能加速实例创建，训练任务启动快速。\n- \n\n数据与训练模型解耦，数据可以持久化存储。\n\n## 准备工作\n\n- \n\n准备训练数据和容器镜像。\n\n- \n\n训练数据：本文以Github的一个TensorFlow训练任务为例。更多信息，请参见[TensorFlow训练任务](https://github.com/tensorflow/models?spm=ata.13261165.0.0.4e0c9e6eiEsp0z)。\n- \n\n容器镜像：ECI已准备好适用的示例镜像，示例镜像已上传到阿里云容器镜像仓库ACR中，您可以直接使用或进行二次开发。\n\n- \n\n镜像私网地址：registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/tensorflow:1.0\n- \n\n镜像公网地址：registry.cn-hangzhou.aliyuncs.com/eci_open/tensorflow:1.0\n\n- \n\n创建ACK Serverless集群。\n\n在[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.2.16.61a036c8iieu29&amp;accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)上创建ACK Serverless集群。具体操作，请参见[创建ACK Serverless集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/getting-started/ask-quick-start#task-e3c-311-ydb)。重要 \n\n如果您需要通过公网拉取镜像，或者训练任务需要访问公网，请配置公网NAT网关。\n\n您可以通过kubectl管理和访问ACK Serverless集群，相关操作如下：\n\n- \n\n如果您需要通过本地计算机管理集群，请安装并配置kubectl客户端。具体操作，请参见[通过kubectl连接Kubernetes集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/connect-to-an-ack-cluster-by-using-kubectl#task-msl-bc1-ydb)。\n- \n\n您也可以在CloudShell上通过kubect管理集群。具体操作，请参见[在CloudShell上通过kubectl管理Kubernetes集群](https://help.aliyun.com/zh/ack/use-kubectl-on-cloud-shell-to-manage-ack-clusters#task-1962399)。\n\n- \n\n创建NAS文件系统，并添加挂载点。\n\n在[NAS文件系统控制台](https://nasnext.console.aliyun.com/overview)上创建文件系统，并添加挂载点。NAS文件系统需和ACK Serverless集群处于同一VPC。具体操作，请参见[管理文件系统](https://help.aliyun.com/zh/nas/user-guide/create-a-file-system#task-27530-zh)和[管理挂载点](https://help.aliyun.com/zh/nas/user-guide/manage-mount-targets#task-27531-zh)。\n\n## 操作步骤\n### 创建镜像缓存\n\n镜像缓存功能已经通过Kubernetes CRD的方式集成到ACK Serverless集群中，可以用于加速镜像拉取。\n\n- \n\n创建镜像缓存的YAML文件。\n\n示例imagecache.yaml的内容如下：说明 \n\n如果您的集群属于华东1（杭州）地域，建议通过镜像私网地址拉取镜像，如果您的集群属于其他地域，可参考示例通过镜像公网地址拉取镜像，\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: tensorflow\nspec:\n  images:\n  - registry.cn-hangzhou.aliyuncs.com/eci_open/tensorflow:1.0\n\n\n- \n\n创建镜像缓存。\n\nkubectl create -f imagecache.yaml\n\n\n创建镜像缓存时需要拉取镜像，受镜像大小和网络的影响，需要一定的时间。您可以通过以下命令查询镜像缓存的创建进度。\n\nkubectl get imagecache tensorflow\n\n\n返回类似如下结果时，表示镜像缓存已经创建成功。\n\n### 创建训练任务\n\n- \n\n创建NAS文件系统对应的PV和PVC。\n\n- \n\n准备YAML文件。\n\n示例nas.yaml的内容如下：\n\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: pv-nas\n  labels:\n    alicloud-pvname: pv-nas\nspec:\n  capacity:\n    storage: 100Gi\n  accessModes:\n    - ReadWriteMany\n  csi:\n    driver: nasplugin.csi.alibabacloud.com\n    volumeHandle: pv-nas\n    volumeAttributes:\n      server: 15e1d4****-gt***.cn-beijing.nas.aliyuncs.com    # NAS文件系统挂载点\n      path: /\n  mountOptions:\n    - nolock,tcp,noresvport\n    - vers=3\n---\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: pvc-nas\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 100Gi\n  selector:\n    matchLabels:\n      alicloud-pvname: pv-nas\n\n\n- \n\n创建PV和PVC。\n\nkubectl create -f nas.yaml\n\n\n- \n\n创建ECI Pod来运行训练任务。\n\n- \n\n准备YAML文件。\n\n示例tensorflow.yaml的内容如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: tensorflow\n  labels:\n    app: tensorflow\n    alibabacloud.com/eci: \"true\"\n  annotations:\n    k8s.aliyun.com/eci-use-specs: \"ecs.gn6i-c4g1.xlarge\"   # 指定GPU规格\n    k8s.aliyun.com/eci-auto-imc: \"true\"                    # 开启自动匹配镜像缓存\nspec:\n  restartPolicy: OnFailure\n  containers:\n    - name: tensorflow\n      image: registry.cn-hangzhou.aliyuncs.com/eci_open/tensorflow:1.0  # 使用镜像缓存对应的镜像地址\n      command:\n        - python\n      args:\n        - /home/classify_image/classify_image.py      # 容器启动后执行训练脚本\n      resources:\n        limits:\n          nvidia.com/gpu: \"1\"   # 容器所需的GPU个数\n      volumeMounts:   "}
{"url": "https://help.aliyun.com/zh/eci/use-cases/run-an-argo-workflow", "page_type": "doc", "title": "使用ECI运行Argo工作流", "keywords": "在ECI上运行Argo工作流,优化Argo on ECI任务,ECI运行Argo工作流实践,Argo on ECI性能优化,Argo on ECI成本优化", "last_modified_ms": 1741832577000, "last_modified_iso": "2025-03-13T10:22:57+08:00", "excerpt": "Serverless K8s支持Pod粒度的弹性，具有秒级启动、秒级计费、2000每分钟的并发等优势，因此越来越多的用户开始使用Serverless K8s来运行Argo。本文介绍如何基于ACK集群，使用ECI运行Argo工作流。\n## 搭建Kubernetes+Argo环境\n\n- \n\n搭建阿里云Serverless K8s集群。\n\n- \n\n（推荐）创建ACK Serverless集群。具体操作，请参见[创建集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/create-an-ask-cluster-2)。\n- \n\n创建ACK集群，并部署ack-virtual-node组件生成虚拟节点。具体操作，请参见[创建ACK托管集群](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/create-an-ack-managed-cluster-2/)和[通过虚拟节点将Pod调度到ECI上运行](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/deploy-the-virtual-node-controller-and-use-it-to-create-elastic-container-instance-based-pods)。\n\n- \n\n在Kubernetes集群中部署Argo。\n\n- \n\n（推荐）安装ack-workflow组件。具体操作，请参见[Argo Workflows](https://help.aliyun.com/zh/ack/product-overview/argo-workflows)。\n- \n\n自行部署Argo。具体操作，请参见[Argo Quick Start](https://argoproj.github.io/argo-workflows/quick-start/)。\n\n- \n\n安装Argo命令。具体操作，请参见[argo-workflows](https://github.com/argoproj/argo-workflows/releases)。\n\n## 优化基础资源配置\n\n默认情况下，完成Argo部署后，argo-server和workflow-controller这两个核心组件并没有指定对应Pod的resources，这会导致这两个组件对应Pod的QoS级别较低，在集群资源不足时会出现组件OOM Kill、Pod被驱逐的情况。因此，建议您根据自身集群规模调整上述两个组件对应Pod的resources，建议其requests或limits设置在2 vCPU，4 GiB内存及以上。\n## 使用OSS作为artifacts仓库\n\n默认情况下，Argo使用minio作为artifacts仓库，在生产环境中则需要考虑artifacts仓库的稳定性，ack-workflow支持使用OSS作为artifacts仓库。关于如何配置OSS作为artifacts仓库，请参见[Configuring Alibaba Cloud OSS](https://argoproj.github.io/argo-workflows/configure-artifact-repository/#configuring-alibaba-cloud-oss-object-storage-service)。\n\n配置成功后，您可以使用以下示例创建Wokrflow进行验证。\n\n- \n\n将以下内容保存为workflow-oss.yaml。\n\napiVersion: argoproj.io/v1alpha1\nkind: Workflow\nmetadata:\n  generateName: artifact-passing-\nspec:\n  entrypoint: artifact-example\n  templates:\n  - name: artifact-example\n    steps:\n    - - name: generate-artifact\n        template: whalesay\n    - - name: consume-artifact\n        template: print-message\n        arguments:\n          artifacts:\n          # bind message to the hello-art artifact\n          # generated by the generate-artifact step\n          - name: message\n            from: \"{{steps.generate-artifact.outputs.artifacts.hello-art}}\"\n\n  - name: whalesay\n    container:\n      image: docker/whalesay:latest\n      command: [sh, -c]\n      args: [\"cowsay hello world | tee /tmp/hello_world.txt\"]\n    outputs:\n      artifacts:\n      # generate hello-art artifact from /tmp/hello_world.txt\n      # artifacts can be directories as well as files\n      - name: hello-art\n        path: /tmp/hello_world.txt\n\n  - name: print-message\n    inputs:\n      artifacts:\n      # unpack the message input artifact\n      # and put it at /tmp/message\n      - name: message\n        path: /tmp/message\n    container:\n      image: alpine:latest\n      command: [sh, -c]\n      args: [\"cat /tmp/message\"]\n\n\n- \n\n创建Workflow。\n\nargo -n argo submit workflow-oss.yaml\n\n\n- \n\n查看Workflow的执行结果。\n\nargo -n argo list\n\n\n预期返回：\n\n## 选择Executor\n\nArgo创建的每个工作Pod中至少会有以下两个容器：\n\n- \n\nmain容器\n\n实际的业务容器，真正运行业务逻辑。\n- \n\nwait容器\n\nArgo的系统组件，以Sidecar的形式注入到Pod内。其核心作用如下：\n\n- \n\n启动阶段\n\n- \n\n加载main容器依赖的artifacts、inputs。\n\n- \n\n运行阶段\n\n- \n\n等待main容器退出，Kill关联的Sidecars容器。\n- \n\n收集main容器的outputs、artifacts，上报main容器状态\n\nExecutor是wait容器访问和控制main容器的“桥梁”，Argo将其抽象为ContainerRuntimeExecutor，其接口定义如下： \n\n- \n\nGetFileContents：获取main容器的输出参数（outputs/parameters）。\n- \n\nCopyFile：获取main容器的产物（outputs/artifacts）。\n- \n\nGetOutputStream：获取main的标准输出（含标准错误）。\n- \n\nWait：等待main容器退出。\n- \n\nKill：Kill关联的Sidecar容器。\n- \n\nListContainerNames：列举Pod内容器的名称列表。\n\n目前Argo已支持多种Executor，其工作原理不同，但都是针对原生K8s架构设计的。由于阿里云Serverless K8s与原生K8s在架构上存在差异，因此需要选择合适的Executor。建议您选择Emisarry作为Serverless K8s场景运行Argo的Executor，相关说明如下：\n\n[表格]\n\nExecutor\n\n说明\n\nEmisarry\n\n通过EmptyDir共享文件的方式实现相关能力，依赖EmptyDir。\n\n由于该Executor仅依赖标准能力EmptyDir，无其他依赖，因此推荐使用该Executor。\n\nKubernetes API\n\n通过Kubernetes API方式实现相关功能，依赖Kubernetes API但功能不完整。\n\n由于该Executor功能不完整，且在大规模场景中会给K8s控制层面带来压力，影响集群规模，因此不推荐使用该Executor。\n\nPNS\n\n基于Pod内的PID共享和chroot实现相关功能，会污染Pod的进程空间，并且依赖特权。\n\n由于Serverless K8s具有更高的安全隔离性，不支持使用特权，因此无法使用该Executor。\n\nDocker\n\n通过Docker CLI实现相关功能，依赖底层容器运行时Docker。\n\n由于Serverless K8s没有"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/run-jobs-on-a-preemptible-instance", "page_type": "doc", "title": "使用抢占式ECI实例运行Job任务", "keywords": "运行抢占式ECI Job,配置抢占式ECI Job,抢占式ECI Job实践,抢占式ECI回收机制", "last_modified_ms": 1717394035000, "last_modified_iso": "2024-06-03T13:53:55+08:00", "excerpt": "ECI支持抢占式实例，对于短时间运行的Job任务，以及部分扩展性和容错率高的无状态应用（例如可弹性伸缩的Web站点服务），使用抢占式实例可以有效地节约实例使用成本。本文以Job任务为例，演示如何创建抢占式实例类型的ECI Pod来运行Job任务。\n## 背景信息\n\n使用抢占式实例前，请了解以下相关信息：\n\n- \n\n计费方式\n\n抢占式实例的市场价格随供需变化而浮动，您需要在创建抢占式实例时指定出价模式，当指定实例规格的实时市场价格低于出价且库存充足时，就能成功创建抢占式实例。创建成功后，在保护期（默认1小时）内按照成交时的市场价格计费。超过保护期后，按照实时的市场价格计费。\n- \n\n回收机制\n\n超过保护期后，系统每隔5分钟将自动检测一次实例规格的市场价格和库存。如果某一时刻的市场价格高于出价或实例规格库存不足，抢占式实例会被释放。在释放前约5分钟，ECI会通过Kubernetes Events事件通知的方式告知您。在此期间，您可以做一定的处理来确保业务不受实例释放所影响（如切断该实例的业务入口流量）。\n- \n\n创建方式\n\n支持指定ECS规格，或者指定vCPU和内存来创建抢占式ECI实例。\n- \n\n配置方法\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-spot-strategy的Annotation来创建抢占式实例。该Annotation用于设置抢占式实例的出价策略，\n\n取值如下：\n\n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格。\n- \n\nSpotWithPriceLimit：自定义设置抢占实例价格上限。如果选择该策略，需添加k8s.aliyun.com/eci-spot-price-limit的Annotation来设置抢占式实例的每小时价格上限。\n\n更多信息，请参见[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-1)。\n## 操作步骤\n\n在Kubernetes中，Job负责批量处理短暂的一次性任务。使用抢占式实例运行Job任务的配置示例如下：\n\n- \n\n准备Job的配置文件，命名为spot_job.yaml。\n\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pi\nspec:\n  template:\n    metadata:\n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.c5.large,2-4Gi # 指定多个规格，提升实例创建成功率\n        k8s.aliyun.com/eci-spot-strategy: SpotAsPriceGo    # 系统自动出价，跟随当前市场实际价格\n    spec:\n      containers:\n      - name: pi\n        image: registry-vpc.cn-beijing.aliyuncs.com/ostest/perl\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n      restartPolicy: Never\n\n\n- \n\n创建Job。\n\nkubectl create -f spot_job.yaml\n\n\n- \n\n查看Pod运行情况。\n\nkubectl get pod\n\n\n- \n\n如果Job任务正在运行，对应Pod状态为Running。\n\nNAME       READY   STATUS      RESTARTS   AGE\npi-frmr8   1/1     Running     0          35s\n\n\n- \n\n如果Job任务正常运行完成，对应Pod状态会变更为Completed。\n\nNAME       READY   STATUS      RESTARTS   AGE\npi-frmr8   0/1     Completed   0          2h\n\n\n- \n\n如果Job任务还未运行完成，对应Pod由于抢占式实例的回收机制被释放了，Kubernetes中的Job Controller会自动创建新的Pod来继续运行任务。\n\n此时仍会保留旧的Pod，该Pod状态会变更为BidFailed。说明 \n\n抢占式实例创建成功后，在保护期内可以正常运行。超出保护期后，如果市场价格高于出价或者资源库存不足，抢占式实例会被释放。抢占式实例在释放前约5分钟，会产生预释放事件（SpotToBeReleased），您可以查看事件信息获取。更多信息，请参见[释放说明](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-1#6f730540ffiky)。\n\nNAME       READY   STATUS      RESTARTS   AGE\npi-frmr8   1/1     BidFailed   0          4h53m\npi-kp5zx   1/1     Running     0          3h45m\n"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/self-built-kubernetes-cluster-on-ecs-to-access-vnode-quickly", "page_type": "doc", "title": "ECS上自建Kubernetes集群快速接入VNode", "keywords": "为自建K8s集成VNode,打通ECI Pod网络,自建K8s接入ECI实践,VNode集成操作指南", "last_modified_ms": 1743055296000, "last_modified_iso": "2025-03-27T14:01:36+08:00", "excerpt": "在阿里云ECS上自建了Kubernetes集群并需要接入ECI服务时，您需要在集群中部署虚拟节点（VNode）。本文介绍在同一VPC下，ECS上自建的Kubernetes集群如何快速接入VNode，以便使用ECI。\n## 背景信息\n\nECI支持无缝集成Kubernetes，可以为Kubernetes提供一种层次化的解决方案：即ECI负责底层Pod容器资源的调度和管理工作，Kubernetes在ECI之上作为PaaS层来管理业务负载。如果您在阿里云ECS上自建了Kubernetes集群，可以通过部署虚拟节点（VNode）的方式来使用ECI。更多信息，请参见[自建Kubernetes集群对接ECI](https://help.aliyun.com/zh/eci/user-guide/overview-3)。\n## 前提条件\n\n- \n\n已在ECS上通过kubeadm自建了Kubernetes集群，且集群的版本属于1.13～1.30版本。\n- \n\n集群中已部署Flannel、Calico或Cilium网络插件。\n\n## 安装VNodectl\n\n为了能够方便地接入和管理VNode，ECI提供了VNodectl命令行工具。建议您将VNodectl安装在Kubernetes集群的master节点上。\n\n- \n\n连接集群。\n- \n\n下载安装包。\n\nwget https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_linux_amd64.tar.gz -O vnodectl.tar.gz \n\n\n- \n\n解压安装包。\n\ntar xvf vnodectl.tar.gz \n\n\n- \n\n复制vnodectl到指定目录。\n\ncp vnodectl /usr/local/bin/vnode\n\n\n## 配置~/.vnode/config文件\n\n- \n\n修改~/.vnode/config文件内容。\n\nvim ~/.vnode/config\n\n\n请根据实际修改~/.vnode/config文件内容，以下为示例：重要 \n\n- \n\nkubeconfig需具有cluster-admin权限。如果您想要使用更小权限的kubeconfig，请参见[配置集群](https://help.aliyun.com/zh/eci/user-guide/use-vnodectl-to-connect-a-vnode-to-a-self-managed-kubernetes-cluster#bd9ae6c07b0fl)。\n- \n\n请确保使用的kubeconfig文件中的apiserver地址能被Vnode访问。\n\nkind: vnode\ncontexts:\n    - name: default                                          # context名称\n      region-id: cn-hangzhou                                 # 地域ID\n      access-key-id: <yourAccessKeyID>                       # AccessKey ID\n      access-key-secret: <yourAccessKeySecret>               # AccessKey Secret，\n      vswitch-id: vsw-7xv2yk45qp5etidgf****                  # VNode所属交换机ID\n      security-group-id: sg-7xv5tcch4kjdr65t****             # VNode所属安全组ID\n      kubeconfig: /path/to/kubeconfig                        # 集群kubeconfig文件\ncurrent-context: default\n\n\n- \n\n使VNode运行加载context下的配置。\n\nvnode config set-context <context-name>\n\n\n## 创建Vnode\n\n- \n\n创建一个VNode。\n\nvnode create\n\n\n返回示例如下，其中VirtualNodeId的值即为生成的VNode的ID。\n\n{\"RequestId\":\"AB772F9D-2FEF-5BFD-AAFB-DA3444851F29\",\"VirtualNodeId\":\"vnd-7xvetkyase7gb62u****\"}\n\n\n- \n\n查看节点信息。\n\nkubectl get node\n\n\n返回示例如下，可以看到集群中已接入VNode。\n\nNAME                                    STATUS     ROLES                  AGE    VERSION\ncn-hangzhou.vnd-7xvetkyase7gb62u****    Ready      agent                  174m   v1.20.6\nvnode-test001                           Ready      control-plane,master   23h    v1.20.6\nvnode-test002                           Ready      <none>                 22h    v1.20.6\n\n\n## 禁止DaemonSet调度到VNode\n\n由于VNode不是真实节点，因此无法运行DaemonSet。创建VNode后，您需要修改kube-proxy的DaemonSet，配置nodeAffinity来禁止DaemonSet调度到VNode。\n\n- \n\n修改DaemonSet配置。\n\nkubectl -n kube-system edit ds kube-proxy\n\n\n- \n\n配置nodeAffinity。\n\n在spec>template>spec下添加以下YAML：\n\naffinity:\n  nodeAffinity:\n    requiredDuringSchedulingIgnoredDuringExecution:\n      nodeSelectorTerms:\n      - matchExpressions:\n        - key: type\n          operator: NotIn\n          values:\n          - virtual-kubelet\n\n\n## 调度Pod到VNode\n\n创建VNode后，您可以通过以下方式将Pod调度到VNode上，以使用ECI来运行Pod。\n\n- \n\n手动调度\n\n通过配置nodeSelector和tolerations、指定nodeName的方式，可以手动将Pod调度到VNode。具体操作，请参见[将Pod调度到VNode](https://help.aliyun.com/zh/eci/user-guide/schedule-pods-to-a-vnode#topic-2145262)。\n- \n\n自动调度\n\n部署eci-profile组件后，可以自定义配置Selector，将满足条件的Pod自动调度到VNode。具体操作，请参见[使用eci-profile调度Pod到VNode](https://help.aliyun.com/zh/eci/user-guide/use-eci-profile-to-schedule-pods-to-a-vnode)。\n\n## 打通Pod网络\n\n调度到VNode上的ECI Pod将占用所属VPC下交换机的一个弹性网卡资源，默认具备一个内网IP地址。\n\n默认情况下，ECI Pod无法访问自建集群Overlay网络（Flannel、Calico或Cilium）中的Pod，但自建集群Overlay网络中的Pod是可以访问ECI Pod的。如果ECI Pod需要访问自建集群Overlay网络中的Pod，需要在所属VPC的路由表中增加路由条目，使得从ECI Pod出去的数据包可以通过该路由条目，正确路由到自建集群对应的ECS节点上。\n\n配置示例如下：\n\n- \n\n示例场景\n\n假设集群中有2个Pod，1个运行在VNode上（test1 ），1个运行在ECS节点上（test2）。默认情况下，test2可以访问test1，但test1无法访问test2。\n\nNAME      READY     RESTARTS    AGE    IP                NODE                                   NOMINATED NODE   READINESS NODE\ntest1     1/1       0           58s    192.168.0.245     cn-hangzhou.vnd-7xvetkyase7gb62u****   <none>           <none>\ntest2     1/1       0           35s    10.88.1.4         vnode-test002                          <none>          "}
{"url": "https://help.aliyun.com/zh/eci/use-cases/use-an-elastic-container-instance-to-run-jobs", "page_type": "doc", "title": "使用ECI运行Job任务", "keywords": "了解ECI运行Job任务,学习ECI运行Job任务,ECI运行Job任务实践,ECI运行Job任务优势", "last_modified_ms": 1736851063000, "last_modified_iso": "2025-01-14T18:37:43+08:00", "excerpt": "ECI支持秒级启动，按需扩容。对于短时间运行的Job任务，使用ECI来运行可以避免资源闲置浪费，在满足业务需求的同时有效降低使用成本，提升集群的弹性能力和资源利用率。\n## 背景信息\n\n对于大多数Kubernetes集群，通常需要同时支撑在线和离线的多种负载，在线负载流量的波动性和离线计算任务的时间不确定性，导致在不同时刻下，负载的资源需求呈波峰波谷状。比如很多企业需要在周末、月中和月末进行大批量的数据计算，在特定的时间点需要大量的计算力，以应对突发的计算资源需求。\n\n目前Kubernetes通常的方法是通过autoscaler来自动扩容节点，直到Pod被成功调度运行，当Pod执行完成后会自动回收临时节点。使用这种扩容方式，Pod一般需要等待2分钟甚至更多时间才能被调度运行。\n\n针对上述场景，推荐您使用ECI来运行Job任务。ECI通过虚拟节点的方式接入Kubernetes集群，支持秒级启动，按需扩容，能够很好地提升集群的弹性能力。使用ECI来运行Job任务，您无需提前预估业务流量，预留闲置资源，在满足业务需求的同时能够有效降低使用和运维成本。\n## 操作说明\n\n根据您的Kubernetes集群类型，请参考以下文档操作：\n\n- \n\n如果您使用阿里云ACK集群，需要部署虚拟节点，以便使用ECI来运行Job任务。具体操作，请参见[基于ECI运行Job任务](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/use-an-elastic-container-instance-to-run-a-job#task-1846832)。\n- \n\n如果您使用阿里云ACK Serverless集群，可以直接使用ECI来运行Job任务。具体操作，请参见[通过ACK Serverless集群运行Job任务](https://help.aliyun.com/zh/ack/serverless-kubernetes/use-cases/use-ask-to-run-jobs#task-2495856)。\n- \n\n如果你在云上或者线下IDC自建了Kubernetes集群，可以通过部署虚拟节点的方式接入ECI，然后将Job任务调度到ECI来运行。关于自建集群如何使用ECI，请参见[自建Kubernetes集群对接ECI](https://help.aliyun.com/zh/eci/user-guide/overview-3#topic-2148389)。\n\n## 相关文档\n\n您也可以结合使用抢占式ECI实例来节约实例使用成本。更多信息，请参见[使用抢占式ECI实例运行Job任务](https://help.aliyun.com/zh/eci/use-cases/run-jobs-on-a-preemptible-instance#topic4204)。\n"}
{"url": "https://help.aliyun.com/zh/eci/use-cases/use-and-integrate-the-elastic-container-instance-terminal", "page_type": "doc", "title": "使用和集成ECI Terminal", "keywords": "使用ECI Terminal,集成ECI Terminal,ECI Terminal使用方法,ECI Terminal集成方案", "last_modified_ms": 1732867298000, "last_modified_iso": "2024-11-29T16:01:38+08:00", "excerpt": "ECI提供Terminal方便您与容器内部进行交互并执行命令，您可以通过浏览器打开Terminal，也可以将Terminal集成到自有系统中。本文为您介绍如何使用ECI Terminal，以及如何将ECI Terminal集成到自有系统中。\n## 使用ECI Terminal\n\n您在使用ECI的时候，如果想要进入到容器内部执行命令，可以调用[ExecContainerCommand](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-execcontainercommand)来获取WebSocketUri。但是WebSocketUri并不能在浏览器中直接打开使用，此时，您可以使用该接口返回的HttpUrl。说明 \n\n通过[ExecContainerCommand](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-execcontainercommand)进入容器执行命令时，执行完毕一次命令后会退出。如果您有多条命令需要执行，可重复调用[ExecContainerCommand](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-execcontainercommand)。您也可以通过[弹性容器实例控制台](https://eci.console.aliyun.com/)，使用Workbench连接容器进行交互式命令调试。具体操作，请参见[连接ECI实例](https://help.aliyun.com/zh/eci/getting-started/connect-to-an-elastic-container-instance)。\n\nHttpUrl的有效时间为30秒，您需要在接口调用后的30秒内在浏览器中打开HttpUrl，即可进入到容器内部。说明 \n\n通过这种方式进入容器的操作将会被审计，您可以在[弹性容器实例控制台](https://eci.console.aliyun.com)的Terminal 审计日志页面查看相关的审计记录。审计信息包括请求时间、实例ID和请求IP等。审计信息最多可以保留一个月。\n## 将ECI Terminal集成到自有系统\n\n在自有系统中，调用[ExecContainerCommand](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-execcontainercommand)获取到HttpUrl后，您可以通过以下方式集成：\n\n- \n\n在独立窗口打开\n\n可以由前端应用为HttpUrl打开一个新的窗口。\n- \n\n内嵌到当前页面\n\n通过iframe的方式内嵌到自有系统的页面中。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/accelerate-building-alpaca-lora-with-data-caching", "page_type": "doc", "title": "搭建Alpaca-LoRa", "keywords": "搭建Alpaca-LoRa应用,使用数据缓存部署模型,Alpaca-LoRa部署教程,ECI数据缓存实践", "last_modified_ms": 1699867774000, "last_modified_iso": "2023-11-13T17:29:34+08:00", "excerpt": "本文以搭建Alpaca-LoRa为例，演示如何使用数据缓存。通过数据缓存提前拉取llama-7b-hf模型数据和alpaca-lora-7b权重数据，然后在创建Alpaca-LoRa应用实例时直接挂载模型和权重数据，可以免去在实例中拉取数据的等待时间，加速Apache-LoRa启动过程。\n## 背景信息\n\nAlpaca-LoRa是一种使用Lora技术在LLaMA模型进行微调的轻量级语言模型。它可以模拟自然语言进行对话交互，根据用户输入的指令来生成不同的文本，协助用户完成写作、翻译、编写代码等任务。重要 \n\n- \n\n阿里云不对第三方模型的合法性、安全性、准确性进行任何保证，阿里云不对由此引发的任何损害承担责任。\n- \n\n您应自觉遵守第三方模型的用户协议、使用规范和相关法律法规，并就使用第三方模型的合法性、合规性自行承担相关责任。\n\n## 前提条件\n\n您使用的VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建数据缓存和部署应用时绑定EIP，以便可以拉取公网数据。\n## 操作步骤\n### 制作Alpaca-LoRa镜像\n\n请根据自身业务需求，参考以下步骤制作镜像。\n\n- \n\n访问[alpaca-lora](https://github.com/tloen/alpaca-lora)，将仓库克隆到本地。\n- \n\n修改仓库中的requirements.txt和Dockerfile。\n\n展开查看requirements.txt\n\naccelerate\nappdirs\nloralib\nbitsandbytes\nblack\nblack[jupyter]\ndatasets\nfire\ngit+https://github.com/huggingface/peft.git\ntransformers>=4.28.0\nsentencepiece\ngradio\nscipy\n\n\n展开查看Dockerfile\n\nFROM nvidia/cuda:11.8.0-devel-ubuntu22.04\n\nARG DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && apt-get install -y \\\n    git \\\n    curl \\\n    software-properties-common \\\n    && add-apt-repository ppa:deadsnakes/ppa \\\n    && apt install -y python3.10 \\\n    && rm -rf /var/lib/apt/lists/*\nWORKDIR /workspace\nCOPY requirements.txt requirements.txt\nRUN curl -sS https://bootstrap.pypa.io/get-pip.py | python3.10 \\\n    && python3.10 -m pip install -r requirements.txt \\\n    && python3.10 -m pip install numpy --pre torch --force-reinstall --index-url https://download.pytorch.org/whl/nightly/cu118 \\\n    && python3.10 -m pip install --upgrade typing-extensions\nCOPY . .\n\nEXPOSE 7860\n\n\n- \n\n使用Dockerfile构建镜像。\n- \n\n将镜像推送到镜像仓库中。\n\n### 创建数据缓存\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本文使用以下两个模型，在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n\n- \n\ndecapoda-research/llama-7b-hf\n- \n\ntloen/alpaca-lora-7b\n\n- \n\n创建数据缓存。说明 \n\n如果您的业务部署在中国内地地域，建议您在中国香港地域创建数据缓存，然后拷贝数据缓存到您需要的地域。\n\n- \n\n创建llama-7b-hf的数据缓存。\n\n调用[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)接口创建数据缓存所采用的参数示例如下，表示从HuggingFace拉取llama-7b-hf模型数据，保存到名为test的Bucket的/model/llama-7b-hf目录。数据缓存名为llama-7b-hf，保留时长为1天。重要 \n\n如果您通过SDK创建数据缓存，DataSource.Options中的各个参数前无需添加参数名的长度，例如#10#repoSource直接写成repoSource，#6#repoId直接写成repoId即可。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/model/llama-7b-hf\",\n  \"Name\": \"llama-7b-hf\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#10#repoSource\": \"HuggingFace/Model\",\n      \"#6#repoId\": \"decapoda-research/llama-7b-hf\"\n    }\n  },\n  \"RetentionDays\": 1\n}\n\n\n- \n\n创建alpaca-lora-7b的数据缓存。\n\n调用[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)接口创建数据缓存所采用的参数示例如下，表示从HuggingFace拉取alpaca-lora-7b模型数据，保存到名为test的Bucket的/model/alpaca-lora-7b目录。数据缓存名为alpaca-lora-7b，保留时长为1天。重要 \n\n如果您通过SDK创建数据缓存，DataSource.Options中的各个参数前无需添加参数名的长度，例如#10#repoSource直接写成repoSource，#6#repoId直接写成repoId即可。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/model/alpaca-lora-7b\",\n  \"Name\": \"alpaca-lora-7b\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#10#repoSource\": \"HuggingFace/Model\",\n      \"#6#repoId\": \"tloen/alpaca-lora-7b\"\n    }\n  },\n  \"RetentionDays\": 1\n}\n\n\n- \n\n查询数据缓存状态。\n\n根据返回的数据缓存ID调用[DescribeDataCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedatacaches)接口查询数据缓存信息，当数据缓存的状态（DataCaches.Status）为Available时，表示可以使用该数据缓存。\n\n### 部署Alpaca-lora应用\n\n- \n\n使用数据缓存创建ECI实例，部署Alpaca-lora应用。\n\n调用[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)接口创建ECI实例所采用的参数示例如下，该ECI实例增加了20 GiB的临时存储空间，并挂载了llama-7b-hf和alpaca-lora-7b模型数据。实例内的容器使用准备好的Alpaca-lora镜像，模型数据在容器内的挂载路径分别为/data/llama-7b-hf和/data/alpaca-lora-7b，容器启动后会运行python3.10 generate.py --load_8bit --base_model /data/llama-7b-hf --lora_weights /data/alpaca-lora-7b。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"Securit"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/add-elastic-container-instances-to-an-slb-instance", "page_type": "doc", "title": "为ECI实例配置负载均衡", "keywords": "配置ECI实例负载均衡,ECI负载均衡配置指南,ECI负载均衡操作步骤", "last_modified_ms": 1716528529000, "last_modified_iso": "2024-05-24T13:28:49+08:00", "excerpt": "负载均衡SLB是一种对流量进行按需分发的服务，可以将流量分发到不同的后端服务来扩展应用系统的服务吞吐能力，并且可以消除系统中的单点故障，提升应用系统的可用性。本文介绍如何将ECI实例添加到SLB实例的后端服务器中，并配置监听，实现通过SLB将流量分发到ECI实例。\n## 背景信息\n\n负载均衡SLB（Server Load Balancer）由SLB实例、后端服务器和监听三部分组成，配置ECI实例挂载到SLB的操作流程如下：\n\n- \n\n创建ECI实例\n\n搭建负载均衡服务前，您需要根据业务需求规划地域和网络，然后在此基础上创建ECI实例，完成相关应用部署。\n- \n\n创建SLB实例\n\n使用负载均衡服务时，您需要创建一个SLB实例，每个SLB实例代表一个负载均衡服务实体，用于接收流量并将其分发给后端服务器。\n\nSLB分为多个类型，您可以根据业务需求进行选择，具体请参见[负载均衡SLB产品家族介绍](https://help.aliyun.com/zh/slb/product-overview/slb-overview#concept-whs-lp4-tdb)。\n- \n\n将ECI实例添加到SLB实例的后端服务器中\n\n后端服务器是一组接收前端请求的服务器。将ECI实例添加到后端服务器后，可以接收SLB实例转发的客户端请求。对于ALB和NLB实例，您需要先创建一个服务器组，然后再添加ECI实例；对于CLB实例，您可以直接将ECI实例添加到默认服务器组。\n- \n\n配置监听\n\n监听用于检查客户端请求，并将请求转发给后端服务器。您需要为SLB实例配置监听，包括协议、端口和调度算法等。\n\n## 准备工作\n\n- \n\n创建多个ECI实例。\n\n此处以创建两个运行Nginx服务的ECI实例为例，创建时请开启日志收集。具体操作，请参见[使用Nginx镜像创建ECI实例](https://help.aliyun.com/zh/eci/getting-started/use-an-nginx-image-to-create-an-elastic-container-instance#topic-1860101)。\n\n- \n\n创建CLB实例。\n\n创建一个具备公网能力的CLB实例。具体操作，请参见[创建CLB实例](https://help.aliyun.com/zh/slb/classic-load-balancer/user-guide/create-and-manage-a-clb-instance#task-ctx-xsm-vdb)。说明 \n\n本文以CLB为例介绍，ALB和NLB的操作类似。\n\n## 操作步骤\n\n将ECI实例添加到CLB实例的后端服务器中并配置监听，可以实现将监听请求转发到ECI实例。说明 \n\n不支持挂载状态为最终状态（如：Succeeded、Failed）的ECI实例。\n## 控制台\n\n- \n\n登录[传统型负载均衡CLB控制台](https://slbnew.console.aliyun.com/slb/cn-beijing/slbs)。\n- \n\n在实例管理页面，找到目标CLB实例，在对应操作列中单击添加后端服务器。\n- \n\n在我的服务器面板，完成服务器添加。\n\n- \n\n选择后端服务器类型为弹性容器实例ECI，然后选中多个ECI实例，单击下一步。\n- \n\n根据需要配置权重，单击添加。\n\n权重默认为100，权重越大，转发的请求越多。\n- \n\n单击确定，然后在弹出的对话框中单击确定。\n\n在实例的默认服务器组页签下，您可以看到新添加的ECI实例。\n\n- \n\n在实例管理页面，找到目标CLB实例，在对应操作列中单击监听配置向导。\n- \n\n在协议&监听配置向导页，完成监听配置，然后单击下一步。\n\n配置时，请根据需要选择协议并设置监听端口，此处配置示例如下：\n\n- \n\n协议选择TCP\n- \n\n监听端口设置为80\n- \n\n其它配置保持默认配置\n\n- \n\n在后端服务器配置向导页，完成服务器配置，然后单击下一步。\n\n配置时，选择默认服务器组，您可以看到步骤3添加的ECI实例已经显示在列表中，请根据需要设置各服务器的监听端口，此处示例设置端口为80。\n- \n\n在健康检查向导页，保持默认配置，单击下一步。\n- \n\n在配置审核向导页，确认配置，单击提交\n\n## OpenAPI\n\n- \n\n调用ECI的[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)接口查询ECI实例相关信息。\n\n在返回参数中获取并记录ECI实例相关信息：\n\n- \n\nECI实例ID，对应参数为ContainerGroupId。\n- \n\nECI实例内网IP，对应参数为IntranetIp。\n\n- \n\n调用CLB的[AddBackendServers](https://help.aliyun.com/zh/slb/api-addbackendservers#doc-api-Slb-AddBackendServers)接口添加后端服务器。\n\n主要参数说明如下表所示。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nLoadBalancerId\n\nString\n\nlb-2ze7o5h52g02kkzz******\n\nCLB实例ID。\n\nBackendServers\n\nString\n\n[{ \"ServerId\": \"eci-2zeb9fwsn3n5lano****\", \"Weight\": \"100\", \"Type\": \"eci\", \"ServerIp\": \"172.16.12.**\", \"Port\":\"80\",\"Description\":\"test\" },{ \"ServerId\": \"eci-2zeb9fwsn3n5lano****\", \"Weight\": \"100\", \"Type\": \"eci\", \"ServerIp\": \"172.16.12.**\", \"Port\":\"80\",\"Description\":\"test\" }]\n\n要添加的后端服务器列表。包含以下参数：\n\n- \n\nServerId：后端服务器实例ID。此处填入ECI实例ID。\n- \n\nWeight：后端服务器权重。取值为0~100，默认值为100。如果值为0，则不会将请求转发给该后端服务器。\n- \n\nDescription：后端服务器描述。\n- \n\nType：后端服务器类型。此处配置为eci。\n- \n\nServerIp：实例IP地址。此处填入ECI实例内网IP。\n- \n\nPort：用来接收请求的后端端口。\n\n- \n\n调用CLB的监听相关API接口创建监听。\n\n- \n\n[CreateLoadBalancerTCPListener - 创建TCP监听](https://help.aliyun.com/zh/slb/classic-load-balancer/developer-reference/api-slb-2014-05-15-createloadbalancertcplistener)\n- \n\n[CreateLoadBalancerUDPListener - 创建UDP监听](https://help.aliyun.com/zh/slb/classic-load-balancer/developer-reference/api-slb-2014-05-15-createloadbalancerudplistener)\n- \n\n[CreateLoadBalancerHTTPListener - 创建HTTP监听](https://help.aliyun.com/zh/slb/classic-load-balancer/developer-reference/api-slb-2014-05-15-createloadbalancerhttplistener)\n- \n\n[CreateLoadBalancerHTTPSListener - 创建HTTPS监听](https://help.aliyun.com/zh/slb/classic-load-balancer/developer-reference/api-slb-2014-05-15-createloadbalancerhttpslistener)\n\n本文以创建TCP监听为例，主要参数说明如下表所示。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nBandwidth\n\nInteger\n\n-1\n\n监听的带宽峰值。取值范围：\n\n- \n\n-1：对于按流量计费的公网CLB实例，可以将带宽峰值设置为-1，即不限制带宽峰值。\n- \n\n1~5120：对于按带宽计费的公网CLB实例，可以设置每个监听的带宽峰值，但所有监听的带宽峰值之和不能超过实例的带宽峰值。单位为Mbps。\n\nBackendServerPort\n\nInteger\n\n80\n\nCLB实例后端使用的端口。\n\n取值范围：1~65535。\n\nLoadBalancerId\n\nString\n\nlb-2ze7o5h52g02kkzz******\n\nCLB实例ID。\n\nListenerPort\n\nInteger\n\n80\n\nCLB实例前端使用的端口。\n\n取值范围：1~65535。\n- \n\n调用CLB的[StartLoadBalancerListener](https://help.aliyun.com/zh/slb/classic-load-balancer/developer-reference"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/annotations-that-can-be-added-to-create-an-image-cache", "page_type": "doc", "title": "ImageCache Annotation", "keywords": "查询ImageCache Annotation,配置ImageCache Annotation,ImageCache Annotation列表,ImageCache Annotation用法", "last_modified_ms": 1730171109000, "last_modified_iso": "2024-10-29T11:05:09+08:00", "excerpt": "在Kubernetes场景下，您可以通过ImageCache CRD使用ECI的镜像缓存功能，以加速创建Pod。创建ImageCache资源时，为充分使用镜像缓存功能，您可以根据需要为ImageCache添加Annotation。本文介绍ImageCache支持的Annotation，并提供配置示例。\n## ImageCache Annotation列表\n\nImageCache目前支持的Annotation如下表所示。\n\n[表格]\n\n参数\n\n示例值\n\n描述\n\n配置示例\n\nk8s.aliyun.com/vswitch-ids\n\n\"vsw-bp1dktddjsg5nktv****,vsw-bp1xpiowfm5vo8o3c****\"\n\n指定交换机。支持指定多个交换机实现多可用区功能。不指定时，默认采用eci-profile中配置的vSwitch。\n\n[多可用区创建资源](#section-h18-qb6-x3g)\n\nk8s.aliyun.com/imc-cpu-arch\n\n\"arm64\"\n\n指定CPU架构。取值范围：\n\n- \n\namd64（默认值）\n- \n\narm64重要 \n\n指定CPU架构为Arm时，请先确保集群中已有Arm架构的虚拟节点。更多信息，请参见[调度Pod到Arm架构的虚拟节点](https://help.aliyun.com/zh/eci/user-guide/scheduling-pods-to-virtual-nodes-in-the-arm-architecture)。\n\n[指定CPU架构](#14965e41f9fhh)\n\nk8s.aliyun.com/imc-os-type\n\n\"windows\"\n\n指定操作系统。取值范围：\n\n- \n\nlinux（默认值）\n- \n\nwindows重要 \n\n指定操作系统为Windows时，请先确保集群中已有Windows虚拟节点。更多信息，请参见[（邀测）调度Pod到Windows虚拟节点](https://help.aliyun.com/zh/eci/create-a-windows-based-pod)。\n\n[指定操作系统](#c22b1cff1960e)\n\nk8s.aliyun.com/security-group-id\n\n\"sg-bp1dktddjsg5nktv****\"\n\n指定安全组。不指定时，默认采用eci-profile中配置的安全组。\n\n[设置安全组和资源组](#section-o98-zln-0gr)\n\nk8s.aliyun.com/resource-group-id\n\n\"rg-aek2z3elfs4****\"\n\n指定资源组。不指定时，默认采用eci-profile中配置的资源组。\n\nk8s.aliyun.com/acr-instance-ids\n\n\"cri-j36zhodptmyq****\"\n\n指定ACR企业版实例，用于免密拉取镜像。\n\n支持跨地域指定ACR企业版实例，此时需在实例ID前加上所属地域，例如\"cn-beijng:cri-j36zhodptmyq****\"。\n\n[免密拉取ACR镜像](#section-vm2-u5o-t27)\n\nk8s.aliyun.com/acr-service-arns\n\nacs:ram::1609982529******:role/role-assume\n\nECI资源归属账号下的RAM角色的ARN。\n\n指定RAM角色创建资源时需配置。\n\nk8s.aliyun.com/acr-user-arns\n\nacs:ram::1298452580******:role/role-acr\n\nACR实例归属账号下的RAM角色的ARN。\n\n跨账号拉取ACR镜像时需配置。\n\nk8s.aliyun.com/plain-http-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n指定自建镜像仓库地址。\n\n使用HTTP协议的自建镜像仓库中的镜像创建ImageCache时，需配置该参数使得ECI使用HTTP协议拉取镜像，避免因协议不同而导致镜像拉取失败。\n\n[使用自建镜像仓库](#section-8tj-m5p-fuq)\n\nk8s.aliyun.com/insecure-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n指定自建镜像仓库地址。\n\n使用自签发证书的自建镜像仓库中的镜像创建ImageCache时，需配置该参数来跳过证书认证，避免因证书认证失败而导致镜像拉取失败。\n\nk8s.aliyun.com/imc-enable-reuse\n\n\"true\"\n\n是否开启镜像缓存复用。开启后，新创建的镜像缓存可以复用已有镜像缓存的镜像层，加快镜像缓存的制作速度。\n\n[开启镜像缓存复用](#section-p0u-z6l-pgc)\n\nk8s.aliyun.com/imc-enable-flash\n\n\"true\"\n\n是否开启极速镜像缓存功能，开启后，将临时创建一份本地快照，可以缩短镜像缓存的创建时长。\n\n[开启极速镜像缓存](#section-8z7-yrg-k6v)\n\nk8s.aliyun.com/imc-retention-days\n\n\"7\"\n\n设置镜像缓存保留时长，单位为天。过期的镜像缓存将被自动清理。默认永不过期。\n\n[设置镜像缓存的大小和保留时长](#section-62w-g9l-0o7)\n\nk8s.aliyun.com/imc-size\n\n\"25\"\n\n设置镜像缓存大小。默认为20 GiB。取值范围为20~32768 GiB。\n\nk8s.aliyun.com/eip-instance-id\n\n\"eip-bp1q5n8cq4p7f6dzu****\"\n\n绑定EIP。在没有配置NAT网关的情况下，可绑定已有的EIP来拉取公网镜像。\n\n[配置EIP拉取公网镜像](#section-eig-q8c-iy6)\n\nk8s.aliyun.com/auto-create-eip\n\n\"true\"\n\n是否自动创建并绑定EIP。在没有配置NAT网关的情况下，可自动创建并绑定EIP来拉取公网镜像。\n\nk8s.aliyun.com/eip-bandwidth\n\n\"5\"\n\n自动创建EIP时，指定EIP带宽。单位为Mbps。\n\nk8s.aliyun.com/eip-internet-charge-type\n\nPayByBandwidth\n\n自动创建EIP时，指定EIP的计量方式。取值范围：\n\n- \n\nPayByBandwidth：按带宽计费\n- \n\nPayByTraffic：按流量计费\n\nk8s.aliyun.com/eip-isp\n\nBGP\n\n自动创建EIP时，指定EIP线路类型。仅按量付费的EIP支持指定。取值范围：\n\n- \n\nBGP（默认值）：BGP（多线）线路\n- \n\nBGP_PRO：BGP（多线）精品线路\n\nk8s.aliyun.com/eip-common-bandwidth-package-id\n\n\"cbwp-2zeukbj916scmj51m****\"\n\n指定共享带宽包。\n## 多可用区创建资源\n\n创建ImageCache的过程中，系统将临时创建一个ECI实例用于中转创建ImageCache。为避免ECI实例资源库存的影响，保证ImageCache可以创建成功，您可以指定多个交换机来实现多可用区功能。说明 \n\n创建ImageCache时，默认采用集群或者虚拟节点的交换机信息，如果集群或者虚拟节点已配置多可用区，则可以不指定。\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/vswitch-ids: \"vsw-bp1dktddjsg5nktv****,vsw-bp1xpiowfm5vo8o3c****\"  # 指定多个交换机\nspec:\n  images:\n  - centos:latest\n  - busybox:latest\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n## 指定CPU架构\n\n拉取Arm架构的镜像来创建ImageCache时，需要指定CPU架构。重要 \n\n指定CPU架构为Arm时，请先确保集群中已有Arm架构的虚拟节点。更多信息，请参见[调度Pod到Arm架构的虚拟节点](https://help.aliyun.com/zh/eci/user-guide/scheduling-pods-to-virtual-nodes-in-the-arm-architecture)。\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/imc-cpu-arch: \"arm64\" # 指定CPU架构为Arm\nspec:\n  images:\n  - arm64v8/centos:7.9.2009   # 使用基于Arm架构的容器镜像\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n## 指定操作系统\n\n拉取Windows镜像"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/annotations-that-can-be-added-to-create-an-image-cache-1", "page_type": "doc", "title": "ImageCache Annotation", "keywords": "查询ImageCache Annotation,配置ImageCache Annotation,ImageCache Annotation参数,ImageCache Annotation示例", "last_modified_ms": 1730171144000, "last_modified_iso": "2024-10-29T11:05:44+08:00", "excerpt": "在Kubernetes场景下，您可以通过ImageCache CRD使用ECI的镜像缓存功能，以加速创建Pod。创建ImageCache资源时，为充分使用镜像缓存功能，您可以根据需要为ImageCache添加Annotation。本文介绍ImageCache支持的Annotation，并提供配置示例。\n## ImageCache Annotation列表\n\nImageCache目前支持的Annotation如下表所示。\n\n[表格]\n\n参数\n\n示例值\n\n描述\n\n配置示例\n\nk8s.aliyun.com/vswitch-ids\n\n\"vsw-bp1dktddjsg5nktv****,vsw-bp1xpiowfm5vo8o3c****\"\n\n指定交换机。支持指定多个交换机实现多可用区功能。不指定时，默认采用eci-profile中配置的vSwitch。\n\n[多可用区创建资源](#section-h18-qb6-x3g)\n\nk8s.aliyun.com/security-group-id\n\n\"sg-bp1dktddjsg5nktv****\"\n\n指定安全组。不指定时，默认采用eci-profile中配置的安全组。\n\n[设置安全组和资源组](#section-o98-zln-0gr)\n\nk8s.aliyun.com/resource-group-id\n\n\"rg-aek2z3elfs4****\"\n\n指定资源组。不指定时，默认采用eci-profile中配置的资源组。\n\nk8s.aliyun.com/acr-instance-ids\n\n\"cri-j36zhodptmyq****\"\n\n指定ACR企业版实例，用于免密拉取镜像。\n\n支持跨地域指定ACR企业版实例，此时需在实例ID前加上所属地域，例如\"cn-beijng:cri-j36zhodptmyq****\"。\n\n[免密拉取ACR镜像](#section-vm2-u5o-t27)\n\nk8s.aliyun.com/acr-service-arns\n\nacs:ram::1609982529******:role/role-assume\n\nECI资源归属账号下的RAM角色的ARN。\n\n指定RAM角色创建资源时需配置。\n\nk8s.aliyun.com/acr-user-arns\n\nacs:ram::1298452580******:role/role-acr\n\nACR实例归属账号下的RAM角色的ARN。\n\n跨账号拉取ACR镜像时需配置。\n\nk8s.aliyun.com/plain-http-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n指定自建镜像仓库地址。\n\n使用HTTP协议的自建镜像仓库中的镜像创建ImageCache时，需配置该参数使得ECI使用HTTP协议拉取镜像，避免因协议不同而导致镜像拉取失败。\n\n[使用自建镜像仓库](#section-8tj-m5p-fuq)\n\nk8s.aliyun.com/insecure-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n指定自建镜像仓库地址。\n\n使用自签发证书的自建镜像仓库中的镜像创建ImageCache时，需配置该参数来跳过证书认证，避免因证书认证失败而导致镜像拉取失败。\n\nk8s.aliyun.com/imc-enable-reuse\n\n\"true\"\n\n是否开启镜像缓存复用。开启后，新创建的镜像缓存可以复用已有镜像缓存的镜像层，加快镜像缓存的制作速度。\n\n[开启镜像缓存复用](#section-p0u-z6l-pgc)\n\nk8s.aliyun.com/imc-enable-flash\n\n\"true\"\n\n是否开启极速镜像缓存功能，开启后，将临时创建一份本地快照，可以缩短镜像缓存的创建时长。\n\n[开启极速镜像缓存](#section-8z7-yrg-k6v)\n\nk8s.aliyun.com/imc-retention-days\n\n\"7\"\n\n设置镜像缓存保留时长，单位为天。过期的镜像缓存将被自动清理。默认永不过期。\n\n[设置镜像缓存的大小和保留时长](#section-62w-g9l-0o7)\n\nk8s.aliyun.com/imc-size\n\n\"25\"\n\n设置镜像缓存大小。默认为20 GiB。取值范围为20~32768 GiB。\n\nk8s.aliyun.com/eip-instance-id\n\n\"eip-bp1q5n8cq4p7f6dzu****\"\n\n绑定EIP。在没有配置NAT网关的情况下，可绑定已有的EIP来拉取公网镜像。\n\n[配置EIP拉取公网镜像](#section-eig-q8c-iy6)\n\nk8s.aliyun.com/auto-create-eip\n\n\"true\"\n\n是否自动创建并绑定EIP。在没有配置NAT网关的情况下，可自动创建并绑定EIP来拉取公网镜像。\n\nk8s.aliyun.com/eip-bandwidth\n\n\"5\"\n\n自动创建EIP时，指定EIP带宽。单位为Mbps。\n\nk8s.aliyun.com/eip-internet-charge-type\n\nPayByBandwidth\n\n自动创建EIP时，指定EIP的计量方式。取值范围：\n\n- \n\nPayByBandwidth：按带宽计费\n- \n\nPayByTraffic：按流量计费\n\nk8s.aliyun.com/eip-isp\n\nBGP\n\n自动创建EIP时，指定EIP线路类型。仅按量付费的EIP支持指定。取值范围：\n\n- \n\nBGP（默认值）：BGP（多线）线路\n- \n\nBGP_PRO：BGP（多线）精品线路\n\nk8s.aliyun.com/eip-common-bandwidth-package-id\n\n\"cbwp-2zeukbj916scmj51m****\"\n\n指定共享带宽包。\n## 多可用区创建资源\n\n创建ImageCache的过程中，系统将临时创建一个ECI实例用于中转创建ImageCache。为避免ECI实例资源库存的影响，保证ImageCache可以创建成功，您可以指定多个交换机来实现多可用区功能。说明 \n\n创建ImageCache时，默认采用集群或者虚拟节点的交换机信息，如果集群或者虚拟节点已配置多可用区，则可以不指定。\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/vswitch-ids: \"vsw-bp1dktddjsg5nktv****,vsw-bp1xpiowfm5vo8o3c****\"  # 指定多个交换机\nspec:\n  images:\n  - centos:latest\n  - busybox:latest\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n## 设置安全组和资源组\n\n创建ImageCache时，默认采用eci-profile中配置的安全组和资源组。如果您有特殊需求，可以指定安全组和资源组。\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/security-group-id: \"sg-bp1dktddjsg5nktv****\" # 指定安全组\n    k8s.aliyun.com/resource-group-id: \"rg-aek2z3elfs4****\"      # 指定资源组\nspec:\n  images:\n  - centos:latest\n  - busybox:latest\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n## 免密拉取ACR镜像\n\n对于ACR镜像，根据ACR实例是否与待创建的ImageCache属于同一阿里云账号，以及ACR实例的类型，免密拉取镜像的支持情况如下：\n\n[表格]\n\n账号情况\n\nACR类型\n\n免密支持情况\n\n同账号\n\n- \n\n个人版\n- \n\n企业版（默认域名）\n\n默认自动免密，支持配置RAM角色来限制免密范围。\n\n同账号\n\n企业版（自定义域名）\n\n无法自动免密，需要指定ACR实例来实现免密。\n\n跨账号\n\n- \n\n个人版\n- \n\n企业版\n\n无法自动免密，需要配置RAM角色来实现免密。\n\n具体配置，请参见[免密拉取ACR镜像](https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret-1)。\n## 使用自建镜像仓库\n\n使用自建镜像仓库中的镜像创建ImageCache时，如果镜像仓库采用HTTP协议，或者使用自签发证书，需配置相关Annotation避免镜像拉取失败。\n\n- \n\n自建镜像仓库采用HTTP协议\n\n由于ECI默认使用HTTPS协议拉取镜像，则创建ImageCache，需要配置k8s.aliyun.com/plain-http-registry，"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/apply-savings-plans", "page_type": "doc", "title": "使用节省计划", "keywords": "使用节省计划,购买节省计划,降低ECI成本,节省计划介绍,节省计划类型,ECI成本优化", "last_modified_ms": 1732523769000, "last_modified_iso": "2024-11-25T16:36:09+08:00", "excerpt": "节省计划是一种折扣权益计划，可以抵扣按量付费实例（（不含抢占式实例））的账单。如果您的业务是长时间运行的在线业务，推荐您使用节省计划抵扣ECI实例费用。本文介绍如何使用节省计划来降低长时间运行实例的费用成本。\n## 购买节省计划\n\n节省计划是一种用于抵扣长期使用按量付费资源的折扣权益。您可以通过承诺在一定期限（1年、3年等）内使用稳定数量的资源（以元/小时为单位衡量），来换取较低折扣。节省计划生效后会抵扣符合条件的按量付费账单，并且在抵扣时享受特有的折扣。更多信息，请参见[节省计划](https://help.aliyun.com/zh/ecs/savings-plans)。\n\nECI支持以下两种类型的节省计划。购买前，请仔细了解节省计划的生效规则，根据自身业务情况，选择合适的节省计划。\n\n- \n\n通用型\n\n抵扣时不受规格限制。相较于ECS计算型，有更高的灵活度。\n- \n\nECS计算型\n\n需要匹配ECS规格进行抵扣，因此仅支持抵扣指定对应ECS规格创建的ECI实例，即按ECS规格计费的ECI实例。相较于通用型，有更低的折扣价格。\n\n在ECS控制台的[节省计划页面](https://ecs.console.aliyun.com/#/savingPlan)，您可以了解更多信息。购买时，可以采纳自动推荐的方案，也可以自行计算消费，选择并购买合适的节省计划。\n\n- \n\n如果您希望对已有的ECI实例进行成本优化，可以前往[节省计划购买推荐页面](https://usercenter2.aliyun.com/resource/spn/recommend)获取购买推荐。\n- \n\n如果您还没有创建ECI实例，可以使用[节省计划价格计算器](https://www.aliyun.com/page-source/website/buy/spn_pricing_calculator)获取购买方案，也可以自行计算实例费用，再按折扣计算每小时承诺消费，然后前往[节省计划购买页面](https://common-buy.aliyun.com/?spm=a2c81.a53620e.app.1.5a1011279HUkI1&commodityCode=savingplan_common_public_cn#/buy)购买。\n\n更多信息，请参见[购买和使用节省计划](https://help.aliyun.com/zh/ecs/user-guide/purchase-and-apply-savings-plans#task-1997695)。\n## 查看节省计划抵扣信息\n\n购买节省计划后，系统将自动匹配节省计划和实例费用进行抵扣，您无需手动操作。您可以打开[费用与成本](https://usercenter2.aliyun.com/home)页面，查看节省计划的抵扣情况。\n\n- \n\n查看实例账单\n\n在账单 > 账单详情页面，在明细账单页签下，您可以按实例查看消费明细。对于节省计划已经抵扣的实例费用，不会产生对应的实例账单。\n- \n\n查看节省计划使用效果\n\n在账户 > 节省计划页面，您可以查看节省计划的总览、使用明细、使用率概况和覆盖率概况等信息。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/apply-savings-plans-1", "page_type": "doc", "title": "使用节省计划", "keywords": "使用节省计划优化ECI,购买ECI节省计划,ECI成本优化方法,ECI节省计划介绍", "last_modified_ms": 1732523756000, "last_modified_iso": "2024-11-25T16:35:56+08:00", "excerpt": "节省计划是一种折扣权益计划，可以抵扣按量付费实例（（不含抢占式实例））的账单。如果您的业务是长时间运行的在线业务，推荐您使用节省计划抵扣ECI实例费用。本文介绍如何使用节省计划来降低长时间运行实例的费用成本。\n## 购买节省计划\n\n节省计划是一种用于抵扣长期使用按量付费资源的折扣权益。您可以通过承诺在一定期限（1年、3年等）内使用稳定数量的资源（以元/小时为单位衡量），来换取较低折扣。节省计划生效后会抵扣符合条件的按量付费账单，并且在抵扣时享受特有的折扣。更多信息，请参见[节省计划](https://help.aliyun.com/zh/ecs/savings-plans)。\n\nECI支持以下两种类型的节省计划。购买前，请仔细了解节省计划的生效规则，根据自身业务情况，选择合适的节省计划。\n\n- \n\n通用型\n\n抵扣时不受规格限制。相较于ECS计算型，有更高的灵活度。\n- \n\nECS计算型\n\n需要匹配ECS规格进行抵扣，因此仅支持抵扣指定对应ECS规格创建的ECI实例，即按ECS规格计费的ECI实例。相较于通用型，有更低的折扣价格。\n\n在ECS控制台的[节省计划页面](https://ecs.console.aliyun.com/#/savingPlan)，您可以了解更多信息。购买时，可以采纳自动推荐的方案，也可以自行计算消费，选择并购买合适的节省计划。\n\n- \n\n如果您希望对已有的ECI实例进行成本优化，可以前往[节省计划购买推荐页面](https://usercenter2.aliyun.com/resource/spn/recommend)获取购买推荐。\n- \n\n如果您还没有创建ECI实例，可以使用[节省计划价格计算器](https://www.aliyun.com/page-source/website/buy/spn_pricing_calculator)获取购买方案，也可以自行计算实例费用，再按折扣计算每小时承诺消费，然后前往[节省计划购买页面](https://common-buy.aliyun.com/?spm=a2c81.a53620e.app.1.5a1011279HUkI1&commodityCode=savingplan_common_public_cn#/buy)购买。\n\n更多信息，请参见[购买和使用节省计划](https://help.aliyun.com/zh/ecs/user-guide/purchase-and-apply-savings-plans#task-1997695)。\n## 查看节省计划抵扣信息\n\n购买节省计划后，系统将自动匹配节省计划和实例费用进行抵扣，您无需手动操作。您可以打开[费用与成本](https://usercenter2.aliyun.com/home)页面，查看节省计划的抵扣情况。\n\n- \n\n查看实例账单\n\n在账单 > 账单详情页面，在明细账单页签下，您可以按实例查看消费明细。对于节省计划已经抵扣的实例费用，不会产生对应的实例账单。\n- \n\n查看节省计划使用效果\n\n在账户 > 节省计划页面，您可以查看节省计划的总览、使用明细、使用率概况和覆盖率概况等信息。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/apply-savings-plans-2", "page_type": "doc", "title": "使用节省计划", "keywords": "使用节省计划降本,购买节省计划,ECI节省计划用法,ECI成本优化", "last_modified_ms": 1732523730000, "last_modified_iso": "2024-11-25T16:35:30+08:00", "excerpt": "节省计划是一种折扣权益计划，可以抵扣按量付费实例（（不含抢占式实例））的账单。如果您的业务是长时间运行的在线业务，推荐您使用节省计划抵扣ECI实例费用。本文介绍如何使用节省计划来降低长时间运行实例的费用成本。\n## 购买节省计划\n\n节省计划是一种用于抵扣长期使用按量付费资源的折扣权益。您可以通过承诺在一定期限（1年、3年等）内使用稳定数量的资源（以元/小时为单位衡量），来换取较低折扣。节省计划生效后会抵扣符合条件的按量付费账单，并且在抵扣时享受特有的折扣。更多信息，请参见[节省计划](https://help.aliyun.com/zh/ecs/savings-plans)。\n\nECI支持以下两种类型的节省计划。购买前，请仔细了解节省计划的生效规则，根据自身业务情况，选择合适的节省计划。\n\n- \n\n通用型\n\n抵扣时不受规格限制。相较于ECS计算型，有更高的灵活度。\n- \n\nECS计算型\n\n需要匹配ECS规格进行抵扣，因此仅支持抵扣指定对应ECS规格创建的ECI实例，即按ECS规格计费的ECI实例。相较于通用型，有更低的折扣价格。\n\n在ECS控制台的[节省计划页面](https://ecs.console.aliyun.com/#/savingPlan)，您可以了解更多信息。购买时，可以采纳自动推荐的方案，也可以自行计算消费，选择并购买合适的节省计划。\n\n- \n\n如果您希望对已有的ECI实例进行成本优化，可以前往[节省计划购买推荐页面](https://usercenter2.aliyun.com/resource/spn/recommend)获取购买推荐。\n- \n\n如果您还没有创建ECI实例，可以使用[节省计划价格计算器](https://www.aliyun.com/page-source/website/buy/spn_pricing_calculator)获取购买方案，也可以自行计算实例费用，再按折扣计算每小时承诺消费，然后前往[节省计划购买页面](https://common-buy.aliyun.com/?spm=a2c81.a53620e.app.1.5a1011279HUkI1&commodityCode=savingplan_common_public_cn#/buy)购买。\n\n更多信息，请参见[购买和使用节省计划](https://help.aliyun.com/zh/ecs/user-guide/purchase-and-apply-savings-plans#task-1997695)。\n## 查看节省计划抵扣信息\n\n购买节省计划后，系统将自动匹配节省计划和实例费用进行抵扣，您无需手动操作。您可以打开[费用与成本](https://usercenter2.aliyun.com/home)页面，查看节省计划的抵扣情况。\n\n- \n\n查看实例账单\n\n在账单 > 账单详情页面，在明细账单页签下，您可以按实例查看消费明细。对于节省计划已经抵扣的实例费用，不会产生对应的实例账单。\n- \n\n查看节省计划使用效果\n\n在账户 > 节省计划页面，您可以查看节省计划的总览、使用明细、使用率概况和覆盖率概况等信息。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/assign-a-ram-role-to-a-pod", "page_type": "doc", "title": "为ECI Pod绑定RAM角色", "keywords": "为ECI Pod绑定RAM角色,获取ECI Pod的STS Token,ECI Pod RAM角色配置,ECI Pod权限管理", "last_modified_ms": 1724911369000, "last_modified_iso": "2024-08-29T14:02:49+08:00", "excerpt": "RAM角色是一种具备某些权限的虚拟用户，可以被ECI Pod扮演，从而使得ECI Pod获得相应的权限。本文介绍如何为ECI Pod（即ECI实例）绑定RAM角色，以便ECI Pod内部的应用程序可以基于STS（Security Token Service）临时凭证访问其他阿里云产品的API。\n## 背景信息\n\nECI Pod上部署的应用程序在云产品通信中，通过云账号或者RAM用户的AccessKey访问阿里云其他云产品（例如OSS、VPC、RDS等）的API。为了方便和快速地调用，部分用户直接把AccessKey固化在实例中，例如直接写在配置文件中。这种方式存在权限过高、泄露信息和难以维护等问题。\n\n实例RAM角色能够避免上述问题。通过RAM角色授权，无需在ECI Pod中保存AccessKey。通过修改RAM角色的权限即可变更ECI Pod的权限，在使用上安全便捷。更多关于RAM角色的信息，请参见[RAM角色概览](https://help.aliyun.com/zh/ram/user-guide/ram-role-overview)。\n## 创建RAM角色并授权\n\n- \n\n创建RAM角色。具体操作，请参见[创建可信实体为阿里云服务的RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service)。\n\n创建RAM角色时，可信实体类型选择阿里云服务，受信服务为云服务器。\n\n- \n\n授权RAM角色。\n\n- \n\n创建权限策略。具体操作，请参见[创建自定义权限策略](https://help.aliyun.com/zh/ram/create-a-custom-policy)。\n- \n\n为RAM角色添加权限策略。具体操作，请参见[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role)。\n\n- \n\n（可选）授权RAM用户使用RAM角色。\n\n如果通过RAM用户使用RAM角色，请确保RAM用户具有ram:passRole权限。权限内容参考如下，其中ECIRamRoleTest为要授权的ram:PassRole权限的RAM角色名称。\n\n{\n   \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ram:PassRole\",\n      \"Resource\": \"acs:ram:*:*:role/ECIRamRoleTest\" \n    }\n  ],\n  \"Version\": \"1\"\n}                \n\n\n## 为ECI Pod绑定RAM角色\n\n创建ECI Pod时，可以通过k8s.aliyun.com/eci-ram-role-name的Annotation为Pod绑定RAM角色，授予Pod访问阿里云产品的能力。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      name: test\n      labels:\n        app: test\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-ram-role-name : \"${your_ram_role_name}\"   #绑定RAM角色\n    spec:\n      containers:\n      - name: test\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/centos:7\n        command: [\"sleep\"]\n        args: [\"3600\"]\n\n\n## 获取STS Token\n\n在ECI实例内部，您可以访问元数据URL来获取RAM角色的STS Token，该STS Token可以执行RAM角色的权限和资源，并且该STS Token会自动周期性地更新。\n\ncurl http://100.100.100.200/latest/meta-data/ram/security-credentials/${your_ram_role_name}\n\n\n请使用实际RAM角色名称替换${your_ram_role_name}，假设RAM角色名称为ECIRamRoleTest，命令示例如下：\n\ncurl http://100.100.100.200/latest/meta-data/ram/security-credentials/ECIRamRoleTest\n\n\n返回结果中可以获取STS Token，示例如下：\n\n{\n  \"AccessKeyId\" : \"STS.******\",\n  \"AccessKeySecret\" : \"******\",\n  \"Expiration\" : \"2023-06-22T19:13:58Z\",\n  \"SecurityToken\" : \"******\",\n  \"LastUpdated\" : \"2023-06-22T13:13:58Z\",\n  \"Code\" : \"Success\"\n}\n\n\n## 基于STS Token访问云服务\n\n以下示例以使用Go SDK访问OSS为例介绍如何基于STS Token访问云服务，该示例可以实现基于STS Token访问某个OSS Bucket并列举其中的所有文件。说明 \n\n该示例仅用于演示基于STS Token访问云服务的方法，实际场景中请根据自身业务编写代码，具体请参考您要使用的云服务的SDK。\n\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"flag\"\n\t\"log\"\n\t\"os/exec\"\n\t\"github.com/aliyun/aliyun-oss-go-sdk/oss\"\n)\n\nconst (\n\tsecurityCredUrl = \"http://100.100.100.200/latest/meta-data/ram/security-credentials/\"\n)\n\nvar (\n\tossEndpoint   string\n\tossBucketName string\n)\n\nfunc init() {\n\tflag.StringVar(&ossEndpoint, \"endpoint\", \"oss-cn-hangzhou-internal.aliyuncs.com\", \"Please input oss endpoint, Recommended internal endpoint, eg: oss-cn-hangzhou-internal.aliyuncs.com\")\n\tflag.StringVar(&ossBucketName, \"bucket\", \"\", \"Please input oss bucket name\")\n}\n\ntype AssumedRoleUserCredentialsWithServiceIdentity struct {\n\tAccessKeyId     string json:\"AccessKeyId\" xml:\"AccessKeyId\"\n\tAccessKeySecret string json:\"AccessKeySecret\" xml:\"AccessKeySecret\"\n\tExpiration      string json:\"Expiration\" xml:\"Expiration\"\n\tSecurityToken   string json:\"SecurityToken\" xml:\"SecurityToken\"\n\tLastUpdated     string json:\"LastUpdated\" xml:\"LastUpdated\"\n\tCode            string json:\"Code\" xml:\"Code\"\n}\n\nfunc main() {\n\tflag.Parse()\n\n\tif ossEndpoint == \"\" {\n\t\tlog.Fatal(\"Please input oss endpoint, eg: oss-cn-hangzhou-internal.aliyuncs.com\")\n\t}\n\tif ossBucketName == \"\" {\n\t\tlog.Fatal(\"Please input oss endpoint\")\n\t}\n\n\toutput, err := exec.Command(\"curl\", securityCredUrl).O"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group", "page_type": "doc", "title": "配置安全组", "keywords": "配置ECI安全组,为ECI Pod指定安全组,ECI安全组配置方法,ECI安全组操作指南", "last_modified_ms": 1709193985000, "last_modified_iso": "2024-02-29T16:06:25+08:00", "excerpt": "安全组是一种虚拟防火墙，具备状态检测和数据包过滤能力，用于在云端划分安全域。通过添加安全组规则，您可以控制安全组内ECI Pod（即ECI实例）的入流量和出流量。\n## 安全组介绍\n\n安全组是一个逻辑上的分组，由同一VPC内具有相同安全保护需求并相互信任的实例组成。通过添加安全组规则，安全组可以允许或拒绝安全组内ECI实例对公网或者私网的访问，以及管理是否放行来自公网或私网的访问请求。更多信息，请参见[安全组概述](https://help.aliyun.com/zh/ecs/user-guide/overview-44#concept-o2y-mqw-ydb)。重要 \n\n- \n\n一个安全组可以管理同一个VPC内的多个ECI实例。\n- \n\n一个ECI实例必须属于一个安全组。\n\n安全组分为普通安全组和企业安全组。如果您对整体规模和运维效率有较高需求，建议您使用企业安全组。相比普通安全组，企业安全组大幅提升了组内支持容纳的实例数量，简化了规则配置方式。更多关于两种安全组的差异信息，请参见[普通安全组与企业级安全组](https://help.aliyun.com/zh/ecs/user-guide/basic-security-groups-and-advanced-security-groups)。\n## 指定安全组\n\n自建Kubernetes集群通过对接VNode来使用ECI时，ECI Pod默认采用所属VNode配置的安全组。如果有特殊需求，您也可以为某些ECI Pod指定其他安全组。\n### 集群配置\n\n- \n\n新建VNode配置\n\n创建VNode时，您可以指定安全组。具体操作，请参见[创建虚拟节点](https://help.aliyun.com/zh/eci/user-guide/manually-connect-a-vnode-to-a-self-managed-kubernetes-cluster#section-h3v-ejq-xz0)。\n- \n\n已有Vnode配置\n\n对于已有VNode，您可以调用UpdateVirtualNode接口更新VNode信息，在SecurityGroupId字段中可以更新安全组ID。更多信息，请参见[UpdateVirtualNode](https://help.aliyun.com/zh/eci/api-updatevirtualnode#section-yaq-p4c-h9o)。\n\n### ECI Pod配置\n\n对于有特殊需求的某些ECI Pod，可以添加k8s.aliyun.com/eci-security-group的Annotation来指定安全组。配置要求如下：\n\n- \n\n支持指定一个或多个安全组，最多可以指定5个安全组。\n- \n\n指定的安全组必须属于同一VPC。\n- \n\n指定的安全组的类型必须相同。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-security-group: \"sg-bp1dktddjsg5nktv****,sg-2ze0b9o8pjjzts4h****\"      #指定安全组\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n## 添加安全组规则\n\n对于安全组内的ECI实例，您可以添加安全组规则来控制其出入流量。例如：\n\n- \n\n当ECI实例需要与所在安全组之外的网络进行通信时，您可以添加允许访问的安全组规则，实现网络互通。\n- \n\n在运行ECI实例的过程中，发现部分请求来源有恶意攻击行为时，您可以添加拒绝访问的安全组规则，实现网络隔离。\n\n关于如何添加安全组规则，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-1", "page_type": "doc", "title": "配置ECI Pod所属安全组", "keywords": "配置ECI Pod安全组,ECI Pod安全组配置方法,ECI Pod安全组介绍", "last_modified_ms": 1705052290000, "last_modified_iso": "2024-01-12T17:38:10+08:00", "excerpt": "安全组是一种虚拟防火墙，具备状态检测和数据包过滤能力，用于在云端划分安全域。通过添加安全组规则，您可以控制安全组内ECI Pod（即ECI实例）的入流量和出流量。\n## 安全组介绍\n\n安全组是一个逻辑上的分组，由同一VPC内具有相同安全保护需求并相互信任的实例组成。通过添加安全组规则，安全组可以允许或拒绝安全组内ECI实例对公网或者私网的访问，以及管理是否放行来自公网或私网的访问请求。更多信息，请参见[安全组概述](https://help.aliyun.com/zh/ecs/user-guide/overview-44#concept-o2y-mqw-ydb)。重要 \n\n- \n\n一个安全组可以管理同一个VPC内的多个ECI实例。\n- \n\n一个ECI实例必须属于一个安全组。\n\n安全组分为普通安全组和企业安全组。如果您对整体规模和运维效率有较高需求，建议您使用企业安全组。相比普通安全组，企业安全组大幅提升了组内支持容纳的实例数量，简化了规则配置方式。更多关于两种安全组的差异信息，请参见[普通安全组与企业级安全组](https://help.aliyun.com/zh/ecs/user-guide/basic-security-groups-and-advanced-security-groups)。\n## 指定安全组\n\n在ACK集群中创建ECI Pod时，Pod默认会加入到eci-profile配置的安全组中。如果有特殊需求，您也可以为某些ECI Pod指定其他安全组。操作前，请先创建安全组，具体操作，请参见[创建安全组](https://help.aliyun.com/zh/ecs/user-guide/create-a-security-group-1)。重要 \n\n创建成功的ECI Pod不支持修改所属安全组。如果想要变更安全组，需要重新创建ECI Pod。\n### 集群配置\n\neci-profile配置文件中包含了安全组配置信息。您可以通过kubectl edit命令进行修改。\n\nkubectl edit configmap eci-profile -n kube-system\n\n说明 \n\n集群中的VK（ACK Virtual Node组件）版本为v2.0.0.90-15deb126e-aliyun及以上时，支持修改eci-profile实现配置热更新。如果您的VK版本低于该版本，建议您升级VK。\n\n修改data中的securityGroupId字段即可修改安全组配置，示例如下：\n\ndata:\n  enableClusterIp: \"true\"\n  enableHybridMode: \"false\"\n  enablePrivateZone: \"false\"\n  resourceGroupId: \"\"\n  securityGroupId: sg-2ze0b9o8pjjzts4h**** # 指定安全组ID，仅支持单个\n  selectors: \"\"\n  vSwitchIds: vsw-2zeet2ksvw7f14ryz****,vsw-2ze94pjtfuj9vaymf****  \n  vpcId: vpc-2zeghwzptn5zii0w7****\n\n\n### ECI Pod配置\n\n对于有特殊需求的某些ECI Pod，可以添加k8s.aliyun.com/eci-security-group的Annotation来指定安全组。配置要求如下：\n\n- \n\n支持指定一个或多个安全组，最多可以指定5个安全组。\n- \n\n指定的安全组必须属于同一VPC。\n- \n\n指定的安全组的类型必须相同。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-security-group: \"sg-bp1dktddjsg5nktv****,sg-2ze0b9o8pjjzts4h****\"      #指定安全组\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n## 添加安全组规则\n\n对于安全组内的ECI实例，您可以添加安全组规则来控制其出入流量。例如：\n\n- \n\n当ECI实例需要与所在安全组之外的网络进行通信时，您可以添加允许访问的安全组规则，实现网络互通。\n- \n\n在运行ECI实例的过程中，发现部分请求来源有恶意攻击行为时，您可以添加拒绝访问的安全组规则，实现网络隔离。\n\n关于如何添加安全组规则，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group-2", "page_type": "doc", "title": "配置ECI实例所属安全组", "keywords": "配置ECI实例安全组,ECI实例安全组配置,ECI安全组限制", "last_modified_ms": 1705024916000, "last_modified_iso": "2024-01-12T10:01:56+08:00", "excerpt": "安全组是一种虚拟防火墙，具备状态检测和数据包过滤能力，用于在云端划分安全域。通过添加安全组规则，您可以控制安全组内ECI实例的入流量和出流量。\n## 安全组介绍\n\n安全组是一个逻辑上的分组，由同一VPC内具有相同安全保护需求并相互信任的实例组成。通过添加安全组规则，安全组可以允许或拒绝安全组内ECI实例对公网或者私网的访问，以及管理是否放行来自公网或私网的访问请求。更多信息，请参见[安全组概述](https://help.aliyun.com/zh/ecs/user-guide/overview-44#concept-o2y-mqw-ydb)。重要 \n\n- \n\n一个安全组可以管理同一个VPC内的多个ECI实例。\n- \n\n一个ECI实例必须属于一个安全组。\n\n安全组分为普通安全组和企业安全组。如果您对整体规模和运维效率有较高需求，建议您使用企业安全组。相比普通安全组，企业安全组大幅提升了组内支持容纳的实例数量，简化了规则配置方式。更多关于两种安全组的差异信息，请参见[普通安全组与企业级安全组](https://help.aliyun.com/zh/ecs/user-guide/basic-security-groups-and-advanced-security-groups)。\n## 指定安全组\n\n创建ECI实例时，必须要指定安全组，即必须要将ECI实例加入到安全组中。关于如何创建安全组，请参见[创建安全组](https://help.aliyun.com/zh/ecs/user-guide/create-a-security-group-1)。重要 \n\n创建成功的ECI实例不支持修改安全组。如果想要变更安全组，需要重新创建ECI实例。\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过SecurityGroupId参数来指定安全组。SecurityGroupId的参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nSecurityGroupId\n\nString\n\nsg-uf66jeqopgqa9hdn****\n\n指定安全组ID。\n## 控制台\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)创建ECI实例时，必须要选择一个安全组。\n\n## 添加安全组规则\n\n对于安全组内的ECI实例，您可以添加安全组规则来控制其出入流量。例如：\n\n- \n\n当ECI实例需要与所在安全组之外的网络进行通信时，您可以添加允许访问的安全组规则，实现网络互通。\n- \n\n在运行ECI实例的过程中，发现部分请求来源有恶意攻击行为时，您可以添加拒绝访问的安全组规则，实现网络隔离。\n\n关于如何添加安全组规则，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/assign-an-ipv6-address-to-an-elastic-container-instance", "page_type": "doc", "title": "为ECI Pod分配IPv6地址", "keywords": "配置ECI Pod IPv6地址,ECI Pod IPv6配置方法,ECI Pod IPv6注解", "last_modified_ms": 1705642400000, "last_modified_iso": "2024-01-19T13:33:20+08:00", "excerpt": "ECI Pod（即ECI实例）同时支持IPv4和IPv6地址，相比IPv4，IPv6大大扩展了地址的可用空间。本文介绍如何为ECI Pod分配IPv6地址。\n## 背景信息\n\nIPv4的应用范围虽广，但网络地址资源有限，制约了互联网的发展。IPv6不仅可以解决网络地址资源有限的问题，还可以解决多种接入设备连入互联网障碍的问题。更多信息，请参见[IPv6网关介绍](https://help.aliyun.com/zh/ipv6-gateway/product-overview/what-is-an-ipv6-gateway/#concept-kjx-3nt-zfb)。\n\nECI实例配置IPv6地址的相关限制如下：\n\n- \n\n每个ECI实例最多只能绑定一个IPv6地址。\n- \n\n指定vCPU和内存创建的ECI实例均支持配置IPv6地址。指定ECS规格创建ECI实例时，请先确保指定的ECS规格支持IPv6。关于ECS规格是否支持IPv6，请参见[ECS实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)。\n\n## 前提条件\n\n已为ECI实例所属的VPC和交换机开通IPv6网段。具体操作，请参见[VPC开通IPv6](https://help.aliyun.com/zh/ipv6-gateway/user-guide/enable-ipv6-for-a-vpc#task-2198980)和[交换机开通IPv6](https://help.aliyun.com/zh/ipv6-gateway/user-guide/enable-ipv6-for-a-vswitch-1#task-2201969)。\n## 配置说明\n\nKubernetes场景下，您可以在Pod metadata中添加Annotation来为ECI Pod绑定一个IPv6地址，开通并设置IPv6地址的公网带宽。相关Annotation如下：\n\n[表格]\n\nAnnotation\n\n示例值\n\n是否必选\n\n说明\n\nk8s.aliyun.com/eci-enable-ipv6\n\n\"true\"\n\n是\n\n配置为true表示为Pod绑定一个IPv6地址。\n\nk8s.aliyun.com/eci-ipv6-bandwidth-enable\n\n\"true\"\n\n否\n\n配置为true表示开通ECI的IPv6公网通信能力。\n\nk8s.aliyun.com/eci-ipv6-bandwidth\n\n200\n\n否\n\n配置IPv6地址的公网带宽峰值。取值如下：\n\n- \n\n当IPv6网关的公网带宽计费方式为按固定带宽计费时，IPv6地址的公网带宽范围为1~2000 Mbps。\n- \n\n当IPv6网关的公网带宽计费方式为按使用流量计费时，IPv6地址的公网带宽范围为1~1000 Mbps。\n说明 \n\n开通IPv6公网通信能力时如果没有配置该Annotation，则Pod所绑定的IPv6地址的公网带宽默认为网关支持的公网带宽最大值。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-enable-ipv6: \"true\"               # 为Pod绑定一个IPv6地址\n        k8s.aliyun.com/eci-ipv6-bandwidth-enable: \"true\"     # 开通IPv6公网通信能力\n        k8s.aliyun.com/eci-ipv6-bandwidth: 100M              # 设置IPv6地址的公网带宽峰值\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n创建ECI Pod后，您可以通过kubectl describe pod命令查看Pod详情，在返回的Annotations中，通过k8s.aliyun.com/allocated-ipv6Address字段可以获取该Pod的IPv6地址。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/assign-an-ipv6-address-to-an-elastic-container-instance-1", "page_type": "doc", "title": "为ECI实例分配IPv6地址", "keywords": "分配ECI实例IPv6地址,查询ECI IPv6配置参数,ECI实例IPv6地址配置,ECI实例IPv6使用限制", "last_modified_ms": 1705642367000, "last_modified_iso": "2024-01-19T13:32:47+08:00", "excerpt": "ECI实例同时支持IPv4和IPv6地址，相比IPv4，IPv6大大扩展了地址的可用空间。本文介绍如何为ECI实例分配一个IPv6地址。\n## 背景信息\n\nIPv4的应用范围虽广，但网络地址资源有限，制约了互联网的发展。IPv6不仅可以解决网络地址资源有限的问题，还可以解决多种接入设备连入互联网障碍的问题。更多信息，请参见[IPv6网关介绍](https://help.aliyun.com/zh/ipv6-gateway/product-overview/what-is-an-ipv6-gateway/#concept-kjx-3nt-zfb)。\n\nECI实例配置IPv6地址的相关限制如下：\n\n- \n\n每个ECI实例最多只能绑定一个IPv6地址。\n- \n\n指定vCPU和内存创建的ECI实例均支持配置IPv6地址。指定ECS规格创建ECI实例时，请先确保指定的ECS规格支持IPv6。关于ECS规格是否支持IPv6，请参见[ECS实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)。\n\n## 前提条件\n\n已为ECI实例所属的VPC和交换机开通IPv6网段。具体操作，请参见[VPC开通IPv6](https://help.aliyun.com/zh/ipv6-gateway/user-guide/enable-ipv6-for-a-vpc#task-2198980)和[交换机开通IPv6](https://help.aliyun.com/zh/ipv6-gateway/user-guide/enable-ipv6-for-a-vswitch-1#task-2201969)。\n## 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Ipv6AddressCount等参数来为ECI实例分配IPv6地址。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nIpv6AddressCount\n\nInteger\n\n1\n\nIPv6地址数。固定为1，即一个ECI实例仅支持绑定一个IPv6地址。\n\nIpv6GatewayBandwidthEnable\n\nBoolean\n\ntrue\n\n是否开通ECI的IPv6公网通信能力。\n\nIpv6GatewayBandwidth\n\nInteger\n\n100\n\n当Ipv6GatewayBandwidthEnable配置为true时，配置IPv6地址的公网带宽峰值。取值如下：\n\n- \n\n当IPv6网关的公网带宽计费方式为按固定带宽计费时，IPv6地址的公网带宽范围为1~2000 Mbps。\n- \n\n当IPv6网关的公网带宽计费方式为按使用流量计费时，IPv6地址的公网带宽范围为1~1000 Mbps。\n\n默认值为网关对应带宽范围的最大值。\n\n创建ECI实例后，您可以调用[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)接口查询实例详情，在返回的Ipv6Address字段中可以获取该实例的IPv6地址。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/assign-an-ipv6-address-to-an-elastic-container-instance-2", "page_type": "doc", "title": "配置IPv6地址", "keywords": "配置ECI实例IPv6,开通ECI IPv6公网,ECI IPv6配置方法,ECI IPv6注解说明", "last_modified_ms": 1736851054000, "last_modified_iso": "2025-01-14T18:37:34+08:00", "excerpt": "ECI实例（即ECI Pod）同时支持IPv4和IPv6地址，相比IPv4，IPv6大大扩展了地址的可用空间。本文介绍如何为ECI实例配置IPv6地址。\n## 背景信息\n\nIPv4的应用范围虽广，但网络地址资源有限，制约了互联网的发展。IPv6不仅可以解决网络地址资源有限的问题，还可以解决多种接入设备连入互联网障碍的问题。更多信息，请参见[IPv6网关介绍](https://help.aliyun.com/zh/ipv6-gateway/product-overview/what-is-an-ipv6-gateway/#concept-kjx-3nt-zfb)。\n\nECI实例配置IPv6地址的相关限制如下：\n\n- \n\n每台ECI实例最多只能绑定一个IPv6地址。\n- \n\n指定vCPU和内存创建的ECI实例均支持配置IPv6地址。指定ECS规格创建ECI实例时，请先确保指定的ECS规格支持IPv6。关于ECS规格是否支持IPv6，请参见[ECS实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)。\n\n## 准备工作\n\n使用IPv6前，请完成以下准备工作：\n\n- \n\n为ECI实例所属的VPC和交换机开通IPv6网段。具体操作，请参见[VPC开通IPv6](https://help.aliyun.com/zh/ipv6-gateway/user-guide/enable-ipv6-for-a-vpc#task-2198980)和[交换机开通IPv6](https://help.aliyun.com/zh/ipv6-gateway/user-guide/enable-ipv6-for-a-vswitch-1#task-2201969)。\n- \n\n（可选）创建IPv6网关。具体操作，请参见[创建和管理IPv6网关](https://help.aliyun.com/zh/ipv6-gateway/user-guide/create-and-manage-an-ipv6-gateway#task-2202006)。\n\nIPv6网关提供不同的规格（免费版、企业版和企业增强版），不同规格网关提供的能力不同。VPC开通IPv6网段后，系统会为VPC自动创建一个免费版的IPv6网关。您可以根据需要创建不同规格的IPv6网关。\n- \n\n如果想要通过IPv6地址进行公网通信，需要为IPv6网关开通IPv6公网带宽。具体操作，请参见[开通和管理IPv6公网带宽](https://help.aliyun.com/zh/ipv6-gateway/user-guide/enable-and-manage-ipv6-internet-bandwidth#task-2202589)。\n\n## 配置说明\n\nKubernetes场景下，您可以在Pod metadata中添加Annotation来为ECI Pod绑定一个IPv6地址，开通并设置IPv6地址的公网带宽。相关Annotation如下：\n\n[表格]\n\nAnnotation\n\n示例值\n\n是否必选\n\n说明\n\nk8s.aliyun.com/eci-enable-ipv6\n\n\"true\"\n\n是\n\n配置为true表示为Pod绑定一个IPv6地址。\n\nk8s.aliyun.com/eci-ipv6-bandwidth-enable\n\n\"true\"\n\n否\n\n配置为true表示开通ECI的IPv6公网通信能力。\n\nk8s.aliyun.com/eci-ipv6-bandwidth\n\n200\n\n否\n\n配置IPv6地址的公网带宽峰值。取值如下：\n\n- \n\n当IPv6网关的公网带宽计费方式为按固定带宽计费时，IPv6地址的公网带宽范围为1~2000 Mbps。\n- \n\n当IPv6网关的公网带宽计费方式为按使用流量计费时，IPv6地址的公网带宽范围为1~1000 Mbps。\n说明 \n\n开通IPv6公网通信能力时如果没有配置该Annotation，则Pod所绑定的IPv6地址的公网带宽默认为网关支持的公网带宽最大值。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-enable-ipv6: \"true\"    #为Pod绑定一个IPv6地址\n        k8s.aliyun.com/eci-ipv6-bandwidth-enable: \"true\"     #开通ECI的IPv6公网通信能力\n        k8s.aliyun.com/eci-ipv6-bandwidth: 100M    #设置IPv6地址的公网带宽峰值\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/automatically-scale-elastic-container-instances-based-on-real-time-workloads", "page_type": "doc", "title": "根据实时负载自动扩缩容ECI实例", "keywords": "自动扩缩容ECI实例,配置ECI弹性伸缩,灰度升级ECI应用,ECI实例自动扩缩容,ECI弹性伸缩配置,ECI应用升级方案", "last_modified_ms": 1758531959000, "last_modified_iso": "2025-09-22T17:05:59+08:00", "excerpt": "ECI支持搭配使用阿里云弹性伸缩（ESS）服务，实现根据实时负载动态增加或者减少ECI实例，从而提升资源利用率和系统可用性，降低使用成本。本文以Spring Boot容器应用为例，演示如何配置负载均衡和弹性伸缩，实现根据实时负载自动扩缩容ECI实例。\n## 背景信息\n\n本文将通过Spring Boot容器应用来演示以下场景：\n\n- \n\n通过阿里云弹性伸缩和负载均衡服务，实现根据实时负载自动扩缩容ECI实例。\n- \n\n结合ECI的镜像缓存、日志采集、监控等能力验证Serverless场景下的容器弹性能力。\n- \n\n借助弹性伸缩原生的扩缩容能力进行应用的灰度升级。\n\n本文示例中各组件的关系如下图所示：\n## 配置说明\n### 配置应用镜像\n\n本文示例基于Spring Boot实现了一个简易的HTTP Server，可以监听外部请求并为每个请求消耗5s左右的CPU时间。源代码详见[SpringBootDemo](https://github.com/aliyuneci/SpringBootDemo)。说明 \n\n示例采用TCP 8761端口作为应用监听的端口，也可自定义端口。\n\n- \n\n编译应用得到.jar文件，然后通过Docker打包成镜像。\n\nFROM java:8\nADD target/*.jar /app.jar\nENTRYPOINT [\"java\", \"-jar\", \"/app.jar\"]\n\n\n- \n\n将打包好的镜像推送到镜像仓库中。\n\n### 配置负载均衡\n\n应用一般采用分布式多副本部署，当应用需要对外提供服务时，则需要负载均衡来实现流量分发，本文使用阿里云负载均衡SLB服务来实现（SLB分为ALB和CLB，本文以CLB为例）。相关操作如下：\n\n- \n\n登录[传统型负载均衡CLB控制台](https://slbnew.console.aliyun.com/slb/cn-beijing/slbs)。\n- \n\n创建CLB实例。\n\nCLB实例是负载均衡服务实体，用于接收流量并进行分发。具体操作，请参见[创建CLB实例](https://help.aliyun.com/zh/slb/classic-load-balancer/user-guide/create-and-manage-a-clb-instance#task-ctx-xsm-vdb)。\n- \n\n配置监听。\n\n监听可以检查客户端请求，并将请求发送到后端服务器。由于示例应用开启的端口为TCP 8761端口，则CLB实例需要监听的后端端口为TCP 8761端口。具体操作，请参见[添加TCP监听](https://help.aliyun.com/zh/slb/classic-load-balancer/user-guide/add-a-tcp-listener#task-1563673)。\n\n### 配置伸缩组\n\n- \n\n登录[弹性伸缩控制台](https://essnew.console.aliyun.com/?#/v3/group/list/cn-beijing)。\n- \n\n创建弹性伸缩组。\n\n- \n\n在左侧导航栏，单击伸缩组管理。\n- \n\n在顶部菜单栏，选择地域。\n- \n\n单击创建伸缩组。\n- \n\n在弹出的对话框中完成伸缩组配置。\n\n创建时需要注意的参数如下表所示。更多信息，请参见[创建伸缩组](https://help.aliyun.com/zh/auto-scaling/user-guide/manage-scaling-groups#concept-25882-zh)。\n\n[表格]\n\n参数\n\n描述\n\n示例\n\n伸缩组类型\n\n伸缩组内的实例类型。此处必须选择ECI。\n\nECI\n\n组内实例配置信息来源\n\n对应伸缩配置，包含扩容时创建的实例的配置信息。\n\n- \n\n选择已有实例：采用已有实例的信息，创建对应的伸缩配置。\n- \n\n从零开始创建：等伸缩组创建完成后再进行伸缩配置。\n\n从零开始创建\n\n组内最小实例数\n\n伸缩组内的实例数量下限。当实例数量低于该下限时，伸缩组会自动添加实例，使得伸缩组内的实例数量等于下限。\n\n1\n\n组内最大实例数\n\n伸缩组内的实例数量上限。当实例数量高于该上限时，伸缩组会自动移出实例，使得伸缩组内的实例数量等于上限。\n\n50\n\n专有网络\n\n选择ECI实例所属的专有网络。\n\nvpc-2zeghwzptn5zii0******\n\n选择交换机\n\n选择ECI实例所示的交换机，建议选择多个交换机实现多可用区功能。\n\n- \n\nvsw-2zevanrscmoiaxr******\n- \n\nvsw-2ze23nqzig8inpr******\n\n关联传统型负载均衡CLB（原SLB）\n\n关联CLB后，加入伸缩组的实例会自动添加为CLB实例的后端服务器。此处选择已创建的CLB实例。\n\nlb-2zerkwijjdblq4n******\n\n- \n\n创建并启用伸缩配置。\n\n- \n\n在伸缩组管理页面，找到目标伸缩组，单击组内实例配置信息来源列对应的创建伸缩配置。\n- \n\n在弹出页面完成伸缩配置。\n\n创建时需要注意的参数如下表所示。更多信息，请参见[创建伸缩配置（ECI实例）](https://help.aliyun.com/zh/auto-scaling/user-guide/create-a-scaling-configuration-of-the-eci-type/#concept-25890-zh)。\n\n[表格]\n\n配置模块\n\n参数\n\n描述\n\n容器组配置\n\nCPU、内存\n\n请根据业务需要选择vCPU和内存规格。本文示例为4 vCPU、8 GiB内存。\n\n存储\n\n如果应用需要使用配置项，或者需要NAS等外部存储，则需要添加数据卷。更多信息，请参见[数据卷](https://help.aliyun.com/zh/eci/user-guide/overview-of-volumes#topic-1860107)。\n\n临时存储大小\n\nECI实例默认提供30 GiB的免费存储空间，如果无法满足需求，可额外增加临时存储空间。更多信息，请参见[增加临时存储空间大小](https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space-1#topic-2043552)。\n\n镜像缓存\n\n镜像缓存用于加速拉取镜像。建议开启该功能，开启后在后续扩容ECI实例时无需拉取相同镜像，从而提高扩容速度。更多信息，请参见[镜像缓存概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2#topic-2131957)。\n\n容器配置\n\n镜像\n\n选择制作好的应用容器镜像以及版本。\n\n启动命令\n\n如果在镜像中没有设置好启动命令，可在此处配置，否则容器可能不会启动或者出现启动异常而退出。更多信息，请参见[设置容器启动命令和参数](https://help.aliyun.com/zh/eci/user-guide/configure-startup-commands-and-arguments-for-a-container#topic-1860110)。\n\n环境变量\n\n除了镜像自带的环境变量外，可自定义添加其他环境变量。建议采用环境变量来自定义配置日志采集，更多信息，请参见[自定义配置ECI日志采集](https://help.aliyun.com/zh/eci/user-guide/configure-log-collection-for-an-elastic-container-instance#topic-1860108)。\n\n示例如下图所示，表示将ECI实例的标准输出日志采集到自定义的store-ess配置中。\n\n启用伸缩配置后，系统将自动创建ECI实例，以满足伸缩组内的最小实例数要求，并将组内所有ECI实例加入到CLB的后端服务器组中。\n\n- \n\n创建伸缩规则。\n\n- \n\n在伸缩组管理页面，找到目标伸缩组，单击伸缩组ID。\n- \n\n单击伸缩规则与报警任务页签。\n- \n\n在伸缩规则页签下，单击创建伸缩规则。\n- \n\n在弹出的对话框中，完成伸缩规则配置。\n\n伸缩规则用于触发伸缩活动，分为简单规则和目标追踪规则等，本文以目标追踪规则为例，采用CPU使用率作为扩缩容指标，目标值为60%，创建时需要注意的参数如下表所示。\n\n[表格]\n\n参数\n\n描述\n\n示例\n\n规则类型\n\n分为简单规则和目标追踪规则：\n\n- \n\n简单规则：指定增加、减少的实例数，或者将实例数量调整到指定值。\n- \n\n目标追踪规则：选择某一监控指标并设置目标值，系统将自动增加或者减少实例数，使得监控指标值维持在目标值附近。\n\n目标追踪规则\n\n指标类型\n\n设置目标追踪规则时，需选择要监控的指标。\n\nCPU使用率\n\n目标值\n\n设置目标追踪规则时，需设置监控指标的目标值。\n\n60\n\n实例预热时间\n\n处于预热状态的实例正常加入伸缩组，但是不会向云监控上报监控数据。动态计算需要扩缩容的实例数量时，处于预热状态的实例不计入现有实例数量，以免造成指标值波动。\n\n30\n\n扩容报警触发的阈值次数\n\n触发扩容时，需要满足规则条件的次数。\n\n1\n\n缩容报警触发的阈值次数\n\n触发缩容时，需要满足规则条件的次数。\n\n10\n\n## 测试弹性伸缩效果\n\n默认情况下，弹性伸缩组保持初始状态，即组内实例数量为期望的实例数，不具备弹性伸缩的能力。配置伸缩规则后，当监控指标不满足规则条件时，将自动进行弹性伸"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/bind-custom-tags-to-a-pod", "page_type": "doc", "title": "为ECI Pod绑定自定义标签", "keywords": "为ECI Pod绑定标签,ECI Pod标签配置,ECI Pod自定义标签", "last_modified_ms": 1706600525000, "last_modified_iso": "2024-01-30T15:42:05+08:00", "excerpt": "标签由一组键值对组成，可以用于标记ECI实例。您可以使用标签来分组管理ECI实例，便于筛选和批量操作。本文介绍如何为ECI Pod绑定自定义标签（Tag），以便后续可以基于标签管理ECI Pod，例如基于标签进行费用分析。\n## 背景信息\n\n标签（Tag）是一组键值对，功能与Label类似，是阿里云提供的用于标识云资源，实现分类管理资源的功能。通过阿里云容器服务Kubernetes版创建的ECI实例默认带有以下标签：\n\n- \n\nManagedBy：集群类型。\n- \n\nClusterId：集群ID。\n- \n\nNameSpace：集群的命名空间。\n- \n\nOwnerReferenceKind：集群下创建的负载类型，例如Deployment、Job等。\n- \n\nOwnerReferenceName：集群下创建的负载名称，例如Deployment name、Job name等。\n- \n\nPodName：Pod名称。\n\n## 配置说明\n\n您可以通过k8s.aliyun.com/eci-custom-tags的Annotation为ECI Pod绑定自定义标签，最多可以绑定3个标签。标签键和标签值之间用半角冒号隔开，多个标签之间用半角逗号隔开。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-custom-tags : \"env:test,name:alice\"   #绑定标签\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n配置完成后，您可以通过kubectl describe命令查询Pod详情，从Annotation中可以查看k8s.aliyun.com/eci-custom-tags的值，即自定义标签。\n\n如果想要更加直观地查看ECI Pod绑定的标签信息，可在[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/welcome)的容器组页面查看。\n\n## 相关文档\n\n为ECI Pod绑定的自定义标签可用于账单分账管理，便于您进行费用分析。更多信息，请参见[通过控制台查看费用分析](https://help.aliyun.com/zh/eci/product-overview/view-your-bills#section-yzr-top-cfq)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/build-an-application-similar-to-a-wonderful-duck-camera", "page_type": "doc", "title": "搭建类似妙鸭相机的应用", "keywords": "搭建妙鸭相机应用,使用DataCache加速模型,妙鸭相机应用实践教程,DataCache加速AIGC应用,ECI部署AIGC应用", "last_modified_ms": 1741845615000, "last_modified_iso": "2025-03-13T14:00:15+08:00", "excerpt": "本文以使用ModelScope社区的人物AIGC基础模型（ID为ly261666/cv_portrait_model）搭建类似妙鸭相机的应用为例，演示如何使用DataCache。通过DataCache提前拉取模型数据，然后在创建应用实例时直接挂载模型数据，可以免去在实例中拉取模型数据的等待时间，加速应用部署。\n## 背景信息\n\n妙鸭相机是一款基于AIGC的应用，用户在小程序中上传一些个人照片，就能得到个人专属的数字分身，然后再挑选喜欢的风格模板，即可得到一组对应的个人写真。\n\n阿里云达摩院近期推出了开源版“妙鸭相机”，即[facechain](https://github.com/modelscope/facechain?spm=a2c6h.12873639.article-detail.7.4c025ae6tQIGxM)。facechain的基本原理是典型的SD（Stable Diffusion）+LoRA，流程大致如下：\n\n- \n\n对已有的几张个人照片（原图）进行训练，得到个人专属的面部LoRA权重。\n- \n\n基于标准的SD基础模型生成各种风格的个人照片（结果图）。说明 \n\nfacechain会在此基础上，使用多种人像、皮肤相关的模型进行人像优化，从而生成更优效果的照片。\n\n虽然目前开源版本的facechain下载后即可配置使用，但存在以下问题：\n\n- \n\n训练和推理的过程中会直接从模型Hub下载模型，整个应用涉及多个模型，大小约25 GB，导致整体耗时长，并且直接通过公网下载模型对带宽和网络稳定性要求很高，一旦无法下载就会失败。\n- \n\n不支持人脸记忆，只能基于当前最新的训练结果进行推理，即不能保留历史训练出来的LoRA权重。\n- \n\n如果想换个模型或者更新版本等，需要手动修改代码，维护复杂，配置不灵活。\n\n针对上述问题，ECI推出了优化版本，即[eci-facechain](https://github.com/liumihust/facechain/tree/feature/eci-facechain?spm=a2c6h.12873639.article-detail.10.4c025ae6tQIGxM)。主要优化点如下：\n\n- \n\n将模型数据放入ECI数据缓存中，应用启动后无需从模型Hub下载模型。\n- \n\n支持人脸记忆，训练流程支持给人脸打标签，推理时支持通过标签选择历史训练过的人脸进行生成。\n- \n\n新增环境变量配置项（详见env.py文件），无需修改应用代码即可通过容器的环境变量自定义SD的模型、版本、目录、以及应用端口等。\n- \n\n优化Web页面，例如支持设置生成照片的像素等。\n\n## 前提条件\n\n- \n\n集群中已[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n- \n\n集群所属VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建DataCache和部署应用时绑定EIP，以便可以拉取公网数据。\n\n## 准备运行环境\n\n- \n\n硬件要求\n\n需使用GPU规格。vCPU、内存等无具体要求，建议选择显存高的规格。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。\n- \n\n软件环境\n\nECI已基于eci-facechain制作了一个公共容器镜像，您可以直接使用该镜像或者将其作为基础镜像进行二次开发。镜像地址为registry.cn-hangzhou.aliyuncs.com/eci_open/facechain:1.0.2。\n\n## 操作步骤\n### 创建DataCache\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用人物AIGC基础模型（ID为ly261666/cv_portrait_model）的v4.0版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n编写DataCache的YAML配置文件，然后使用该YAML文件创建DataCache拉取人物AIGC基础模型。\n\nkubectl create -f datacache-test.yaml\n\n\ndatacache-test.yaml的内容示例如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: cv\nspec:\n  bucket: test  \n  path: /model/cv/ \n  dataSource:\n    type: URL \n    options:\n      repoSource: ModelScope/Model              # 指定数据源为ModelScope的模型\n      repoId: ly261666/cv_portrait_model        # 指定模型ID\n      revision: v4.0                            # 指定模型版本\n  retentionDays: 1\n  netConfig: \n    securityGroupId: sg-2ze63v3jtm8e6s******\n    vSwitchId: vsw-2ze94pjtfuj9vay******       # 指定已配置SNAT的交换机\n\n\n- \n\n查询DataCache状态。\n\nkubectl get edc\n\n\n当数据下载完成，DataCache的状态为Available时，表示可以使用DataCache。示例如下：\n\n### 搭建“妙鸭相机”\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件部署“妙鸭相机”应用。\n\nkubectl create -f cv.yaml\n\n\ncv.yaml的内容示例如下，可以创建一个包含1个Pod副本的Deployment，Pod使用GPU规格，并挂载了人物AIGC基础模型。Pod内容器使用ECI提供的镜像，容器启动后会运行一个Web服务，可通过8888端口访问。说明 \n\n- \n\n以下YAML示例中，系统会自动创建并为Pod绑定一个EIP。如果您的集群所属VPC已绑定公网NAT网关，可去掉该Annotation，在Pod创建成功后，您可以配置DNAT条目实现外部访问Pod。实际业务场景中，建议创建Service来统一提供Pod访问入口。\n- \n\n容器默认对外开放8888端口，如果想要修改端口，可通过设置容器环境变量APP_PORT来指定端口。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cv\n  labels:\n    app: cv\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cv\n  template:\n    metadata:\n      name: cv\n      labels:\n        app: cv\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.gn7i-c8g1.2xlarge\"    # 指定GPU规格\n        k8s.aliyun.com/eci-data-cache-bucket: \"test\"             # 指定DataCache Bucket\n        k8s.aliyun.com/eci-with-eip: \"true\"                      # 自动创建并绑定EIP，以便外部可以访问\n    spec:\n      containers:\n      - name: cv\n        image: registry.cn-hangzhou.aliyuncs.com/eci_open/facechain:1.0.2  # 使用ECI制作好的镜像\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"           # 设置容器所需的GPU数\n        volumeMounts:\n        - name: \"model-cv\"\n          mountPath: \"/mnt/workspace/.cache/modelscope/ly261666/cv_portrait_model/\"  # 模型数据在容器内的挂载路径\n      volumes: \n      - name: \"model-cv\"\n        hostPath:             \n          path: \"/model/cv/\"    # 挂载模型数据\n\n\n- \n\n确认应用部署状态。\n\nkubectl get deployment cv\nkubectl get P"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/build-an-application-similar-to-a-wonderful-duck-camera-1", "page_type": "doc", "title": "搭建类似妙鸭相机的应用", "keywords": "搭建妙鸭相机应用,使用ECI数据缓存,加速AIGC应用部署,妙鸭相机搭建教程,ECI数据缓存实践,AIGC应用部署", "last_modified_ms": 1758531377000, "last_modified_iso": "2025-09-22T16:56:17+08:00", "excerpt": "本文以部署ModelScope社区的人物AIGC基础模型（ly261666/cv_portrait_model）搭建类似妙鸭相机的应用为例，演示如何使用数据缓存。通过数据缓存提前拉取模型数据，然后在创建应用实例时直接挂载模型数据，可以免去在实例中拉取模型数据的等待时间，加速应用部署。\n\n## 背景信息\n\n妙鸭相机是一款基于AIGC的应用，用户在小程序中上传一些个人照片，就能得到个人专属的数字分身，然后再挑选喜欢的风格模板，即可得到一组对应的个人写真。\n\n阿里云达摩院近期推出了开源版“妙鸭相机”，即[facechain](https://github.com/modelscope/facechain?spm=a2c6h.12873639.article-detail.7.4c025ae6tQIGxM)。facechain的基本原理是典型的SD（Stable Diffusion）+LoRA，流程大致如下：\n\n- \n\n对已有的几张个人照片（原图）进行训练，得到个人专属的面部LoRA权重。\n- \n\n基于标准的SD基础模型生成各种风格的个人照片（结果图）。说明 \n\nfacechain会在此基础上，使用多种人像、皮肤相关的模型进行人像优化，从而生成更优效果的照片。\n\n虽然目前开源版本的facechain下载后即可配置使用，但存在以下问题：\n\n- \n\n训练和推理的过程中会直接从模型Hub下载模型，整个应用涉及多个模型，大小约25 GB，导致整体耗时长，并且直接通过公网下载模型对带宽和网络稳定性要求很高，一旦无法下载就会失败。\n- \n\n不支持人脸记忆，只能基于当前最新的训练结果进行推理，即不能保留历史训练出来的LoRA权重。\n- \n\n如果想换个模型或者更新版本等，需要手动修改代码，维护复杂，配置不灵活。\n\n针对上述问题，ECI推出了优化版本，即[eci-facechain](https://github.com/liumihust/facechain/tree/feature/eci-facechain?spm=a2c6h.12873639.article-detail.10.4c025ae6tQIGxM)。主要优化点如下：\n\n- \n\n将模型数据放入ECI数据缓存中，应用启动后无需从模型Hub下载模型。\n- \n\n支持人脸记忆，训练流程支持给人脸打标签，推理时支持通过标签选择历史训练过的人脸进行生成。\n- \n\n新增环境变量配置项（详见env.py文件），无需修改应用代码即可通过容器的环境变量自定义SD的模型、版本、目录、以及应用端口等。\n- \n\n优化Web页面，例如支持设置生成照片的像素等。\n\n## 前提条件\n\n您使用的VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建数据缓存和部署应用时绑定EIP，以便可以拉取公网数据。\n## 准备运行环境\n\n- \n\n硬件要求\n\n需使用GPU规格。vCPU、内存等无具体要求，建议选择显存高的规格。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。\n- \n\n软件环境\n\nECI已基于eci-facechain制作了一个公共容器镜像，您可以直接使用该镜像或者将其作为基础镜像进行二次开发。镜像地址为registry.cn-hangzhou.aliyuncs.com/eci_open/facechain:1.0.2。\n\n## 操作步骤\n### 创建数据缓存\n## 控制台\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用人物AIGC基础模型（ID为ly261666/cv_portrait_model）的v4.0版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在左侧导航栏，单击数据缓存。\n- \n\n创建人物AIGC基础模型的数据缓存。\n\n- \n\n单击创建数据缓存。\n- \n\n完成数据缓存参数配置。\n\n本文使用的参数示例如下，其中缓存数据源为拉取人物AIGC基础模型的固定配置，其他参数可自定义配置，更多信息，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches#3c9228a032ffp)。\n\n[表格]\n\n配置项\n\n示例值\n\n缓存所属Bucket\n\ntest\n\n缓存所属目录\n\n/model/cv\n\n缓存名\n\ncv\n\n缓存大小\n\n20 GiB\n\n缓存数据源\n\n- \n\n类型：URL\n- \n\n参数\n\n- \n\nrepoSource：ModelScope/Mode\n- \n\nrepoId：ly261666/cv_portrait_model\n- \n\nrevision：v4.0\n\n- \n\n单击确定。\n\n- \n\n查看数据缓存状态。\n\n在数据缓存页面刷新查看数据缓存状态，当状态为Available时，表示可以使用该数据缓存。\n\n## OpenAPI\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用人物AIGC基础模型（ID为ly261666/cv_portrait_model）的v4.0版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n创建人物AIGC基础模型的数据缓存。\n\n调用[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)接口创建数据缓存所采用的参数示例如下，表示从ModelScope拉取指定模型数据，保存到名为test的Bucket的/model/cv/目录。数据缓存名为cv，保留时长为1天。重要 \n\n如果您通过SDK创建数据缓存，DataSource.Options中的各个参数前无需添加参数名的长度，例如#10#repoSource直接写成repoSource，#6#repoId直接写成repoId即可。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"VSwitchId\": \"vsw-2ze23nqzig8inpr******\",\n  \"SecurityGroupId\": \"sg-2ze1003ujo0fuv******\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/model/cv/\",\n  \"Name\": \"cv\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#6#repoId\": \"ly261666/cv_portrait_model\",\n      \"#10#repoSource\": \"ModelScope/Model\",\n      \"#8#revision\": \"v4.0\"\n    }\n  },\n  \"RetentionDays\": 1\n}\n\n\n- \n\n查询数据缓存状态。\n\n根据返回的数据缓存ID调用[DescribeDataCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedatacaches)接口查询数据缓存信息，当数据缓存的状态（DataCaches.Status）为Available时，表示可以使用该数据缓存。\n\n### 搭建“妙鸭相机”\n## 控制台\n\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com/)的容器组页面，单击创建弹性容器组。\n- \n\n填写实例相关配置信息，然后单击配置确认。\n\n本文使用的参数示例如下，实例使用GPU规格，并挂载了人物AIGC基础模型的数据缓存。实例内容器使用ECI提供的制作好的facechain镜像，容器启动后会运行一个Web服务，可通过8888端口访问。说明 \n\n- \n\n当VPC已绑定公网NAT网关时，创建ECI实例时可以不绑定EIP。在实例创建完成后，可配置DNAT条目实现外部访问ECI实例。\n- \n\n容器默认对外开放8888端口，如果想要修改端口，可通过设置容器环境变量APP_PORT来指定端口。\n\n[表格]\n\n配置区域\n\n配置项\n\n示例值\n\n容器组配置\n\n指定规格\n\necs.gn6i-c4g1.xlarge\n\n名称\n\ncv\n\n容器配置\n\n容器名称\n\ncv\n\n镜像\n\n- \n\n镜像：registry.cn-hangzhou.aliyuncs.com/eci_open/facechain\n- \n\n镜像版本：1.0.2\n\n数据缓存\n\n缓存Bucket\n\ntest\n\n单击添加，挂载人物AIGC基础模型的数据缓存\n\n- \n\n缓存目录：/model/cv/\n- \n\n目标容器：cv\n- \n\n容器挂载目录：/mnt/workspace/.cache/modelscope/ly261"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/change-the-image-of-a-pod-without-changing-the-ip-address", "page_type": "doc", "title": "修改ECI Pod的镜像并保持IP不变", "keywords": "修改ECI Pod镜像,ECI Pod镜像更新,ECI Pod IP不变", "last_modified_ms": 1766048637000, "last_modified_iso": "2025-12-18T17:03:57+08:00", "excerpt": "对于部署在虚拟节点上的Pod应用，在应用迭代过程中，因为解决bug或者增加功能特性而制作新的镜像后，您可能需要修改镜像，同时为了不影响业务，需要保持Pod的IP不变。本文介绍如何通过kubectl命令修改Pod的容器镜像，并保持Pod的IP不变。\n## 前提条件\n\n已准备好要更新的镜像，且已将镜像上传到镜像仓库中。\n## 操作步骤\n\n下文以部署Nginx的Pod为例，介绍如何通过kubectl命令，将容器镜像从nginx:1.7.9修改为nginx:1.9.6，并保持Pod的IP不变。说明 \n\n体验以下示例请确保集群所属VPC已创建公网NAT网关并配置SNAT，以便可以拉取公网镜像。\n\n- \n\n创建一个ECI Pod。\n\nkubectl create -f nginx.yaml\n\n\nnginx.yaml的内容示例如下，使用的容器镜像为nginx:1.7.9。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  namespace: default\n  labels:\n    alibabacloud.com/eci: \"true\" \nspec:\n  containers:\n  - image: nginx:1.7.9\n    imagePullPolicy: Always\n    name: nginx\n\n\n- \n\n查询Pod信息。\n\n- \n\n查询Pod的IP。\n\nkubectl get pod/nginx -n default -o wide\n\n\n返回示例如下，可以看到Pod的IP为172.16.22.193。\n\nNAME    READY   STATUS    RESTARTS   AGE    IP              NODE                           NOMINATED NODE   READINESS GATES\nnginx   1/1     Running   0          5m5s   172.16.22.193   virtual-kubelet-cn-beijing-e   <none>           <none>\n\n\n- \n\n查询Pod的镜像tag。\n\nkubectl get pod/nginx -n default -o=custom-columns='IMAGE:spec.containers[*].image'\n\n\n返回示例如下，可以查看Pod的容器镜像为nginx:1.7.9。\n\nIMAGE\nnginx:1.7.9\n\n\n- \n\n选择以下一种方式修改镜像。\n\n- \n\nkubectl patch\n\n执行kubectl命令直接修改容器镜像tag。\n\nkubectl patch pod nginx -p '{\"spec\":{\"containers\":[{\"name\": \"nginx\",\"image\": \"nginx:1.9.6\"}]}}'\n\n\n- \n\nkubectl edit\n\n执行kubectl edit命令编辑Pod，直接修改容器镜像tag。\n\nkubectl edit pod/nginx -o yaml \n\n\n- \n\nkubectl apply\n\n打开Pod对应的nginx.yaml配置文件，修改容器镜像tag，然后执行kubectl apply命令重新部署Pod。\n\nkubectl apply -f nginx.yaml \n\n\n- \n\n查看修改后的Pod信息。\n\n- \n\n查询Pod的IP。\n\nkubectl get pod/nginx -n default -o wide\n\n\n返回示例如下，可以看到Pod的IP与修改前一致，为172.16.22.193。\n\nNAME    READY   STATUS    RESTARTS   AGE   IP              NODE                           NOMINATED NODE   READINESS GATES\nnginx   1/1     Running   1          19m   172.16.22.193   virtual-kubelet-cn-beijing-e   <none>           <none>\n\n\n- \n\n查询Pod的镜像tag。\n\nkubectl get pod/nginx -n default -o=custom-columns='IMAGE:spec.containers[*].image'\n\n\n返回示例如下，可以查看Pod的容器镜像已经修改为nginx:1.9.6。\n\nIMAGE\nnginx:1.9.6\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/change-the-image-of-a-pod-without-changing-the-ip-address-2", "page_type": "doc", "title": "修改ECI Pod的镜像并保持IP不变", "keywords": "修改ECI Pod镜像,保持ECI Pod IP,ECI Pod镜像更新,ECI Pod固定IP", "last_modified_ms": 1705025330000, "last_modified_iso": "2024-01-12T10:08:50+08:00", "excerpt": "对于部署在虚拟节点上的Pod应用，在应用迭代过程中，因为解决bug或者增加功能特性而制作新的镜像后，您可能需要修改镜像，同时为了不影响业务，需要保持Pod的IP不变。本文介绍如何通过kubectl命令修改Pod的容器镜像，并保持Pod的IP不变。\n## 前提条件\n\n已准备好要更新的镜像，且已将镜像上传到镜像仓库中。\n## 操作步骤\n\n下文以部署Nginx的Pod为例，介绍如何通过kubectl命令，将容器镜像从nginx:1.7.9修改为nginx:1.9.6，并保持Pod的IP不变。说明 \n\n体验以下示例请确保集群所属VPC已创建公网NAT网关并配置SNAT，以便可以拉取公网镜像。\n\n- \n\n创建一个ECI Pod。\n\nkubectl create -f nginx.yaml\n\n\nnginx.yaml的内容示例如下，使用的容器镜像为nginx:1.7.9。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  namespace: default\n  alibabacloud.com/eci: \"true\" \nspec:\n  containers:\n  - image: nginx:1.7.9\n    imagePullPolicy: Always\n    name: nginx\n\n\n- \n\n查询Pod信息。\n\n- \n\n查询Pod的IP。\n\nkubectl get pod/nginx -n default -o wide\n\n\n返回示例如下，可以看到Pod的IP为172.16.22.193。\n\nNAME    READY   STATUS    RESTARTS   AGE    IP              NODE                           NOMINATED NODE   READINESS GATES\nnginx   1/1     Running   0          5m5s   172.16.22.193   virtual-kubelet-cn-beijing-e   <none>           <none>\n\n\n- \n\n查询Pod的镜像tag。\n\nkubectl get pod/nginx -n default -o=custom-columns='IMAGE:spec.containers[*].image'\n\n\n返回示例如下，可以查看Pod的容器镜像为nginx:1.7.9。\n\nIMAGE\nnginx:1.7.9\n\n\n- \n\n选择以下一种方式修改镜像。\n\n- \n\nkubectl patch\n\n执行kubectl命令直接修改容器镜像tag。\n\nkubectl patch pod nginx -p '{\"spec\":{\"containers\":[{\"name\": \"nginx\",\"image\": \"nginx:1.9.6\"}]}}'\n\n\n- \n\nkubectl edit\n\n执行kubectl edit命令编辑Pod，直接修改容器镜像tag。\n\nkubectl edit pod/nginx -o yaml \n\n\n- \n\nkubectl apply\n\n打开Pod对应的nginx.yaml配置文件，修改容器镜像tag，然后执行kubectl apply命令重新部署Pod。\n\nkubectl apply -f nginx.yaml \n\n\n- \n\n查看修改后的Pod信息。\n\n- \n\n查询Pod的IP。\n\nkubectl get pod/nginx -n default -o wide\n\n\n返回示例如下，可以看到Pod的IP与修改前一致，为172.16.22.193。\n\nNAME    READY   STATUS    RESTARTS   AGE   IP              NODE                           NOMINATED NODE   READINESS GATES\nnginx   1/1     Running   1          19m   172.16.22.193   virtual-kubelet-cn-beijing-e   <none>           <none>\n\n\n- \n\n查询Pod的镜像tag。\n\nkubectl get pod/nginx -n default -o=custom-columns='IMAGE:spec.containers[*].image'\n\n\n返回示例如下，可以查看Pod的容器镜像已经修改为nginx:1.9.6。\n\nIMAGE\nnginx:1.9.6\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/cloud-storage-overview", "page_type": "doc", "title": "云存储概述", "keywords": "对比云存储服务,选择云存储方案,云存储服务概述,云存储服务对比", "last_modified_ms": 1718159131000, "last_modified_iso": "2024-06-12T10:25:31+08:00", "excerpt": "基于Kubernetes社区的CSI存储插件，阿里云提供了相关组件，可以实现自建Kubernetes使用阿里云存储服务，包括云盘、文件存储NAS和对象存储OSS。\n## 云存储介绍\n\n阿里云提供针对各种存储资源（块、文件和对象）的低成本、高可靠、高可用的存储服务，您可以根据业务负载的存储需求，考虑数据量、数据访问频率、IOPS和吞吐量等因素，来选择合适的云存储服务。常用的云存储服务如下：\n\n- \n\n云盘\n\n一种数据块级别的块存储产品，采用分布式多副本机制，具有低时延、高性能、持久性、高可靠等性能，可以随时创建、扩容以及释放。更多信息，请参见[云盘概述](https://help.aliyun.com/zh/ecs/user-guide/disks-2#concept-n1s-rzb-wdb)。\n- \n\n文件存储NAS\n\n一种可共享访问、弹性扩展、高可靠以及高性能的分布式文件系统，支持NFS和SMB协议。更多信息，请参见[文件存储NAS概述](https://help.aliyun.com/zh/nas/product-overview/what-is-nas#concept-qpg-wrt-1fb)。\n- \n\n对象存储OSS\n\n一个海量、安全、低成本、高可靠的存储空间，适合存储非结构化数据（如图片、音视频等）。更多信息，请参见[对象存储OSS概述](https://help.aliyun.com/zh/oss/user-guide/what-is-oss#concept-ybr-fg1-tdb)。\n\n三者的对比如下表所示：\n\n[表格]\n\n对比项\n\n云盘\n\n文件存储NAS\n\n对象存储OSS\n\n时延\n\n极低时延（微秒级）\n\n低时延（毫秒级）\n\n较低时延（几十毫秒级）\n\n吞吐\n\n数十Gbps\n\n数百Gbps\n\n数百Gbps\n\n访问模式\n\n单个客户端通过POSIX接口访问，随机读写。\n\n上千个客户端通过POSIX接口并发访问，随机读写。\n\n数百万个客户端通过Web并发，追加写。\n\n挂载方式\n\n非共享存储，一个云盘只能挂载到一个Pod。\n\n共享存储，一个NAS文件系统可以挂载到多个Pod。\n\n共享存储，一个OSS Bucket可以挂载到多个Pod。\n\n更多信息，请参见[阿里云存储服务](https://help.aliyun.com/document_detail/207150.html#concept-1948520)。\n## 挂载云存储\n\n- \n\n[挂载云盘](https://help.aliyun.com/zh/eci/user-guide/mount-a-disk-volume-3)\n- \n\n[挂载NAS](https://help.aliyun.com/zh/eci/user-guide/mount-a-nas-file-system-1)\n- \n\n[挂载OSS](https://help.aliyun.com/zh/eci/user-guide/mount-an-oss-bucket-as-a-volume-1)\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/collect-logs-by-using-environment-variables", "page_type": "doc", "title": "通过环境变量方式采集日志", "keywords": "配置ECI日志采集,用环境变量采集日志,ECI日志环境变量,ECI日志采集配置", "last_modified_ms": 1755488057000, "last_modified_iso": "2025-08-18T11:34:17+08:00", "excerpt": "ECI支持通过容器的环境变量传入日志相关的自定义配置。本文介绍如何通过环境变量来配置日志采集，实现通过阿里云日志服务SLS自动采集容器日志。重要 \n\n- \n\n对于 ACK Serverless集群，推荐您优先使用SLS CRD的方式采集日志。具体操作，请参见[通过SLS CRD采集日志](https://help.aliyun.com/zh/eci/user-guide/collect-logs-by-using-log-service-crds)。\n- \n\n请勿同时使用SLS CRD和环境变量方式，这可能会导致日志采集失败。\n\n## 背景信息\n\n阿里云日志服务SLS（Log Service）是针对日志数据的一站式服务，您无需开发就能快捷完成日志数据采集、消费、投递以及查询分析等功能。更多信息，请参见[日志服务简介](https://help.aliyun.com/zh/sls/what-is-log-service#concept-mt2-ykn-vdb)。\n## 前提条件\n\n已开通日志服务。登录[日志服务控制台](https://sls.console.aliyun.com/lognext/profile)时，如果没有开通日志服务，将收到相关提示，您可以根据页面提示开通。\n## 注意事项\n\n- \n\n仅在创建ECI实例时才能通过环境变量自定义配置日志采集，更新实例时传入的日志相关环境变量不会生效。\n- \n\n对于自定义配置的日志Project和Logtail配置，如果后续不再使用，请及时删除相关Project和Logtail配置，避免产生不必要的费用。\n- \n\n对自定义配置的环境变量名称进行修改后，原有的配置不会自动删除，请手动清理以免产生不必要的费用。\n\n## 配置说明\n\n日志相关环境变量名称的格式前缀为aliyun_logs_{key}，可配置的环境变量如下：重要 \n\n{key}表示日志服务中Logtail采集配置的名称，只能包含小写字母、数字和短划线（-）。您可以自定义配置{key}，但必须保证在K8s集群内唯一。\n\n[表格]\n\n配置对象\n\n是否必选\n\n环境变量名称\n\n说明\n\nLogtail配置\n\n是\n\naliyun_logs_{key}\n\n创建Logtail配置。取值说明如下：\n\n- \n\n采集标准输出，取值如下：\n\n- \n\nstdout：采集正常输出和错误信息。\n- \n\nstderr-only：只采集错误信息，不采集正常输出。\n- \n\nstdout-only：只采集正常输出，不采集错误信息。\n\n- \n\n采集文本文件时，取值为容器内的文件目录。\n\n项目\n\n否\n\naliyun_logs_{key}_project\n\n指定日志服务Project。\n\n如果不设置该环境变量，则使用默认的Project。默认的Project的名称格式为k8s-log-<cluster-id>。\n\n日志库\n\n否\n\naliyun_logs_{key}_logstore\n\n指定日志服务Logstore。\n\n如果不设置该环境变量，则Logstore和{key}一致。\n\n机器组\n\n否\n\naliyun_logs_{key}_machinegroup\n\n指定机器组。\n\n如果不设置该环境变量，则使用默认的机器组。\n\n分区\n\n否\n\naliyun_logs_{key}_shard\n\n设置日志分区数。\n\n- \n\n取值范围为1~10。\n- \n\n如果不设置该环境变量，则默认分区数为2。\n\n日志保留时间\n\n否\n\naliyun_logs_{key}_ttl\n\n设置日志保留时间，单位为天。\n\n- \n\n取值范围为1~3650。取值为3650时，表示永久保留日志。\n- \n\n如果不设置该环境变量，则日志默认保留90天。\n\n标签\n\n否\n\naliyun_logs_{key}_tags\n\n绑定标签。取值格式为tag-key=tag-value，用于对日志进行标识。\n## 配置示例\n\n- \n\n连接集群。\n- \n\n创建应用。\n\n在容器的环境变量中可以传入日志相关配置。以Deployment为例，YAML内容示例如下，示例中容器启动后会执行相关命令，不断打印标准输出和日志文件。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: sls\n  name: eci-sls-demo\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sls\n  template:\n    metadata:\n      labels:\n        app: sls\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/alpine:3.5\n        imagePullPolicy: Always\n        args:\n        - -c\n        - mkdir -p /log;while true; do echo hello world; date; echo hello sls >> /log/alpine.log; sleep 1;done\n        command:\n        - /bin/sh\n        name: alpine\n        env:\n        #配置Project，如果使用默认的Project，则可以不填\n        - name: aliyun_logs_test-stdout_project\n          value: k8s-log-c21492\n        - name: aliyun_logs_test-file_project\n          value: k8s-log-c21492\n        #配置机器组，如果使用默认的机器组，则可以不填\n        - name: aliyun_logs_test-stdout_machinegroup\n          value: k8s-group-app-alpine\n        - name: aliyun_logs_test-file_machinegroup\n          value: k8s-group-app-alpine\n        #将标准输出采集到名为test-stdout的Logstore，采集路径为标准输出stdout\n        - name: aliyun_logs_test-stdout\n          value: stdout\n        #将/log/*.log目录下的日志采集到名为test-file的Logstore，采集对象为/log目录下的所有.log文件\n        - name: aliyun_logs_test-file\n          value: /log/*.log\n        #设置日志保留时间，只对名为test-stdout的Logstore生效\n        - name: aliyun_logs_test-stdout_ttl\n          value: \"7\"\n        #设置日志分区数，只对名为test-stdout的Logstore生效\n        - name: aliyun_logs_test-stdout_shard\n          value: \"2\"\n        #挂载EmptyDir Volume。除标准输出外，其它自定义目录的日志采集必须挂载EmptyDir Volume\n        volumeMounts:\n        - name: volume-sls\n          mountPath: /log\n      volumes:\n      - name: volume-sls\n        emptyDir: {}\n\n\n将以上YAML保存为test-sls-env.yaml，执行以下命令创建应用。\n\nkubectl create -f test-sls-env.yaml\n\n\n- \n\n确认应用状态。\n\nkubectl get pod\n\n\n预期返回：\n\nNAME                             READY   STATUS    RESTARTS   AGE\neci-sls-demo-b97bbd7d6-z9twz     1/1     Running   0          2m45s\n\n\n- \n\n查看日志。\n\n- \n\n登录[日志服务控制台](https://sls.console.aliyun.com/lognext/profile)。\n- \n\n单击目标Project名称。\n- \n\n找到目标日志库，单击日志库名称查看日志。\n\n- \n\n标准输出\n\n- \n\n文件日志\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/collect-logs-by-using-environment-variables-1", "page_type": "doc", "title": "通过环境变量方式采集日志", "keywords": "使用环境变量采集日志,配置ECI日志采集,日志采集环境变量,ECI日志采集配置", "last_modified_ms": 1732067753000, "last_modified_iso": "2024-11-20T09:55:53+08:00", "excerpt": "ECI支持通过容器的环境变量传入日志相关的自定义配置。本文介绍如何通过环境变量来配置日志采集，实现通过阿里云日志服务SLS自动采集容器日志。\n## 背景信息\n\n阿里云日志服务SLS（Log Service）是针对日志数据的一站式服务，您无需开发就能快捷完成日志数据采集、消费、投递以及查询分析等功能。更多信息，请参见[日志服务简介](https://help.aliyun.com/zh/sls/what-is-log-service#concept-mt2-ykn-vdb)。\n## 前提条件\n\n已开通日志服务。登录[日志服务控制台](https://sls.console.aliyun.com/lognext/profile)时，如果没有开通日志服务，将收到相关提示，您可以根据页面提示开通。\n## 注意事项\n\n- \n\n仅在创建ECI实例时才能通过环境变量自定义配置日志采集，更新实例时传入的日志相关环境变量不会生效。\n- \n\n对于自定义配置的日志Project和Logtail配置，如果后续不再使用，请及时删除相关Project和Logtail配置，避免产生不必要的费用。\n\n## 配置说明\n\n日志相关环境变量名称的格式前缀为aliyun_logs_{key}，可配置的环境变量如下：重要 \n\n{key}表示日志服务中Logtail采集配置的名称，只能包含小写字母、数字和短划线（-）。您可以自定义配置{key}，但必须保证在K8s集群内唯一。\n\n[表格]\n\n配置对象\n\n是否必选\n\n环境变量名称\n\n说明\n\nLogtail配置\n\n是\n\naliyun_logs_{key}\n\n创建Logtail配置。取值说明如下：\n\n- \n\n采集标准输出，取值如下：\n\n- \n\nstdout：采集正常输出和错误信息。\n- \n\nstderr-only：只采集错误信息，不采集正常输出。\n- \n\nstdout-only：只采集正常输出，不采集错误信息。\n\n- \n\n采集文本文件时，取值为容器内的文件目录。\n\n项目\n\n否\n\naliyun_logs_{key}_project\n\n指定日志服务Project。\n\n如果不设置该环境变量，则使用默认的Project。默认的Project的名称格式为k8s-log-<cluster-id>。\n\n日志库\n\n否\n\naliyun_logs_{key}_logstore\n\n指定日志服务Logstore。\n\n如果不设置该环境变量，则Logstore和{key}一致。\n\n机器组\n\n否\n\naliyun_logs_{key}_machinegroup\n\n指定机器组。\n\n如果不设置该环境变量，则使用默认的机器组。\n\n分区\n\n否\n\naliyun_logs_{key}_shard\n\n设置日志分区数。\n\n- \n\n取值范围为1~10。\n- \n\n如果不设置该环境变量，则默认分区数为2。\n\n日志保留时间\n\n否\n\naliyun_logs_{key}_ttl\n\n设置日志保留时间，单位为天。\n\n- \n\n取值范围为1~3650。取值为3650时，表示永久保留日志。\n- \n\n如果不设置该环境变量，则日志默认保留90天。\n\n标签\n\n否\n\naliyun_logs_{key}_tags\n\n绑定标签。取值格式为tag-key=tag-value，用于对日志进行标识。\n## 配置示例\n\n- \n\n连接集群。\n- \n\n创建应用。\n\n在容器的环境变量中可以传入日志相关配置。以Deployment为例，YAML内容示例如下，示例中容器启动后会执行相关命令，不断打印标准输出和日志文件。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: sls\n  name: eci-sls-demo\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sls\n  template:\n    metadata:\n      labels:\n        app: sls\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/alpine:3.5\n        imagePullPolicy: Always\n        args:\n        - -c\n        - mkdir -p /log;while true; do echo hello world; date; echo hello sls >> /log/alpine.log; sleep 1;done\n        command:\n        - /bin/sh\n        name: alpine\n        env:\n        #配置Project，如果使用默认的Project，则可以不填\n        - name: aliyun_logs_test-stdout_project\n          value: k8s-log-c21492\n        - name: aliyun_logs_test-file_project\n          value: k8s-log-c21492\n        #配置机器组，如果使用默认的机器组，则可以不填\n        - name: aliyun_logs_test-stdout_machinegroup\n          value: k8s-group-app-alpine\n        - name: aliyun_logs_test-file_machinegroup\n          value: k8s-group-app-alpine\n        #将标准输出采集到名为test-stdout的Logstore，采集路径为标准输出stdout\n        - name: aliyun_logs_test-stdout\n          value: stdout\n        #将/log/*.log目录下的日志采集到名为test-file的Logstore，采集对象为/log目录下的所有.log文件\n        - name: aliyun_logs_test-file\n          value: /log/*.log\n        #设置日志保留时间，只对名为test-stdout的Logstore生效\n        - name: aliyun_logs_test-stdout_ttl\n          value: \"7\"\n        #设置日志分区数，只对名为test-stdout的Logstore生效\n        - name: aliyun_logs_test-stdout_shard\n          value: \"2\"\n        #挂载EmptyDir Volume。除标准输出外，其它自定义目录的日志采集必须挂载EmptyDir Volume\n        volumeMounts:\n        - name: volume-sls\n          mountPath: /log\n      volumes:\n      - name: volume-sls\n        emptyDir: {}\n\n\n将以上YAML保存为test-sls-env.yaml，执行以下命令创建应用。\n\nkubectl create -f test-sls-env.yaml\n\n\n- \n\n确认应用状态。\n\nkubectl get pod\n\n\n预期返回：\n\nNAME                             READY   STATUS    RESTARTS   AGE\neci-sls-demo-b97bbd7d6-z9twz     1/1     Running   0          2m45s\n\n\n- \n\n查看日志。\n\n- \n\n登录[日志服务控制台](https://sls.console.aliyun.com/lognext/profile)。\n- \n\n单击目标Project名称。\n- \n\n找到目标日志库，单击日志库名称查看日志。\n\n- \n\n标准输出\n\n- \n\n文件日志\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/collect-logs-by-using-log-service-crds", "page_type": "doc", "title": "通过SLS CRD采集日志", "keywords": "配置SLS CRD日志采集,SLS CRD配置方法,ACK Serverless日志采集", "last_modified_ms": 1766559765000, "last_modified_iso": "2025-12-24T15:02:45+08:00", "excerpt": "本文介绍在ACK Serverless集群中，如何通过SLS CRD来配置日志采集，实现通过阿里云日志服务SLS自动采集容器日志。\n## 背景信息\n\n阿里云日志服务SLS（Log Service）是针对日志数据的一站式服务，无需开发就能快捷完成日志数据采集、消费、投递以及查询分析等功能。更多信息，请参见[日志服务简介](https://help.aliyun.com/zh/sls/what-is-log-service#concept-mt2-ykn-vdb)。\n## 前提条件\n\n已开通日志服务。登录[日志服务控制台](https://sls.console.aliyun.com/lognext/profile)时，如果没有开通日志服务，将收到相关提示，可根据页面提示开通。\n## 注意事项\n\n通过SLS CRD开启日志采集仅对后续创建的ECI Pod生效。如果想要采集存量Pod的日志，需要对存量Pod进行一次滚动发布。\n## 配置日志采集\n\n在集群内部署alibaba-log-controller组件后，可通过日志采集配置CRD（AliyunLogConfig CRD）来配置日志采集。\n### 部署alibaba-log-controller组件\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.2.16.61a036c8iieu29&amp;accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在集群列表页面，单击目标ACK Serverless集群的名称，进入集群管理页面。\n- \n\n在集群中部署alibaba-log-controller组件。\n\n- \n\n在集群管理页左侧导航栏，选择运维管理>组件管理。\n- \n\n单击日志与监控页签，找到alibaba-log-controller卡片，然后单击安装。\n- \n\n在弹出的对话框中，单击确认。\n\n安装完成后，alibaba-log-controller卡片右上角会显示已安装。\n\n### 创建Logtail采集配置\n\n- \n\n连接ACK Serverless集群。\n- \n\n编写日志采集配置CRD的YAML配置文件。重要 \n\n创建日志采集配置CRD后，可在日志服务控制台查看生成的日志库及logtail配置。通过CRD方式创建的配置，在控制台上对其修改不会同步到CRD中。如果后续需要更新配置，请直接修改CRD资源，不要在控制台操作，避免导致配置不一致。\n\nAliyunLogConfig CRD YAML模板\n\napiVersion: log.alibabacloud.com/v1alpha1     \nkind: AliyunLogConfig                         \nmetadata:\n  name: simple-stdout-example                 \nspec:\n  project: k8s-my-project                      \n  logstore: k8s-stdout                         \n  logstoreMode: standard                       \n  shardCount: 2                               \n  lifeCycle: 90                               \n  logtailConfig:                            \n    inputType: plugin                          \n    configName: simple-stdout-example          \n    inputDetail:                               \n      ...\n\n\n以下为常用基本参数的说明，更多参数配置请参见[使用AliyunLogConfig管理采集配置](https://help.aliyun.com/zh/sls/use-aliyunlogconfig-to-manage-collection-configurations)。\n\n- \n\n基本参数\n\n[表格]\n\n参数\n\n类型\n\n是否必填\n\n说明\n\nproject\n\nstring\n\n否\n\nProject名称。默认为安装Logtail组件时设置的Project。\n\n如果要新建Project，可自定义输入名称，如果不存在该Project，系统会自动新建。\n\nlogstore\n\nstring\n\n是\n\nLogstore名称。如所指定的Logstore不存在，系统会自动创建。\n\nlogstoreMode\n\nstring\n\n否\n\nLogstore类型。该参数值仅在新建Logstore时生效。取值范围：\n\n- \n\nquery：查询型Logstore。\n- \n\nstandard：标准型Logstore。\n\n更多信息，请参见[管理LogStore](https://help.aliyun.com/zh/sls/manage-a-logstore#concept-xkb-zh5-vdb)。\n\nshardCount\n\nint\n\n否\n\nShard数量。默认值为2，取值范围为1~10。\n\nlifeCycle\n\nint\n\n否\n\nLogstore中数据的存储时间。默认值为90，取值范围为1~3650。其中，3650天为永久存储。该参数值仅在新建Logstore时生效。\n\nmachineGroups\n\narray\n\n否\n\n机器组。安装Logtail组件时，日志服务会自动创建名为k8s-group-${your_k8s_cluster_id}的机器组。\n\nlogtailConfig\n\nobject\n\n是\n\nLogtail配置。包含以下参数：\n\n- \n\nconfigName：Logtail配置的名称。必须与metadata.name相同。\n- \n\ninputType：日志输入的方式。可选值如下：\n\n- \n\nplugin：通过Logtail插件采集MySQL Binlog等日志。\n- \n\nfile：通过固定模式（正则模式、分隔符模式等）采集文本文件中的日志。\n\n- \n\ninputDetail：日志输入的相关配置。\n- \n\noutputType：日志输出的方式，只支持LogService，即只支持将数据上传到日志服务。\n- \n\noutputDetail：日志输出的相关配置。\n- \n\nlogSample：日志样例。\n\n详细的参数说明请参见[Logtail配置（旧版）](https://help.aliyun.com/zh/sls/developer-reference/logtail-configurations#concept-f3n-s5q-12b)。\n- \n\n容器过滤\n\n- \n\nLogtail 1.0.34以下版本，只支持通过环境变量、容器Label进行容器过滤。\n\nKubernetes中的命名空间名和容器名会映射到容器Label中，分别为io.kubernetes.pod.namespace和io.kubernetes.container.name。推荐使用这两个容器Label进行容器过滤。如果这两个容器Label未满足需求，请使用环境变量的黑白名单进行容器过滤。\n- \n\nLogtail 1.0.34及以上版本，可以使用Kubernetes层级的信息（Pod名称、Namespace、容器名称、容器Label等）进行容器过滤。\n\n容器过滤参数请配置在logtailConfig.inputDetail.advanced.k8s字段下。支持的参数如下：\n\n- \n\nIncludeK8sLabel：Kubernetes Label白名单，用于指定待采集的容器。\n- \n\nExcludeK8sLabel：Kubernetes Label黑名单，用于排除不采集的容器。\n- \n\nK8sNamespaceRegex：指定Namespace。\n- \n\nK8sPodRegex：指定Pod名称。\n- \n\nK8sContainerRegex：指定容器名称。\n\nAliyunLogConfig CRD YAML示例\n#### 文本日志CRD YAML示例\n\n将以下内容保存为log-file.yaml。\n\napiVersion: log.alibabacloud.com/v1alpha1  # 使用默认值，无需修改。\nkind: AliyunLogConfig                      # 使用默认值，无需修改。\nmetadata:\n  name: test-file                  # 资源名，在当前Kubernetes集群内唯一。\nspec:\n  project: k8s-log-c326bc86****    # 可选配置，Project名称，如果不存在该Project，系统会自动新建\n  logstore: test-file              # 必选配置，Logstore名称，如果不存在该Logstore，系统会自动创建   \n  logtailConfig:                   # Logtail配置\n    in"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/collect-logs-of-jobs", "page_type": "doc", "title": "采集Job任务的日志", "keywords": "采集ECI Job日志,Job日志采集方案,Job日志NAS存储", "last_modified_ms": 1736851099000, "last_modified_iso": "2025-01-14T18:38:19+08:00", "excerpt": "由于ECI不支持DaemonSet，在ECI上运行的Job任务运行结束后，Pod会立即退出，因此可能会出现日志尚未完全采集的情况。建议您为Job挂载NAS文件系统来保存日志文件。本文介绍在ACK集群中使用ECI来运行Job任务时，如何采集Job任务的日志。\n## 前提条件\n\n- \n\n已创建一个ACK集群并在该集群上部署了虚拟节点。具体操作，请参见[创建ACK托管集群](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/create-an-ack-managed-cluster-2/#task-skz-qwk-qfb)和[通过虚拟节点将Pod调度到ECI上运行](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/deploy-the-virtual-node-controller-and-use-it-to-create-elastic-container-instance-based-pods#task-1443354)。\n- \n\n已为Namespace添加alibabacloud.com/eci=true的Label。\n\n通过配置Namespace Label的方式可以将Pod调度到ECI上运行。更多信息，请参见[调度Pod到x86架构的虚拟节点](https://help.aliyun.com/zh/eci/user-guide/schedule-pods-to-virtual-kubelet#topic-2090698)。\n- \n\n已创建NAS文件系统，并已添加挂载点。具体操作，请参见[管理文件系统](https://help.aliyun.com/zh/nas/user-guide/create-a-file-system#task-27530-zh)和[管理挂载点](https://help.aliyun.com/zh/nas/user-guide/manage-mount-targets#task-27531-zh)。\n\n## 背景信息\n\n在ACK集群中，对于在标准节点的ECS上运行的Job任务，可以通过DaemonSet的方式来采集日志。但是对于在虚拟节点的ECI上运行的Job任务，由于ECI不支持DaemonSet，当Job任务运行结束后，Pod会立即退出，此时日志可能还未被采集完成。\n\n针对上述场景，您可以采用以下方式来采集ECI上运行的Job任务的日志：\n\n- \n\n为Job挂载NAS文件系统，将输出的日志保存到NAS文件系统上。\n- \n\n将收集了Job任务日志的NAS文件系统挂载到另一个Pod上，获取NAS文件系统中存储的Job任务日志。\n说明 \n\n如果您使用了阿里云日志服务SLS，通过配置环境变量的方式为Job挂载Volume，可以直接同步阿里云日志服务。更多信息，请参见[通过环境变量方式采集日志](https://help.aliyun.com/zh/eci/user-guide/collect-logs-by-using-environment-variables)。\n## 操作步骤\n\n下文以名为vk的Namespace为例说明操作步骤，该Namespace已添加alibabacloud.com/eci=true的Label，部署在该Namespace下的Pod将被调度到ECI上运行。实际配置时请替换为您要使用的Namespace。\n\n- \n\n准备Job任务的YAML配置文件。\n\nvim job.yaml\n\n\n以下为一个计算π值的Job任务配置示例：\n\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pi\nspec:\n  template:\n    spec:\n      containers:\n      - name: pi\n        image: resouer/ubuntu-bc \n        command: [\"sh\", \"-c\", \"echo 'scale=1000; 4*a(1)' | bc -l > /eci/a.log 2>&1\"] # 输出结果重定向到指定文件\n        volumeMounts:\n        - name: log-volume\n          mountPath: /eci\n          readOnly: false\n      restartPolicy: Never\n      volumes:    # 挂载NAS文件系统用于存储日志\n      - name: log-volume  \n        nfs:\n            server: 04edd48c7c-****.cn-hangzhou.nas.aliyuncs.com\n            path: /\n            readOnly: false\n  backoffLimit: 4\n\n\n- \n\n部署Job。\n\nkubectl apply -f job.yaml -n vk\n\n\n- \n\n查看Pod状态，确认Job是否已正常运行。\n\nkubectl get pod -n vk\n\n\n预期返回示例如下：\n\n- \n\n准备用于采集Job任务日志的Pod的配置文件。\n\nvim log-collection.yaml\n\n\nYAML文件内容示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: log-collection\nspec:\n  containers:\n  - image: nginx:latest\n    name: log-collection\n    command: ['/bin/sh', '-c', 'echo &(cat /eci/a.log)'] # 输出Job任务的日志文件\n    volumeMounts:\n    - mountPath: /eci\n      name: log-volume\n  restartPolicy: Never\n  volumes:      # 挂载存储了Job任务日志的NAS文件系统\n  - name: log-volume\n    nfs:\n      server: 04edd48c7c-****.cn-hangzhou.nas.aliyuncs.com\n      path: /\n      readOnly: false\n\n\n- \n\n部署Pod。\n\nkubectl apply -f log-collection.yaml -n vk\n\n\n- \n\n确认Pod运行结束，然后查看Job任务的日志文件。\n\nkubectl get pod -n vk\nkubectl logs log-collection -n vk\n\n\n预期返回示例如下：\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/commit-a-container-to-generate-an-image-and-push-the-image-to-an-image-repository-in-container-registry", "page_type": "doc", "title": "提交容器生成镜像并推送到ACR", "keywords": "保存容器为镜像,推送镜像到ACR,查询镜像生成任务,容器生成镜像方法,CommitContainer API参考,ECI容器镜像化", "last_modified_ms": 1713319242000, "last_modified_iso": "2024-04-17T10:00:42+08:00", "excerpt": "根据业务需求，启动ECI实例后，您可能需要在容器内部进行一些操作修改。如果您想要保留修改后的环境，可以将修改过的容器环境打包成镜像，并推送到ACR，以便后续可以使用。本文介绍如何通过CommitContainer和DescribeCommitContainerTask接口提交容器生成镜像并推送到ACR。\n## 准备工作\n\n- \n\n创建ACR实例和镜像仓库，并获取镜像仓库地址。\n\n关于如何创建ACR实例和镜像仓库，请参见以下文档：\n\n- \n\n[使用个人版实例推送拉取镜像](https://help.aliyun.com/zh/acr/user-guide/use-a-container-registry-personal-edition-instance-to-push-and-pull-images)\n- \n\n[使用企业版实例推送和拉取镜像](https://help.aliyun.com/zh/acr/getting-started/use-a-container-registry-enterprise-edition-instance-to-push-and-pull-images)\n\n创建成功后，从镜像仓库页面获取仓库地址。本文使用私网地址。\n\n- \n\n创建RAM角色并授权，然后获取角色的ARN。\n\n- \n\n创建RAM角色。\n\n具体操作，请参见[创建可信实体为阿里云服务的RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service)。需要注意的配置如下：\n\n- \n\n在选择类型页面，可信实体类型选择阿里云服务。\n- \n\n在配置角色页面，角色类型选择普通服务角色，角色名称可以自定义输入，受信服务选择弹性容器实例ECI。\n\n- \n\n为RAM角色授权。\n\n具体操作，请参见[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role)。授权时，请选择AliyunContainerRegistryFullAccess权限策略。\n- \n\n获取角色的ARN。\n\n在角色详情页面的基本信息处可以获取ARN。\n\n## 配置说明\n\n调用CommitContainer接口创建异步任务，可以将ECI实例中的指定容器保存为镜像，并推送至阿里云ACR的镜像仓库中。CommitContainer接口的主要参数说明如下，更多信息，请参见[CommitContainer](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-commitcontainer)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainerGroupId\n\nstring\n\neci-bp1do4xz75fa5sd****\n\n要创建CommitContainer任务的ECI实例ID。\n\nContainerName\n\nstring\n\ncontainer-1\n\n要制作镜像的容器的名称。\n\nImage.Repository\n\nstring\n\nregistry-vpc.cn-beijing.aliyuncs.com/test/test-****\n\nACR镜像仓库地址。\n\n出于安全考虑，目前仅支持将镜像推送（Push）至ACR。\n\nImage.Tag\n\nString\n\n1.0.1\n\n镜像标签。\n\nAcrRegistryInfo.InstanceId\n\nstring\n\ncri-nwj395hgf6f3****\n\nACR企业版实例ID。\n\n使用ACR个人版实例时无需配置该参数；使用ACR企业版实例时必须配置该参数。\n\nAcrRegistryInfo.RegionId\n\nstring\n\ncn-beijing\n\nACR企业版实例所属的地域。\n\n使用ACR个人版实例时无需配置该参数；使用ACR企业版实例时必须配置该参数。\n\nArn.RoleArn\n\nstring\n\nacs:ram::1609982529******:role/commit-test\n\n授权角色的ARN。配置和获取方式请参考准备工作。\n\nArn.RoleType\n\nstring\n\nservice\n\n授权类型。可配置为service，表示使用RAM角色进行授权。\n\n调用CommitContainer接口成功后，会返回TaskId。您可以通过该TaskId调用DescribeCommitContainerTask接口查询任务状态。如果返回的TaskStatus为Succeeded，则表示已成功生成镜像并推送到ACR。关于DescribeCommitContainerTask接口的详细参数说明，请参见[DescribeCommitContainerTask](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecommitcontainertask)。\n## 配置示例\n\n- \n\n创建一台ECI实例A。\n- \n\n连接ECI实例A，在容器内进行操作。\n\n此处以在容器写入一个文件（hello.txt）作为示例。\n\n- \n\n调用CommitContainer接口，将实例A中的容器环境打包成镜像，并推送到ACR。\n\n采用的参数示例如下：\n\nRegionId=cn-beijing\nContainerGroupId=eci-2zeh3j8kdnqvnf5n****\nContainerName-container-1\nImage.Repository=registry-vpc.cn-beijing.aliyuncs.com/***-test/***-registry\nImage.Tag=1.0.1\nArn,RoleArn=acs:ram::1609982529******:role/commit-test\nArn.RoleType=service\n\n\n如果使用ACR企业版实例，需增加ACR企业版实例的访问凭证配置信息，即AcrRegistryInfo相关参数，示例如下：\n\nAcrRegistryInfo.InstanceId=cri-nwj395hgf6f3****\nAcrRegistryInfo.RegionId=cn-beijing\n\n\n预期返回如下：\n\n{\n  \"TaskId\": \"t-2zej6nstkg744qc3****\",\n  \"RequestId\": \"4ADE19FF-C487-5020-A6E4-03D5D9708834\"\n}\n\n\n- \n\n调用DescribeCommitContainerTask接口查看任务状态。\n\n采用的参数示例如下：\n\nRegionId=cn-beijing\nTaskId=[\"t-2zej6nstkg744qc3****\"]\n\n\n预期返回如下，TaskStatus为Succeeded表示任务执行成功，在CommitPhaseInfos中可以看到PushCommittedImage阶段成功的信息，表示镜像已推送到指定的ACR镜像仓库中。\n\n{\n  \"TotalCount\": 1,\n  \"CommitTasks\": [\n    {\n      \"TaskId\": \"t-2zej6nstkg744qc3****\",\n      \"ContainerName\": \"container-1\",\n      \"CommitPhaseInfos\": [\n        ......\n        {\n          \"Status\": \"Success\",\n          \"RecordTime\": \"2023-02-01T11:08:04.313047785+08:00\",\n          \"Phase\": \"PushCommittedImage\",\n          \"Message\": \"Push image registry-vpc.cn-beijing.aliyuncs.com/***-test/***-registry:1.0.1 successfully\"\n        }\n      ],\n      \"CreationTime\": \"2023-02-01T11:08:00Z\",\n      \"TaskStatus\": \"Succeeded\",\n      \"FinishedTime\": \"2023-02-01T11:08:10Z\"\n    }\n  ],\n  \"NextToken\": \"\",\n  \"RequestId\": \"42E65299-8224-5D4A-915E-5AEC04A523FC\"\n}\n\n\n此时，登录[容器镜像服务控制台](https://cr.console.aliyun.com/cn-beijing/instances)，在目标ACR镜像仓库中可以看到ECI推送的新的镜像。\n\n- \n\n使用新的镜像重新创建一台ECI实例B。\n\n此处使用的镜像为CommitContainer任务推送到ACR的镜像，示例为registry-vpc.cn-beijing.aliyuncs.com/***-test/***-registry:1.0.1。\n\n说明 \n\n在选择镜像时，如果使用ACR个人版镜像仓库，请选择我的镜像；如果使用ACR企业版镜像仓库，请选择企业镜像。\n- \n\n确认"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/common-commands-for-vnodectl", "page_type": "doc", "title": "VNodectl常用命令参考", "keywords": "VNodectl,查询VNodectl命令,使用VNodectl管理VNode,VNodectl命令参考,VNodectl命令参数", "last_modified_ms": 1679988768000, "last_modified_iso": "2023-03-28T15:32:48+08:00", "excerpt": "安装并配置VNodectl命令行工具后，您可以使用VNodectl来管理VNode、插件等。本文列举了VNodectl常用命令供您参考。说明 \n\n- \n\nvnode命令均支持添加--dry进行客户端校验。\n- \n\n执行vnode命令的过程中，如果遇到API版本兼容的错误，请添加--kubernetes-version明确指定集群的K8s版本。\n\n## 管理VNode重要 \n\n使用下述命令管理VNode时，需确保~/.vnode/config文件存在且配置正确。\n### create\n\ncreate命令用于创建VNode。\n\n- \n\n命令格式\n\nvnode create [--vswitch-id] [--security-group-id] [--custom-resources] [--cluster-dns] [--cluster-domain]\n\n\n- \n\n参数说明\n\n[表格]\n\n参数\n\n说明\n\n示例\n\n--vswitch-id\n\nVNode所属的交换机ID。\n\n--vswitch-id vsw-7xv2yk45qp5etidgf****\n\n--security-group-id\n\nVNode所属的安全组ID。\n\n--security-group-id sg-7xv5tcch4kjdr65t****\n\n--custom-resources\n\nVNode支持的自定义资源。如果ECI Pod的request中声明了相应的自定义资源，则该Pod会被调度到VNode。\n\n格式为资源名称=资源数量，多个资源之间使用半角逗号间隔。\n\n--custom-resources example1.com=10000,example2.com=20000\n\n--cluster-dns\n\nDNS服务器的IP地址。如果ECI Pod中设置了dnsPolicy=ClusterFirst，则使用该配置值为容器提供DNS服务。\n\n支持配置多个IP地址，多个IP地址之间使用半角逗号间隔。\n\n--cluster-dns 192.168.XX.XX\n\n--cluster-domain\n\n集群的域名。配置后，除了主机的搜索域外，Kubelet会配置所有容器来搜索该域名。\n\n--cluster-domain example.com\n- \n\n使用示例\n\n- \n\n示例一：不添加参数创建VNode\n- \n\n示例二：配置自定义资源（customResources）\n\n创建完成后，您可以通过kubectl describe node命令查看节点详情，在Capacity和Allocatable中可以看到配置的自定义资源。\n- \n\n示例三：配置clusterDNS和clusterDomain\n\n创建完成后，对于调度到该VNode的ECI Pod，通过kubectl describe pod命令查看Pod详情，在annotations中可以查看clusterDNS和clusterDomain。\n\n### list\n\nlist命令用于查询VNode状态。\n\n- \n\n命令格式\n\nvnode list\n\n\n- \n\n使用示例\n\n### describe\n\ndescribe命令用于查看某一VNode的详细信息。\n\n- \n\n命令格式\n\nvnode describe <vnode id>\n\n\n- \n\n使用示例\n\n### update\n\nupdate命令用于更新指定的VNode配置。支持更新交换机、安全组、customResources、clusterDNS和clusterDomain。\n\n- \n\n命令格式\n\nvnode update <vnode id> [--vswitch-id] [--security-group-id] [--custom-resources] [--cluster-dns] [--cluster-domain]\n\n\n- \n\n参数说明重要 \n\nupdate命令更新VNode配置为全量更新，传入的参数值会覆盖原有参数值，例如原有VNode已配置--custom-resources example1.com=10000，此时如果想要增加自定义资源example2.com，数量为10000，需传入--custom-resources example1.com=10000,example2.com=10000。\n\n[表格]\n\n参数\n\n说明\n\n示例\n\n--vswitch-id\n\nVNode所属的交换机ID。\n\n--vswitch-id vsw-7xv2yk45qp5etidgf****\n\n--security-group-id\n\nVNode所属的安全组ID。\n\n--security-group-id sg-7xv5tcch4kjdr65t****\n\n--custom-resources\n\nVNode支持的自定义资源。如果ECI Pod的request中声明了相应的自定义资源，则该Pod会被调度到VNode。\n\n格式为资源名称=资源数量，多个资源之间使用半角逗号间隔。\n\n--custom-resources example1.com=10000,example2.com=20000\n\n--cluster-dns\n\nDNS服务器的IP地址。如果ECI Pod中设置了dnsPolicy=ClusterFirst，则使用该配置值为容器提供DNS服务。\n\n支持配置多个IP地址，多个IP地址之间使用半角逗号间隔。\n\n--cluster-dns 192.168.XX.XX\n\n--cluster-domain\n\n集群的域名。配置后，除了主机的搜索域外，Kubelet会配置所有容器来搜索该域名。\n\n--cluster-domain example.com\n- \n\n使用示例\n\n### delete\n\ndelete命令用于删除指定的VNode。删除前，需确保VNode上没有ECI实例。\n\n- \n\n命令格式\n\nvnode delete <vnode id>\n\n\n- \n\n使用示例\n\n## 管理组件\n\n除管理VNode外，VNodectl还可以管理eci-profile和vnode-approver组件。\n### addon list\n\naddon list命令用于列出可用插件。\n\n- \n\n命令格式\n\nvnode addon list --kubeconfig /path/to/kubeconfig\n\n\n- \n\n使用示例\n\n### addon enable\n\naddon enable命令用于加载插件。\n\n- \n\n命令格式\n\nvnode addon enable <plug-in name> --kubeconfig /path/to/kubeconfig\n\n\n- \n\n命令示例\n\n### addon disable\n\naddon disable命令用于卸载插件。\n\n- \n\n命令格式\n\nvnode addon disable <plug-in name> --kubeconfig /path/to/kubeconfig\n\n\n- \n\n使用示例\n\n## 清理集群配置\n### cluster clean\n\ncluster clean命令用于清理集群配置。如果后续不再使用VNode，可执行该命令清理。\n\n- \n\n命令格式\n\nvnode cluster clean --kubeconfig <kubeconfig路径> [--bootstrap]\n\n\n- \n\n使用示例\n\n- \n\n之前使用普通方式配置集群\n\nvnode cluster clean --kubeconfig /path/to/kubeconfig\n\n\n- \n\n之前TLS Bootstrap方式配置集群\n\nvnode cluster clean --kubeconfig /path/to/kubeconfig --bootstrap\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-a-container-image", "page_type": "doc", "title": "配置容器镜像", "keywords": "配置ECI容器镜像,ECI容器镜像配置,ECI容器镜像配置方法", "last_modified_ms": 1736851071000, "last_modified_iso": "2025-01-14T18:37:51+08:00", "excerpt": "容器镜像包含了容器应用运行所需的程序、库文件、配置等。本文介绍在创建ECI实例时，如何配置容器镜像。\n## 背景信息\n\n创建ECI实例前，需要先将容器镜像上传到镜像仓库中。ECI支持从DockerHub、阿里云容器镜像服务ACR等镜像仓库中拉取镜像。推荐您使用ACR来构建、分发和管理容器镜像，更多信息，请参见[容器镜像服务ACR简介](https://help.aliyun.com/zh/acr/product-overview/what-is-container-registry#concept-2058233)。\n## 注意事项\n\n拉取公网镜像时，如果VPC内没有创建NAT网关，则需要为ECI实例绑定弹性公网IP。\n## 配置说明\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Container.N.Image等参数配置容器镜像，相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.Image\n\nString\n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:latest\n\n容器使用的镜像。\n\nInitContainer.N.Image\n\nString\n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:latest\n\nInit容器使用的镜像。\n\n对于不同来源的镜像，还需配置以下参数：\n\n- \n\n如果镜像来源于私有镜像仓库，需通过ImageRegistryCredential参数配置镜像仓库的访问凭证。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nImageRegistryCredential.N.Password\n\nString\n\nyourpassword\n\n镜像仓库的密码。\n\nImageRegistryCredential.N.Server\n\nString\n\nregistry-vpc.cn-hangzhou.aliyuncs.com\n\n镜像仓库的注册地址。\n\nImageRegistryCredential.N.UserName\n\nString\n\nyourusername\n\n镜像仓库的用户名。\n- \n\n如果镜像来源于ACR企业版镜像仓库，支持通过AcrRegistryInfo参数实现免密拉取。更多信息，请参见[免密拉取ACR企业版镜像](https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret-2)。\n- \n\n如果镜像来源于自建镜像仓库，且自建镜像仓库采用HTTP协议，或者使用自签发证书时，需配置PlainHttpRegistry或InsecureRegistry参数来避免镜像拉取失败。更多信息，请参见[拉取自建镜像仓库的镜像](https://help.aliyun.com/zh/eci/user-guide/use-self-managed-image-repositories)。\n\n### 控制台\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)创建ECI实例的过程中，在基础配置页面配置容器时，您可以选择以下几类镜像：\n\n- \n\n常用镜像：ECI提供的用于测试的开源镜像，方便您快速测试ECI产品功能。\n- \n\nDocker官方镜像：DockerHub公开的镜像。\n- \n\n我的镜像：ACR个人版镜像仓库中的镜像。\n- \n\n企业镜像：ACR企业版镜像仓库中的镜像。\n\n如果是私有镜像（非ECI公开镜像、非ACR镜像、非DockerHub公开镜像），则在镜像配置处可以直接输入镜像地址和版本，然后在下一步的其他设置（选填）页面，配置私有镜像仓库的访问凭证。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-a-fault-handling-policy-for-a-pod", "page_type": "doc", "title": "设置ECI Pod的故障处理策略", "keywords": "设置ECI Pod故障策略,ECI Pod故障策略配置,ECI故障策略Annotation", "last_modified_ms": 1747980044000, "last_modified_iso": "2025-05-23T14:00:44+08:00", "excerpt": "默认情况下，ECI Pod创建失败后，系统会自动重试尝试创建。如果您希望尽快得到创建结果以便及时处理故障，可以修改ECI Pod的故障处理策略。\n## 配置说明\n\n在虚拟节点上创建ECI Pod时，可能会因为库存不足等原因导致Pod创建失败，默认情况下，系统会自动进行重调度，尝试重新创建Pod。您可以通过添加k8s.aliyun.com/eci-fail-strategy的Annotation来修改ECI Pod的故障处理策略，设置ECI Pod创建失败后是否尝试重新创建。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\nk8s.aliyun.com/eci-fail-strategy的取值说明如下：\n\n[表格]\n\n取值\n\n说明\n\n场景\n\nfail-back\n\n失败自动恢复。即Pod创建失败后自动尝试重新创建。此时，Pod会保持Pending状态，直到创建成功变为Running状态。\n\n侧重成功率，能够接受Pod延迟交付。\n\nfail-over\n\n失败转移。效果等同于fail-back。\n\nfail-fast\n\n快速失败。Pod创建失败后直接报错。Pod显示为ProviderFailed状态，由上层编排决定是否重试，或者把Pod创建调度到普通节点。\n\n侧重效率，希望Pod快速交付，有完善的失败处理逻辑。说明 \n\n- \n\n如果ECI Pod添加了k8s.aliyun.com/eci-fail-strategy: \"fail-fast\"的Annotation，则该Pod挂载云盘动态存储卷时，不支持使用WaitForFirstConsumer类型的StorageClass。\n- \n\n不推荐通过k8s.aliyun.com/eci-reschedule-enable设置重调度。\n\n## 配置示例\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-fail-strategy: \"fail-fast\"  #设置Pod创建失败后直接报错，不再重新创建\n        k8s.aliyun.com/eci-use-specs: \"ecs.c6.large\"\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n以上YAML示例中，ECI Pod的故障处理策略为fail-fast。如果Pod长时间Pending，您可以查看Pod status.reason。\n\n- \n\n如果Pod status.reason为ContainerInstanceScheduleFailed，则表示ECI调度失败。此时查看Pod status condition，通过ContainerInstanceCreated的reason和message可以确定具体原因，进而采取相应措施，例如修改指定的规格，设置多可用区等。更多信息，请参见[ContainerInstanceCreated](https://help.aliyun.com/zh/eci/user-guide/eci-custom-condition#61de43d047mw3)。\n- \n\n如果Pod status.reason为空（fail-fast一般不会出现该情况），可以查看Pod status condition，通过ContainerInstanceCreated的status确认调度状态。\n\n- \n\n如果ContainerInstanceCreated为True，则表示ECI调度成功，是Sandbox创建异常。\n- \n\n如果ContainerInstanceCreated为False，且reason不是Creating，则表示ECI调度还未成功，需要继续等待。\n\n以库存不足创建ECI Pod失败为例，当Pod的故障处理策略为fail-fast时，Pod status condition为ContainerInstanceCreated的示例如下：说明 \n\n如果Pod的故障处理策略为fail-back，Pod创建失败后系统会自动尝试重调度。此时，Pod status.reason不会显示ContainerInstanceScheduleFailed，您也可以查看Pod status condition，通过ContainerInstanceCreated的reason和message确定当前调度周期内调度失败的原因。\n\n{\n    \"conditions\": [\n        {\n            \"lastProbeTime\": \"2023-03-30T18:11:31Z\",\n            \"lastTransitionTime\": \"2023-03-30T18:11:31Z\",\n            \"message\": \"Create ECI failed because the specified instance is out of stock. %s\",\n            \"reason\": \"ContainerGroup.NoStock\",\n            \"status\": \"False\",\n            \"type\": \"ContainerInstanceCreated\"\n        }\n    ],\n    \"Reason\":\"ContainerInstanceScheduleFailed\",\n    \"phase\": \"Pending\"\n}\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-a-security-context-for-a-pod-or-container", "page_type": "doc", "title": "配置Security Context", "keywords": "配置Security Context,了解Security Context,为容器增加权限,Security Context配置,Security Context参数说明,Security Context配置示例", "last_modified_ms": 1723514320000, "last_modified_iso": "2024-08-13T09:58:40+08:00", "excerpt": "Security Context（安全上下文）用于控制和管理容器内进程权限，可以限制容器内进程的行为，确保容器内进程只能运行在给定的权限和资源限制下。本文介绍如何为Pod或者Container配置Security Context，定义Pod或者Container的权限和访问控制。\n## 背景信息\n\nSecurity Context，即安全上下文，用于定义Pod或者Container的权限和访问控制，包括Discretionary Access Control、SELinux、Linux Capabilities等。更多信息，请参见[Security Context](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)。\n\nKubernetes提供了两种配置安全上下文的方式：\n\n[表格]\n\n方式\n\n应用范围\n\n支持的功能\n\nPod Security Context\n\nPod级别，应用于Pod内所有容器和Volume。\n\n修改sysctl参数和runAsUser。\n\nContainer Security Context\n\n容器级别，应用于指定的容器。\n\n修改runAsUser和capabilities等。\n## 配置Pod Security Context\n### 配置说明\n\n在Linux中，通常可以通过sysctl接口修改内核运行时的参数。对于ECI实例的内核参数，您可以通过以下命令进行查看。更多信息，请参见[sysctl.sh](https://github.com/aliyuneci/Virtual-Kubelet-Example/blob/master/eci-securitycontext/sysctl.sh)。\n\nsysctl -a\n\n\n在Pod级别，您可以通过配置Security Context来修改sysctl参数和runAsUser。警告 \n\n为了避免破坏操作系统的稳定性，请您在充分了解sysctl参数变更影响后，再进行配置。更多信息，请参见[sysctl](https://man7.org/linux/man-pages/man8/sysctl.8.html)。\n\n目前ECI支持修改的sysctl参数如下：\n\n- \n\nkernel.shm*\n- \n\nkernel.msg*\n- \n\nkernel.sem\n- \n\nfs.mqueue.*\n- \n\nnet.*（net.ipv4.tcp_syncookies除外）\n- \n\nvm.min_free_kbytes\n\n修改vm.min_free_kbytes的值时，建议不要超过总内存的20%。\n重要 \n\n除上述sysctl参数外，如果想要修改其他host级别的sysctl参数，请提交工单申请。申请成功后，可通过为Pod添加k8s.aliyun.com/eci-host-sysctls: '[{\"name\":\"xxx\", \"value\": \"vvv\"}]'的Annotation的方式来修改sysctl参数。\n### 配置示例\n\n以修改net.core.somaxconn和kernel.msgmax为例，YAML示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: sysctl-example\n  labels: \n    alibabacloud.com/eci: \"true\"\nspec:\n  securityContext:\n    sysctls:\n    - name: net.core.somaxconn\n      value: \"1024\"\n    - name: kernel.msgmax\n      value: \"65536\"\n  containers:\n  - name: busybox\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n    command: [ \"sh\", \"-c\", \"sleep 12000\" ]\n\n\n## 配置Container Security Context\n### 配置说明\n\n在Container级别，您可以为指定的容器设置Security Context。重要 \n\n对于Pod Security Context和Container Security Context中均设置的参数（如runAsUser），容器的设置将覆盖Pod的设置。\n\n目前ECI支持配置的参数如下：\n\n[表格]\n\n支持配置的参数\n\n说明\n\nrunAsUser\n\n设置运行容器的用户ID。该参数配置会覆盖Dockerfile中的USER指令。\n\nrunAsGroup\n\n设置运行容器的用户组。\n\nrunAsNonRoot\n\n设置容器是否以非root模式运行容器。取值为true表示以非root模式运行容器。默认为false。\n\nprivileged\n\n设置容器是否以特权模式运行。取值为true表示以特权模式运行容器。默认为false。说明 \n\n特权容器功能正在内测中。如需体验，请提交工单申请。\n\ncapabilities\n\n为容器内的进程授予某些特定的权限。更多信息，请参见[Linux Capabilities](https://man7.org/linux/man-pages/man7/capabilities.7.html)。\n\n目前支持配置以下权限：\n\n- \n\nAUDIT_WRITE\n- \n\nCHOWN\n- \n\nDAC_OVERRIDE\n- \n\nFSETID\n- \n\nFOWNER\n- \n\nKILL\n- \n\nMKNOD\n- \n\nNET_ADMIN\n- \n\nNET_BIND_SERVICE\n- \n\nNET_RAW\n- \n\nSETGID\n- \n\nSETUID\n- \n\nSETFCAP\n- \n\nSETPCAP\n- \n\nSYS_CHROOT\n- \n\nSYS_PTRACE\n- \n\nSYS_RAWIO\n说明 \n\nSYS_RAWIO默认不支持，需提交工单申请。\n\n部分不支持配置的参数及其默认值如下：\n\n[表格]\n\n不支持配置的参数\n\n说明\n\nAllowedProcMountTypes\n\n指定容器可以挂载的proc类型，默认为DefaultProcMount。\n\nreadOnlyRootFilesystem\n\n容器运行的根文件系统是否为只读，默认为true。\n### 配置示例\n\n默认情况下，容器并不具备NET_ADMIN权限。如果在容器内进行网络相关操作，会返回报错提示。\n\n您可以为容器配置Security Context，设置capabilities参数来增加NET_ADMIN权限。YAML示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: sysctl-example\n  labels: \n    alibabacloud.com/eci: \"true\"\nspec:\n  containers:\n  - name: busybox\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n    command: [\"sh\", \"-c\", \"sleep 12000\"]\n    securityContext:\n      capabilities:\n        add: [\"NET_ADMIN\"]   \n\n\n重新创建ECI Pod，在容器内可以进行网络相关操作。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-a-security-context-for-a-pod-or-container-1", "page_type": "doc", "title": "配置Security Context", "keywords": "配置Security Context,修改Pod内核参数,设置容器运行权限,Security Context配置,Security Context参数说明,Security Context配置示例", "last_modified_ms": 1723082522000, "last_modified_iso": "2024-08-08T10:02:02+08:00", "excerpt": "Security Context（安全上下文）用于控制和管理容器内进程权限，可以限制容器内进程的行为，确保容器内进程只能运行在给定的权限和资源限制下。本文介绍如何为Pod或者Container配置Security Context，定义Pod或者Container的权限和访问控制。\n## 背景信息\n\nSecurity Context，即安全上下文，用于定义Pod或者Container的权限和访问控制，包括Discretionary Access Control、SELinux、Linux Capabilities等。更多信息，请参见[Security Context](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)。\n\nKubernetes提供了两种配置安全上下文的方式：\n\n[表格]\n\n方式\n\n应用范围\n\n支持的功能\n\nPod Security Context\n\nPod级别，应用于Pod内所有容器和Volume。\n\n修改sysctl参数和runAsUser。\n\nContainer Security Context\n\n容器级别，应用于指定的容器。\n\n修改runAsUser和capabilities等。\n## 配置Pod Security Context\n### 配置说明\n\n在Linux中，通常可以通过sysctl接口修改内核运行时的参数。对于ECI实例的内核参数，您可以通过以下命令进行查看。更多信息，请参见[sysctl.sh](https://github.com/aliyuneci/Virtual-Kubelet-Example/blob/master/eci-securitycontext/sysctl.sh)。\n\nsysctl -a\n\n\n在Pod级别，您可以通过配置Security Context来修改sysctl参数和runAsUser。警告 \n\n为了避免破坏操作系统的稳定性，请您在充分了解sysctl参数变更影响后，再进行配置。更多信息，请参见[sysctl](https://man7.org/linux/man-pages/man8/sysctl.8.html)。\n\n目前ECI支持修改的sysctl参数如下：\n\n- \n\nkernel.shm*\n- \n\nkernel.msg*\n- \n\nkernel.sem\n- \n\nfs.mqueue.*\n- \n\nnet.*（net.ipv4.tcp_syncookies除外）\n- \n\nvm.min_free_kbytes\n\n修改vm.min_free_kbytes的值时，建议不要超过总内存的20%。\n重要 \n\n除上述sysctl参数外，如果想要修改其他host级别的sysctl参数，请提交工单申请。申请成功后，可通过为Pod添加k8s.aliyun.com/eci-host-sysctls: '[{\"name\":\"xxx\", \"value\": \"vvv\"}]'的Annotation的方式来修改sysctl参数。\n### 配置示例\n\n以修改net.core.somaxconn和kernel.msgmax为例，YAML示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: sysctl-example\n  labels: \n    alibabacloud.com/eci: \"true\"\nspec:\n  securityContext:\n    sysctls:\n    - name: net.core.somaxconn\n      value: \"1024\"\n    - name: kernel.msgmax\n      value: \"65536\"\n  containers:\n  - name: busybox\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n    command: [ \"sh\", \"-c\", \"sleep 12000\" ]\n\n\n## 配置Container Security Context\n### 配置说明\n\n在Container级别，您可以为指定的容器设置Security Context。重要 \n\n对于Pod Security Context和Container Security Context中均设置的参数（如runAsUser），容器的设置将覆盖Pod的设置。\n\n目前ECI支持配置的参数如下：\n\n[表格]\n\n支持配置的参数\n\n说明\n\nrunAsUser\n\n设置运行容器的用户ID。该参数配置会覆盖Dockerfile中的USER指令。\n\nrunAsGroup\n\n设置运行容器的用户组。\n\nrunAsNonRoot\n\n设置容器是否以非root模式运行容器。取值为true表示以非root模式运行容器。默认为false。\n\nprivileged\n\n设置容器是否以特权模式运行。取值为true表示以特权模式运行容器。默认为false。说明 \n\n特权容器功能正在内测中。如需体验，请提交工单申请。\n\ncapabilities\n\n为容器内的进程授予某些特定的权限。更多信息，请参见[Linux Capabilities](https://man7.org/linux/man-pages/man7/capabilities.7.html)。\n\n目前支持配置以下权限：\n\n- \n\nAUDIT_WRITE\n- \n\nCHOWN\n- \n\nDAC_OVERRIDE\n- \n\nFSETID\n- \n\nFOWNER\n- \n\nKILL\n- \n\nMKNOD\n- \n\nNET_ADMIN\n- \n\nNET_BIND_SERVICE\n- \n\nNET_RAW\n- \n\nSETGID\n- \n\nSETUID\n- \n\nSETFCAP\n- \n\nSETPCAP\n- \n\nSYS_CHROOT\n- \n\nSYS_PTRACE\n- \n\nSYS_RAWIO\n说明 \n\nSYS_RAWIO默认不支持，需提交工单申请。\n\n部分不支持配置的参数及其默认值如下：\n\n[表格]\n\n不支持配置的参数\n\n说明\n\nAllowedProcMountTypes\n\n指定容器可以挂载的proc类型，默认为DefaultProcMount。\n\nreadOnlyRootFilesystem\n\n容器运行的根文件系统是否为只读，默认为true。\n### 配置示例\n\n默认情况下，容器并不具备NET_ADMIN权限。如果在容器内进行网络相关操作，会返回报错提示。\n\n您可以为容器配置Security Context，设置capabilities参数来增加NET_ADMIN权限。YAML示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: sysctl-example\n  labels: \n    alibabacloud.com/eci: \"true\"\nspec:\n  containers:\n  - name: busybox\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n    command: [\"sh\", \"-c\", \"sleep 12000\"]\n    securityContext:\n      capabilities:\n        add: [\"NET_ADMIN\"]   \n\n\n重新创建ECI Pod，在容器内可以进行网络相关操作。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-a-security-context-for-an-elastic-container-instance-or-a-container", "page_type": "doc", "title": "配置Security Context", "keywords": "配置Security Context,修改sysctl内核参数,设置容器用户权限,Security Context配置,Pod Security Context,容器Security Context", "last_modified_ms": 1756903158000, "last_modified_iso": "2025-09-03T20:39:18+08:00", "excerpt": "如需自定义Pod或Container的权限和访问控制，可对应配置Security Context。\n## 背景信息\n\nSecurity Context，即安全上下文，用于定义Pod或者Container的权限和访问控制，包括Discretionary Access Control、SELinux、Linux Capabilities等。更多信息，请参见[Security Context](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)。\n\n配置Security Context时，可配置以下两种：\n\n- \n\nPod Security Context\n\nECI支持通过配置Pod（实例）级别的Security Context来修改sysctl参数，可应用于实例内所有容器和数据卷。\n- \n\nContainer Security Context\n\nECI支持通过配置Container（容器）级别的Security Context来修改runAsUser和capabilities，仅应用于指定的容器。\n\n## 配置实例Security Context\n### 功能说明\n\n在Linux中，通常可以通过sysctl接口修改内核运行时的参数。对于ECI实例的内核参数，您可以通过以下命令进行查看。更多信息，请参见[sysctl.sh](https://github.com/aliyuneci/Virtual-Kubelet-Example/blob/master/eci-securitycontext/sysctl.sh)。\n\nsysctl -a\n\n\n在Pod级别，您可以通过配置Security Context来修改sysctl参数和runAsUser。警告 \n\n为了避免破坏操作系统的稳定性，请您在充分了解sysctl参数变更影响后，再进行配置。更多信息，请参见[sysctl](https://man7.org/linux/man-pages/man8/sysctl.8.html)。\n\n目前ECI支持修改的sysctl参数如下：\n\n- \n\nkernel.shm*\n- \n\nkernel.msg*\n- \n\nkernel.sem\n- \n\nfs.mqueue.*\n- \n\nnet.*（net.ipv4.tcp_syncookies除外）\n- \n\nvm.min_free_kbytes\n\n修改vm.min_free_kbytes的值时，建议不要超过总内存的20%。\n\n### 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，可通过SecurityContext.Sysctl或HostSecurityContext.Sysctl配置实例Security Context，以修改sysctl参数，其中SecurityContext.Sysctl用于修改安全sysctl参数，HostSecurityContext.Sysctl用于修改非安全sysctl参数。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nSecurityContext.Sysctl.N.Name\n\nstring\n\nnet.ipv4.ping_group_range\n\n通过安全上下文修改sysctl参数时，安全sysctl参数的名称。取值范围：\n\n- \n\nnet.ipv4.ping_group_range\n- \n\nnet.ipv4.ip_unprivileged_port_start\n\nSecurityContext.Sysctl.N.Value \n\nstring\n\n1\n\n通过安全上下文修改sysctl参数时，安全sysctl参数的取值。\n\nHostSecurityContext.Sysctl.N.Name\n\nstring\n\nkernel.msgmax\n\n通过安全上下文修改sysctl参数时，非安全sysctl参数的名称。取值范围：\n\n- \n\nkernel.shm*（kernel.shm_rmid_forced除外）\n- \n\nkernel.msg*\n- \n\nkernel.sem\n- \n\nfs.mqueue.*\n- \n\nnet.*（net.ipv4.ip_local_port_range、net.ipv4.tcp_syncookies、net.ipv4.ping_group_range、net.ipv4.ip_unprivileged_port_start除外）\n\nHostSecurityContext.Sysctl.N.Value \n\nstring\n\n65536\n\n通过安全上下文修改sysctl参数时，非安全sysctl参数的取值。\n## 配置容器Security Context\n### 功能说明\n\n在容器级别，可以为指定的容器配置Security Context。目前ECI支持配置的参数如下：\n\n[表格]\n\n支持配置的参数\n\n说明\n\nrunAsUser\n\n设置运行容器的用户ID。该参数配置会覆盖Dockerfile中的USER指令。\n\nrunAsGroup\n\n设置运行容器的用户组。\n\nrunAsNonRoot\n\n设置容器是否以非root模式运行容器。取值为true表示以非root模式运行容器。默认为false。\n\nprivileged\n\n设置容器是否以特权模式运行。取值为true表示以特权模式运行容器。默认为false。说明 \n\n特权容器功能正在内测中。如需体验，请提交工单申请。\n\ncapabilities\n\n为容器内的进程授予某些特定的权限。更多信息，请参见[Linux Capabilities](https://man7.org/linux/man-pages/man7/capabilities.7.html)。\n\n目前支持配置以下权限：\n\n- \n\nAUDIT_WRITE\n- \n\nCHOWN\n- \n\nDAC_OVERRIDE\n- \n\nFSETID\n- \n\nFOWNER\n- \n\nKILL\n- \n\nMKNOD\n- \n\nNET_ADMIN\n- \n\nNET_BIND_SERVICE\n- \n\nNET_RAW\n- \n\nSETGID\n- \n\nSETUID\n- \n\nSETFCAP\n- \n\nSETPCAP\n- \n\nSYS_CHROOT\n- \n\nSYS_PTRACE\n- \n\nSYS_RAWIO\n说明 \n\nSYS_RAWIO默认不支持，需提交工单申请。\n\n部分不支持配置的参数及其默认值如下：\n\n[表格]\n\n不支持配置的参数\n\n说明\n\nAllowedProcMountTypes\n\n指定容器可以挂载的proc类型，默认为DefaultProcMount。\n\nreadOnlyRootFilesystem\n\n容器运行的根文件系统是否为只读，默认为true。\n### 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Container.N.SecurityContext的相关参数配置容器Security Context。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.SecurityContext.Capability.Add.N\n\narray\n\nNET_ADMIN\n\n为容器内的进程授予某些特定的权限。\n\nContainer.N.SecurityContext.ReadOnlyRootFilesystem\n\nboolean\n\ntrue\n\n容器运行的根文件系统是否为只读，目前仅支持配置为true。\n\nContainer.N.SecurityContext.RunAsUser\n\nlong\n\n1000\n\n设置运行容器的用户ID。\n\nContainer.N.SecurityContextRunAsGroup\n\nlong\n\n3000\n\n设置运行容器的用户组。\n\nContainer.N.SecurityContextRunAsNonRoot\n\nboolean\n\ntrue\n\n是否以非root模式运行容器。取值范围：\n\n- \n\ntrue：非root模式\n- \n\nfalse（默认值）：root模式\n\nContainer.N.SecurityContextPrivileged\n\nboolean\n\ntrue\n\n容器是否启用特权，即是否以特权模式运行容器。取值范围：\n\n- \n\ntrue：启用特权\n- \n\nfalse（默认值）：不启用特权\n说明 \n\n特权容器功能正在内测中。如需体验，请提交工单申请。说明 \n\nInitContainer也支持配置Security Context，参数与上表类似，但不支持SecurityContextRunAsGroup和SecurityContextRunAsNonRoot。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-an-eci-profile", "page_type": "doc", "title": "配置eci-profile", "keywords": "eci-profile,配置eci-profile,了解eci-profile功能,eci-profile配置说明,eci-profile功能介绍", "last_modified_ms": 1747807395000, "last_modified_iso": "2025-05-21T14:03:15+08:00", "excerpt": "为了减少您对业务YAML的改动，ECI支持了eci-profile功能。eci-profile可以提供集群维度的ECI资源视图，支持根据selector实现Pod编排。本文介绍如何配置eci-profile。\n## 功能介绍\n\n阿里云容器服务ACK通过VK（部署ack-virtual-node组件）使用ECI时，可能会碰到以下问题：\n\n- \n\n需要上层业务修改YAML才能调度Pod到ECI\n- \n\n需要上层业务修改YAML才能开启ECI特有的高级特性\n\n这类问题导致了运维管理工作和业务管理工作混淆在一起。为解决此类问题，ECI支持了eci-profile。eci-profile可以实现以下三个功能：\n\n- \n\nECI Scheduler\n\n在混合使用ECI和普通节点的场景下，一般可以通过配置Pod Label、配置Namespace Label和配置ECI弹性调度等方式将Pod调度到ECI，但这些方式均需要对存量资源做一定的修改，无法做到零侵入。\n\n对于上述情况，ECI Scheduler基于Mutating Webhook机制实现了一种新的调度机制。在eci-profile中，您可以自定义selector，selector可以根据Pod的Label或者Pod所属Namespace的Label来筛选Pod，满足selector筛选条件的Pod会自动调度到ECI。\n- \n\nECI Effect\n\n对于ECI的一些功能特性，例如指定ECS实例规格，启用镜像缓存，设置NTP服务等，需要在Pod中追加Annotation或者Label来实现。更多信息，请参见[ECI Pod Annotation](https://help.aliyun.com/zh/eci/user-guide/pod-annotations-1#topic-1860148)。\n\n对于上述情况，ECI Effect实现了自动追加Annotation和Label的功能。在eci-profile中，您可以自定义selector，在selector中同时指定筛选条件和要追加的Annotation和Label，满足selector筛选条件的Pod会自动调度到ECI，并自动追加指定的Annotation和Label。\n- \n\n配置热更新\n\neci-profile中包含了Cluster IP、混合云模式、日志采集、交换机等配置，您可以根据需要进行更新。\n\n- \n\n更新配置时无需重启VK。\n- \n\n对于新创建的ECI Pod，可以即时生效更新后的配置；对于存量ECI Pod，需要滚动发布后才能生效更新后的配置。\n\n## 注意事项\n\n- \n\n使用该功能时，请确保集群中的VK（ack-virtual-node组件）为最新版本。关于如何升级组件，请参见[管理组件](https://help.aliyun.com/zh/ack/manage-system-components)。\n- \n\n如果需要使用ECI Scheduler功能，则必须要开启Webhook。ACK Serverless集群默认调度Pod到ECI，无需使用ECI Scheduler功能。\n\n## 配置说明\n\n创建Pod时，系统会读取kube-system命名空间下的eci-profile配置文件（名为eci-profile的ConfigMap），按其data配置来创建Pod。您可以通过kubectl get cm -n kube-system eci-profile -o yaml命令查看eci-profile的YAML。eci-profile的YAML模板如下：\n\napiVersion: v1\ndata:\n  enableClusterIp: \"true\"\n  enableHybridMode: \"false\"\n  enableLinuxArm64Node: \"false\" \n  enableLogController: \"false\"\n  enablePVCController: \"false\"\n  enablePrivateZone: \"false\"\n  enableReuseSSLKey: \"false\"\n  featureGates: \"WaitForFirstConsumer=false\"\n  securityGroupId: sg-2zeeyaaxlkq9sppl****\n  selectors: \"\"\n  slsMachineGroup: \"\"\n  vSwitchIds: vsw-2ze23nqzig8inprou****,vsw-2ze94pjtfuj9vaymf****\n  vpcId: vpc-2zeghwzptn5zii0w7****\nkind: ConfigMap\nmetadata:\n  creationTimestamp: \"2023-01-11T08:28:14Z\"\n  name: eci-profile\n  namespace: kube-system\n  resourceVersion: \"356\"\n  uid: b345fa8c-919e-41fc-a981-57864b1a****\n\n\n您可以修改eci-profile中的data配置，配置selectors或更新固定配置项。\n\n[表格]\n\ndata中的配置项\n\n说明\n\n详细说明及示例\n\nselectors\n\n可自定义增加selector（分为objectSelector和namespaceSelector）和effect，用于实现ECI Scheduler和ECI Effect功能。您可以根据需要灵活配置selectors。\n\n[配置selectors](#608bd88090xlj)\n\n除selectors外，vpcId、vswitchIds等固定配置项\n\n集群级别配置项，支持热更新。您可以根据需要更新配置项取值。\n\n[更新固定配置项](#8689e8c090a4a)\n\n修改eci-profile的方式如下：\n\n- \n\n通过kubectl edit命令\n\nkubectl edit configmap eci-profile -n kube-system\n\n\n- \n\n通过容器服务管理控制台\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/)。\n- \n\n在集群页面，找到目标集群，单击集群名称。\n- \n\n在集群管理页的左侧导航栏，选择配置管理>配置项。\n- \n\n选择命名空间为kube-system。\n- \n\n找到eci-profile，单击YAML编辑。\n\n## 配置selectors\n\nselectors包含了ECI Scheduler和ECI Effect的配置。创建Pod时，系统会按照selectors去匹配Pod，对于Label能够匹配上的Pod，会自动调度到ECI，或者追加Annotation和Label，以便生效ECI的功能特性。\n\nselectors中可以包含多个selector，在每个selector中，您必须声明selector的name，可以根据需要声明以下信息：\n\n- \n\nnamespaceSelector：要匹配的Namespace Label。\n- \n\nobjectSelector：要匹配的Pod Label。\n- \n\neffect：要动态追加的Annotation和Label。\n\nselectors的配置模板如下：说明 \n\n请根据自身业务场景设计selectors，实际配置时请去除注释信息。\n\ndata:\n  selectors: |\n    [\n      {\n        \"name\": \"selector-demo1\", #selector名称，必填，不能为空\n        \"namespaceSelector\": {    #通过NameSpace Label筛选,可选\n          \"matchLabels\": {        #要匹配的NameSpace Label。如果填写多个，为与关系\n            \"eci\": \"true\"\n          }\n        },\n        \"objectSelector\": {       #通过Pod Label筛选，可选\n          \"matchLabels\": {        #要匹配的Pod Label。如果填写多个，为与关系\n            \"eci\": \"true\"\n          }\n        },\n        \"effect\": {               #要动态追加的Annotation和Label，可选\n          \"annotations\": {\n            \"k8s.aliyun.com/eci-use-specs\": \"ecs.c6.xlarge\"\n          },\n          \"labels\": {\n            \"created-by-eci\": \"true\"\n          }\n        }\n      },\n      {\n        \"name\": \"selector-demo2\",   \n        \"objectSelector\": {      \n          \"matchLabels\": {     \n            \"eci\": \"test\"\n    \t  }\n        }\n      }\n    ]\n\n\n上述模板中，名为sele"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-an-elastic-container-instance-pod-to-use-a-fixed-ip-address", "page_type": "doc", "title": "配置ECI Pod使用固定IP地址", "keywords": "配置ECI Pod固定IP,ECI Pod固定IP配置,ECI Pod固定IP原理", "last_modified_ms": 1691484844000, "last_modified_iso": "2023-08-08T16:54:04+08:00", "excerpt": "某些业务场景下，可能需要某一业务Pod使用固定的IP地址。本文介绍如何配置ECI Pod使用固定的IP地址。\n## 功能说明\n\n默认情况下，创建ECI Pod时，系统会从eci-profile中配置的交换机网段中，随机为Pod分配一个IP地址。如果Pod因为故障释放了，IP地址会随之释放，新创建的Pod会被分配新的IP地址。在某些业务场景下（例如一些IP地址直接暴露的服务），可能需要某一Pod使用固定的IP地址，否则会影响实际业务。\n\n基于上述场景，ECI支持了固定IP地址的功能。在创建ECI Pod时，如果Pod启用了固定IP地址，则系统会从配置的交换机网段中为其分配两个IP地址，一个为动态IP地址（该地址在集群内不可见），一个为固定IP地址。该Pod释放后，系统会保留其固定的IP地址，在有效期内（默认48小时），如果新创建的Pod与被释放的Pod的Cluster ID、Namespace和Pod Name一致，且启用了固定IP地址，则系统会将保留的IP地址分配给新创建的Pod，从而实现同一业务需求的Pod的IP地址保持不变。说明 \n\n该功能场景下，您可以使用StatefulSet来部署业务，StatefulSet包含的Pod释放后，系统会自动创建新的相同Namespace和Pod Name的Pod。\n## 配置说明\n\n您可以在Pod metadata中添加Annotation来配置ECI Pod启用固定IP地址，以及固定IP地址空闲后的保留时长。相关Annotation说明如下：\n\n[表格]\n\nAnnotation\n\n示例值\n\n说明\n\nk8s.aliyun.com/eci-fixed-ip\n\n\"true\"\n\n配置为true表示Pod启用固定IP地址。\n\nk8s.aliyun.com/eci-fixed-ip-retain-hour\n\n\"24\"\n\n固定IP地址空闲后的保留时长，即启用固定IP地址的Pod释放后，其固定IP地址的保留时长，单位为小时。\n\n如果没有配置该Annotation，默认保留48小时。\n## 配置示例\n\n- \n\n创建Service和StatefulSet。\n\nkubectl apply -f fixedIp.yaml\n\n\nfixedIp.yaml的内容示例如下，表示创建一个Service和一个StatefulSet，StatefulSet中包含一个ECI Pod，该Pod配置了启用固定IP地址的Annotation。\n\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  ports:\n  - port: 80\n    name: web\n  clusterIP: None\n  selector:\n    app: nginx\n---\napiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  serviceName: \"nginx\"\n  minReadySeconds: 10\n  template:\n    metadata:\n      annotations:\n        k8s.aliyun.com/eci-fixed-ip: \"true\"  #启用固定IP地址\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\"\n    spec:\n      containers:\n      - name: nginx\n        image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n          name: web\n\n\n- \n\n执行以下命令监控Pod状态变化。\n\nkubectl get pod -o wide -w\n\n\n返回示例如下，可以看到StatefulSet对应一个名称为web-0的Pod，Pod的IP地址为172.16.0.129。\n- \n\n重新打开一个命令行终端来连接集群，执行以下命令删除StatefulSet包含的Pod。\n\nkubectl delete pod web-0\n\n\n- \n\n切换回前一个命令行终端，继续观察Pod状态变化。\n\n新增的返回示例如下，可以看到删除Pod后，StatefulSet会自动创建一个新的Pod，新的Pod的IP地址保持不变。说明 \n\n前一个Pod未完全删除前会一直占用IP地址，影响新Pod的创建速度。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-an-elastic-container-instance-to-use-a-fixed-ip-address", "page_type": "doc", "title": "配置ECI实例使用固定IP地址", "keywords": "配置ECI实例固定IP,了解ECI固定IP功能,ECI固定IP配置方法,ECI固定IP API参数", "last_modified_ms": 1706677852000, "last_modified_iso": "2024-01-31T13:10:52+08:00", "excerpt": "默认情况下，ECI实例释放后IP地址会随之释放，如果您的业务场景需要某一业务的ECI实例保持IP地址不变，可以启用固定IP地址功能。该实例释放后会暂时保留其IP，在有效期内可以将该IP重新分配给新创建的实例，从而实现同一业务的实例使用固定IP地址。本文介绍如何配置ECI实例使用固定的IP地址。\n## 功能说明\n\n默认情况下，创建ECI实例时，系统会从配置的交换机网段中，随机为实例分配一个IP地址。如果实例释放了，IP地址会随之释放，新创建的实例会被分配新的IP地址。在某些业务场景下（例如一些IP地址直接暴露的服务），可能需要某一实例使用固定的IP地址，否则会影响实际业务。\n\n基于上述场景，ECI支持了固定IP地址的功能。在创建ECI实例时，如果实例启用了固定IP地址功能，则系统会从配置的交换机网段中为其分配两个IP地址，一个为动态IP地址（内部地址，不可见），一个为固定IP地址。该实例释放后，系统会保留其固定的IP地址。在有效期内（默认48小时），如果新创建的实例与被释放的实例的名称和所属交换机一致，且启用了固定IP地址功能，则系统会将保留的IP地址分配给新创建的实例，从而实现同一业务需求的实例的IP地址保持不变。\n## 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过FixedIp等参数为实例启用固定IP地址。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVSwitchId\n\nString\n\nvsw-bp1xpiowfm5vo8o3c****\n\n实例所属的交换机。\n\n启用固定IP地址的场景下，必须要指定交换机。\n\nSecurityGroupId\n\nString\n\nsg-2ze468xqmne3u4ak*\n\n实例所属的安全组。\n\n指定交换机的情况下，必须要指定安全组。\n\nFixedIp\n\nstring\n\ntrue\n\n配置为true表示实例启用固定IP地址。\n\nFixedIpRetainHour\n\ninteger\n\n24\n\n固定IP地址空闲后的保留时长，即启用固定IP地址的实例释放后，其固定IP地址的保留时长，单位为小时。默认值为48。\n## 配置示例\n\n- \n\n创建一台启用固定IP地址的ECI实例A。\n\n调用CreateContainerGroup接口创建实例A所采用的参数示例如下：\n\nRegionId=cn-beijing\nSecurityGroupId=sg-bp1daxpbz9lzpvvc****\nVSwitchId=vsw-bp1gds63lmlm7ib05****\nContainerGroupName=test\nContainer.1.Name=nginx1\nContainer.1.Image=registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\nFixedIp=true\n\n\n- \n\n确认实例A的IP地址。\n\n您可以根据返回的实例ID调用DescribeContainerGroups接口查询，也可以直接在控制台查看。\n\n- \n\n删除实例A。\n- \n\n创建一台ECI实例B。\n\n调用CreateContainerGroup接口创建实例B所采用的参数示例如下，配置的实例名称和交换机与实例A一致，且启用了固定IP地址。\n\nRegionId=cn-beijing\nSecurityGroupId=sg-bp1daxpbz9lzpvvc****\nVSwitchId=vsw-bp1gds63lmlm7ib05****\nContainerGroupName=test\nContainer.1.Name=nginx2\nContainer.1.Image=registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.15.10\nFixedIp=true\n\n\n- \n\n确认实例B的IP地址是否和实例A一致。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-container-termination-messages", "page_type": "doc", "title": "设置容器终止消息", "keywords": "设置容器终止消息,获取容器终止消息,容器终止消息配置,容器终止消息示例", "last_modified_ms": 1708329759000, "last_modified_iso": "2024-02-19T16:02:39+08:00", "excerpt": "在Kubernetes中，terminationMessagePath和terminationMessagePolicy用于指定容器终止消息的来源路径和策略。本文介绍如何设置terminationMessagePath和terminationMessagePolicy，以便在容器终止后能够及时获取和分析终止消息。\n## 配置说明\n\nKubernetes通过terminationMessagePath和terminationMessagePolicy管理容器终止消息。\n\n[表格]\n\n字段\n\n说明\n\nterminationMessagePath\n\n用于设置容器终止的消息来源。即当容器退出时，Kubernetes 从容器的terminationMessagePath字段中指定的终止消息文件中检索终止消息。默认值为 /dev/termination-log。\n\n通过自定义设置terminationMessagePath，可以使得Kubernetes在容器运行成功或失败时，使用指定文件中的内容来填充容器的终止消息。终止消息内容最大为4 KB。\n\nterminationMessagePolicy\n\n用于设置容器终止消息的策略。取值为：\n\n- \n\nFile（默认）：仅从终止消息文件中检索终止消息。\n- \n\nFallbackToLogsOnError：在容器因错误退出时，如果终止消息文件为空，则使用容器日志输出的最后一部分内容来作为终止消息。\n说明 \n\nPod内所有容器的终止信息大小之和最大为12 KB。当总和超过12 KB时，Kubernetes的状态管理器会对其加以限制。例如：Pod内有4个InitContainer和8个应用Container，则状态管理器会限制每个容器的终止信息最大为1 KB，即截取每个Container终止信息的前1 KB。\n## 配置示例\n\n在以下示例中，配置了terminationMessagePath字段为/tmp/termination-log，则容器会把终止消息写入/tmp/termination-log给Kubernetes接收。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: msg-path-demo\nspec:\n  containers:\n  - name: msg-path-demo-container\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    terminationMessagePath: \"/tmp/termination-log\"\n\n\n此外，您还可以设置容器的terminationMessagePolicy字段，进一步设置容器终止消息的策略。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: msg-path-demo\nspec:\n  containers:\n  - name: msg-path-demo-container\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    terminationMessagePath: \"/tmp/termination-log\"\n    terminationMessagePolicy: \"FallbackToLogsOnError\"\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-container-termination-messages-2", "page_type": "doc", "title": "设置容器终止消息", "keywords": "设置容器终止消息,容器终止消息配置,容器终止消息策略", "last_modified_ms": 1710747533000, "last_modified_iso": "2024-03-18T15:38:53+08:00", "excerpt": "在Kubernetes中，terminationMessagePath和terminationMessagePolicy用于指定容器终止消息的来源路径和策略。本文介绍如何设置terminationMessagePath和terminationMessagePolicy，以便在容器终止后能够及时获取和分析终止消息。\n## 配置说明\n\nKubernetes通过terminationMessagePath和terminationMessagePolicy管理容器终止消息。\n\n[表格]\n\n字段\n\n说明\n\nterminationMessagePath\n\n用于设置容器终止的消息来源。即当容器退出时，Kubernetes 从容器的terminationMessagePath字段中指定的终止消息文件中检索终止消息。默认值为 /dev/termination-log。\n\n通过自定义设置terminationMessagePath，可以使得Kubernetes在容器运行成功或失败时，使用指定文件中的内容来填充容器的终止消息。终止消息内容最大为4 KB。\n\nterminationMessagePolicy\n\n用于设置容器终止消息的策略。取值为：\n\n- \n\nFile（默认）：仅从终止消息文件中检索终止消息。\n- \n\nFallbackToLogsOnError：在容器因错误退出时，如果终止消息文件为空，则使用容器日志输出的最后一部分内容来作为终止消息。\n说明 \n\nPod内所有容器的终止信息大小之和最大为12 KB。当总和超过12 KB时，Kubernetes的状态管理器会对其加以限制。例如：Pod内有4个InitContainer和8个应用Container，则状态管理器会限制每个容器的终止信息最大为1 KB，即截取每个Container终止信息的前1 KB。\n## 配置示例\n\n在以下示例中，配置了terminationMessagePath字段为/tmp/termination-log，则容器会把终止消息写入/tmp/termination-log给Kubernetes接收。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: msg-path-demo\nspec:\n  containers:\n  - name: msg-path-demo-container\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    terminationMessagePath: \"/tmp/termination-log\"\n\n\n此外，您还可以设置容器的terminationMessagePolicy字段，进一步设置容器终止消息的策略。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: msg-path-demo\nspec:\n  containers:\n  - name: msg-path-demo-container\n    image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    terminationMessagePath: \"/tmp/termination-log\"\n    terminationMessagePolicy: \"FallbackToLogsOnError\"\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-custom-dns-for-eci-pods", "page_type": "doc", "title": "为ECI Pod配置自定义DNS", "keywords": "配置ECI Pod自定义DNS,解析ECI Pod内网域名,ECI Pod自定义DNS配置,ECI Pod DNS Annotation", "last_modified_ms": 1719565387000, "last_modified_iso": "2024-06-28T17:03:07+08:00", "excerpt": "混合云场景下，如果需要使用内网的镜像仓库来拉取镜像，或者容器需要访问内网中的域名，则需要配置ECI Pod使用的DNS为用户内网DNS，以便解析内网域名。本文介绍如何为ECI Pod配置自定义DNS。\n## 背景信息\n\n混合云场景下，例如Kubernetes集群包含本地节点，镜像仓库在本地的情况下，如果使用集群的DNS，可能会因为无法解析内网域名而导致Pod无法访问本地的内网环境。因此，ECI支持了配置自定义DNS功能，您可以为ECI Pod配置自定义DNS来解析内网域名，满足访问本地内网的需求。\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-custom-dnsconfig的Annotation来指定ECI Pod使用自定义DNS。该Annotation的取值格式为{\\\"nameservers\\\":\\\"20.1.xx.xx,20.1.xx.xx\\\",\\\"searches\\\":\\\"xx.com,xx.eee\\\",\\\"options\\\":\\\"ndots:2,edns0\\\"}。各字段说明如下：\n\n[表格]\n\n字段\n\n说明\n\nnameservers\n\nDNS服务器的IP地址列表。仅支持填入2个IP地址，多余的会自动忽略。\n\n同时，系统会在最后自动追加阿里云DNS服务器的IP地址，以保证系统服务正常。\n\nsearches\n\nDNS搜索域列表。最多允许32个。\n\n进行域名解析时，如果输入的域名不完整，系统会自动尝试使用该列表中的域名后缀来补全并进行解析。\n\noptions\n\nDNS解析选项。可包含多个KV值。以下为一些常见选项：\n\n- \n\nndots：设置DNS在主机名中必须至少包含多少个点号（.）才会将其视为绝对域名，否则会尝试在搜索域中进行解析。\n- \n\nedns0：开启EDNS0扩展支持，以支持更大的UDP数据包大小和提高安全性。\n- \n\ntimeout：设置DNS查询超时时间。\n- \n\nattempts：设置DNS查询尝试次数。\n\n配置示例如下：说明 \n\n请根据自身业务需求为Pod配置dnsPolicy，建议配置dnsPolicy为Default，表示Pod继承所在节点的DNS配置。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-custom-dnsconfig: \"{\\\"nameservers\\\":\\\"20.1.xx.xx,20.1.xx.xx\\\",\\\"searches\\\":\\\"xx.com,xx.eee\\\",\\\"options\\\":\\\"ndots:2,edns0\\\"}\"\n    spec:\n      dnsPolicy: Default  \n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n## 相关文档\n\n如需了解更多关于DNS配置的信息，请参见[DNS概述](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/service-discovery-dns-1/)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-eci-pod-to-start-after-clusterip-ready", "page_type": "doc", "title": "配置ECI Pod在ClusterIP同步后再创建", "keywords": "配置ECI Pod启动时序,解决ECI Pod访问超时,ECI Pod启动配置,ECI Pod与ClusterIP同步", "last_modified_ms": 1703820771000, "last_modified_iso": "2023-12-29T11:32:51+08:00", "excerpt": "由于ECI Pod和负责同步Service的组件是并行启动运行的，当集群中存在大量Service和Endpoint时，可能会出现因ClusterIp未同步而导致Pod访问超时的情况。本文介绍如何配置ECI Pod在ClusterIP同步后再创建，确保Pod中的容器在访问Service时，不会因为ClusterIp还未同步而导致访问超时。\n## 功能说明\n\n在ACK+ECI的场景下，ECI Pod和负责同步Service的组件是并行启动运行的。当集群中存在大量Service和Endpoint时，同步Service需要一定时间。此时，如果Pod中的容器访问了未同步ClusterIp的Service，则会造成访问超时。\n\n例如：在Spark等大数据场景下，Pod创建后需要立即访问Driver或者其他服务的Service，如果此时CoreDNS的ClusterIp未同步完成，那么就会造成Pod访问超时而导致任务结束。\n\n针对上述问题，ECI支持了等待ClusterIP同步完成后再开始创建Pod的功能，以此来确保Pod中的容器在访问Service时，不会因为ClusterIp还未同步而导致访问超时。重要 \n\n启用此功能时，如果集群中的Service和Endpoint规模较大，会影响Pod的启动时间。\n## 配置说明\n\n您可以在Pod metadata中添加Annotation来配置ECI Pod在ClusterIP同步后再开始创建，对应的Annotation为k8s.aliyun.com/eci-wait-clusterip-ready。取值为*时表示等待ClusterIP同步完成再开始创建Pod。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n      annotations:\n        k8s.aliyun.com/eci-wait-clusterip-ready: \"*\"  # 等待ClusterIP同步完成再启动Pod\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-eci-profile-to-automatically-use-datacache", "page_type": "doc", "title": "配置eci-profile实现自动使用DataCache", "keywords": "配置eci-profile,自动使用DataCache,eci-profile配置说明,DataCache自动使用", "last_modified_ms": 1694681201000, "last_modified_iso": "2023-09-14T16:46:41+08:00", "excerpt": "eci-profile支持ECI Effect能力，可以为满足条件的Pod自动追加Annotation来使用ECI的功能特性。本文介绍如何配置eci-profile，为特定Pod自动追加Annotation来使用DataCache。\n## 配置说明\n\n基于eci-profile的ECI Effect能力，在eci-profile配置文件的selectors中，支持以数组的形式声明需要匹配的Namespace或者Pod的Label，以及需要动态追加的Annotation。对于Label能够匹配上的Pod，将自动追加配置的Annotation。更多关于eci-profile的信息，请参见[配置eci-profile](https://help.aliyun.com/zh/eci/user-guide/configure-an-eci-profile)。\n\nselectors中可以包含多个selector，在每个selector中，您必须声明selector的name，可以根据需要声明以下信息：\n\n- \n\nnamespaceSelector：要匹配的Namespace Label。\n- \n\nobjectSelector：要匹配的Pod Label。\n- \n\neffect：要动态追加的Annotation和Label。\n\n可以添加的DataCache相关Annotation为k8s.aliyun.com/eci-data-cache-bucket，用于指定DataCache Bucket。\n## 配置示例\n\n- \n\n编辑eci-profile配置文件。\n\nkubectl -n kube-system edit cm eci-profile\n\n\n- \n\n在selectors中添加selector。\n\n内容示例如下，可以为带有data-cache: true的Label的Pod自动追加k8s.aliyun.com/eci-data-cache-bucket: \"default\"的Annotation，指定DataCache Bucket。\n\ndata:\n  selectors: |\n    [\n      {\n        \"name\": \"datacache-selector\",\n        \"objectSelector\": {\n          \"matchLabels\": {\n            \"data-cache\": \"true\"\n          }\n        },\n        \"effect\": {\n          \"annotations\": {\n            \"k8s.aliyun.com/eci-data-cache-bucket\": \"default\"\n          }\n        }\n      }\n    ]\n\n\n- \n\n创建DataCache。具体操作，请参见[创建DataCache](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-datacache#de188f402cndk)。\n- \n\n使用DataCache创建Pod。\n\nkubectl create -f test-edc.yaml\n\n\ntest-edc.yaml的内容示例如下：重要 \n\n使用DataCache创建Pod时，在指定DataCache Bucket的基础上，还需要通过挂载HostPath的方式挂载数据存储的路径。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test-edc\n  labels: \n    alibabacloud.com/eci: \"true\"\n    data-cache: \"true\"   #添加Label后，eci-profile会自动追加Annotation来指定DataCache Bucket\nspec:\n  containers:\n    - name: model\n      image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n      command: [\"sleep\", \"999999\"]\n      volumeMounts:\n        - name: \"model\"\n          mountPath: \"/model\"\n  volumes:        \n    - name: \"model\"\n      hostPath:\n        path: \"/model/test\"   #挂载数据存储路径，请根据实际替换\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-eci-profile-to-automatically-use-the-imagecache-feature", "page_type": "doc", "title": "配置eci-profile实现自动使用ImageCache", "keywords": "配置eci-profile用ImageCache,eci-profile配置方法,ImageCache自动使用", "last_modified_ms": 1702357968000, "last_modified_iso": "2023-12-12T13:12:48+08:00", "excerpt": "eci-profile支持ECI Effect能力，可以为满足条件的Pod自动追加Annotation来使用ECI的功能特性。本文介绍如何配置eci-profile，为特定Pod自动追加Annotation来使用ImageCache功能。\n## 配置说明\n\n基于eci-profile的ECI Effect能力，在eci-profile配置文件的selectors中，支持以数组的形式声明需要匹配的Namespace或者Pod的Label，以及需要动态追加的ImageCache相关Annotation。对于Label能够匹配上的Pod，将自动追加配置的Annotation。说明 \n\n更多关于eci-profile的信息，请参见[配置eci-profile](https://help.aliyun.com/zh/eci/user-guide/configure-an-eci-profile)。\n\n支持为Pod添加的ImageCache相关Annotation如下：\n\n[表格]\n\n使用方式\n\n配置项\n\n示例值\n\n说明\n\n自动匹配\n\nk8s.aliyun.com/eci-auto-imc\n\n\"true\"\n\n是否自动匹配ImageCache，默认为true，表示系统会根据匹配策略自动匹配最优的ImageCache创建Pod。匹配策略的优先级从高到低依次为：镜像匹配度、匹配的镜像大小、创建时间。\n\n如果没有完全匹配，系统会在创建Pod的同时自动创建对应的ImageCache。\n\nk8s.aliyun.com/imc-perfect-match\n\n\"true\"\n\nPod内所有容器镜像是否均要完全匹配ImageCache。默认为false。\n\nk8s.aliyun.com/imc-match-count-request\n\n\"2\"\n\nPod内要完全匹配ImageCache的容器镜像个数。\n\n明确指定\n\nk8s.aliyun.com/eci-imc-id\n\nimc-2zebxkiifuyzzlhl****\n\n明确指定使用某个ImageCache存创建Pod。\n\nselectors说明如下：\n\n  selectors: |\n   [\n    {\n        \"name\":\"demo\",  #必填，不能为空\n        \"namespaceSelector\":{  #选填，匹配Namespace Label\n            \"matchLabels\":{  #需要匹配的Label，如果填写多个，为与关系\n                \"app\":\"nginx\"\n            }\n        },\n        \"objectSelector\":{  #选填，匹配Pod Label\n            \"matchLabels\":{  #需要匹配的Label，如果填写多个，为与关系\n                \"type\":\"test\"\n            }\n        },\n        \"effect\":{  #需要动态追加的Annotation\n            \"annotations\":{\n                \"k8s.aliyun.com/eci-auto-imc\": \"true\"\n            }\n        }\n    }\n   ]\n\n\n配置selectors后，您可以通过以下命令确认selectors是否生效。如果返回的YAML中已包含配置的selectors，则表示配置成功；如果未包含selectors，请检查selectors的格式是否有误。\n\nkubectl get mutatingwebhookconfigurations -o yaml vk-webhook\n\n\n## 配置示例\n\n编辑eci-profile配置文件。\n\nkubectl -n kube-system edit cm eci-profile\n\n\n在selectors中添加以下示例内容：\n\n[\n  ...\n\t{\n    \"name\":\"image-cache-selector-1\",\n    \"objectSelector\":{\n      \"matchLabels\":{\n        \"image-cache\":\"true\"\n      }\n    },\n    \"effect\": {\n      \"annotations\": {\n        \"k8s.aliyun.com/eci-imc-id\": \"imc-uf6ic***************\"\n      }\n    }\n  },\n  {\n    \"name\":\"image-cache-selector-2\",\n      \"namespaceSelector\":{\n      \"matchLabels\":{\n        \"image-cache\":\"true\"\n      }\n    },\n    \"effect\": {\n      \"annotations\": {\n        \"k8s.aliyun.com/eci-auto-imc\": \"true\"\n      }\n    }\n  }\n]\n\n\n上述配置包含了2个selector：\n\n- \n\nimage-cache-selector-1：如果Pod带有image-cache: true的Label，将自动追加 \"k8s.aliyun.com/eci-imc-id\": \"imc-uf6ic***************\"的Annotation，使用指定的镜像缓存。\n- \n\nimage-cache-selector-2：如果Pod所属Namespace带有image-cache: true的Label，将自动追加 \"k8s.aliyun.com/eci-auto-imc\": \"true\"的Annotation，开启自动匹配镜像缓存。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-eci-profile-to-automatically-use-the-imagecache-feature-1", "page_type": "doc", "title": "配置eci-profile实现自动使用ImageCache", "keywords": "配置eci-profile使用ImageCache,了解eci-profile配置,eci-profile配置方法,ImageCache自动使用,eci-profile配置示例", "last_modified_ms": 1702352195000, "last_modified_iso": "2023-12-12T11:36:35+08:00", "excerpt": "eci-profile支持ECI Effect能力，可以为满足条件的Pod自动追加Annotation来使用ECI的功能特性。本文介绍如何配置eci-profile，为特定Pod自动追加Annotation来使用ImageCache功能。\n## 配置说明\n\n基于eci-profile的ECI Effect能力，在eci-profile配置文件的selectors中，支持以数组的形式声明需要匹配的Namespace或者Pod的Label，以及需要动态追加的ImageCache相关Annotation。对于Label能够匹配上的Pod，将自动追加配置的Annotation。说明 \n\n更多关于eci-profile的信息，请参见[配置eci-profile](https://help.aliyun.com/zh/eci/user-guide/configure-an-eci-profile)。\n\n支持为Pod添加的ImageCache相关Annotation如下：\n\n[表格]\n\n使用方式\n\n配置项\n\n示例值\n\n说明\n\n自动匹配\n\nk8s.aliyun.com/eci-auto-imc\n\n\"true\"\n\n是否自动匹配ImageCache，默认为true，表示系统会根据匹配策略自动匹配最优的ImageCache创建Pod。匹配策略的优先级从高到低依次为：镜像匹配度、匹配的镜像大小、创建时间。\n\n如果没有完全匹配，系统会在创建Pod的同时自动创建对应的ImageCache。\n\nk8s.aliyun.com/imc-perfect-match\n\n\"true\"\n\nPod内所有容器镜像是否均要完全匹配ImageCache。默认为false。\n\nk8s.aliyun.com/imc-match-count-request\n\n\"2\"\n\nPod内要完全匹配ImageCache的容器镜像个数。\n\n明确指定\n\nk8s.aliyun.com/eci-imc-id\n\nimc-2zebxkiifuyzzlhl****\n\n明确指定使用某个ImageCache存创建Pod。\n\nselectors说明如下：\n\n  selectors: |\n   [\n    {\n        \"name\":\"demo\",  #必填，不能为空\n        \"namespaceSelector\":{  #选填，匹配Namespace Label\n            \"matchLabels\":{  #需要匹配的Label，如果填写多个，为与关系\n                \"app\":\"nginx\"\n            }\n        },\n        \"objectSelector\":{  #选填，匹配Pod Label\n            \"matchLabels\":{  #需要匹配的Label，如果填写多个，为与关系\n                \"type\":\"test\"\n            }\n        },\n        \"effect\":{  #需要动态追加的Annotation\n            \"annotations\":{\n                \"k8s.aliyun.com/eci-auto-imc\": \"true\"\n            }\n        }\n    }\n   ]\n\n\n配置selectors后，您可以通过以下命令确认selectors是否生效。如果返回的YAML中已包含配置的selectors，则表示配置成功；如果未包含selectors，请检查selectors的格式是否有误。\n\nkubectl get mutatingwebhookconfigurations -o yaml vk-webhook\n\n\n## 配置示例\n\n编辑eci-profile配置文件。\n\nkubectl -n kube-system edit cm eci-profile\n\n\n在selectors中添加以下示例内容：\n\n[\n  ...\n\t{\n    \"name\":\"image-cache-selector-1\",\n    \"objectSelector\":{\n      \"matchLabels\":{\n        \"image-cache\":\"true\"\n      }\n    },\n    \"effect\": {\n      \"annotations\": {\n        \"k8s.aliyun.com/eci-imc-id\": \"imc-uf6ic***************\"\n      }\n    }\n  },\n  {\n    \"name\":\"image-cache-selector-2\",\n      \"namespaceSelector\":{\n      \"matchLabels\":{\n        \"image-cache\":\"true\"\n      }\n    },\n    \"effect\": {\n      \"annotations\": {\n        \"k8s.aliyun.com/eci-auto-imc\": \"true\"\n      }\n    }\n  }\n]\n\n\n上述配置包含了2个selector：\n\n- \n\nimage-cache-selector-1：如果Pod带有image-cache: true的Label，将自动追加 \"k8s.aliyun.com/eci-imc-id\": \"imc-uf6ic***************\"的Annotation，使用指定的镜像缓存。\n- \n\nimage-cache-selector-2：如果Pod所属Namespace带有image-cache: true的Label，将自动追加 \"k8s.aliyun.com/eci-auto-imc\": \"true\"的Annotation，开启自动匹配镜像缓存。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-hosts-for-a-pod", "page_type": "doc", "title": "自定义设置ECI Pod的hosts", "keywords": "设置ECI Pod的hosts,ECI Pod hosts配置,ECI Pod hosts注解", "last_modified_ms": 1706600550000, "last_modified_iso": "2024-01-30T15:42:30+08:00", "excerpt": "某些场景下，您可能需要自定义设置ECI Pod的hosts，例如拉取自建镜像仓库的镜像时，需要通过hosts明确镜像仓库的实际IP地址。本文介绍如何自定义设置ECI Pod级别的hosts（即/etc/hosts）。\n## 配置说明\n\n您可以通过k8s.aliyun.com/eci-custom-hosts的Annotation自定义设置ECI Pod的hosts，支持传入多组IP和域名的映射关系，单组格式为{\\\"host\\\":\\\"example.com\\\",\\\"ip\\\":\\\"100.100.XX.XX\\\"}。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\n例如拉取自建镜像仓库的镜像时，需要通过hosts明确镜像仓库的实际IP地址时，可参考以下YAML示例。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      name: test\n      labels:\n        app: test\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-custom-hosts: \"[{\\\"host\\\":\\\"example.com\\\",\\\"ip\\\":\\\"100.100.XX.XX\\\"},{\\\"host\\\":\\\"aliyundoc.com\\\",\\\"ip\\\":\\\"100.100.XX.XX\\\"}]\"\n    spec:\n      containers:\n      - name: nginx\n        image: example.com/test/nginx:latest\n        ports:\n        - containerPort: 80\n      - name: busybox\n        image: aliyundoc.com/test/busybox:1.30\n        command: [\"sleep\"]\n        args: [\"999999\"]\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-log-collection-for-an-elastic-container-instance", "page_type": "doc", "title": "自定义配置ECI日志采集", "keywords": "自定义ECI日志采集,配置ECI日志环境变量,ECI日志采集配置,ECI日志环境变量", "last_modified_ms": 1755488011000, "last_modified_iso": "2025-08-18T11:33:31+08:00", "excerpt": "ECI支持对接阿里云日志服务SLS，将ECI日志采集到SLS中。本文介绍如何通过环境变量自定义配置ECI日志采集，包括指定项目、日志库、机器组等。\n## 背景信息\n\n阿里云日志服务SLS是针对日志数据的一站式服务，您无需开发就能快捷完成日志数据采集、消费、投递以及查询分析等功能。更多信息，请参见[日志服务简介](https://help.aliyun.com/zh/sls/what-is-log-service)。重要 \n\n日志服务按照您的实际使用量收费。关于日志服务如何计费，请参见[计费概述](https://help.aliyun.com/zh/sls/billing-overview)。\n\n默认情况下，创建ECI实例时如果开启了日志采集功能，系统会自动生成一个项目和一个机器组：\n\n- \n\n项目名称为eci-log-default-project-{Region}-{账号ID}。\n- \n\n机器组名称为eci-log-default-machine-group-{Region}。\n\n如果您有自定义日志采集的需求，例如需要将日志收集到自定义的项目和日志库，或者需要将不同应用对应的ECI实例加入到不同的机器组，可以通过容器的环境变量传入日志相关的自定义配置，如果日志服务没有环境变量对应的项目、日志库和机器组等，系统将自动创建。\n## 注意事项\n\n- \n\n仅在创建ECI实例时才能通过环境变量自定义配置日志采集，更新实例时传入的日志相关环境变量不会生效。\n- \n\n对于自定义配置的日志Project和Logtail配置，如果后续不再使用，请及时删除相关Project和Logtail配置，避免产生不必要的费用。\n- \n\n对自定义配置的环境变量名称进行修改后，原有的配置不会自动删除，请手动清理以免产生不必要的费用。\n\n## 配置说明\n\n创建ECI实例时，可以通过容器的环境变量传入日志相关的自定义配置，包括项目（Project）、日志库（Logstore）、Logtail配置、机器组（Machinegroup）、分区（Shard）、日志保留时间、标签（Tag）等。可配置的环境变量如下：说明 \n\n日志相关环境变量名称的格式前缀为aliyun_logs_{key}，{key}表示日志服务中Logtail配置的名称，只能包含小写字母、数字和短划线（-）。\n\n[表格]\n\n配置对象\n\n环境变量名称\n\n环境变量取值说明\n\nLogtail配置\n\naliyun_logs_{key}\n\n创建Logtail配置。取值为日志采集路径。\n\n- \n\n采集标准输出时，取值如下：\n\n- \n\nstdout：采集正常输出和错误信息。\n- \n\nstderr-only：只采集错误信息，不采集正常输出。\n- \n\nstdout-only：只采集正常输出，不采集错误信息。\n\n- \n\n采集文本文件时，取值为容器内的文件目录。\n\n项目\n\naliyun_logs_{key}_project\n\n指定Project。Project名称格式要求如下：\n\n- \n\n长度为3~63个字符。\n- \n\n仅支持小写字母、数字和短划线（-），且必须以小写字母和数字作为开头和结尾。\n说明 \n\n项目名称必须全局唯一，创建后不可修改。如果名称格式校验不通过，将直接忽略该配置，采用默认项目。\n\n日志库\n\naliyun_logs_{key}_logstore\n\n指定Logstore。Logstore名称格式要求如下：\n\n- \n\n长度为3~63个字符。\n- \n\n仅支持小写字母、数字、短划线（-）和下划线（_），且必须以小写字母和数字作为开头和结尾。\n说明 \n\n如果名称格式校验不通过，将直接忽略该配置，采用默认日志库。默认情况下，日志库名称与Logtail配置名称{key}相同。\n\n机器组\n\naliyun_logs_{key}_machinegroup\n\n指定机器组。机器组名称格式要求如下：\n\n- \n\n长度为3~63个字符。\n- \n\n仅支持小写字母、数字、短划线（-）和下划线（_），且必须以小写字母和数字作为开头和结尾。\n说明 \n\n如果名称格式校验不通过，将直接忽略该配置，采用默认机器组。\n\n分区\n\naliyun_logs_{key}_shard\n\n设置日志分区数。取值范围为1~10。\n\nLogstore读写日志必须保存在某一个分区上，默认情况下，每个日志库有2个分区。\n\n日志保留时间\n\naliyun_logs_{key}_ttl\n\n设置日志保留时间，单位为天。取值范围为1~3650。\n\n- \n\n取值为3650时，表示永久保留日志。\n- \n\n默认保留90天。\n\n标签\n\naliyun_logs_{key}_tags\n\n绑定标签。取值格式为tag-key=tag-value，用于对日志进行标识。\n## 配置示例\n\n假设您需要自定义以下日志相关配置项：\n\n- \n\nLogtail配置和Logstore名称：标准输出日志保存到stdout-eci，文本文件日志保存到file-eci。\n- \n\nProject名称：project-eci-test\n- \n\n机器组名称：mg-eci-test\n说明 \n\n以下为示例配置，实际配置请使用您自定义的配置，确保Project名称唯一。\n## OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，可以通过Container.N.EnvironmentVar.N.Key和Container.N.EnvironmentVar.N.Value来设置环境变量。示例如下：\n\nContainerGroupName=test-sls\nContainer.1.Name=busybox\nContainer.1.Image=registry-vpc.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\nContainer.1.Command.1=/bin/sh\nContainer.1.Arg.1=-c\nContainer.1.Arg.2=mkdir -p /log;while true; do echo hello world; date; echo hello sls >> /log/busy.log; sleep 1;done\n# 采集标准输出\nContainer.1.EnvironmentVar.1.Key=aliyun_logs_stdout-eci\nContainer.1.EnvironmentVar.1.Value=stdout\nContainer.1.EnvironmentVar.2.Key=aliyun_logs_stdout-eci_project\nContainer.1.EnvironmentVar.2.Value=project-eci-test\nContainer.1.EnvironmentVar.3.Key=aliyun_logs_stdout-eci_machinegroup\nContainer.1.EnvironmentVar.3.Value=mg-eci-test\n# 采集文本文件\nContainer.1.EnvironmentVar.4.Key=aliyun_logs_file-eci\nContainer.1.EnvironmentVar.4.Value=/log/*.log\nContainer.1.EnvironmentVar.5.Key=aliyun_logs_file-eci_project\nContainer.1.EnvironmentVar.5.Value=project-eci-test\nContainer.1.EnvironmentVar.6.Key=aliyun_logs_file-eci_machinegroup\nContainer.1.EnvironmentVar.6.Value=mg-eci-test\n\n\n## 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建ECI实例时，您可以在容器配置区域选择容器，展开该容器的高级配置，然后打开环境变量开关，添加环境变量。示例如下：\n\n## 效果示例\n\n在[日志服务控制台](https://sls.console.aliyun.com/lognext/profile)找到目标Project，单击Project名称后进入日志库，可查看日志信息。示例如下：\n## 标准输出\n\n## 文本文件\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-startup-commands-and-arguments-for-a-container", "page_type": "doc", "title": "设置容器启动命令和参数", "keywords": "设置ECI启动命令,设置ECI启动参数,ECI启动命令规则,CreateContainerGroup参数", "last_modified_ms": 1722823017000, "last_modified_iso": "2024-08-05T09:56:57+08:00", "excerpt": "ECI实例通过容器镜像中的预设参数来启动容器。如果您在构建镜像时没有设置启动命令和参数，或者想要变更启动命令和参数，可以在创建ECI实例时设置。通过设置容器启动命令和参数，可以定义容器的启动行为和初始化过程，保证容器能够正确运行并提供所需服务。本文介绍如何为容器设置启动命令和参数。\n## 功能说明\n\n如果您想覆盖镜像中设置的启动默认值，包括工作目录、启动命令和参数，可以通过以下参数进行配置：\n\n- \n\n工作目录\n\n镜像构建时，通过WORKDIR可以指定容器的工作目录， 容器启动时执行的命令会在该目录下执行。更多信息，请参见[WORKDIR](https://docs.docker.com/engine/reference/builder/#workdir)。\n\n创建ECI实例时，通过配置ECI实例中容器的工作目录（ WorkingDir），可以覆盖WORKDIR。 说明 \n\n- \n\n如果镜像里未指定WORKDIR，且创建ECI实例也未配置工作目录，则工作目录默认为根目录。\n- \n\n如果指定的工作目录不存在，系统将自动创建。 \n\n- \n\n启动命令和参数\n\n镜像构建时，通过ENTRYPOINT和CMD可以指定启动容器后要执行的命令和参数。更多信息，请参见[ENTRYPOINT](https://docs.docker.com/engine/reference/builder/#entrypoint)和[CMD](https://docs.docker.com/engine/reference/builder/#cmd)。\n\n创建ECI实例时，通过配置ECI实例中容器的启动命令（Command）和参数（Arg），可以覆盖ENTRYPOINT和CMD。具体生效规则如下：重要 \n\n启动命令必须为容器镜像支持的命令，否则会导致容器启动失败。\n\n[表格]\n\n镜像ENTRYPOINT\n\n镜像CMD\n\n容器Command\n\n容器Arg\n\n最终执行\n\n说明\n\nmkdir\n\n/data/backup\n\n未设置\n\n未设置\n\nmkdir /data/backup\n\n容器没有设置Command和Arg，则执行镜像ENTRYPOINT和CMD。\n\nmkdir\n\n/data/backup\n\ncd\n\n未设置\n\ncd\n\n容器设置了Command，未设置Arg，则只执行容器Command，忽略镜像ENTRYPOINT和CMD。\n\nmkdir\n\n/data/backup\n\n未设置\n\n/opt/backup\n\nmkdir /opt/backup\n\n容器设置了Arg，未设置Command，则执行镜像ENTRYPOINT和容器Arg。\n\nmkdir\n\ndata/backup\n\ncd\n\n/opt/backup\n\ncd /opt/backup\n\n容器同时设置了Command和Arg，则执行容器Command和Arg。\n\n## 配置说明\n## OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过容器中的WorkingDir、Command和Arg参数来设置工作目录、启动命令和参数。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.WorkingDir\n\nstring\n\n/usr/local/\n\n容器工作目录。\n\nContainer.N.Command.N\n\narray\n\nsleep\n\n容器启动命令。最多20个。\n\nContainer.N.Arg.N\n\narray\n\n100\n\n容器启动命令对应的参数。最多10个。\n## 控制台\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)创建ECI实例时，您可以在容器配置中设置各个容器的启动命令和参数。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-startup-commands-and-arguments-for-containers", "page_type": "doc", "title": "设置容器启动命令和参数", "keywords": "设置容器启动命令,设置容器启动参数,容器启动命令配置,容器启动命令生效规则", "last_modified_ms": 1722823084000, "last_modified_iso": "2024-08-05T09:58:04+08:00", "excerpt": "ECI Pod（即ECI实例）通过容器镜像中的预设参数来启动容器。如果您在构建镜像时没有设置启动命令和参数，或者想要变更启动命令和参数，可以在创建ECI Pod时设置。通过设置容器启动命令和参数，可以定义容器的启动行为和初始化过程，保证容器能够正确运行并提供所需服务。本文介绍如何为容器设置启动命令和参数。\n## 功能说明\n\n如果您想覆盖镜像中设置的启动默认值，包括工作目录、启动命令和参数，可以通过以下参数进行配置：\n\n- \n\n工作目录\n\n镜像构建时，通过WORKDIR可以指定容器的工作目录， 容器启动时执行的命令会在该目录下执行。更多信息，请参见[WORKDIR](https://docs.docker.com/engine/reference/builder/#workdir)。\n\n创建ECI实例时，通过配置ECI实例中容器的工作目录（ WorkingDir），可以覆盖WORKDIR。 说明 \n\n- \n\n如果镜像里未指定WORKDIR，且创建ECI实例也未配置工作目录，则工作目录默认为根目录。\n- \n\n如果指定的工作目录不存在，系统将自动创建。 \n\n- \n\n启动命令和参数\n\n镜像构建时，通过ENTRYPOINT和CMD可以指定启动容器后要执行的命令和参数。更多信息，请参见[ENTRYPOINT](https://docs.docker.com/engine/reference/builder/#entrypoint)和[CMD](https://docs.docker.com/engine/reference/builder/#cmd)。\n\n创建ECI实例时，通过配置ECI实例中容器的启动命令（Command）和参数（Arg），可以覆盖ENTRYPOINT和CMD。具体生效规则如下：重要 \n\n启动命令必须为容器镜像支持的命令，否则会导致容器启动失败。\n\n[表格]\n\n镜像ENTRYPOINT\n\n镜像CMD\n\n容器Command\n\n容器Arg\n\n最终执行\n\n说明\n\nmkdir\n\n/data/backup\n\n未设置\n\n未设置\n\nmkdir /data/backup\n\n容器没有设置Command和Arg，则执行镜像ENTRYPOINT和CMD。\n\nmkdir\n\n/data/backup\n\ncd\n\n未设置\n\ncd\n\n容器设置了Command，未设置Arg，则只执行容器Command，忽略镜像ENTRYPOINT和CMD。\n\nmkdir\n\n/data/backup\n\n未设置\n\n/opt/backup\n\nmkdir /opt/backup\n\n容器设置了Arg，未设置Command，则执行镜像ENTRYPOINT和容器Arg。\n\nmkdir\n\ndata/backup\n\ncd\n\n/opt/backup\n\ncd /opt/backup\n\n容器同时设置了Command和Arg，则执行容器Command和Arg。\n\n## 配置示例\n\n您可以通过容器的workingDir、command和args字段来设置工作目录、启动命令和参数。更多信息，请参见[为容器设置启动时要执行的命令和参数](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        workingDir: /work\n        command: [\"sleep\"]\n        args: [\"999\"]\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-startup-commands-and-arguments-for-containers-2", "page_type": "doc", "title": "设置容器启动命令和参数", "keywords": "设置ECI容器启动命令,设置ECI容器启动参数,容器启动命令生效规则,ECI容器启动配置", "last_modified_ms": 1722823127000, "last_modified_iso": "2024-08-05T09:58:47+08:00", "excerpt": "ECI Pod（即ECI实例）通过容器镜像中的预设参数来启动容器。如果您在构建镜像时没有设置启动命令和参数，或者想要变更启动命令和参数，可以在创建ECI Pod时设置。通过设置容器启动命令和参数，可以定义容器的启动行为和初始化过程，保证容器能够正确运行并提供所需服务。本文介绍如何为容器设置启动命令和参数。\n## 功能说明\n\n如果您想覆盖镜像中设置的启动默认值，包括工作目录、启动命令和参数，可以通过以下参数进行配置：\n\n- \n\n工作目录\n\n镜像构建时，通过WORKDIR可以指定容器的工作目录， 容器启动时执行的命令会在该目录下执行。更多信息，请参见[WORKDIR](https://docs.docker.com/engine/reference/builder/#workdir)。\n\n创建ECI实例时，通过配置ECI实例中容器的工作目录（ WorkingDir），可以覆盖WORKDIR。 说明 \n\n- \n\n如果镜像里未指定WORKDIR，且创建ECI实例也未配置工作目录，则工作目录默认为根目录。\n- \n\n如果指定的工作目录不存在，系统将自动创建。 \n\n- \n\n启动命令和参数\n\n镜像构建时，通过ENTRYPOINT和CMD可以指定启动容器后要执行的命令和参数。更多信息，请参见[ENTRYPOINT](https://docs.docker.com/engine/reference/builder/#entrypoint)和[CMD](https://docs.docker.com/engine/reference/builder/#cmd)。\n\n创建ECI实例时，通过配置ECI实例中容器的启动命令（Command）和参数（Arg），可以覆盖ENTRYPOINT和CMD。具体生效规则如下：重要 \n\n启动命令必须为容器镜像支持的命令，否则会导致容器启动失败。\n\n[表格]\n\n镜像ENTRYPOINT\n\n镜像CMD\n\n容器Command\n\n容器Arg\n\n最终执行\n\n说明\n\nmkdir\n\n/data/backup\n\n未设置\n\n未设置\n\nmkdir /data/backup\n\n容器没有设置Command和Arg，则执行镜像ENTRYPOINT和CMD。\n\nmkdir\n\n/data/backup\n\ncd\n\n未设置\n\ncd\n\n容器设置了Command，未设置Arg，则只执行容器Command，忽略镜像ENTRYPOINT和CMD。\n\nmkdir\n\n/data/backup\n\n未设置\n\n/opt/backup\n\nmkdir /opt/backup\n\n容器设置了Arg，未设置Command，则执行镜像ENTRYPOINT和容器Arg。\n\nmkdir\n\ndata/backup\n\ncd\n\n/opt/backup\n\ncd /opt/backup\n\n容器同时设置了Command和Arg，则执行容器Command和Arg。\n\n## 配置示例\n\n您可以通过容器的workingDir、command和args字段来设置工作目录、启动命令和参数。更多信息，请参见[为容器设置启动时要执行的命令和参数](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        workingDir: /work\n        command: [\"sleep\"]\n        args: [\"999\"]\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-the-bandwidth-of-a-pod", "page_type": "doc", "title": "限制ECI Pod的出入带宽", "keywords": "限制ECI Pod带宽,ECI Pod带宽限制,ECI Pod带宽注解", "last_modified_ms": 1704856742000, "last_modified_iso": "2024-01-10T11:19:02+08:00", "excerpt": "出于网络稳定性、安全性和QoS等考虑，如果您的业务有网络限速的需求，可以在创建ECI Pod时，为其指定入方向和出方向的带宽，从而对出入流量进行限速。\n## 配置说明\n\n创建ECI Pod时，您可以在Pod metadata中添加Annotation来指定入方向和出方向带宽值，带宽值的单位支持TB、T、GB、G、MB、M、KB、K、B等。如果未填写单位，则默认对应的单位为B，即字节。说明 \n\n此处带宽值的单位指的是Annotation中取值传入的单位，系统会自动添加Bps（Byte per second）换算成带宽，即如果传入40M，会自动换算成320 Mbps。\n\n相关Annotation如下：\n\n- \n\nkubernetes.io/ingress-bandwidth：入方向带宽。\n- \n\nkubernetes.io/egress-bandwidth：出方向带宽。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        kubernetes.io/ingress-bandwidth: 40M    # 限制入方向带宽\n        kubernetes.io/egress-bandwidth: 10M     # 限制出方向带宽\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-the-bandwidth-of-a-pod-1", "page_type": "doc", "title": "限制ECI Pod的出入带宽", "keywords": "限制ECI Pod带宽,ECI Pod带宽限制,ECI Pod Annotation", "last_modified_ms": 1704856346000, "last_modified_iso": "2024-01-10T11:12:26+08:00", "excerpt": "出于网络稳定性、安全性和QoS等考虑，如果您的业务有网络限速的需求，可以在创建ECI Pod时，为其指定入方向和出方向的带宽，从而对出入流量进行限速。\n## 配置说明\n\n创建ECI Pod时，您可以在Pod metadata中添加Annotation来指定入方向和出方向带宽值，带宽值的单位支持TB、T、GB、G、MB、M、KB、K、B等。如果未填写单位，则默认对应的单位为B，即字节。说明 \n\n此处带宽值的单位指的是Annotation中取值传入的单位，系统会自动添加Bps（Byte per second）换算成带宽，即如果传入40M，会自动换算成320 Mbps。\n\n相关Annotation如下：\n\n- \n\nkubernetes.io/ingress-bandwidth：入方向带宽。\n- \n\nkubernetes.io/egress-bandwidth：出方向带宽。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        kubernetes.io/ingress-bandwidth: 40M    # 限制入方向带宽\n        kubernetes.io/egress-bandwidth: 10M     # 限制出方向带宽\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-the-ntp-service", "page_type": "doc", "title": "配置NTP服务", "keywords": "配置ECI的NTP服务,验证ECI的NTP配置,ECI NTP服务配置方法,ECI NTP服务配置示例", "last_modified_ms": 1706601719000, "last_modified_iso": "2024-01-30T16:01:59+08:00", "excerpt": "对于一些时间敏感的业务场景，容器时间同步不准确会影响业务正常运行。例如在分布式系统中各个容器节点时间不一致会导致数据不一致，或者参考日志调试程序时，日志时间戳不准确会导致日志顺序混乱和调试过程中的错误判断等。对于这类时间敏感的业务场景，在部署容器应用时，您可以为ECI实例配置NTP服务来确保实例内容器的时间同步准确，从而解决时间不准确导致的问题，保证数据准确性和业务正常运行。\n## 配置说明说明 \n\n仅支持通过OpenAPI配置，控制台暂不支持。\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过NtpServer.N参数为实例配置NTP服务，相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nNtpServer.N\n\narray\n\nntp.aliyun.com\n\nNTP服务器的地址。\n## 配置示例\n\n- \n\n创建一台ECI实例，并为其配置NTP服务。\n\n调用CreateContainerGroup接口创建实例所采用的参数示例如下：\n\nContainerGroupName=test-ntp\nNtpServer.1=100.100.XX.XX\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/centos:7\nContainer.1.Command=sleep\nContainer.1.Arg=3600\n\n\n- \n\n连接实例，查询容器的时间来源。\n\nchronyc sources\n\n说明 \n\n如果没有安装chrony，可执行yum -y install chrony进行安装。\n\n如果返回了NTP服务器的IP地址，则表示设置成功。返回示例如下：\n\n210 Number of sources = 7\nMS Name/IP address         Stratum Poll Reach LastRx Last sample               \n===============================================================================\n^* 100.100.XX.XX                 1   4   177    13    +22us[ +153us] +/-   10ms\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-the-ntp-service-1", "page_type": "doc", "title": "配置NTP服务", "keywords": "配置ECI Pod的NTP,验证ECI Pod的NTP,ECI Pod NTP配置,ECI NTP Annotation", "last_modified_ms": 1706600386000, "last_modified_iso": "2024-01-30T15:39:46+08:00", "excerpt": "对于一些时间敏感的业务场景，容器时间同步不准确会影响业务正常运行。例如在分布式系统中各个容器节点时间不一致会导致数据不一致，或者参考日志调试程序时，日志时间戳不准确会导致日志顺序混乱和调试过程中的错误判断等。对于这类时间敏感的业务场景，在部署容器应用时，您可以为ECI Pod配置NTP服务来确保Pod内容器的时间同步准确，从而解决时间不准确导致的问题，保证数据准确性和业务正常运行。\n## 配置说明\n\n创建ECI Pod时，可以为Pod添加k8s.aliyun.com/eci-ntp-server的Annotation来指定NTP服务器的地址，使得Pod内的容器能与NTP服务进行时间同步，从而保证时间准确性。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\n- \n\n创建配置NTP服务的应用。\n\nkubectl create -f set-ntp.yaml\n\n\nset-ntp.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test-ntp\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: test-ntp\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-ntp-server: 100.100.XX.XX  # 指定NTP服务器的IP地址\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/centos:7\n        ports:\n        - containerPort: 80\n        command: [\"/bin/sh\",\"-c\",\"sleep 3600\" ]\n\n\n- \n\n登录到容器，验证NTP服务是否设置成功。\n\n- \n\n获取Pod信息。\n\nkubectl get pod\n\n\n预期返回：\n\nNAME                        READY   STATUS    RESTARTS   AGE\ntest-ntp-599d5ff9f5-9kb56   1/1     Running   0          3m59s\n\n\n- \n\n进入容器。\n\nkubectl exec -it test-ntp-599d5ff9f5-9kb56 -- bash\n\n\n- \n\n查询容器的时间来源。\n\nchronyc sources\n\n说明 \n\n如果没有安装chrony，可执行yum -y install chrony进行安装。\n\n如果返回了NTP服务器的IP地址，则表示配置成功。返回示例如下：\n\n210 Number of sources = 1\nMS Name/IP address         Stratum Poll Reach LastRx Last                            sample\n===============================================================================\n^* 100.100.XX.XX                    2           6     377     35       +40us[ +135us] +/-   14ms\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/configure-the-ntp-service-2", "page_type": "doc", "title": "配置NTP服务", "keywords": "为ECI Pod配置NTP,ECI Pod NTP配置方法,ECI Pod NTP注解", "last_modified_ms": 1695280573000, "last_modified_iso": "2023-09-21T15:16:13+08:00", "excerpt": "本文主要介绍如何为ECI Pod配置NTP服务。当您在部署应用时，如果需要Pod内的容器能与NTP服务进行时间同步，您可以参考本文进行配置。\n## 配置说明\n\n创建ECI Pod时，可以为Pod添加k8s.aliyun.com/eci-ntp-server的Annotation来指定NTP服务器的地址，使得Pod内的容器能与NTP服务进行时间同步。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\n- \n\n创建配置NTP服务的应用。\n\nkubectl create -f set-ntp.yaml\n\n\nset-ntp.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test-ntp\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: test-ntp\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-ntp-server: 100.100.XX.XX  # 设置您的NTP服务器的IP地址\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/centos:7\n        ports:\n        - containerPort: 80\n        command: [\"/bin/sh\",\"-c\",\"sleep 3600\" ]\n\n\n- \n\n登录到容器，验证NTP服务是否设置成功。\n\n- \n\n获取Pod信息。\n\nkubectl get pod\n\n\n预期返回：\n\nNAME                        READY   STATUS    RESTARTS   AGE\ntest-ntp-599d5ff9f5-9kb56   1/1     Running   0          3m59s\n\n\n- \n\n进入容器。\n\nkubectl exec -it test-ntp-599d5ff9f5-9kb56 -- bash\n\n\n- \n\n查询容器的时间来源。\n\nchronyc sources\n\n说明 \n\n如果没有安装chrony，可执行yum -y install chrony进行安装。\n\n如果返回了NTP服务器的IP地址，则表示设置成功。返回示例如下：\n\n210 Number of sources = 1\nMS Name/IP address         Stratum Poll Reach LastRx Last                            sample\n===============================================================================\n^* 100.100.XX.XX                    2           6     377     35       +40us[ +135us] +/-   14ms\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/connect-ask-clusters-to-arms-application-monitoring", "page_type": "doc", "title": "接入ARMS应用监控", "keywords": "接入ARMS应用监控,监控ACK Serverless应用,ARMS应用监控接入,ACK Serverless监控", "last_modified_ms": 1709020853000, "last_modified_iso": "2024-02-27T16:00:53+08:00", "excerpt": "借助ARMS应用监控，您可以对ACK Serverless集群中的应用进行应用拓扑、接口调用、异常事务和慢事务监控、SQL分析等监控。本文介绍如何将ACK Serverless集群接入ARMS应用监控，以便通过ARMS监控使用ECI运行的应用。\n## 背景信息\n\n应用实时监控服务ARMS（Application Real-Time Monitoring Service）是一款应用性能管理（APM）产品，包含应用监控、Prometheus监控等功能模块，能帮助您实现全栈式性能监控和端到端全链路追踪诊断，实现轻松高效的应用运维。\n\n为ACK Serverless集群安装ARMS应用监控组件（探针）后，ARMS可以对应用进行全方位监控，帮助您快速定位出错接口和慢接口、重现调用参数、发现系统瓶颈，从而大幅提升线上问题诊断的效率。更多信息，请参见[应用监控概述](https://help.aliyun.com/zh/arms/application-monitoring/product-overview/overview-9#concept-63796-zh)。\n## 前提条件\n\n- \n\n已创建ACK Serverless集群。\n- \n\n已开通ARMS服务。具体操作，请参见[开通ARMS](https://help.aliyun.com/zh/arms/getting-started/activate-arms#concept-65257-zh)。\n- \n\n检查您的JDK版本。ARMS应用监控支持的JDK版本如下：\n\n- \n\nJDK 1.7.0+\n- \n\nJDK 1.8.0_25+说明 \n\n如果JDK版本为1.8.0_25或者1.8.0_31，可能会出现无法安装探针的情况。如果出现该情况，请升级JDK版本至1.8.0_191及以上版本。\n- \n\nJDK 11.0.8+\n说明 \n\nJDK 1.8及以下版本和JDK 11版本对应的探针安装包不同，请根据不同的JDK版本下载对应的探针安装包或调整应用监控组件ack-onepilot的配置。\n\n## 步骤一：安装应用监控组件\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.2.16.61a036c8iieu29&amp;accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)。\n- \n\n在集群页面，单击目标集群名称，进入集群管理页面。\n- \n\n在集群中安装ack-onepilot组件。\n\n- \n\n在集群管理页左侧导航栏，选择运维管理>组件管理。\n- \n\n单击日志与监控页签，找到ack-onepilot卡片，然后单击安装。\n- \n\n在弹出的对话框中，参考页面提示填写组件配置信息，然后单击确定。\n\n安装完成后，ack-onepilot卡片右上角会显示已安装。\n\n## 步骤二：授予ARMS资源的访问权限\n\n- \n\n打开[云资源访问授权](https://ram.console.aliyun.com/role/authorization?spm=a2c4g.11186623.0.0.79a4217dHXoaR4&request=%7B%22Services%22%3A%5B%7B%22Service%22%3A%22ECS%22%2C%22Roles%22%3A%5B%7B%22RoleName%22%3A%22AliyunMSEForECIRole%22%2C%22TemplateId%22%3A%22AliyunMSEForECIRole%22%7D%5D%7D%5D%2C%22ReturnUrl%22%3A%22https%3A%2F%2Farms.console.aliyun.com%22%7D)页面，完成授权操作。\n- \n\n重启ack-onepilot组件下的所有Pod。\n\n- \n\n在[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.2.16.61a036c8iieu29&amp;accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)的集群页面，单击目标集群名称，打开集群管理页面。\n- \n\n在左侧导航栏，选择工作负载>无状态。\n- \n\n重新部署命名空间为ack-onepilot的所有Deployment。\n\n部署完成后，可在容器组页面确认相关Pod（命名空间为ack-onepilot）的状态是否均为Running。\n\n## 步骤三：为应用开启应用监控\n\n- \n\n在集群管理页面的左侧导航栏，选择工作负载>无状态，或者选择工作负载>有状态。\n- \n\n根据需要创建新的应用，或者更新已有应用。\n\n在应用的YAML配置文件中为Pod添加Label即可开启应用监控。相关Label如下：\n\nlabels:\n  armsPilotAutoEnable: \"on\"      #开启应用监控\n  armsPilotCreateAppName: \"<deployment-name>\"    #请将<deployment-name>替换为您的应用名称\n  one-agent.jdk.version: \"OpenJDK11\"    #如果应用的JDK版本是JDK 11，则需要配置此参数\n  armsSecAutoEnable: \"on\"    #如果需要接入应用安全，则需要配置此参数\n\n说明 \n\n- \n\nLabel请添加在Pod的metadata下，例如配置Deployment时，需添加在spec>template>metadata下。\n- \n\n对于已有应用，更新Label后请重启应用。\n\n创建Java应用并开启ARMS应用监控的完整YAML示例如下：\n\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: arms-demo\n---\napiVersion: apps/v1 # for versions before 1.8.0 use apps/v1beta1\nkind: Deployment\nmetadata:\n  name: arms-springboot-demo\n  namespace: arms-demo\n  labels:\n    app: arms-springboot-demo\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: arms-springboot-demo\n  template:\n    metadata:\n      labels:\n        app: arms-springboot-demo\n        armsPilotAutoEnable: \"on\"\n        armsPilotCreateAppName: \"arms-springboot-demo\"\n        one-agent.jdk.version: \"OpenJDK11\"\n    spec:\n      containers:\n        - resources:\n            limits:\n              cpu: 0.5\n          image: registry.cn-hangzhou.aliyuncs.com/arms-docker-repo/arms-springboot-demo:v0.1\n          imagePullPolicy: Always\n          name: arms-springboot-demo\n          env:\n            - name: SELF_INVOKE_SWITCH\n              value: \"true\"\n            - name: COMPONENT_HOST\n              value: \"arms-demo-component\"\n            - name: COMPONENT_PORT\n              value: \"6666\"\n            - name: MYSQL_SERVICE_HOST\n              value: \"arms-demo-mysql\"\n            - name: MYSQL_SERVICE_PORT\n              value: \"3306\"\n---\napiVersion: apps/v1 # for versions before 1.8.0 use apps/v1beta1\nkind: Deployment\nmetadata:\n  name: arms-springboot-demo-subcomponent\n  namespace: arms-demo\n  labels:\n    app: arms-springboot-demo-subcomponent\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: arms-springboot-demo-subcomponent\n  template:\n    metadata:\n      labels:\n "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/connection-overview", "page_type": "doc", "title": "ACK对接ECI", "keywords": "了解ACK对接ECI,选择ACK对接ECI方案,实现ACK对接ECI,ACK对接ECI概述,ACK对接ECI方式,ACK对接ECI使用流程", "last_modified_ms": 1739269419000, "last_modified_iso": "2025-02-11T18:23:39+08:00", "excerpt": "ECI能为Kubernetes提供基础的容器Pod运行环境，但业务间的依赖、负载均衡、弹性伸缩、定期调度等能力依然需要Kubernetes来提供。本文为您介绍阿里云容器服务Kubernetes版（简称ACK）如何与ECI对接，使用ECI作为Pod的运行资源。\n## 对接方式\n\nECI为Kubernetes提供一种层次化的解决方案：即ECI负责底层Pod容器资源的调度和管理工作，Kubernetes在ECI之上作为PaaS层来管理业务负载，例如管理Deployment、Service、StatefulSet、CronJob等。\n\n基于Kubernetes社区的Virtual Kubelet（简称VK）技术，ECI可以以虚拟节点的形式接入到Kubernetes集群中，使得集群可以轻松获得极大的弹性能力，而不必受限于集群的节点计算容量。ECI在接管Pod容器底层基础设施的管理工作后，Kubernetes不再需要直接负责单个Pod的放置、启动等工作，也不再需要关心底层虚拟机的资源情况，通过ECI即可确保Pod需要的资源随时可用。\n\n目前ECI已经无缝集成到阿里云容器服务Kubernetes版中，您可以通过ACK Serverless集群或者ACK集群，快速体验ECI的容器运行能力。\n### ACK Serverless集群（完全基于ECI）\n\n依托ECI免运维的特性，Kubernetes可以完全依托ECI来构建，即所有Pod均运行在ECI上，Kubernetes仅需要负责管理业务负载，无需关注底层虚拟机的运维和容量问题。\n\n如果您正在进行Kubernetes集群的选型，强烈推荐您选用ACK Serverless集群。ACK Serverless集群可以为您提供完全基于ECI运行的Kubernetes集群，为您的在线和离线业务、仿真环境、开发测试环境等提供免运维、低成本的Kubernetes环境。\n\n- \n\n低成本\n\n您无需购买节点，无需对集群进行节点维护和容量规划，即可直接部署容器应用，并且只需要为应用配置的CPU和内存资源量进行按需付费。\n- \n\n免运维\n\n您可以直接使用Kubernetes API或者命令行直接管理容器应用。同时，ACK Serverless集群集成阿里云各类服务，可以帮助您简化Kubernetes的开发，专注于应用构建而非基础架构运维。\n\n在ACK Serverless集群中，您无需手动部署虚拟节点，可以直接创建ECI Pod。ACK Serverless集群中的所有Pod均基于ECI运行在安全隔离的容器运行环境中，每个Pod对应一个ECI实例。更多信息，请参见[ACK Serverless概述](https://help.aliyun.com/zh/ack/serverless-kubernetes/product-overview/ask-overview#concept-pc2-xyz-xdb)。\n\n### ACK集群（混合使用ECI和ECS）\n\nACK是全球首批通过Kubernetes一致性认证的服务平台，提供高性能的容器应用管理服务。它整合了阿里云虚拟化、存储、网络和安全能力，简化集群的搭建和扩容等工作，让您专注于容器化的应用的开发与管理。\n\n如果您已经建立了ACK集群，可以通过部署虚拟节点（基于VK）的方式来使用ECI。有了虚拟节点后，当您的ACK集群需要扩容时，无需规划节点的计算容量，可以直接在虚拟节点下按需创建ECI，ECI与集群中真实节点上的Pod之间网络互通。建议您将长时间运行的业务负载的弹性流量部分调度至ECI，这可以缩短弹性扩容的时间，减少扩容成本，并充分利用已有资源。当业务流量下降后，您可以快速释放部署在ECI上的Pod，从而降低使用成本。\n\n在ACK集群中，您需要手动部署虚拟节点（基于VK），才能创建ECI Pod。虚拟节点上的Pod均基于ECI运行在安全隔离的容器运行环境中，每个Pod对应一个ECI实例。更多信息，请参见[ACK产品概述](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/ack-cluster-overview/#concept-jlf-y4f-vdb)。\n\n说明 \n\n如果您在阿里云ECS上或者线下IDC自建了Kubernetes集群，需要自行部署虚拟节点（基于VNode）来使用ECI，更多信息，请参见[自建Kubernetes集群对接ECI](https://help.aliyun.com/zh/eci/user-guide/overview-3#topic-2148389)。\n## 管理工具\n\n通过VK将ECI以虚拟节点的方式接入Kubernetes集群后，您可以通过以下方式管理Kubernetes集群及ECI实例的运行情况：\n\n- \n\n弹性容器实例控制台\n\n您可以通过弹性容器实例控制台查看ECI实例的运行情况。操作步骤如下：\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在容器组页面，您可以查看该地域下已经创建的ECI实例。\n\n- \n\n容器服务管理控制台\n\n您可以通过容器服务管理控制台来操作ACK Serverless集群或ACK集群，并查看ECI实例的运行情况。查看ECI实例的操作步骤如下：\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在左侧导航栏单击集群列表。\n- \n\n在集群列表中找到想要查看的集群，单击集群ID进入详情页面。\n- \n\n在左侧导航栏，选择工作负载>容器组。\n- \n\n在容器组页面，选择命名空间，您可以查看该命名空间下的ECI实例。\n\n- \n\n阿里云CloudShell\n\n您可以通过阿里云提供的CloudShell来访问Kubernetes集群，使用kubectl命令来管理集群。具体操作，请参见[在CloudShell上通过kubectl管理Kubernetes集群](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/use-kubectl-on-cloud-shell-to-manage-ack-clusters-1690962464408#task-y24-gbm-2gb)。\n- \n\nkubectl客户端\n\n您可以通过kubectl客户端在本地计算机来访问远端的Kubernetes集群，使用kubectl命令来管理集群。具体操作，请参见[通过kubectl连接Kubernetes集群](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/obtain-the-kubeconfig-file-of-a-cluster-and-use-kubectl-to-connect-to-the-cluster#task-ubf-lhg-vdb)。\n\n## 功能限制和说明\n\n基于公有云的安全性和虚拟节点本身带来的限制，ECI目前还不支持Kubernetes中HostPath、DaemonSet等功能，具体如下表所示。\n\n[表格]\n\n不支持的功能\n\n说明\n\n推荐替代方案\n\nHostPath\n\n挂载本地宿主机文件到容器中\n\n使用emptyDir、云盘或者NAS文件系统\n\nHostNetwork\n\n将宿主机端口映射到容器上\n\n使用type=LoadBalancer的负载均衡\n\nDaemonSet\n\n在容器所在宿主机上部署Static Pod\n\n通过sidecar形式在Pod中部署多个镜像\n\ntype=NodePort的Service\n\n将宿主机端口映射到容器上\n\n使用type=LoadBalancer的负载均衡\n\n通过容器服务Kubernetes版使用ECI时，请注意以下事项：\n\n- \n\n请先将容器镜像上传到容器镜像仓库中，便于镜像拉取。推荐您使用阿里云容器镜像服务ACR，并使用专有网络的镜像地址（registry-vpc.xxx）。\n- \n\n支持Deployment、ReplicaSet、Job、Cronjob、StatefulSet等常见controller，可以直接运行。\n- \n\n支持利用PrivateZone实现服务发现，建议您在创建集群时开启PrivateZone。\n- \n\n支持负载均衡，即配置type=LoadBalancer的Service。\n\n## 使用流程\n### ACK Serverless集群\n\n- \n\n创建ACK Serverless集群。具体操作，请参见[创建集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/create-an-ask-cluster-2)。\n- \n\n准备容器镜像。\n- \n\n创建ECI Pod。更多信息，请参见[ECI Pod概述](https://help.aliyun.com/zh/eci/user-guide/overview-4)。\n\n### ACK集群\n\n- \n\n创建ACK集群。具体操作，请参见[创建ACK托管集群](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/c", "aliases": ["https://help.aliyun.com/document_detail/90668.html"]}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-arm-specification", "page_type": "doc", "title": "指定Arm规格创建Pod", "keywords": "创建Arm规格ECI Pod,Arm规格ECI Pod配置,ECI Arm规格说明", "last_modified_ms": 1731634325000, "last_modified_iso": "2024-11-15T09:32:05+08:00", "excerpt": "本文介绍如何指定ECS Arm规格创建一个Arm架构的ECI Pod，该Pod将运行在Arm架构的虚拟节点上。\n## 前提条件\n\n已在集群中创建了Arm架构的虚拟节点。关于如何创建Arm架构的虚拟节点，请参见[添加Arm架构的虚拟节点](https://help.aliyun.com/zh/eci/user-guide/scheduling-pods-to-virtual-nodes-in-the-arm-architecture#42f0d9a058lbp)。\n## 规格说明\n\nArm规格基于Arm架构，每一个vCPU都对应一个处理器的物理核心，具有性能稳定且资源独享的特点，适用于容器、微服务、网站和应用服务器、高性能计算、基于CPU的机器学习等场景。\n\n[表格]\n\n规格类型\n\nArm规格族\n\n通用型\n\ng8y\n\n计算型\n\nc8y\n\n内存型\n\nr8y\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n除了在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定Arm规格外，创建Arm规格的Pod必须要配置nodeSelector为kubernetes.io/arch: arm64以适配K8s调度。\n\n配置示例如下：\n\n- \n\n确认集群中已有Arm架构的虚拟节点。\n\nkubectl get node\n\n\n如果返回的节点名称中带有linux-arm64的后缀，则表示该节点为Arm架构的虚拟节点。\n\n说明 \n\n关于如何在集群中创建Arm架构的虚拟节点，请参见[添加Arm架构的虚拟节点](https://help.aliyun.com/zh/eci/user-guide/scheduling-pods-to-virtual-nodes-in-the-arm-architecture#42f0d9a058lbp)。\n- \n\n指定Arm规格创建Pod。\n\nkubectl create -f arm-test.yaml\n\n\narm-test.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.c8y.large,ecs.g8y.large\"   # 指定支持的ECS Arm规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: arm64v8/centos:7.9.2009   # 使用基于Arm架构的镜像。\n        command: [\"sleep\"]\n        args: [\"999999\"]\n      nodeSelector:\n        kubernetes.io/arch: arm64  # 调度到Arm节点。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification", "page_type": "doc", "title": "指定GPU规格创建Pod", "keywords": "创建ECI GPU Pod,指定Pod的GPU规格,ECI GPU Pod配置,ECI GPU规格说明", "last_modified_ms": 1742538098000, "last_modified_iso": "2025-03-21T14:21:38+08:00", "excerpt": "本文介绍如何指定ECS GPU规格创建一个ECI Pod，以及如何修改GPU驱动版本。\n## 规格说明\n\nGPU规格含有GPU计算卡，适用于深度学习、图像处理等场景。GPU对应的Docker镜像可以直接运行在ECI GPU实例上。实例内已预装NVIDIA显卡设备驱动，不同GPU规格支持安装的驱动和CUDA版本不同。说明 \n\n下表中的gn8ia和gn8is目前仅支持海外等部分地域，如有需求，请联系阿里云销售人员。\n\n[表格]\n\n规格类型\n\nGPU规格族\n\n驱动和CUDA版本\n\nGPU虚拟化型实例规格族\n\nsgn7i-vws\n\nGRID 470，CUDA 11.4（默认安装）\n\nvgn7i-vws\n\nvgn6i-vws\n\nGPU计算型实例规格族\n\ngn7e\n\n- \n\nTesla 470，CUDA 11.4（默认安装）\n- \n\nTesla 535，CUDA 12.2\n- \n\nTesla 550，CUDA 12.4\n\ngn7i\n\ngn7s\n\ngn7\n\ngn6v\n\ngn6e\n\ngn6i\n\ngn5i\n\ngn5\n\ngn8ia\n\n- \n\nTesla 535，CUDA 12.2（默认安装）\n- \n\nTesla 550，CUDA 12.2\n\ngn8is重要 \n\n自2025年3月17日开始。指定GPU驱动版本不再使用完整版本号（如535.161.08），而是只使用大版本号（如535），实际创建出的实例的驱动版本可能会在保证大版本号不变的情况下更新小版本号，较老的驱动下线后会自动使用更高版本驱动创建。特定版本驱动的支持时间与NVIDIA官方对该驱动的支持时间一致，具体请参见[NVIDIA Driver Documentation](https://docs.nvidia.com/datacenter/tesla/index.html)。\n\nGPU驱动更新记录\n\n[表格]\n\n更新时间\n\n更新说明\n\n2025年3月\n\n- \n\nGRID 470驱动更新为470.239.06。\n- \n\nTesla 470驱动更新为470.256.02，Tesla 535驱动更新为535.230.02，Tesla550驱动更新为550.127.08。\n- \n\nTesla 525驱动不再支持，指定该驱动将回退到535版本。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定GPU规格。指定GPU规格后，需要在Container的resources中添加nvidia.com/gpu字段声明容器所需的GPU资源。重要 \n\n- \n\nnvidia.com/gpu字段值为容器所需的GPU个数，创建GPU Pod时必须明确指定。如果没有指定该值，Pod启动后将会报错。\n- \n\n默认情况下，多个容器可以共享使用GPU，配置时需确保单个容器内配置的GPU个数不超过指定的GPU规格所具备的GPU个数。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.gn6i-c4g1.xlarge,ecs.gn6i-c8g1.2xlarge\"  # 指定支持的ECS GPU规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"    # nginx容器所需的GPU个数，共享使用。\n        ports:\n        - containerPort: 80\n      - name: busybox\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n        command: [\"sleep\"]\n        args: [\"999999\"]\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"    # busybox容器所需的GPU个数，共享使用。\n\n\n默认情况下，ECI GPU实例会根据指定的GPU规格自动安装支持的驱动和CUDA版本。在一些场景中，您可能需要在不同的ECI GPU实例负载中依赖不同的驱动和CUDA版本，此时，您可以添加k8s.aliyun.com/eci-gpu-driver-version的Annotation来指定驱动版本。\n\n例如，指定ecs.gn6i-c4g1.xlarge规格时，默认安装的驱动和CUDA版本为Tesla 470，CUDA 11.4，添加k8s.aliyun.com/eci-gpu-driver-version: tesla=535的Annotation后可以变更为Tesla 535，CUDA 12.2。YAML示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.gn6i-c4g1.xlarge      # 指定支持的GPU规格，该规格支持更换驱动版本。\n        k8s.aliyun.com/eci-gpu-driver-version: tesla=535  # 指定GPU驱动版本。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"    # 容器所需的GPU个数\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification-1", "page_type": "doc", "title": "指定GPU规格创建Pod", "keywords": "创建GPU规格Pod,指定ECI GPU规格,修改GPU驱动版本,ECI GPU Pod配置,GPU规格说明,GPU驱动版本说明", "last_modified_ms": 1742538220000, "last_modified_iso": "2025-03-21T14:23:40+08:00", "excerpt": "本文介绍如何指定ECS GPU规格创建一个ECI Pod，以及如何修改GPU驱动版本。\n## 规格说明\n\nGPU规格含有GPU计算卡，适用于深度学习、图像处理等场景。GPU对应的Docker镜像可以直接运行在ECI GPU实例上。实例内已预装NVIDIA显卡设备驱动，不同GPU规格支持安装的驱动和CUDA版本不同。说明 \n\n下表中的gn8ia和gn8is目前仅支持海外等部分地域，如有需求，请联系阿里云销售人员。\n\n[表格]\n\n规格类型\n\nGPU规格族\n\n驱动和CUDA版本\n\nGPU虚拟化型实例规格族\n\nsgn7i-vws\n\nGRID 470，CUDA 11.4（默认安装）\n\nvgn7i-vws\n\nvgn6i-vws\n\nGPU计算型实例规格族\n\ngn7e\n\n- \n\nTesla 470，CUDA 11.4（默认安装）\n- \n\nTesla 535，CUDA 12.2\n- \n\nTesla 550，CUDA 12.4\n\ngn7i\n\ngn7s\n\ngn7\n\ngn6v\n\ngn6e\n\ngn6i\n\ngn5i\n\ngn5\n\ngn8ia\n\n- \n\nTesla 535，CUDA 12.2（默认安装）\n- \n\nTesla 550，CUDA 12.2\n\ngn8is重要 \n\n自2025年3月17日开始。指定GPU驱动版本不再使用完整版本号（如535.161.08），而是只使用大版本号（如535），实际创建出的实例的驱动版本可能会在保证大版本号不变的情况下更新小版本号，较老的驱动下线后会自动使用更高版本驱动创建。特定版本驱动的支持时间与NVIDIA官方对该驱动的支持时间一致，具体请参见[NVIDIA Driver Documentation](https://docs.nvidia.com/datacenter/tesla/index.html)。\n\nGPU驱动更新记录\n\n[表格]\n\n更新时间\n\n更新说明\n\n2025年3月\n\n- \n\nGRID 470驱动更新为470.239.06。\n- \n\nTesla 470驱动更新为470.256.02，Tesla 535驱动更新为535.230.02，Tesla550驱动更新为550.127.08。\n- \n\nTesla 525驱动不再支持，指定该驱动将回退到535版本。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定GPU规格。指定GPU规格后，需要在Container的resources中添加nvidia.com/gpu字段声明容器所需的GPU资源。重要 \n\n- \n\nnvidia.com/gpu字段值为容器所需的GPU个数，创建GPU Pod时必须明确指定。如果没有指定该值，Pod启动后将会报错。\n- \n\n默认情况下，多个容器可以共享使用GPU，配置时需确保单个容器内配置的GPU个数不超过指定的GPU规格所具备的GPU个数。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.gn6i-c4g1.xlarge,ecs.gn6i-c8g1.2xlarge\"  # 指定支持的ECS GPU规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"    # nginx容器所需的GPU个数，共享使用。\n        ports:\n        - containerPort: 80\n      - name: busybox\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n        command: [\"sleep\"]\n        args: [\"999999\"]\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"    # busybox容器所需的GPU个数，共享使用。\n\n\n默认情况下，ECI GPU实例会根据指定的GPU规格自动安装支持的驱动和CUDA版本。在一些场景中，您可能需要在不同的ECI GPU实例负载中依赖不同的驱动和CUDA版本，此时，您可以添加k8s.aliyun.com/eci-gpu-driver-version的Annotation来指定驱动版本。\n\n例如，指定ecs.gn6i-c4g1.xlarge规格时，默认安装的驱动和CUDA版本为Tesla 470，CUDA 11.4，添加k8s.aliyun.com/eci-gpu-driver-version: tesla=535的Annotation后可以变更为Tesla 535，CUDA 12.2。YAML示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.gn6i-c4g1.xlarge      # 指定支持的GPU规格，该规格支持更换驱动版本。\n        k8s.aliyun.com/eci-gpu-driver-version: tesla=535  # 指定GPU驱动版本。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"    # 容器所需的GPU个数\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-specifications-of-a-local-disk", "page_type": "doc", "title": "指定本地盘规格创建Pod", "keywords": "创建本地盘Pod,指定Pod本地盘规格,挂载Pod本地盘,本地盘Pod配置方法,ECI Pod本地盘规格", "last_modified_ms": 1730786309000, "last_modified_iso": "2024-11-05T13:58:29+08:00", "excerpt": "本文介绍如何指定ECS本地盘规格创建一个ECI Pod，并挂载本地盘。\n## 规格说明\n\n本地盘是实例所在物理机上的本地硬盘设备，具有本地盘具有低时延、高随机IOPS、高吞吐量和高性价比的优势。但本地盘来自于单台物理机，存在单点故障风险。更多信息，请参见[本地盘](https://help.aliyun.com/zh/ecs/user-guide/local-disks#concept-g3w-qzv-tdb)。重要 \n\n本地盘来自单台物理机，数据可靠性取决于物理机的可靠性，存在单点故障风险。更多信息，请参见[本地盘使用注意事项](https://help.aliyun.com/zh/ecs/user-guide/local-disks#concept-g3w-qzv-tdb/section-ydp-m2w-ydb)。\n\n支持指定的ECS本地盘规格族如下：\n\n[表格]\n\n规格类型\n\n规格族\n\n本地SSD型\n\ni4、i4g、i3、i3g、i2、i2g\n\n大数据型\n\nd1\n\n大数据网络增强型\n\nd1ne\n\nGPU计算型\n\ngn5说明 \n\ngn5为GPU规格，除了本地盘相关参数外，您还需要指定GPU相关参数。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定本地盘规格。挂载本地盘时，通过将EmptyDir Volume的medium设置为LocalRaid0的方式，可以自动把本地盘组成RAID 0，并挂载到指定的路径上。\n\n配置示例如下：\n\n- \n\n指定本地盘规格创建Pod。\n\nkubectl create -f localdisk-test.yaml\n\n\nlocaldisk-test.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: localdisk-test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.i2g.2xlarge,ecs.i2.xlarge\"  # 指定支持的ECS本地盘规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts:\n          - name: localdisk\n            mountPath: /localdisk-test\n      volumes:                               #挂载本地盘\n        - name: localdisk\n          emptyDir:\n            medium: LocalRaid0\n\n\n- \n\n查看本地盘挂载信息。\n\n等待Pod创建完成后查看Pod信息，可以看到本地盘已生成RAID 0（/dev/md0），且已挂载到指定的/localdisk-test路径。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-specifications-of-a-local-disk-1", "page_type": "doc", "title": "指定本地盘规格创建Pod", "keywords": "创建本地盘Pod,指定Pod本地盘规格,本地盘Pod配置方法,本地盘Pod规格说明", "last_modified_ms": 1730786335000, "last_modified_iso": "2024-11-05T13:58:55+08:00", "excerpt": "本文介绍如何指定ECS本地盘规格创建一个ECI Pod，并挂载本地盘。\n## 规格说明\n\n本地盘是实例所在物理机上的本地硬盘设备，具有本地盘具有低时延、高随机IOPS、高吞吐量和高性价比的优势。但本地盘来自于单台物理机，存在单点故障风险。更多信息，请参见[本地盘](https://help.aliyun.com/zh/ecs/user-guide/local-disks#concept-g3w-qzv-tdb)。重要 \n\n本地盘来自单台物理机，数据可靠性取决于物理机的可靠性，存在单点故障风险。更多信息，请参见[本地盘使用注意事项](https://help.aliyun.com/zh/ecs/user-guide/local-disks#concept-g3w-qzv-tdb/section-ydp-m2w-ydb)。\n\n支持指定的ECS本地盘规格族如下：\n\n[表格]\n\n规格类型\n\n规格族\n\n本地SSD型\n\ni4、i4g、i3、i3g、i2、i2g\n\n大数据型\n\nd1\n\n大数据网络增强型\n\nd1ne\n\nGPU计算型\n\ngn5说明 \n\ngn5为GPU规格，除了本地盘相关参数外，您还需要指定GPU相关参数。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定本地盘规格。挂载本地盘时，通过将EmptyDir Volume的medium设置为LocalRaid0的方式，可以自动把本地盘组成RAID 0，并挂载到指定的路径上。\n\n配置示例如下：\n\n- \n\n指定本地盘规格创建Pod。\n\nkubectl create -f localdisk-test.yaml\n\n\nlocaldisk-test.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: localdisk-test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.i2g.2xlarge,ecs.i2.xlarge\"  # 指定支持的ECS本地盘规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts:\n          - name: localdisk\n            mountPath: /localdisk-test\n      volumes:                               #挂载本地盘\n        - name: localdisk\n          emptyDir:\n            medium: LocalRaid0\n\n\n- \n\n查看本地盘挂载信息。\n\n等待Pod创建完成后查看Pod信息，可以看到本地盘已生成RAID 0（/dev/md0），且已挂载到指定的/localdisk-test路径。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-pod-using-datacache", "page_type": "doc", "title": "使用DataCache创建Pod", "keywords": "使用DataCache创建Pod,配置Pod使用DataCache,DataCache创建Pod方法,DataCache创建Pod配置", "last_modified_ms": 1736851079000, "last_modified_iso": "2025-01-14T18:37:59+08:00", "excerpt": "创建DataCache（数据缓存）后，您可以使用DataCache创建Pod，将缓存好的数据直接挂载到Pod中，免去拉取数据的等待时间，加速业务启动。本文介绍如何使用DataCache创建Pod。\n## 前提条件\n\n已创建DataCache。具体操作，请参见[创建和管理DataCache](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-datacache)。\n## 配置说明\n\nDataCache是Cluster级别的资源，因此在不同的Namespace下创建ECI Pod时均可以使用DataCache来提前拉取数据。\n\n使用DataCache创建Pod时，您需要添加Annotation来指定DataCache的Bucket，并通过挂载HostPath的方式挂载DataCache的数据存储路径。说明 \n\n使用DataCache时，系统会自动创建并挂载一块按量付费的云盘。该云盘的容量等于数据缓存大小，随Pod一起创建和释放。\n\n相关Annotation如下：\n\n[表格]\n\n配置项\n\n示例值\n\n说明\n\nk8s.aliyun.com/eci-data-cache-bucket\n\ndefault\n\n指定DataCache的Bucket。使用DataCache创建Pod时必须配置。\n\nk8s.aliyun.com/eci-data-cache-pl\n\nPL1\n\n基于DataCache创建的云盘的性能等级。默认使用ESSD云盘，性能等级默认为PL1。\n\nk8s.aliyun.com/eci-data-cache-provisionedIops\n\n\"40000\"\n\nESSD AutoPL云盘预配置的读写IOPS。取值范围：0~min{50000, 1000 * 容量-基准性能}。基准性能=min{1800+50 * 容量, 50000}。更多信息，请参见[ESSD AutoPL云盘](https://help.aliyun.com/zh/ecs/user-guide/essd-autopl-disks)。\n\n如果添加了该Annotation，则基于DataCache创建的云盘类型为ESSD AutoPL云盘。\n\nk8s.aliyun.com/eci-data-cache-burstingEnabled\n\n\"true\"\n\nESSD AutoPL云盘是否开启Burst（性能突发）。更多信息，请参见[ESSD AutoPL云盘](https://help.aliyun.com/zh/ecs/user-guide/essd-autopl-disks)。\n\n如果添加了该Annotation，则基于DataCache创建的云盘类型为ESSD AutoPL云盘。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\nYAML示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\n  labels: \n    alibabacloud.com/eci: \"true\" \n  annotations:\n    k8s.aliyun.com/eci-data-cache-bucket: \"default\"   #指定数据缓存Bucket\nspec:\n  containers:\n    - name: modelscope\n      image: registry.cn-hangzhou.aliyuncs.com/modelscope-repo/modelscope:ubuntu20.04-py38-torch1.11.0-tf1.15.5-1.6.1\n      command: [\"sleep\", \"999999\"]\n      volumeMounts:\n        - name: \"model\"\n          mountPath: \"/model\"\n  volumes:                  \n    - name: \"model\"\n      hostPath:              \n        path: \"/model/ms/\"  #挂载数据存储的路径\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance", "page_type": "doc", "title": "创建抢占式实例", "keywords": "创建抢占式实例,了解抢占式实例,抢占式实例创建方法,抢占式实例概念", "last_modified_ms": 1731998847000, "last_modified_iso": "2024-11-19T14:47:27+08:00", "excerpt": "ECI支持抢占式实例，对于短时间运行的Job任务，以及部分扩展性和容错率高的无状态应用，使用抢占式实例可以有效地节约实例使用成本。本文介绍如何创建抢占式ECI实例。\n## 背景信息\n\n抢占式实例是一种低成本竞价型实例，您可以对阿里云当前闲置的资源出价，获得资源后运行容器，直到出价低于市场价格或者库存不足等原因导致资源回收。\n\n抢占式实例适用于短时间运行的Job任务，以及部分扩展性和容错率高的无状态应用，例如可弹性伸缩的Web站点服务、图像渲染、大数据分析和大规模并行计算等。应用程序的分布度、可扩展性和容错能力越高，越适合使用抢占式实例节省成本和提升吞吐量。更多信息，请参见[什么是抢占式实例](https://help.aliyun.com/zh/ecs/user-guide/what-is-a-spot-instance#concept-t3p-gv2-5db)。\n### 基本概念\n\n创建抢占式实例前，您需要了解以下信息：\n\n- \n\n计费方式\n\n抢占式实例的市场价格随供需变化而浮动，您需要在创建抢占式实例时指定出价模式，当指定实例规格的实时市场价格低于出价且库存充足时，就能成功创建抢占式实例。创建成功后，在保护期（默认1小时）内按照成交时的市场价格计费。超过保护期后，按照实时的市场价格计费。说明 \n\n抢占式实例相对于按量付费实例价格有一定的折扣，实际价格随供求波动，并按实际使用时长进行收费。更多信息，请参见[抢占式实例计费](https://help.aliyun.com/zh/ecs/spot-instance#concept-1936192)。\n- \n\n回收机制\n\n超过保护期后，系统每隔5分钟将自动检测一次实例规格的市场价格和库存。如果某一时刻的市场价格高于出价或实例规格库存不足，抢占式实例会被释放。说明 \n\n- \n\n资源回收前约3分钟，系统会产生准备释放的事件。\n- \n\n资源回收后，实例不再收费，但会保留实例信息，且状态会变更为已过期（Expired）。\n\n### 注意事项\n\n基于抢占式实例的特点，使用抢占式实例时，请注意以下信息：\n\n- \n\n选择一个合适的实例规格和一个合理的出价。\n\n您可以通过ECS的OpenAPI接口查询抢占式实例近30天的信息，以便选择实例规格和出价。相关接口如下：\n\n- \n\n[DescribeSpotPriceHistory](https://help.aliyun.com/zh/ecs/api-describespotpricehistory#doc-api-Ecs-DescribeSpotPriceHistory)：查询实例历史价格。\n- \n\n[DescribeSpotAdvice](https://help.aliyun.com/zh/ecs/api-describespotadvice#doc-api-Ecs-DescribeSpotAdvice)：查询实例平均释放率、平均折扣率等信息。\n重要 \n\n您的出价应该足够高，同时充分考虑了市场价格的波动，并且符合您对自身业务评估后的预期。这样才能成功创建抢占式实例，且实例不会因为价格因素被释放，在满足业务需求的同时实现成本节约。\n- \n\n使用不受抢占式实例释放影响的存储介质来保存您的重要数据，例如：云盘（关闭随实例释放）、NAS等。\n\n### 创建方式\n\n支持指定ECS规格，或者指定vCPU和内存来创建抢占式ECI实例：\n\n- \n\n指定ECS规格\n\n计费以指定规格的按量市场价格和实时折扣为准。\n- \n\n指定vCPU和内存\n\n该方式与指定ECS规格方式的效果相同。系统会自动匹配满足规格和价格要求的ECS规格，并以此规格的市场价格作为计费的原始市场价格，即折扣是基于该ECS规格的市场价，而非对应ECI的vCPU和内存的按量价格。\n\n该方式仅支持2 vCPU及以上规格，支持指定的vCPU和内存规格如下表所示。如果指定的规格不支持，系统会自动向上规整。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n2\n\n2、4、8、16\n\n4\n\n4、8、16、32\n\n8\n\n8、16、32、64\n\n12\n\n12、24、48、96\n\n16\n\n16、32、64 、128\n\n24\n\n24、48、96、192\n\n32\n\n32、64、128、256\n\n52\n\n96、192、384\n\n64\n\n128、256、512\n\n## 配置说明\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过SpotStrategy参数来设置抢占式实例的出价模式，SpotPriceLimit参数来设置抢占式实例的每小时价格上限，以及SpotDuration参数来设置抢占式实例的保护期。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nSpotStrategy\n\nstring\n\nSpotWithPriceLimit\n\n实例的抢占策略。取值范围：\n\n- \n\nNoSpot（默认）：普通按量付费实例。\n- \n\nSpotWithPriceLimit：设置上限价格的抢占式实例。\n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格的抢占式实例。重要 \n\n使用SpotAsPriceGo策略时，如果对应可用区规格资源紧张，最高价格可能会达到按量价格。\n\nSpotPriceLimit\n\nnumber\n\n0.2\n\n设置抢占式实例的每小时最高价格，最多精确到小数点后3位。当SpotStrategy取值为SpotWithPriceLimit时，必须设置SpotPriceLimit。\n\nSpotDuration\n\nlong\n\n1\n\n抢占式实例的保护期。单位为小时。默认为1。可设置为0，表示无保护期。\n### 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci)创建抢占式ECI实例时，可以直接选择付费模式为抢占式实例。\n\n该方式不支持以下功能：\n\n- \n\n不支持设置出价策略，默认采用SpotAsPriceGo，即系统自动出价，跟随当前市场实际价格。\n- \n\n不支持设置无保护期，默认保护期为1小时。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-1", "page_type": "doc", "title": "创建抢占式实例", "keywords": "创建抢占式实例,配置抢占式实例,实现实例优雅下线,抢占式实例创建方法,抢占式实例YAML示例,抢占式实例回收机制", "last_modified_ms": 1731999405000, "last_modified_iso": "2024-11-19T14:56:45+08:00", "excerpt": "ECI支持抢占式实例，对于短时间运行的Job任务，以及部分扩展性和容错率高的无状态应用，使用抢占式实例可以有效地节约实例使用成本。本文介绍在Kubernetes集群中，如何创建抢占式实例类型的ECI Pod。\n## 背景信息\n\n抢占式实例是一种低成本竞价型实例，您可以对阿里云当前闲置的资源出价，获得资源后运行容器，直到出价低于市场价格或者库存不足等原因导致资源回收。\n\n抢占式实例适用于短时间运行的Job任务，以及部分扩展性和容错率高的无状态应用，例如可弹性伸缩的Web站点服务、图像渲染、大数据分析和大规模并行计算等。应用程序的分布度、可扩展性和容错能力越高，越适合使用抢占式实例节省成本和提升吞吐量。更多信息，请参见[什么是抢占式实例](https://help.aliyun.com/zh/ecs/user-guide/what-is-a-spot-instance#concept-t3p-gv2-5db)。\n### 基本概念\n\n创建抢占式实例前，您需要了解以下信息：\n\n- \n\n计费方式\n\n抢占式实例的市场价格随供需变化而浮动，您需要在创建抢占式实例时指定出价模式，当指定实例规格的实时市场价格低于出价且库存充足时，就能成功创建抢占式实例。创建成功后，在保护期（默认1小时）内按照成交时的市场价格计费。超过保护期后，按照实时的市场价格计费。说明 \n\n抢占式实例相对于按量付费实例价格有一定的折扣，实际价格随供求波动，并按实际使用时长进行收费。更多信息，请参见[抢占式实例计费](https://help.aliyun.com/zh/ecs/spot-instance#concept-1936192)。\n- \n\n回收机制\n\n超过保护期后，系统每隔5分钟将自动检测一次实例规格的市场价格和库存。如果某一时刻的市场价格高于出价或实例规格库存不足，抢占式实例会被释放。说明 \n\n- \n\n资源回收前约3分钟，系统会产生准备释放的事件。\n- \n\n资源回收后，实例不再收费，但会保留实例信息，且状态会变更为已过期（Expired）。\n\n### 注意事项\n\n基于抢占式实例的特点，使用抢占式实例时，请注意以下信息：\n\n- \n\n选择一个合适的实例规格和一个合理的出价。\n\n您可以通过ECS的OpenAPI接口查询抢占式实例近30天的信息，以便选择实例规格和出价。相关接口如下：\n\n- \n\n[DescribeSpotPriceHistory](https://help.aliyun.com/zh/ecs/api-describespotpricehistory#doc-api-Ecs-DescribeSpotPriceHistory)：查询实例历史价格。\n- \n\n[DescribeSpotAdvice](https://help.aliyun.com/zh/ecs/api-describespotadvice#doc-api-Ecs-DescribeSpotAdvice)：查询实例平均释放率、平均折扣率等信息。\n重要 \n\n您的出价应该足够高，同时充分考虑了市场价格的波动，并且符合您对自身业务评估后的预期。这样才能成功创建抢占式实例，且实例不会因为价格因素被释放，在满足业务需求的同时实现成本节约。\n- \n\n使用不受抢占式实例释放影响的存储介质来保存您的重要数据，例如：云盘（关闭随实例释放）、NAS等。\n\n### 创建方式\n\n支持指定ECS规格，或者指定vCPU和内存来创建抢占式ECI实例：\n\n- \n\n指定ECS规格\n\n计费以指定规格的按量市场价格和实时折扣为准。\n- \n\n指定vCPU和内存\n\n该方式与指定ECS规格方式的效果相同。系统会自动匹配满足规格和价格要求的ECS规格，并以此规格的市场价格作为计费的原始市场价格，即折扣是基于该ECS规格的市场价，而非对应ECI的vCPU和内存的按量价格。\n\n该方式仅支持2 vCPU及以上规格，支持指定的vCPU和内存规格如下表所示。如果指定的规格不支持，系统会自动向上规整。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n2\n\n2、4、8、16\n\n4\n\n4、8、16、32\n\n8\n\n8、16、32、64\n\n12\n\n12、24、48、96\n\n16\n\n16、32、64 、128\n\n24\n\n24、48、96、192\n\n32\n\n32、64、128、256\n\n52\n\n96、192、384\n\n64\n\n128、256、512\n\n## 配置说明\n\n您可以在Pod metadata中添加Annotation来创建抢占式实例。相关Annotation如下：\n\n[表格]\n\nAnnotation\n\n示例值\n\n是否必选\n\n说明\n\nk8s.aliyun.com/eci-spot-strategy\n\nSpotAsPriceGo\n\n是\n\n抢占式实例的出价策略。可根据需要配置为：\n\n- \n\nSpotWithPriceLimit：自定义设置抢占实例价格上限。此时必须通过k8s.aliyun.com/eci-spot-price-limit来指定每小时价格上限。\n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格。重要 \n\n使用SpotAsPriceGo策略时，如果对应可用区规格资源紧张，最高价格可能会达到按量价格。\n\nk8s.aliyun.com/eci-spot-price-limit\n\n\"0.5\"\n\n否\n\n抢占式实例的每小时价格上限，最多支持精确到小数点后三位。\n\n仅当k8s.aliyun.com/eci-spot-strategy设置为SpotWithPriceLimit时有效。\n\nk8s.aliyun.com/eci-spot-duration\n\n\"0\"\n\n否\n\n抢占式实例的保护期。默认为1，可设置为0，表示无保护期。\n\nk8s.aliyun.com/eci-spot-fallback\n\n\"true\"\n\n否\n\n抢占式实例没有库存时，是否自动转为按量付费，以保证实例创建成功。默认为false。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Job时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n#### 示例一：指定ECS规格，采用SpotWithPriceLimit策略\n\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: test\nspec:\n  template:\n    metadata:\n      labels:\n        app: perl\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs : \"ecs.c6.large\"           #指定ECS实例规格\n        k8s.aliyun.com/eci-spot-strategy: \"SpotWithPriceLimit\"  #采用自定义设置价格上限的策略\n        k8s.aliyun.com/eci-spot-price-limit: \"0.25\"            #设置每小时价格上限\n    spec:\n      containers:\n      - name: pi\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/perl:5\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n      restartPolicy: Never\n\n\n以上YAML示例可创建一个ecs.c6规格的抢占式实例。\n\n- \n\n创建时，如果没有满足规格和价格上限要求的库存，则创建失败。\n- \n\n创建后，可以稳定使用1小时，超出1小时保护期后，如果某一时刻的市场价格高于出价或实例规格库存不足，抢占式实例会被释放。\n\n#### 示例二：指定vCPU和内存，采用SpotAsPriceGo策略\n\n- \n\n通过pod.spec.resources指定vCPU和内存规格\n\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: test\nspec:\n  template:\n    metadata:\n      labels:\n        app: perl\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-spot-strategy: \"SpotAsPriceGo\"  #采用系统自动出价，跟随当前市场实际价格\n    spec:\n      containers:\n      - name: pi\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/perl:5\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n        resources:\n          limits:              #指定pi"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-2", "page_type": "doc", "title": "创建抢占式实例", "keywords": "创建抢占式ECI实例,配置抢占式ECI实例,实现ECI优雅下线,抢占式ECI实例创建,抢占式ECI实例配置,抢占式ECI实例释放", "last_modified_ms": 1731999440000, "last_modified_iso": "2024-11-19T14:57:20+08:00", "excerpt": "ECI支持抢占式实例，对于短时间运行的Job任务，以及部分扩展性和容错率高的无状态应用，使用抢占式实例可以有效地节约实例使用成本。本文介绍在Kubernetes集群中，如何创建抢占式实例类型的ECI Pod。\n## 背景信息\n\n抢占式实例是一种低成本竞价型实例，您可以对阿里云当前闲置的资源出价，获得资源后运行容器，直到出价低于市场价格或者库存不足等原因导致资源回收。\n\n抢占式实例适用于短时间运行的Job任务，以及部分扩展性和容错率高的无状态应用，例如可弹性伸缩的Web站点服务、图像渲染、大数据分析和大规模并行计算等。应用程序的分布度、可扩展性和容错能力越高，越适合使用抢占式实例节省成本和提升吞吐量。更多信息，请参见[什么是抢占式实例](https://help.aliyun.com/zh/ecs/user-guide/what-is-a-spot-instance#concept-t3p-gv2-5db)。\n### 基本概念\n\n创建抢占式实例前，您需要了解以下信息：\n\n- \n\n计费方式\n\n抢占式实例的市场价格随供需变化而浮动，您需要在创建抢占式实例时指定出价模式，当指定实例规格的实时市场价格低于出价且库存充足时，就能成功创建抢占式实例。创建成功后，在保护期（默认1小时）内按照成交时的市场价格计费。超过保护期后，按照实时的市场价格计费。说明 \n\n抢占式实例相对于按量付费实例价格有一定的折扣，实际价格随供求波动，并按实际使用时长进行收费。更多信息，请参见[抢占式实例计费](https://help.aliyun.com/zh/ecs/spot-instance#concept-1936192)。\n- \n\n回收机制\n\n超过保护期后，系统每隔5分钟将自动检测一次实例规格的市场价格和库存。如果某一时刻的市场价格高于出价或实例规格库存不足，抢占式实例会被释放。说明 \n\n- \n\n资源回收前约3分钟，系统会产生准备释放的事件。\n- \n\n资源回收后，实例不再收费，但会保留实例信息，且状态会变更为已过期（Expired）。\n\n### 注意事项\n\n基于抢占式实例的特点，使用抢占式实例时，请注意以下信息：\n\n- \n\n选择一个合适的实例规格和一个合理的出价。\n\n您可以通过ECS的OpenAPI接口查询抢占式实例近30天的信息，以便选择实例规格和出价。相关接口如下：\n\n- \n\n[DescribeSpotPriceHistory](https://help.aliyun.com/zh/ecs/api-describespotpricehistory#doc-api-Ecs-DescribeSpotPriceHistory)：查询实例历史价格。\n- \n\n[DescribeSpotAdvice](https://help.aliyun.com/zh/ecs/api-describespotadvice#doc-api-Ecs-DescribeSpotAdvice)：查询实例平均释放率、平均折扣率等信息。\n重要 \n\n您的出价应该足够高，同时充分考虑了市场价格的波动，并且符合您对自身业务评估后的预期。这样才能成功创建抢占式实例，且实例不会因为价格因素被释放，在满足业务需求的同时实现成本节约。\n- \n\n使用不受抢占式实例释放影响的存储介质来保存您的重要数据，例如：云盘（关闭随实例释放）、NAS等。\n\n### 创建方式\n\n支持指定ECS规格，或者指定vCPU和内存来创建抢占式ECI实例：\n\n- \n\n指定ECS规格\n\n计费以指定规格的按量市场价格和实时折扣为准。\n- \n\n指定vCPU和内存\n\n该方式与指定ECS规格方式的效果相同。系统会自动匹配满足规格和价格要求的ECS规格，并以此规格的市场价格作为计费的原始市场价格，即折扣是基于该ECS规格的市场价，而非对应ECI的vCPU和内存的按量价格。\n\n该方式仅支持2 vCPU及以上规格，支持指定的vCPU和内存规格如下表所示。如果指定的规格不支持，系统会自动向上规整。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n2\n\n2、4、8、16\n\n4\n\n4、8、16、32\n\n8\n\n8、16、32、64\n\n12\n\n12、24、48、96\n\n16\n\n16、32、64 、128\n\n24\n\n24、48、96、192\n\n32\n\n32、64、128、256\n\n52\n\n96、192、384\n\n64\n\n128、256、512\n\n## 配置说明\n\n您可以在Pod metadata中添加Annotation来创建抢占式实例。相关Annotation如下：\n\n[表格]\n\nAnnotation\n\n示例值\n\n是否必选\n\n说明\n\nk8s.aliyun.com/eci-spot-strategy\n\nSpotAsPriceGo\n\n是\n\n抢占式实例的出价策略。可根据需要配置为：\n\n- \n\nSpotWithPriceLimit：自定义设置抢占实例价格上限。此时必须通过k8s.aliyun.com/eci-spot-price-limit来指定每小时价格上限。\n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格。重要 \n\n使用SpotAsPriceGo策略时，如果对应可用区规格资源紧张，最高价格可能会达到按量价格。\n\nk8s.aliyun.com/eci-spot-price-limit\n\n\"0.5\"\n\n否\n\n抢占式实例的每小时价格上限，最多支持精确到小数点后三位。\n\n仅当k8s.aliyun.com/eci-spot-strategy设置为SpotWithPriceLimit时有效。\n\nk8s.aliyun.com/eci-spot-duration\n\n\"0\"\n\n否\n\n抢占式实例的保护期。默认为1，可设置为0，表示无保护期。\n\nk8s.aliyun.com/eci-spot-fallback\n\n\"true\"\n\n否\n\n抢占式实例没有库存时，是否自动转为按量付费，以保证实例创建成功。默认为false。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Job时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n#### 示例一：指定ECS规格，采用SpotWithPriceLimit策略\n\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: test\nspec:\n  template:\n    metadata:\n      labels:\n        app: perl\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs : \"ecs.c6.large\"           #指定ECS实例规格\n        k8s.aliyun.com/eci-spot-strategy: \"SpotWithPriceLimit\"  #采用自定义设置价格上限的策略\n        k8s.aliyun.com/eci-spot-price-limit: \"0.25\"            #设置每小时价格上限\n    spec:\n      containers:\n      - name: pi\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/perl:5\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n      restartPolicy: Never\n\n\n以上YAML示例可创建一个ecs.c6规格的抢占式实例。\n\n- \n\n创建时，如果没有满足规格和价格上限要求的库存，则创建失败。\n- \n\n创建后，可以稳定使用1小时，超出1小时保护期后，如果某一时刻的市场价格高于出价或实例规格库存不足，抢占式实例会被释放。\n\n#### 示例二：指定vCPU和内存，采用SpotAsPriceGo策略\n\n- \n\n通过pod.spec.resources指定vCPU和内存规格\n\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: test\nspec:\n  template:\n    metadata:\n      labels:\n        app: perl\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-spot-strategy: \"SpotAsPriceGo\"  #采用系统自动出价，跟随当前市场实际价格\n    spec:\n      containers:\n      - name: pi\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/perl:5\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n        resources:\n          limits:              #指定pi"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-a-local-disk-type", "page_type": "doc", "title": "指定本地盘规格创建实例", "keywords": "创建ECI本地盘实例,挂载ECI本地盘,ECI本地盘实例创建,ECI本地盘规格", "last_modified_ms": 1730786289000, "last_modified_iso": "2024-11-05T13:58:09+08:00", "excerpt": "本文介绍如何指定ECS本地盘规格创建一个ECI实例，并挂载本地盘。\n## 规格说明\n\n本地盘是实例所在物理机上的本地硬盘设备，具有本地盘具有低时延、高随机IOPS、高吞吐量和高性价比的优势。但本地盘来自于单台物理机，存在单点故障风险。更多信息，请参见[本地盘](https://help.aliyun.com/zh/ecs/user-guide/local-disks#concept-g3w-qzv-tdb)。重要 \n\n本地盘来自单台物理机，数据可靠性取决于物理机的可靠性，存在单点故障风险。更多信息，请参见[本地盘使用注意事项](https://help.aliyun.com/zh/ecs/user-guide/local-disks#concept-g3w-qzv-tdb/section-ydp-m2w-ydb)。\n\n支持指定的ECS本地盘规格族如下：\n\n[表格]\n\n规格类型\n\n规格族\n\n本地SSD型\n\ni4、i4g、i3、i3g、i2、i2g\n\n大数据型\n\nd1\n\n大数据网络增强型\n\nd1ne\n\nGPU计算型\n\ngn5说明 \n\ngn5为GPU规格，除了本地盘相关参数外，您还需要指定GPU相关参数。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n### 配置说明说明 \n\n仅支持通过OpenAPI指定本地盘规格创建实例并挂载本地盘，控制台暂不支持挂载本地盘。\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过InstanceType参数来指定规格，Volume相关参数来挂载本地盘。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n- \n\n创建本地盘实例并声明本地盘数据卷\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nInstanceType\n\nString\n\necs.gn6v-c8g1.2xlarge\n\n指定ECS本地盘实例规格。目前支持的本地盘规格族包括：d1、d1ne、i2、i2g、gn5。\n\n支持指定多个规格（单次最多5个），各规格之间用半角逗号（,）进行分隔。例如：ecs.d1.2xlarge,ecs.d1ne.2xlarge。\n\nVolume.N.Name\n\nString\n\nlocaldisk\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nEmptyDirVolume\n\n数据卷类型。取值为EmptyDirVolume，表示创建一个EmptyDir类型的数据卷。\n\nVolume.N.EmptyDirVolume.Medium\n\nString\n\nLocalRaid0\n\nEmptyDir数据卷的存储媒介。取值为LocalRaid0时，表示将本地盘组成RAID 0。\n- \n\n挂载本地盘RAID0\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.VolumeMount.N.Name\n\nString\n\nlocaldisk\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/localdisk-test\n\n挂载目录。\n\n容器挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n\n配置示例如下：\n\n- \n\n创建一台本地盘实例。\n\n调用CreateContainerGroup接口创建本地盘实例所采用的参数示例如下：\n\nContainerGroupName=test-localdisk\n# 指定本地盘规格\nInstanceType=ecs.i2g.2xlarge\n# 声明本地盘RAID0数据卷\nVolume.1.Name=localdisk\nVolume.1.Type=EmptyDirVolume\nVolume.1.EmptyDirVolume.Medium=LocalRaid0\n# 为容器挂载本地盘\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=localdisk\nContainer.1.VolumeMount.1.MountPath=/localdisk-test\n\n\n- \n\n确认本地盘的挂载情况。\n\n连接实例，执行df-h命令查看本地盘RAID 0的挂载信息，可以看到本地盘已生成RAID 0（/dev/md0），且已挂载到指定的/localdisk-test路径。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-the-arm-type", "page_type": "doc", "title": "创建Arm架构的实例", "keywords": "创建Arm架构ECI,Arm架构ECI创建方法,Arm架构ECI规格", "last_modified_ms": 1721642067000, "last_modified_iso": "2024-07-22T17:54:27+08:00", "excerpt": "本文介绍如何创建一个Arm架构的ECI实例。\n## 规格说明\n\nArm规格基于Arm架构，每一个vCPU都对应一个处理器的物理核心，具有性能稳定且资源独享的特点，适用于容器、微服务、网站和应用服务器、高性能计算、基于CPU的机器学习等场景。\n\n[表格]\n\n规格类型\n\nArm规格族\n\n通用型\n\ng8y\n\n计算型\n\nc8y\n\n内存型\n\nr8y\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 注意事项\n\nArm架构的ECI实例按照实际生成的Arm规格进行计费，不按vCPU和内存计费。重要 \n\nECI实例创建成功后，您可以调用[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)接口查询实例详情，通过返回的InstanceType参数确认ECI实例实际使用的ECS Arm规格。\n## 配置说明\n#### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以使用以下两种方式创建Arm实例。\n\n- \n\n方式一：直接通过InstanceType参数指定具体的ECS Arm规格。\n- \n\n方式二：指定vCPU和内存的同时，通过CpuArchitecture参数指定CPU架构。系统会从ECI支持的ECS Arm规格中自动选择一个符合vCPU和内存条件的Arm规格。\n\n其中，指定vCPU和内存可以通过以下几种方式：\n\n- \n\n仅指定容器级别vCPU和内存，系统自动汇总到实例级别。\n- \n\n指定实例级别vCPU和内存，按需设置容器级别vCPU和内存。\n- \n\n通过InstanceType参数设置实例级别vCPU和内存。\n\n相关参数如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nCpu\n\nnumber\n\n2.0\n\n实例级别vCPU大小。单位：核。\n\nMemory\n\nnumber\n\n4.0\n\n实例级别内存大小。单位：GiB。\n\nContainer.N.Cpu\n\nnumber\n\n0.5\n\n容器的vCPU大小。单位：核。\n\nContainer.N.Memory\n\nnumber\n\n1.0\n\n容器的内存大小。单位：GiB。\n\nInstanceType\n\nString\n\n2-4Gi\n\n指定实例规格。\n\n- \n\n支持指定多个规格（单次最多5个），各规格之间用半角逗号（,）进行分隔。\n- \n\n可以指定vCPU和内存规格，也可以指定ECS规格。\n\nCpuArchitecture\n\nString\n\nARM64\n\n指定ECI实例的CPU架构。取值范围：\n\n- \n\nAMD64（默认值）\n- \n\nARM64\n\n配置示例如下：\n\n- \n\n示例一：指定ECS Arm规格\n\nContainerGroupName=test-arm\n# 指定多个ECS Arm规格\nInstanceType=ecs.c8y.large,ecs.g8y.large\n# 创建并绑定EIP，以便拉取公网镜像\nAutoCreateEip=true\n# 配置容器，使用Arm架构的容器镜像\nContainer.1.Name=centos\nContainer.1.Image=arm64v8/centos:7.9.2009\nContainer.1.command.1=sleep\nContainer.1.Arg.1=999999\n\n\n- \n\n示例二：指定vCPU和内存，同时指定CPU架构\n\nContainerGroupName=test-arm\n# 指定实例的vCPU和内存规格\nCpu=2.0\nMemory=4.0\n# 指定CPU架构\nCpuArchitecture=ARM64\n# 创建并绑定EIP，以便拉取公网镜像\nAutoCreateEip=true\n# 配置容器，使用Arm架构的容器镜像\nContainer.1.Name=centos\nContainer.1.Image=arm64v8/centos:7.9.2009\nContainer.1.command.1=sleep\nContainer.1.Arg.1=999999\n\n\n#### 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建ARM实例时，当选择的地域和可用区支持ARM规格时，可以在容器组配置区域选择指定规格页签，然后直接选择ECS ARM规格。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-the-gpu-type", "page_type": "doc", "title": "指定GPU规格创建实例", "keywords": "创建GPU ECI实例,指定GPU实例规格,GPU规格说明,GPU实例创建方法", "last_modified_ms": 1742538046000, "last_modified_iso": "2025-03-21T14:20:46+08:00", "excerpt": "本文介绍如何指定ECS GPU规格创建一个ECI实例。\n## 规格说明\n\nGPU规格含有GPU计算卡，适用于深度学习、图像处理等场景。GPU对应的Docker镜像可以直接运行在ECI GPU实例上。实例内已预装NVIDIA显卡设备驱动，不同GPU规格支持安装的驱动和CUDA版本不同。说明 \n\n下表中的gn8ia和gn8is目前仅支持海外等部分地域，如有需求，请联系阿里云销售人员。\n\n[表格]\n\n规格类型\n\nGPU规格族\n\n驱动和CUDA版本\n\nGPU虚拟化型实例规格族\n\nsgn7i-vws\n\nGRID 470，CUDA 11.4（默认安装）\n\nvgn7i-vws\n\nvgn6i-vws\n\nGPU计算型实例规格族\n\ngn7e\n\n- \n\nTesla 470，CUDA 11.4（默认安装）\n- \n\nTesla 535，CUDA 12.2\n- \n\nTesla 550，CUDA 12.4\n\ngn7i\n\ngn7s\n\ngn7\n\ngn6v\n\ngn6e\n\ngn6i\n\ngn5i\n\ngn5\n\ngn8ia\n\n- \n\nTesla 535，CUDA 12.2（默认安装）\n- \n\nTesla 550，CUDA 12.2\n\ngn8is重要 \n\n自2025年3月17日开始。指定GPU驱动版本不再使用完整版本号（如535.161.08），而是只使用大版本号（如535），实际创建出的实例的驱动版本可能会在保证大版本号不变的情况下更新小版本号，较老的驱动下线后会自动使用更高版本驱动创建。特定版本驱动的支持时间与NVIDIA官方对该驱动的支持时间一致，具体请参见[NVIDIA Driver Documentation](https://docs.nvidia.com/datacenter/tesla/index.html)。\n\nGPU驱动更新记录\n\n[表格]\n\n更新时间\n\n更新说明\n\n2025年3月\n\n- \n\nGRID 470驱动更新为470.239.06。\n- \n\nTesla 470驱动更新为470.256.02，Tesla 535驱动更新为535.230.02，Tesla550驱动更新为550.127.08。\n- \n\nTesla 525驱动不再支持，指定该驱动将回退到535版本。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n### 配置说明\n\n创建GPU实例时，在指定GPU规格的基础上，容器内还需要指定GPU个数。重要 \n\n- \n\n如果实例指定使用GPU规格，但容器内没有指定GPU个数，则实例启动会报错。\n- \n\n默认情况下，多个容器可以共享使用GPU，配置时需确保单个容器内配置的GPU个数不超过指定的GPU规格所具备的GPU个数。\n\n#### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，在通过InstanceType参数指定ECS GPU实例规格的基础上，必须通过容器属性中的GPU参数指定容器使用的GPU个数。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nInstanceType\n\nString\n\necs.gn6v-c8g1.2xlarge\n\n指定ECS GPU实例规格。\n\n支持指定多个规格（单次最多5个），各规格之间用半角逗号（,）进行分隔。\n\nContainer.N.Gpu\n\nInteger\n\n1\n\n指定容器使用的GPU个数。说明 \n\n您也可以调用UpdateContainerGroup更新GPU实例中各容器使用的GPU个数。更多信息，请参见[UpdateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updatecontainergroup)。\n\n默认情况下，ECI GPU实例会根据指定的GPU规格自动安装支持的驱动和CUDA版本。在一些场景中，您可能需要在不同的ECI GPU实例负载中依赖不同的驱动和CUDA版本，此时，您可以通过GpuDriverVersion参数来指定驱动版本。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nGpuDriverVersion\n\nstring\n\ntesla=535\n\n指定GPU驱动版本。说明 \n\n仅部分规格支持切换GPU驱动版本。具体请参见[规格说明](#eb72b1505dl9e)。\n#### 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建GPU实例时，GPU相关配置如下：\n\n- \n\n在容器组配置区域单击指定规格页签，然后选择GPU规格。\n\n- \n\n在各个容器的高级配置中，设置容器使用的GPU个数。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-an-instance-of-the-specified-x86-type", "page_type": "doc", "title": "指定x86规格创建实例", "keywords": "创建x86规格ECI实例,了解ECI x86规格,ECI x86规格说明,ECI实例创建方法", "last_modified_ms": 1743158594000, "last_modified_iso": "2025-03-28T18:43:14+08:00", "excerpt": "本文介绍如何指定ECS x86规格创建一个ECI实例。\n## 规格说明\n\n根据是否适合企业场景，x86架构规格可以分为企业级和共享型：\n\n企业级x86计算规格族\n\nx86规格基于x86架构，每一个vCPU都对应一个处理器核心的超线程，具有性能稳定的特点，适用于各种类型和规模的企业级应用、数据库系统、视频编解码、数据分析等场景。\n\n[表格]\n\n规格类型\n\n企业级x86规格族\n\n通用型\n\ng8a、g8i、g7a、g7、g6e、g6a、g6、g5、sn2ne\n\n计算型\n\nc8a、c8i、c7a、c7、c6e、c6a、c6、c5、sn1ne\n\n内存型\n\nr8a、r8i、r7a、r7、r6e、r6a、r6、r5、se1ne、se1\n\n通用算力型\n\nu1\n\n密集计算型\n\nic5\n\n高主频\n\n- \n\nhfg8i、hfg7、hfg6、hfg5\n- \n\nhfc8i、hfc7、hfc6、hfc5\n- \n\nhfr8i、hfr7\n\n大数据\n\nd1、d1ne\n\n本地SSD型\n\ni2、i2g\n\n内存增强型\n\nre6\n\n共享型x86计算规格族\n\n共享型规格主要面向一般中小网站或个人开发。与企业级规格相比，共享型规格在资源利用上更多强调资源性能的共享，所以无法保证实例计算性能的稳定，但是成本相对来说更低。\n\n[表格]\n\n规格类型\n\n共享型x86规格族\n\n经济型\n\ne说明 \n\n上述规格族部分带有本地盘（如i2、d1ne等），如果需要挂载本地盘，请配置Volume。具体操作，请参见[指定本地盘规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-a-local-disk-type)\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n#### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过InstanceType参数来指定ECS规格。InstanceType的参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nInstanceType\n\nString\n\necs.c6.xlarge,ecs.g6.xlarge\n\n指定ECS实例规格。支持指定多个规格（单次最多5个），各规格之间用半角逗号（,）进行分隔。\n#### 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建ECI实例时，在容器组配置区域单击指定规格页签，可以按需选择x86规格。说明 \n\n- \n\n您可以输入vCPU、内存或者具体的规格进行筛选，也可以在规格列表中通过处理器列筛选。\n- \n\n如果选择带有本地存储的x86规格（即本地盘规格），由于控制台暂不支持挂载本地盘操作，建议您采用OpenAPI方式。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-an-instance-using-the-data-cache", "page_type": "doc", "title": "使用数据缓存创建实例", "keywords": "使用数据缓存创建ECI,查CreateContainerGroup参数,ECI数据缓存配置,ECI数据缓存API参考", "last_modified_ms": 1700115408000, "last_modified_iso": "2023-11-16T14:16:48+08:00", "excerpt": "创建数据缓存后，您可以使用数据缓存创建ECI实例，将缓存好的数据直接挂载到ECI实例中，免去拉取数据的等待时间，加速业务启动。本文介绍如何使用数据缓存创建ECI实例。\n## 前提条件\n\n已创建数据缓存。具体操作，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches#3c9228a032ffp)。\n## 配置说明\n\n使用数据缓存创建ECI实例时，您可以指定数据缓存Bucket，并通过HostPath的方式直接挂载数据存储路径。此时，系统会自动创建并挂载一块按量付费的云盘。该云盘的容量等于数据缓存大小，随实例一起创建和释放。\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，数据缓存功能的相关参数如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。说明 \n\n- \n\nDataCache相关参数：DataCacheBucket为必填参数，其他参数为可选参数。\n- \n\nVolume相关参数：本文仅说明数据缓存功能涉及的Volume相关必填参数，不说明其他可选参数。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nDataCacheBucket\n\nstring\n\ndefault\n\n指定数据缓存Bucket。\n\nDataCachePL\n\nstring\n\nPL1\n\n基于数据缓存创建的云盘的性能等级。默认使用ESSD云盘，性能等级默认为PL1。\n\nDataCacheProvisionedIops\n\nlong\n\n40000\n\nESSD AutoPL云盘预配置的读写IOPS。取值范围：0~min{50000, 1000 * 容量-基准性能}。基准性能=min{1800+50 * 容量, 50000}。更多信息，请参见[ESSD AutoPL云盘](https://help.aliyun.com/zh/ecs/user-guide/essd-autopl-disks)。\n\n如果配置了该参数，则基于数据缓存创建的云盘类型为ESSD AutoPL云盘。\n\nDataCacheBurstingEnabled\n\nboolean\n\nfalse\n\nESSD AutoPL云盘是否开启Burst（性能突发）。更多信息，请参见[ESSD AutoPL云盘](https://help.aliyun.com/zh/ecs/user-guide/essd-autopl-disks)。\n\n如果配置了该参数，则基于数据缓存创建的云盘类型为ESSD AutoPL云盘。\n\nVolume.N.Name\n\nString\n\ndatacache-demo\n\n数据卷名称，自定义设置。\n\nVolume.N.Type\n\nString\n\nHostPathVolume\n\n取值为HostPathVolume，表示创建一个HostPath类型的数据卷。\n\nVolume.N.HostPathVolume.Path\n\nString\n\n/test/data\n\n取值为数据存储路径，即数据缓存的Path。\n\nContainer.N.VolumeMount.N.Name\n\nString\n\ndatacache-demo\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/data\n\n数据挂载到容器的目录。\n\n挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n## 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/?spm=a2c4g.11186623.0.0.147e4501mVkZpz#/eci/createEci?regionId=cn-shanghai)创建ECI实例时，在数据缓存区域可以配置数据缓存。\n\n相关说明如下：\n\n[表格]\n\n配置项\n\n说明\n\n缓存Bucket\n\n输入数据缓存Bucket。\n\n添加\n\n单击添加后，在弹出的对话框中可以选择数据缓存，并挂载到指定容器的指定目录。\n\n开启Burst\n\n按需开启。表示ESSD AutoPL云盘是否开启Burst（性能突发）。如果开启了，则基于数据缓存创建的云盘类型为ESSD AutoPL云盘。更多信息，请参见[ESSD AutoPL云盘](https://help.aliyun.com/zh/ecs/user-guide/essd-autopl-disks)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches", "page_type": "doc", "title": "创建和管理数据缓存", "keywords": "创建数据缓存,管理数据缓存,数据缓存配置参数,数据缓存数据源", "last_modified_ms": 1736851086000, "last_modified_iso": "2025-01-14T18:38:06+08:00", "excerpt": "数据缓存可以提前拉取业务所需数据，以便在创建ECI实例时可以直接挂载使用。本文介绍数据缓存的配置参数以及如何创建、查询、更新、拷贝和删除数据缓存。\n## 创建数据缓存\n\n创建方式如下：\n\n- \n\nOpenAPI：调用CreateDataCache接口可以创建数据缓存。更多信息，请参见[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)。\n- \n\n控制台：在[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-shanghai/dataCache)的数据缓存页面，单击创建数据缓存。按照需求配置数据缓存相关参数，单击确定。\n\n### 配置说明\n\n创建数据缓存需要配置的参数如下：\n\n- \n\n基本属性\n\n[表格]\n\nAPI\n\n控制台\n\n说明\n\nRegionId\n\n地域\n\n数据缓存所属地域。\n\nBucket\n\n缓存所属Bucket\n\n数据的存储空间。默认为default。支持自定义，以便进行业务分组和避免路径冲突。\n\neci-system为ECI保留空间，不可使用。\n\nPath\n\n缓存所属目录\n\n数据存储的路径。\n\nName\n\n缓存名\n\n数据缓存名称。\n\nSize\n\n缓存大小\n\n数据缓存大小。单位为GiB，默认为20 GiB。请根据实际数据量评估所需大小。\n\nRetentionDays\n\n保留天数\n\n数据缓存保留天数。过期会被清理。默认不过期。\n- \n\n数据源\n\n[表格]\n\nAPI\n\n控制台\n\n说明\n\nDataSource.Type\n\n类型\n\n数据源类型。\n\nDataSource.Options\n\n参数\n\n数据源配置参数。格式为JSON对象，不同类型数据源要传入的参数不同。\n\n各类型数据源及其配置参数说明如下：重要 \n\n如果通过OpenAPI门户创建数据缓存，DataSource.Options中各个参数前需要添加参数名的长度，例如url需要写成#3#url，repoId需要写成#6#repoId，repoSource需要写成#10#repoSource。如果通过SDK创建数据缓存，无需添加。\n\n[表格]\n\n数据源类型\n\n数据来源说明\n\n配置参数\n\nURL\n\n链接地址\n\n- \n\nurl：数据下载地址。\n- \n\naccessToken：拉取私有数据时，需配置该参数来验证身份以访问数据。\n\nHuggingFace或ModelScope\n\n- \n\nrepoSource：取值范围为ModelScope/Model、ModelScope/DataSet、HuggingFace/Model、HuggingFace/DataSet，表示从ModelScope或HuggingFace社区拉取模型或者数据集。\n- \n\nrepoId：模型ID或数据集ID。\n- \n\nrevision：版本。默认为main或者master。\n- \n\naccessToken：拉取私有数据时，需配置该参数来验证身份以访问数据。\n\nNAS\n\nNAS文件系统\n\n- \n\nserver：NAS文件系统的挂载点。\n- \n\npath：挂载子目录。极速型NAS需要以/share为前缀，例如/share/path。\n- \n\nvers：挂载NAS的NFS协议版本号。推荐使用v3，极速型NAS仅支持v3。\n- \n\noptions：挂载选项。建议使用NAS服务推荐选项，例如nolock,tcp,noresvport。\n\nOSS\n\nOSS存储空间\n\n- \n\nbucket：OSS Bucket的名称。\n- \n\nurl：OSS的接入域名（Endpoint）。\n- \n\npath：挂载子目录。相对Bucket根目录的目录，默认为/。\n- \n\notherOpts：挂载OSS时支持输入定制化参数，格式为-o *** -o ***，例如-o max_stat_cache_size=0 -o allow_other。\n- \n\nramRole：使用RAM角色授权时，对应的RAM角色。说明 \n\n请创建RAM角色并为该角色授权。具体操作，请参见[创建可信实体为阿里云服务的RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service#task-2448632)和[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role#task-187801)。\n\n创建时，可信实体类型为阿里云服务，角色类型为普通服务角色，受信服务为云服务器；为角色授权时，请选择AliyunOSSFullAccess权限策略。\n- \n\nakId：使用AccessKey直接授权时，对应的AccessKey ID。具体操作，请参见[获取AccessKey](https://help.aliyun.com/document_detail/175967.html#task-354412)。\n- \n\nakSecret：使用AccessKey直接授权时，对应的AccessKey Secret。具体操作，请参见[获取AccessKey](https://help.aliyun.com/document_detail/175967.html#task-354412)。\n\nSNAPSHOT\n\n快照\n\nsnapshotId：快照ID。\n- \n\n网络参数\n\n如果需要通过公网拉取数据，在指定的交换机没有配置SNAT时，支持绑定EIP来拉取公网数据。\n\n[表格]\n\nAPI\n\n控制台\n\n说明\n\nEipInstanceId\n\n使用已有\n\n绑定已有的EIP。\n\nEipCreateParam包含的参数\n\n自动创建\n\n自动创建并绑定EIP。\n- \n\n其他参数\n\n除上述参数外，创建数据缓存时还需指定专有网络、交换机、安全组等参数，用于在创建数据缓存的过程中创建临时资源。\n\n### 配置示例\n\n以OpenAPI为例，创建各类型数据缓存的参数配置示例如下：\n#### URL\n\n- \n\n从链接地址拉取数据\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/demo/url\",\n  \"Name\": \"test-url-1\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#10#url\": \"https://www.example.com\"\n    }\n  },\n  \"RetentionDays\": 1\n}\n\n\n- \n\n从HuggingFace拉取模型\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/demo/url\",\n  \"Name\": \"test-url-2\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#10#repoSource\": \"HuggingFace/Model\",\n      \"#6#repoId\": \"stabilityai/stable-diffusion-2-1\"\n    }\n  },\n  \"RetentionDays\": 1\n}\n\n\n#### NAS\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/demo/nas\",\n  \"Name\": \"test-nas\",\n  \"DataSource\": {\n    \"Type\": \"NAS\",\n    \"Options\": {\n      \"#6#server\": \"126c24****-tw***.cn-beijing.nas.aliyuncs.com\",\n      \"#4#path\": \"/\",\n      \"#4#vers\": \"3\",\n      \"#7#options\": \"nolock,tcp,noresvport\"\n    }\n  },\n  \"RetentionDays\": 1\n}\n\n\n#### OSS\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/demo/oss\",\n  \"Name\": \"test-oss\""}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-and-manage-datacache", "page_type": "doc", "title": "创建和管理DataCache", "keywords": "DataCache,创建DataCache,管理DataCache,配置DataCache,DataCache配置参数,DataCache操作指南,DataCache配置示例", "last_modified_ms": 1721721928000, "last_modified_iso": "2024-07-23T16:05:28+08:00", "excerpt": "部署DataCache CRD后，您可以创建DataCache提前拉取业务所需的数据，例如AI训练模型等。本文介绍DataCache的配置参数以及如何创建、查询和删除DataCache。\n## 前提条件\n\n集群中已部署DataCache CRD。具体操作，请参见[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n## 创建DataCache\n### 配置说明\n\nDataCache的YAML配置参数如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: test-url\nspec:\n  bucket: default\n  path: /demo/url\n  size: 20\n  retentionDays: 3\n  dataSource:\n    type: URL \n    options:\n      url: https://www.example.com\n  netConfig: \n    securityGroupId: sg-2ze63v3jtm8e6sy******\n    vSwitchId: vsw-2ze94pjtfuj9vaym******\n\n\n参数说明如下：\n\n- \n\napiVersion：API版本，固定为eci.aliyun.com/v1alpha1。\n- \n\nkind：资源类型，固定为DataCache。\n- \n\nmetadata\n\n- \n\nname：DataCache名称。\n\n- \n\nspec\n\n- \n\nbucket：数据的存储空间。默认为default，支持自定义。eci-system为ECI保留空间，不可使用。\n- \n\npath：数据存储的路径。\n- \n\nsize：DataCache大小。单位为GiB，默认为20 GiB。请根据实际数据量评估所需大小。\n- \n\nretentionDays：DataCache保留天数。过期会被清理。默认不过期。\n- \n\ndataSource：数据源，包括数据源类型type和配置参数options。\n\n[表格]\n\n数据源类型\n\n数据来源说明\n\n配置参数\n\nURL\n\n链接地址\n\n- \n\nurl：数据下载地址。\n- \n\naccessToken：拉取私有数据时，需配置该参数来验证身份以访问数据。\n\nHuggingFace或ModelScope\n\n- \n\nrepoSource：取值范围为ModelScope/Model、ModelScope/DataSet、HuggingFace/Model、HuggingFace/DataSet，表示从ModelScope或HuggingFace社区拉取模型或者数据集。\n- \n\nrepoId：模型ID或数据集ID。\n- \n\nrevision：版本。默认为main或者master。\n- \n\naccessToken：拉取私有数据时，需配置该参数来验证身份以访问数据。\n\nNAS\n\nNAS文件系统\n\n- \n\nserver：NAS文件系统的挂载点。\n- \n\npath：挂载子目录。极速型NAS需要以/share为前缀，例如/share/path。\n- \n\nvers：挂载NAS的NFS协议版本号。推荐使用v3，极速型NAS仅支持v3。\n- \n\noptions：挂载选项。建议使用NAS服务推荐选项，例如nolock,tcp,noresvport。\n\nOSS\n\nOSS存储空间\n\n- \n\nbucket：OSS Bucket的名称。\n- \n\nurl：OSS的接入域名（Endpoint）。\n- \n\npath：挂载子目录。相对Bucket根目录的目录，默认为/。\n- \n\notherOpts：挂载OSS时支持输入定制化参数，格式为-o *** -o ***，例如-o max_stat_cache_size=0 -o allow_other。\n- \n\nramRole：使用RAM角色授权时，对应的RAM角色。说明 \n\n请创建RAM角色并为该角色授权。具体操作，请参见[创建可信实体为阿里云服务的RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service#task-2448632)和[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role#task-187801)。\n\n创建时，可信实体类型为阿里云服务，角色类型为普通服务角色，受信服务为云服务器；为角色授权时，请选择AliyunOSSFullAccess权限策略。\n- \n\nakId：使用AccessKey直接授权时，对应的AccessKey ID。具体操作，请参见[获取AccessKey](https://help.aliyun.com/document_detail/175967.html#task-354412)。\n- \n\nakSecret：使用AccessKey直接授权时，对应的AccessKey Secret。具体操作，请参见[获取AccessKey](https://help.aliyun.com/document_detail/175967.html#task-354412)。\n\nSNAPSHOT\n\n快照\n\nsnapshotId：快照ID。\n- \n\nnetConfig\n\n- \n\nsecurityGroupId：创建DataCache过程中生成的ECI实例所属的安全组ID。\n- \n\nvSwitchId：创建DataCache过程中生成的ECI实例所属的交换机ID。\n\n如果需要通过公网拉取数据，在指定的交换机没有配置SNAT时，支持绑定EIP来拉取公网数据。此时，可在netConfig下添加EIP相关参数。\n\nnetConfig: \n  eipInstanceId: eip-2zey74a7zienoxf*****  #与eipCreateParam二选一\n  eipCreateParam:  #与eipInstanceId二选一\n    bandwidth: 5\n    commonBandwidthPackage:  cbwp-2zeukbj916scmj5******\n    internetChargeType:  PayByTraffic\n    publicIpAddressPoolId: pippool-bp187arfugi543y1s****\n    ISP: BGP\n\n\n- \n\neipInstanceId：如果指定的交换机没有配置SNAT，可以绑定已有的可用EIP，以便拉取公网数据。\n- \n\neipCreateParam：如果指定的交换机没有配置SNAT，且没有可用的EIP，此时如果想要拉取公网数据，可以配置以下参数创建一个EIP并绑定。\n\n- \n\nbandwidth：EIP带宽。单位为Mbps。默认为5 Mbps。\n- \n\ncommonBandwidthPackage：绑定已有的共享带宽包。更多信息，请参见[共享带宽](https://help.aliyun.com/zh/internet-shared-bandwidth/product-overview/what-is-internet-shared-bandwidth)。\n- \n\ninternetChargeType：EIP的计量方式。取值范围为PayByBandwidth（按带宽计费）和PayByTraffic（按流量计费）。更多信息，请参见[EIP计费方式](https://help.aliyun.com/zh/eip/product-overview/billing-overview/#section-j0c-7wh-cko)。\n- \n\npublicIpAddressPoolId：IP地址池ID。 EIP将从该IP地址池中分配。 IP地址池功能默认不开放。如需使用，请在配额中心申请IP地址池功能权益配额。更多信息，请参见[创建和管理IP地址池](https://help.aliyun.com/zh/eip/create-and-manage-ip-address-pools)。\n- \n\nISP：EIP的线路类型。取值范围为BGP（默认值）和BGP_PRO。更多信息，请参见[EIP线路类型](https://help.aliyun.com/zh/eip/product-overview/what-is-eip#section-vzi-lqi-chm)。\n\n### 配置示例\n\n编写DataCache的YAML配置文件（假设名称为datacache.yaml），通过kubectl命令即可创建DataCache。\n\n- \n\n全新创建\n\nkubectl create -f datacache.yaml\n\n\n- \n\n更新创建\n\nkubectl apply -f datacache.yaml\n\n\n各类型DataCache的YAML示例如下：\n#### URL\n\n- \n\n从链接地址拉取数据\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: test-url-1\nspec:\n  path: /demo/url\n  dataS"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-pods-by-specifying-multiple-specifications", "page_type": "doc", "title": "多规格创建Pod", "keywords": "多规格创建ECI Pod,解决Pod创建库存不足,ECI Pod支持的规格,ECI Pod多规格配置", "last_modified_ms": 1743158693000, "last_modified_iso": "2025-03-28T18:44:53+08:00", "excerpt": "大规模创建ECI Pod（即ECI实例）时，可能会遇到库存不足的情况。此时，建议您配置多个规格，系统会按照配置顺序依次尝试创建，从而提升ECI Pod的创建成功率。\n## 背景信息\n\n创建ECI实例的过程中，如果遇到库存不足而导致创建失败，系统会根据配置的规格顺序依次重试创建实例。因此，配置多个规格可以提升ECI实例的创建成功率。说明 \n\n- \n\n在重试创建过程中，ECI实例会一直处于Pending状态。\n- \n\n多规格方式为实例级别，仅影响单个实例的创建策略。\n- \n\n您可以配合使用多可用区和多规格的方式来创建实例，从而进一步提高实例的创建成功率。\n\n## 规格说明\n\n指定多规格时，可以指定vCPU和内存规格，也可以指定ECS规格，支持同时指定两者。\n### ECI支持的vCPU和内存规格\n\n- \n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n- \n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n\n#### ECI支持的ECS实例规格族\n\n- \n\n企业级x86计算规格族\n\nx86规格基于x86架构，每一个vCPU都对应一个处理器核心的超线程，具有性能稳定的特点，适用于各种类型和规模的企业级应用、数据库系统、视频编解码、数据分析等场景。\n\n[表格]\n\n规格类型\n\n企业级x86规格族\n\n通用型\n\ng8a、g8i、g7a、g7、g6e、g6a、g6、g5、sn2ne\n\n计算型\n\nc8a、c8i、c7a、c7、c6e、c6a、c6、c5、sn1ne\n\n内存型\n\nr8a、r8i、r7a、r7、r6e、r6a、r6、r5、se1ne、se1\n\n通用算力型\n\nu1\n\n密集计算型\n\nic5\n\n高主频\n\n- \n\nhfg8i、hfg7、hfg6、hfg5\n- \n\nhfc8i、hfc7、hfc6、hfc5\n- \n\nhfr8i、hfr7\n\n大数据\n\nd1、d1ne\n\n本地SSD型\n\ni2、i2g\n\n内存增强型\n\nre6\n- \n\n企业级异构计算规格族\n\nGPU规格含有GPU计算卡，适用于深度学习、图像处理等场景。GPU对应的Docker镜像可以直接运行在ECI GPU实例上。实例内已预装NVIDIA显卡设备驱动，不同GPU规格支持安装的驱动和CUDA版本不同。说明 \n\n下表中的gn8ia和gn8is目前仅支持海外等部分地域，如有需求，请联系阿里云销售人员。\n\n[表格]\n\n规格类型\n\nGPU规格族\n\n驱动和CUDA版本\n\nGPU虚拟化型实例规格族\n\nsgn7i-vws\n\nGRID 470，CUDA 11.4（默认安装）\n\nvgn7i-vws\n\nvgn6i-vws\n\nGPU计算型实例规格族\n\ngn7e\n\n- \n\nTesla 470，CUDA 11.4（默认安装）\n- \n\nTesla 535，CUDA 12.2\n- \n\nTesla 550，CUDA 12.4\n\ngn7i\n\ngn7s\n\ngn7\n\ngn6v\n\ngn6e\n\ngn6i\n\ngn5i\n\ngn5\n\ngn8ia\n\n- \n\nTesla 535，CUDA 12.2（默认安装）\n- \n\nTesla 550，CUDA 12.2\n\ngn8is重要 \n\n自2025年3月17日开始。指定GPU驱动版本不再使用完整版本号（如535.161.08），而是只使用大版本号（如535），实际创建出的实例的驱动版本可能会在保证大版本号不变的情况下更新小版本号，较老的驱动下线后会自动使用更高版本驱动创建。特定版本驱动的支持时间与NVIDIA官方对该驱动的支持时间一致，具体请参见[NVIDIA Driver Documentation](https://docs.nvidia.com/datacenter/tesla/index.html)。\n\nGPU驱动更新记录\n\n[表格]\n\n更新时间\n\n更新说明\n\n2025年3月\n\n- \n\nGRID 470驱动更新为470.239.06。\n- \n\nTesla 470驱动更新为470.256.02，Tesla 535驱动更新为535.230.02，Tesla550驱动更新为550.127.08。\n- \n\nTesla 525驱动不再支持，指定该驱动将回退到535版本。\n\n- \n\n共享型x86计算规格族\n\n共享型规格主要面向一般中小网站或个人开发。与企业级规格相比，共享型规格在资源利用上更多强调资源性能的共享，所以无法保证实例计算性能的稳定，但是成本相对来说更低。\n\n[表格]\n\n规格类型\n\n共享型x86规格族\n\n经济型\n\ne\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定实例规格。\n\n- \n\n指定多规格时，可以指定vCPU和内存规格，也可以指定ECS规格，支持同时指定两者。重要 \n\n您可以在Pod创建成功后查看其YAML详情，通过k8s.aliyun.com/eci-instance-spec字段确认Pod实际使用的规格。如果是ECS规格，则按ECS规格计费；如果是具体的vCPU和内存数值，则按vCPU和内存计费。\n- \n\n请根据想要使用规格的优先级，按顺序设置多个规格（单次最多5个）。\n- \n\n对于GPU、本地盘、ARM等除了指定规格外还需要额外配置其他参数的规格，指定多规格时只能指定同类型的规格，无法和其他规格同时指定。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: 2-4Gi,ecs.c5.large,ecs.c6.large  #根据需要替换您想要使用的规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-pods-by-specifying-multiple-specifications-1", "page_type": "doc", "title": "多规格创建Pod", "keywords": "创建多规格ECI Pod,解决ECI库存不足,ECI Pod多规格配置,ECI支持的实例规格", "last_modified_ms": 1743158660000, "last_modified_iso": "2025-03-28T18:44:20+08:00", "excerpt": "大规模创建ECI Pod（即ECI实例）时，可能会遇到库存不足的情况。此时，建议您配置多个规格，系统会按照配置顺序依次尝试创建，从而提升ECI Pod的创建成功率。\n## 背景信息\n\n创建ECI实例的过程中，如果遇到库存不足而导致创建失败，系统会根据配置的规格顺序依次重试创建实例。因此，配置多个规格可以提升ECI实例的创建成功率。说明 \n\n- \n\n在重试创建过程中，ECI实例会一直处于Pending状态。\n- \n\n多规格方式为实例级别，仅影响单个实例的创建策略。\n- \n\n您可以配合使用多可用区和多规格的方式来创建实例，从而进一步提高实例的创建成功率。\n\n## 规格说明\n### ECI支持的vCPU和内存规格\n\n- \n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n- \n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n\n#### ECI支持的ECS实例规格族\n\n- \n\n企业级x86计算规格族\n\nx86规格基于x86架构，每一个vCPU都对应一个处理器核心的超线程，具有性能稳定的特点，适用于各种类型和规模的企业级应用、数据库系统、视频编解码、数据分析等场景。\n\n[表格]\n\n规格类型\n\n企业级x86规格族\n\n通用型\n\ng8a、g8i、g7a、g7、g6e、g6a、g6、g5、sn2ne\n\n计算型\n\nc8a、c8i、c7a、c7、c6e、c6a、c6、c5、sn1ne\n\n内存型\n\nr8a、r8i、r7a、r7、r6e、r6a、r6、r5、se1ne、se1\n\n通用算力型\n\nu1\n\n密集计算型\n\nic5\n\n高主频\n\n- \n\nhfg8i、hfg7、hfg6、hfg5\n- \n\nhfc8i、hfc7、hfc6、hfc5\n- \n\nhfr8i、hfr7\n\n大数据\n\nd1、d1ne\n\n本地SSD型\n\ni2、i2g\n\n内存增强型\n\nre6\n- \n\n企业级异构计算规格族\n\nGPU规格含有GPU计算卡，适用于深度学习、图像处理等场景。GPU对应的Docker镜像可以直接运行在ECI GPU实例上。实例内已预装NVIDIA显卡设备驱动，不同GPU规格支持安装的驱动和CUDA版本不同。说明 \n\n下表中的gn8ia和gn8is目前仅支持海外等部分地域，如有需求，请联系阿里云销售人员。\n\n[表格]\n\n规格类型\n\nGPU规格族\n\n驱动和CUDA版本\n\nGPU虚拟化型实例规格族\n\nsgn7i-vws\n\nGRID 470，CUDA 11.4（默认安装）\n\nvgn7i-vws\n\nvgn6i-vws\n\nGPU计算型实例规格族\n\ngn7e\n\n- \n\nTesla 470，CUDA 11.4（默认安装）\n- \n\nTesla 535，CUDA 12.2\n- \n\nTesla 550，CUDA 12.4\n\ngn7i\n\ngn7s\n\ngn7\n\ngn6v\n\ngn6e\n\ngn6i\n\ngn5i\n\ngn5\n\ngn8ia\n\n- \n\nTesla 535，CUDA 12.2（默认安装）\n- \n\nTesla 550，CUDA 12.2\n\ngn8is重要 \n\n自2025年3月17日开始。指定GPU驱动版本不再使用完整版本号（如535.161.08），而是只使用大版本号（如535），实际创建出的实例的驱动版本可能会在保证大版本号不变的情况下更新小版本号，较老的驱动下线后会自动使用更高版本驱动创建。特定版本驱动的支持时间与NVIDIA官方对该驱动的支持时间一致，具体请参见[NVIDIA Driver Documentation](https://docs.nvidia.com/datacenter/tesla/index.html)。\n\nGPU驱动更新记录\n\n[表格]\n\n更新时间\n\n更新说明\n\n2025年3月\n\n- \n\nGRID 470驱动更新为470.239.06。\n- \n\nTesla 470驱动更新为470.256.02，Tesla 535驱动更新为535.230.02，Tesla550驱动更新为550.127.08。\n- \n\nTesla 525驱动不再支持，指定该驱动将回退到535版本。\n\n- \n\n企业级Arm计算规格族\n\nArm规格基于Arm架构，每一个vCPU都对应一个处理器的物理核心，具有性能稳定且资源独享的特点，适用于容器、微服务、网站和应用服务器、高性能计算、基于CPU的机器学习等场景。\n\n[表格]\n\n规格类型\n\nArm规格族\n\n通用型\n\ng8y\n\n计算型\n\nc8y\n\n内存型\n\nr8y\n- \n\n共享型x86计算规格族\n\n共享型规格主要面向一般中小网站或个人开发。与企业级规格相比，共享型规格在资源利用上更多强调资源性能的共享，所以无法保证实例计算性能的稳定，但是成本相对来说更低。\n\n[表格]\n\n规格类型\n\n共享型x86规格族\n\n经济型\n\ne\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定实例规格。\n\n- \n\n指定多规格时，可以指定vCPU和内存规格，也可以指定ECS规格，支持同时指定两者。重要 \n\n您可以在Pod创建成功后查看其YAML详情，通过k8s.aliyun.com/eci-instance-spec字段确认Pod实际使用的规格。如果是ECS规格，则按ECS规格计费；如果是具体的vCPU和内存数值，则按vCPU和内存计费。\n- \n\n请根据想要使用规格的优先级，按顺序设置多个规格（单次最多5个）。\n- \n\n对于GPU、本地盘、ARM等除了指定规格外还需要额外配置其他参数的规格，指定多规格时只能指定同类型的规格，无法和其他规格同时指定。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: 2-4Gi,ecs.c5.large,ecs.c6.large  #根据需要替换您想要使用的规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/create-pods-in-multiple-zones", "page_type": "doc", "title": "多可用区创建Pod", "keywords": "创建多可用区Pod,解决Pod库存不足,ECI Pod多可用区配置,多可用区调度策略", "last_modified_ms": 1747980033000, "last_modified_iso": "2025-05-23T14:00:33+08:00", "excerpt": "当您在应对突发流量，进行业务的快速水平扩容时，或者启动大量ECI Pod进行Job任务处理时，可能会遇到可用区对应规格实例库存不足或者指定的交换机IP耗尽等特殊情况，从而导致Pod创建失败，影响业务。此时，您可以采用指定多可用区的方式来创建ECI Pod（即ECI实例），以提高实例创建的成功率。\n## 前提条件\n\n已在要使用的专有网络VPC下创建多个不同可用区的交换机。\n\n- \n\n关于如何创建交换机，请参见[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n\n## 背景信息\n\n创建ECI实例时，可以通过指定多个交换机来指定了多个可用区，系统会随机把请求分散到所有指定的可用区中，来分散压力，如果在某一个可用区遇到没有库存的情况，会自动切换到下一个可用区继续尝试创建。\n\n指定多可用区（交换机）时，需注意以下限制：\n\n- \n\n指定的交换机必须属于同一个VPC。\n- \n\n最多可以指定10个交换机。\n\n您可以配合使用多可用区和多规格的方式来创建实例，提高实例的创建成功率。\n## 配置说明\n\n配置多可用区时，您可以根据需要选择为集群或者为特定ECI Pod进行配置：\n\n- \n\n集群：为集群指定多个交换机，对集群内的所有ECI Pod生效。\n- \n\nECI Pod：在创建ECI Pod时指定多个交换机，仅对该ECI Pod生效。\n\n### 新建集群配置\n\n创建集群前，建议您在要使用的专有网络VPC下创建多个不同可用区的交换机。创建集群时，您可以配置多个交换机来实现多可用区功能。下图以在容器服务管理控制台创建ACK Serverless集群为例。\n\n### 已有集群配置\n\n根据VK（ack-virtual-node组件）的版本，您可以通过以下方式来配置多可用区。\n\n- \n\nVK版本为v2.0.0.90-15deb126e-aliyun及以上，请修改eci-profile。\n- \n\nVK版本低于v2.0.0.90-15deb126e-aliyun，请修改环境变量。\n\n### 修改eci-profile\n\n您可以编辑名为eci-profile的ConfigMap，追加vswitch ID到data.vSwitchIds字段来实现多可用区。方式如下：\n\n- \n\n编辑eci-profile。\n\nkubectl edit cm -n kube-system eci-profile\n\n\n- \n\n修改vSwitchIds字段值。\n\n追加vSwitch ID，多个vSwitch ID之间采用半角逗号（,）分隔。\n\ndata:\n  enableClusterIp: \"true\"\n  enableHybridMode: \"false\"\n  enablePrivateZone: \"false\"\n  resourceGroupId: \"\"\n  securityGroupId: sg-2ze0b9o8pjjzts4h****\n  selectors: \"\"\n  vSwitchIds: vsw-2zeet2ksvw7f14ryz****,vsw-2ze94pjtfuj9vaymf**** \n  vpcId: vpc-2zeghwzptn5zii0w7****\n\n\n- \n\n修改完成后，保存退出。\n\n### 修改环境变量说明 \n\n建议您升级VK到最新版本，以便使用新功能。\n\n根据您部署VK的方式，您可以更新Deployment或者StatefulSet的环境变量ECI_VSWITCH的值，来实现多可用区。以Deployment为例，方式如下：\n\n- \n\n编辑Deployment。\n\nkubectl -n kube-system edit deployment/virtual-node-controller\n\n\n- \n\n修改环境变量ECI_VSWITCH。\n\n追加vSwitch ID到环境变量ECI_VSWITCH的value中。多个vSwitch ID之间采用半角逗号（,）分隔。\n\n- name:  ECI_VSWITCH\n  value:  vsw-bp1xpiowfm5vo8o3c****,vsw-bp1rkyjgr1xwoho6k**** \n\n\n- \n\n修改完成后，保存退出。\n\n### ECI Pod配置\n\n您可以在Pod metadata中添加Annotation来指定多可用区，相关配置项如下：\n\n- \n\nk8s.aliyun.com/eci-vswitch：指定多个交换机实现多可用区。说明 \n\n如果ECI Pod添加了k8s.aliyun.com/eci-vswitch的Annotation，则该Pod挂载云盘动态存储卷时，不支持使用WaitForFirstConsumer类型的StorageClass。\n- \n\nk8s.aliyun.com/eci-schedule-strategy：配置多可用区调度策略。可配置为VSwitchOrdered或者VSwitchRandom。两种策略的说明如下表所示。说明 \n\n如果没有配置多可用区调度策略，默认采用VSwitchRandom策略。\n\n[表格]\n\n调度策略\n\n调度说明\n\nVSwitchOrdered（按指定顺序调度）\n\n- \n\n如果ECI Pod挂载了云盘，云盘所属可用区必须和Pod一致，不符合的可用区会被过滤。\n- \n\n按照指定的顺序尝试创建资源，当第一个可用区没有库存时，尝试使用第二个，以此类推，直至资源创建成功。\n\nVSwitchRandom（ 库存最优策略调度）\n\n- \n\n如果ECI Pod挂载了云盘，云盘所属可用区必须和Pod一致，不符合的可用区会被过滤。\n- \n\n由阿里云根据库存最优的调度策略选择合适的交换机（对应可用区）。\n- \n\n如果ECI Pod指定了规格，优先调度到有该规格对应预留实例券的可用区。\n- \n\n优先调度到存储性能较好的可用区。以下老的可用区调度优先级靠后。\n\n- \n\ncn-beijing-e、cn-beijing-d\n- \n\ncn-shenzhen-a、cn-shenzhen-b、cn-shenzhen-c\n- \n\ncn-hangzhou-b、cn-hangzhou-e、cn-hangzhou-f\n- \n\ncn-shanghai-a、cn-shanghai-c\n\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-vswitch: \"vsw-bp1xpiowfm5vo8o3c****,vsw-bp1rkyjgr1xwoho6k****\"    # 指定多个交换机ID\n        k8s.aliyun.com/eci-schedule-strategy: \"VSwitchOrdered\"   # 配置多可用区调度策略\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n## 后续步骤\n\n如果您采用NAT网关来连接公网，配置多可用区（即多个交换机）后，您需要检查SNAT条目配置是否仍满足需求。\n\n例如：如果原有SNAT条目粒度为交换机粒度，则配置多个交换机后，您需要增加新增交换机对应的条目，保证新交换机下的ECI实例可以访问公网。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/custom-events-of-elastic-container-instance", "page_type": "doc", "title": "ECI自定义事件", "keywords": "获取ECI自定义事件,查询ECI事件含义,排查ECI事件问题,ECI事件列表,ECI事件说明,ECI事件分类", "last_modified_ms": 1756806917000, "last_modified_iso": "2025-09-02T17:55:17+08:00", "excerpt": "本文汇总了ECI相关的事件并给出说明，包括ECI实例事件、镜像缓存事件、相关资源事件和系统运维事件。\n## 获取自定义事件\n## OpenAPI方式\n\n- \n\n调用OpenAPI接口[DescribeContainerGroupEvents](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupevents)，查询容器组事件列表。\n- \n\n调用成功后，在页面右侧查看调用结果。\n\n- \n\n以系统运维事件OOMKilled为例：\n\n...\n{\n  \"count\": 1,\n  \"firstTimestamp\": \"2025-**-**T07:51:06Z\",\n  \"involvedObject\": {\n    \"apiVersion\": \"v1\",\n    \"kind\": \"Pod\",\n    \"name\": \"container-group-1756*****1311\",\n    \"namespace\": \"default\",\n    \"uid\": \"eci-0jlh3g*****hnkrv5w74\"\n  },\n  \"lastTimestamp\": \"2025-**-**T07:51:06Z\",\n  \"message\": \"Out of memory\",\n  \"metadata\": {\n    \"name\": \"container-group-1756*****1311.1861*****6a400\",\n    \"namespace\": \"default\"\n  },\n  \"reason\": \"OOMKilled\",\n  \"source\": {\n    \"component\": \"EciService\"\n  },\n  \"type\": \"Warning\"\n}\n...\n\n\n- \n\n主要字段说明：\n\n- \n\ninvolvedObject：事件关联的资源对象。内容包括ECI实例的Kubernetes版本（apiVersion）、资源类型（kind）、资源名称（name）、资源所在命名空间（namespace）和资源ID（uid）。\n- \n\nmessage：事件信息。例如Out of memory。\n- \n\nreason：事件原因。例如OOMKilled。\n- \n\ntype：事件类型。Normal或者Warning。\n\n## 控制台方式\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com)，单击目标容器组ID。\n- \n\n单击事件页签，查看容器组事件列表。\n\n- \n\n以系统运维事件OOMKilled为例：\n\n- \n\n主要字段说明：\n\n- \n\n事件名称：例如container-group-1756*****1311.1861*****6a400。\n- \n\n类型：事件类型。返回Normal或者Warning。\n- \n\n描述：事件原因和信息。例如Out of memory。\n- \n\n开始时间：例如2025年*月*日 15:51:06。\n- \n\n结束时间：例如2025年*月*日 15:51:06。\n\n## ECI实例（ContainerGroup）相关事件\n\n[表格]\n\n事件名称（reason）\n\n事件类型（type）\n\n事件信息（message）\n\n事件说明\n\nStockExhaust\n\nWarning\n\nThe stock of the specified zones will be used up. %s\n\n当前可用区的ECI资源库存即将耗尽。建议更换可用区。\n\nNoStock\n\nWarning\n\nCreate ECI failed because the specified instance is out of stock. %s\n\n当前可用区的ECI资源库存不足。您可以使用多可用区和多规格的方式创建ECI来提高创建成功率。\n\nInsufficientBalance\n\nWarning\n\nYour account does not have enough balance to purchase %s\n\n您的账户余额不足，无法创建ECI实例。\n\nStockClose\n\nWarning\n\nCreate ECI failed because current zone closed or limited without living instance. %s\n\n创建ECI实例失败，无法使用当前可用区。请更换可用区。\n\nFailedScheduling\n\nWarning\n\nUnknown error occurred.\n\n创建ECI实例失败，发生未知错误。请提交工单。\n\nFailedScheduling\n\nWarning\n\nSchedule eci failed:%s\n\n调度ECI实例失败。请重新尝试。\n\nUnknownError\n\nWarning\n\nThe ECI service is under heavy load while creating container group resources, please wait and try again later\n\nECI服务负载过大，请稍后再尝试创建ECI实例。\n\nDiskCapacityQuotaFull\n\nWarning\n\nYour disk capacity quota is exceeded\n\n磁盘容量已达到配额限制。请至[配额中心](https://quotas.console.aliyun.com/products/ecs/quotas)申请提升配额。\n\nDiskCapacityQuotaFull\n\nWarning\n\nYour disk capacity quota in [%s] is exceeded\n\n磁盘容量已达到配额限制。请至[配额中心](https://quotas.console.aliyun.com/products/ecs/quotas)申请提升配额。\n\nAttachDiskFailed\n\nWarning\n\nAttach disk %s failed\n\n挂载磁盘失败。\n\nUnknownError\n\nWarning\n\nAn unknown error occurred for %s\n\n发生未知错误。请提交工单。\n\nCpuOptionsNotSupported\n\nWarning\n\nThe cpu options is not supported for your instanceType[%s] in current region\n\n当前可用区下，您的ECI实例不支持自定义CPU选项。\n\nCpuOptionsNotValid\n\nWarning\n\nThe cpu options is not valid for your instanceType[%s]\n\n您的ECI实例不支持自定义CPU选项。\n\nSYSTEM_FAILURE\n\nWarning\n\nThe ContainerGroup has failed due to a temporary failure of the host\n\n由于系统故障，ECI实例创建失败。\n\nSystemFailureReboot\n\nWarning\n\nThe Specified ContainerGroup is rebooting\n\nECI实例正在重新启动。\n\nStartingFailed\n\nWarning\n\neci starting failed: %s\n\nECI实例启动失败。\n\nSystemReboot\n\nWarning\n\nIt is strongly recommended that you re-create this instance within 48 hours because of %s, otherwise, the pod will be forced to restart.\n\n由于系统维护实例重启，建议您在48小时内重新创建该实例。\n\nThrottling\n\nWarning\n\nThe request was denied due to system flow control, please wait and try again later\n\n由于系统流量控制，请求被拒绝。请稍候再尝试操作。\n\nThrottling\n\nWarning\n\nThe request was denied due to system flow control, please wait and try again later, flowControlType:%s\n\n由于系统流量控制，请求被拒绝。请稍候再尝试操作。\n\nSpotDegraded\n\nWarning\n\nSpot [%s] will be degraded because the specified instance is out of stock\n\n创建抢占式实例时，由于抢占式实例没有满足要求的库存，自动转为创建按量付费实例。\n\nSpotToBeReleased\n\nWarning\n\nSpot ECI will be released in %s minutes\n\n抢占式ECI实例即将过期，您需要在业务上进行兼容处理。\n\nCreateBackoff\n\nWarning\n\n%s\n\n创建ECI实例失败。\n\nQuotaExceeded\n\nWarning\n\nEci instance type %s or vcpu quota is exceeded\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/customize-the-maximum-pending-duration-of-the-eci-pod", "page_type": "doc", "title": "自定义设置ECI Pod的最大Pending时长", "keywords": "设置ECI Pod Pending时长,避免ECI Pod费用损失,ECI Pod Pending时长配置,ECI Pod Pending时长计费", "last_modified_ms": 1719799431000, "last_modified_iso": "2024-07-01T10:03:51+08:00", "excerpt": "由于Pending状态的ECI实例（ECI Pod）是计费的，对于长时间处于Pending状态的异常Pod，如果您没有及时处理，会造成费用损失。默认情况下，ECI实例的最大Pending时长为4小时，您可以根据实际业务情况自定义设置最大Pending时长，系统会自动终止超时的ECI实例，可以在一定程度上规避因没有及时处理异常Pod而造成的费用损失。\n## 功能说明\n\n每个ECI实例相当于一个Pod。创建ECI Pod时，当对应的ECI实例从创建中（Scheduling）进入启动中（Pending）状态后，该ECI实例开始计费。在Pending阶段，如果出现镜像拉取失败、Volume挂载失败等问题，ECI实例会一直处于Pending状态并持续计费，您需要及时处理这类异常的ECI实例来避免费用损失。默认情况下，对于Pending时长超出4小时的ECI实例，系统会自动终止并停止计费。如果您对于时长有要求，可以自定义设置最大Pending时长。重要 \n\n当ECI实例处于Scheduling、Pending、Restarting等状态时，对应的Pod状态（PodStatus.Phase）均为Pending。支持自定义设置的Pending时长指的是ECI实例处于Pending阶段的时长，不包括Scheduling、Restarting等阶段的时长。更多信息，请参见[ECI Pod生命周期](https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-2)。\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-max-pending-minute的Annotation来自定义设置Pod对应ECI实例的最大Pending时长。该Annotation的相关说明如下：\n\n- \n\n该Annotation的取值范围为10~1440的整数，单位为分钟，即下限为10分钟，上限为1天。重要 \n\n请根据实际业务情况合理设置最大Pending时长。如果镜像过大且没有镜像缓存的情况下，创建Pod时需要一定的时长来拉取镜像，此时如果最大Pending时长设置过短，可能会导致Pod创建失败。\n- \n\n未添加该Annotation的情况下，默认的最大Pending时长为4小时。\n- \n\n对于配置了initContainer，且initContainer在运行中的ECI Pod，不受该Annotation约束。\n\n超出最大Pending时长后，系统会上报对应事件。此时，ECI实例的状态会变更为运行失败（Failed），对应的Pod状态（PodStatus.Phase）由restartPolicy决定。\n\n- \n\nrestartPolicy为Always或OnFailure时，PodStatus.Phase为Pending。\n- \n\nrestartPolicy为Never时，则PodStatus.Phase为Failed。\n\n## 配置示例\n\n- \n\n创建一个设置了最大Pending时长的ECI Pod。\n\nkubectl create -f pending-test.yaml\n\n\npending-test.yaml的内容示例如下，用于模拟镜像拉取失败导致Pod处于Pending状态。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: pending-test\n  labels:\n    alibabacloud.com/eci: \"true\"\n  annotations:\n    k8s.aliyun.com/eci-max-pending-minute: \"10\"    # 设置最大Pending时长为10分钟\nspec:\n  containers:\n  - image: test****-registry.example.com/eci_test/nginx:1.0  # 使用私有镜像来模拟镜像拉取失败，请根据实际替换镜像\n    name: test-container\n  restartPolicy: Never  # 设置重启策略为不自动重启容器\n\n\n- \n\n确认ECI Pod的状态。\n\nkubectl get pod <pod-name> -o=jsonpath='{.status.phase}'\n\n\n示例如下：\n\n- \n\n等待一段时间，待超出设置的最大Pending时长后，确认ECI Pod的状态和事件信息。\n\n- \n\n由于restartPolicy为Never，因此超时后，Pod会处于Failed状态。\n\nkubectl get pod <pod-name> -o=jsonpath='{.status.phase}'\n\n\n示例如下：\n\n- \n\n查看Pod事件，可以看到对应事件信息。\n\nkubectl get events --field-selector involvedObject.name=<pod-name>\n\n\n示例如下：\n\n说明 \n\n您也可以通过[弹性容器实例控制台](https://eci.console.aliyun.com/)确认ECI实例是否为运行失败（Failed）状态，同时在实例详情页的事件页签下查看对应事件信息。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/data-cache-overview", "page_type": "doc", "title": "数据缓存概述", "keywords": "了解ECI数据缓存,评估ECI数据缓存,ECI数据缓存概述,ECI数据缓存应用场景", "last_modified_ms": 1698895224000, "last_modified_iso": "2023-11-02T11:20:24+08:00", "excerpt": "对于一些数据量较大的业务数据，例如训练模型等，ECI支持创建数据缓存（DataCache）来提前拉取数据，将数据缓存到本地，以便在创建ECI实例时可以直接挂载使用，从而减少实例启动耗时，避免数据重复下载，节约使用成本。本文为您介绍什么是数据缓存，包括功能简介、应用场景、创建和使用方式、计费说明等。\n## 功能简介\n\n为了解决数据加载与容器镜像加载解耦的问题，ECI提供了数据缓存的功能。在创建业务应用前，您可以提前创建数据缓存，将业务应用所需的数据缓存到本地。在创建业务应用时，可以直接挂载使用缓存好的数据。\n\n通过数据缓存功能，您无需将数据打包进应用镜像，从而避免因数据变更而频繁更新镜像；也无需从远端的仓库下载数据，避免因下载数据导致应用启动过慢。\n## 应用场景\n\n适合数据量大，或者数据经常更新的场景。例如在机器学习场景下，是否使用数据缓存部署模型应用的流程如下：\n\n- \n\n不使用数据缓存\n\n- \n\n下载模型数据到开发环境。\n- \n\n将模型数据和应用打包制作容器镜像，并创建镜像缓存。\n- \n\n基于镜像缓存部署应用。\n\n- \n\n使用数据缓存\n\n- \n\n创建数据缓存拉取模型数据。\n- \n\n将应用打包制作容器镜像，并创建镜像缓存。\n- \n\n基于镜像缓存和数据缓存部署应用。\n\n从流程可以看出，如果不使用数据缓存，会带来容器镜像过大的问题，并且如果要更新模型，则需要重新制作镜像，重复镜像版本发布、镜像缓存制作，应用部署等工作。如果使用数据缓存，将数据和镜像解耦，在要更新模型时，只需重新制作数据缓存，重新挂载到应用即可。\n## 创建方式\n\n您可以自行设置数据缓存的属性来创建数据缓存。一个数据缓存主要具有以下属性：\n\n- \n\n存储路径\n\n创建时，可以指定数据存储空间（Bucket）以及在空间里的存储路径（Path）。如果没有指定Bucket，默认存储在default。\n- \n\n数据源\n\n一般情况下，业务数据通常存储在NAS文件系统、OSS存储空间等，对于一些模型，可能是存储在[ModelScope](https://www.modelscope.cn/home)或者[HuggingFace](https://huggingface.co/)上。ECI对这些数据源都提供了缓存支持，可以从以下数据源中拉取数据制作数据缓存。\n\n- \n\nURL：具体某一数据下载链接、ModelScope和HuggingFace上的模型和数据集。\n- \n\nNAS：阿里云NAS文件系统。\n- \n\nOSS：阿里云OSS存储空间。\n- \n\nSNAPSHOT：阿里云快照。\n\n- \n\n大小\n\n创建前，您需要根据实际的数据量来确定数据缓存的大小。创建时如果没有指定大小，则数据缓存默认为20 GiB。如果数据量超出20 GiB，数据缓存会创建失败。\n- \n\n保留时长\n\n创建时如果没有设置保留时长，则数据缓存会一直保留。对于不需要长期使用的数据缓存，建议您在创建时设置保留时长，以免产生不必要的快照费用。\n\n## 使用方式\n\n使用数据缓存创建ECI实例时，您可以指定数据缓存Bucket，并通过HostPath的方式直接挂载数据存储路径。此时，系统会自动创建并挂载一块按量付费的云盘。该云盘的容量等于数据缓存大小，随实例一起创建和释放。\n## 计费说明\n\n- \n\n创建数据缓存\n\n创建数据缓存的过程中会自动创建临时资源（ECI实例和云盘），基于临时资源创建一个快照，因此需支付临时资源费用和快照费用。\n- \n\n使用数据缓存\n\n使用数据缓存创建ECI实例时，将为ECI实例自动创建并挂载一个和数据缓存相同大小的云盘，即除ECI实例费用外，需额外支付云盘费用。\n\n更多信息，请参见[数据缓存计费](https://help.aliyun.com/zh/eci/product-overview/data-cache-billing)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/data-caching-overview", "page_type": "doc", "title": "数据缓存概述", "keywords": "了解数据缓存功能,了解数据缓存用法,了解数据缓存计费,数据缓存功能介绍,数据缓存应用场景,数据缓存计费说明", "last_modified_ms": 1698895248000, "last_modified_iso": "2023-11-02T11:20:48+08:00", "excerpt": "对于一些数据量较大的业务数据，例如训练模型等，ECI支持创建数据缓存（DataCache）来提前拉取数据，将数据缓存到本地，以便在创建ECI实例时可以直接挂载使用，从而减少实例启动耗时，避免数据重复下载，节约使用成本。本文为您介绍什么是数据缓存，包括功能简介、应用场景、创建和使用方式、计费说明等。\n## 功能简介\n\n为了解决数据加载与容器镜像加载解耦的问题，ECI提供了数据缓存的功能。在创建业务应用前，您可以提前创建数据缓存，将业务应用所需的数据缓存到本地。在创建业务应用时，可以直接挂载使用缓存好的数据。\n\n通过数据缓存功能，您无需将数据打包进应用镜像，从而避免因数据变更而频繁更新镜像；也无需从远端的仓库下载数据，避免因下载数据导致应用启动过慢。\n## 应用场景\n\n适合数据量大，或者数据经常更新的场景。例如在机器学习场景下，是否使用数据缓存部署模型应用的流程如下：\n\n- \n\n不使用数据缓存\n\n- \n\n下载模型数据到开发环境。\n- \n\n将模型数据和应用打包制作容器镜像，并创建镜像缓存。\n- \n\n基于镜像缓存部署应用。\n\n- \n\n使用数据缓存\n\n- \n\n创建数据缓存拉取模型数据。\n- \n\n将应用打包制作容器镜像，并创建镜像缓存。\n- \n\n基于镜像缓存和数据缓存部署应用。\n\n从流程可以看出，如果不使用数据缓存，会带来容器镜像过大的问题，并且如果要更新模型，则需要重新制作镜像，重复镜像版本发布、镜像缓存制作，应用部署等工作。如果使用数据缓存，将数据和镜像解耦，在要更新模型时，只需重新制作数据缓存，重新挂载到应用即可。\n## 创建方式\n\n您可以自行设置数据缓存的属性来创建数据缓存。一个数据缓存主要具有以下属性：\n\n- \n\n存储路径\n\n创建时，可以指定数据存储空间（Bucket）以及在空间里的存储路径（Path）。如果没有指定Bucket，默认存储在default。\n- \n\n数据源\n\n一般情况下，业务数据通常存储在NAS文件系统、OSS存储空间等，对于一些模型，可能是存储在[ModelScope](https://www.modelscope.cn/home)或者[HuggingFace](https://huggingface.co/)上。ECI对这些数据源都提供了缓存支持，可以从以下数据源中拉取数据制作数据缓存。\n\n- \n\nURL：具体某一数据下载链接、ModelScope和HuggingFace上的模型和数据集。\n- \n\nNAS：阿里云NAS文件系统。\n- \n\nOSS：阿里云OSS存储空间。\n- \n\nSNAPSHOT：阿里云快照。\n\n- \n\n大小\n\n创建前，您需要根据实际的数据量来确定数据缓存的大小。创建时如果没有指定大小，则数据缓存默认为20 GiB。如果数据量超出20 GiB，数据缓存会创建失败。\n- \n\n保留时长\n\n创建时如果没有设置保留时长，则数据缓存会一直保留。对于不需要长期使用的数据缓存，建议您在创建时设置保留时长，以免产生不必要的快照费用。\n\n## 使用方式\n\n使用数据缓存创建ECI实例时，您可以指定数据缓存Bucket，并通过HostPath的方式直接挂载数据存储路径。此时，系统会自动创建并挂载一块按量付费的云盘。该云盘的容量等于数据缓存大小，随实例一起创建和释放。\n## 计费说明\n\n- \n\n创建数据缓存\n\n创建数据缓存的过程中会自动创建临时资源（ECI实例和云盘），基于临时资源创建一个快照，因此需支付临时资源费用和快照费用。\n- \n\n使用数据缓存\n\n使用数据缓存创建ECI实例时，将为ECI实例自动创建并挂载一个和数据缓存相同大小的云盘，即除ECI实例费用外，需额外支付云盘费用。\n\n更多信息，请参见[数据缓存计费](https://help.aliyun.com/zh/eci/product-overview/data-cache-billing)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/declaring-container-types", "page_type": "doc", "title": "强制终止Sidecar容器并忽略容器退出码", "keywords": "强制终止Sidecar,忽略Sidecar退出码,Sidecar环境变量,Sidecar容器配置", "last_modified_ms": 1704937989000, "last_modified_iso": "2024-01-11T09:53:09+08:00", "excerpt": "当您采用Sidecar容器的形式实现类似DaemonSet的效果时，可能会出现Job类Pod无法运行完成的情况，此时可以通过设置环境变量的方式，为Sidecar容器标记容器类型，并设置忽略Sidecar容器的退出码，以保证Job可以正常运行完成。\n## 功能说明\n\n在ACK Serverless集群+ECI场景下，由于虚拟节点的限制，ECI不支持Kubernetes的DaemonSet功能。此时部分需要使用DaemonSet的场景可以采用为ECI Pod添加Sidecar容器的形式来实现类似效果，但该方式在RestartPolicy配置为OnFailure和Never时，会影响ECI Pod的生命周期。例如：运行Job类任务时，为Job添加Filebeat Sidecar容器后，由于业务容器退出后，Filebeat容器会继续运行，会导致Job始终无法达到终态，无法运行完成。\n\n针对上述场景，ECI支持了以下两个功能：\n\n- \n\n声明容器类型\n\n通过设置容器环境变量的方式，为Sidecar容器添加类型标记，可以实现在业务容器已退出且不会重启的情况下，ECI强制终止Sidecar容器的运行，保证Job可以运行完成。\n- \n\n忽略容器退出码\n\n由于ECI强制终止Sidecar容器的运行时，Sidecar容器的退出码为非0（非0表示容器运行失败终止），会导致Job最终的状态为Failed，此时可以通过设置容器环境变量的方式，标记Sidecar容器忽略容器退出码，强制将该容器置为运行成功终止状态，保证Job最终的状态为Succeeded。\n\n## 配置说明\n\n[表格]\n\n配置项\n\n环境变量名称\n\n配置说明\n\n声明容器类型\n\nECI_CONTAINER_TYPE\n\n取值说明如下：\n\n- \n\nnormal：表示容器类型为普通容器。没有设置该环境变量时，默认为normal。\n- \n\nsidecar：表示容器类型为Sidecar容器。\n\n忽略容器退出码\n\nECI_CONTAINER_IGNORE_EXIT_CODE\n\n取值为true时，表示忽略容器退出码。设置了该环境变量的容器运行终止时，如果退出码为非0，ECI会强制将该容器置为运行成功终止状态，并将实际的退出码、失败原因、失败信息以文本形式补充到Message字段中。\n## 配置示例\n\n- \n\n编写Job的YAML配置文件，然后使用该YAML文件创建Job。\n\nkubectl apply -f test-sidecar.yaml\n\n\ntest-sidecar.yaml的内容示例如下，表示创建一个Job，Job内包含两个容器，c1为业务容器，c2为Sidecar容器，并且添加了环境变量声明容器类型，和忽略容器退出码。\n\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: test\nspec:\n  template:\n    metadata:\n      labels:\n        app: test\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: c1\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/perl:5\n        command: [\"perl\",\"-Mbignum=bpi\",\"-wle\",\"print bpi(2000)\"]\n      - name: c2\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/perl:5\n        command: [\"/bin/sh\",\"-c\",\"sleep 999\"] \n        env:\n        - name: ECI_CONTAINER_TYPE\n          value: \"sidecar\"\n        - name: ECI_CONTAINER_IGNORE_EXIT_CODE\n          value: \"true\"\n      restartPolicy: Never\n      backoffLimit: 2\n\n\n- \n\n查看Job详情和对应的Pod详情，观察环境变量的效果。\n\n- \n\n确认Job已经运行完成，且状态为Succeeded。\n\nkubectl describe job <job-name>\n\n\n示例如下：\n\n- \n\n查看Sidecar容器详情，确认实际的退出码和相关信息。\n\nkubectl describe pod <pod-name>\n\n\n示例如下：\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-a-deepseek-r1-model-and-implement-scaling-of-pods-in-the-model", "page_type": "doc", "title": "部署DeepSeek-R1系列模型并实现弹性扩缩容", "keywords": "部署DeepSeek-R1模型,为DeepSeek-R1模型扩缩容,DeepSeek-R1模型部署,DeepSeek-R1模型弹性伸缩,ECI部署大模型实践", "last_modified_ms": 1741845689000, "last_modified_iso": "2025-03-13T14:01:29+08:00", "excerpt": "本文以部署DeepSeek-R1-Distill-Qwen-7B模型为例，演示如何使用DataCache快速部署DeepSeek-R1系列模型，同时通过配置HPA实现基于自定义指标的弹性扩缩容。\n## 为什么使用ECI部署DeepSeek\n\n- \n\nECI具有免运维、灵活部署、高弹性、低成本等优势。更多信息，请参见[产品优势](https://help.aliyun.com/zh/eci/product-overview/benefits)。\n- \n\nECI通过[数据缓存](https://help.aliyun.com/zh/eci/user-guide/data-cache-overview)和[镜像缓存](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-1)功能，可以节约镜像拉取和模型下载的时间，降低网络资源消耗，提升系统效率。说明 \n\n在容器化的大模型推理服务部署中，主要有几个阶段：容器创建与启动、镜像拉取、模型文件下载和推理服务加载模型并启动。由于大模型推理服务的镜像和模型都较大（例如vLLM镜像约16.5 GB，DeepSeek-R1-Distill-Qwen-7B模型约14 GB），需要花费大量时间与网络流量拉取。ECI通过镜像缓存和数据缓存功能，可以节约镜像拉取和模型下载的时间。\n\n## 前提条件\n\n- \n\n集群中已[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n- \n\n集群所属VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建DataCache和部署应用时绑定EIP，以便可以拉取公网数据。\n- \n\n集群中已部署阿里云Prometheus监控组件。具体操作，请参见[使用阿里云Prometheus监控](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/use-managed-service-for-prometheus-to-monitor-an-ack-cluster)。\n- \n\n集群中已部署ack-alibaba-cloud-metrics-adapter组件。\n\n您可以登录[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.0.0.4a54630dqJJh6z)，在市场 > 应用市场页面部署ack-alibaba-cloud-metrics-adapter组件。\n- \n\n集群中已部署KServe。\n\nKServe是一个基于Kubernetes的机器学习模型服务框架，支持以Kubernetes CRD的形式将单个或多个经过训练的模型部署到模型服务运行时。更多信息，请参见[安装ack-kserve️](https://help.aliyun.com/zh/ack/cloud-native-ai-suite/user-guide/installing-ack-kserve-components)。\n\n## 准备运行环境\n\n不同的DeepSeek模型对于运行环境的要求不同，本文以DeepSeek-R1-Distill-Qwen-7B模型为例。\n\n- \n\n规格推荐\n\n需使用的GPU规格要求如下。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。\n\n- \n\nCPU：无严格限制\n- \n\n内存：>16 GiB\n- \n\nGPU：≥1\n- \n\n显存：≥20 GB，例如A10（显存过低可能会出现OOM）\n\n- \n\n软件环境\n\n大模型部署依赖的库和配置较多，vLLM是目前一个主流的大模型推理引擎，本文使用vLLM进行推理服务的部署。ECI已经制作好了一个公共容器镜像，您可以直接使用该镜像或者将其作为基础镜像进行二次开发，镜像地址为registry.cn-hangzhou.aliyuncs.com/eci_open/vllm-openai:v0.7.2，镜像大小约为16.5 GB。\n\n## 步骤一：创建DataCache\n\n首次使用时，提前创建DataCache，可以免去在Pod中拉取模型数据的等待时间，加速部署DeepSeek。\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本示例使用DeepSeek-R1-Distill-Qwen-7B模型的main版本。在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n编写DataCache的YAML配置文件，然后使用该YAML文件创建DataCache拉取DeepSeek-R1-Distill-Qwen-7B模型。\n\nkubectl create -f datacache-test.yaml\n\n\ndatacache-test.yaml的内容示例如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: deepseek-r1-distill-qwen-7b\nspec:\n  bucket: test\n  path: /model/deepseek-r1-distill-qwen-7b\n  dataSource:\n    type: URL\n    options:\n      repoSource: HuggingFace/Model                          # 指定数据源为HuggingFace的模型\n      repoId: deepseek-ai/DeepSeek-R1-Distill-Qwen-7B        # 指定模型ID\n      revision: main                                         # 指定模型版本\n  netConfig:\n    securityGroupId: sg-bp1***********\n    vSwitchId: vsw-bp1uo************                 # 指定已配置SNAT的交换机\n    # 如果交换机没有配置SNAT接入公网，需要自动创建并绑定EIP\n    eipCreateParam:                                  \n      bandwidth: 5                                   # EIP带宽\n\n\n- \n\n查询DataCache状态。\n\nkubectl get edc\n\n\n当数据下载完成，DataCache的状态为Available时，表示可以使用DataCache。阿里云为DeepSeek-R1系列模型提供了热加载能力，能实现DataCache秒级制作完成。\n\nNAME                          AGE   DATACACHEID                STATUS      PROGRESS   BUCKET    PATH\ndeepseek-r1-distill-qwen-7b   40s   edc-uf6btsb4q5j4b9ue****   Available   100%       test      /model/deepseek-r1-distill-qwen-7b\n\n\n## 步骤二：配置GPU指标Adapter Rules\n\n自定义指标的扩缩容依赖ACK提供的ack-alibaba-cloud-metrics-adapter组件与Kubernetes HPA机制实现。GPU HPA目前支持的指标如下，更多信息，请参见[基于GPU指标实现弹性伸缩](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/enable-auto-scaling-based-on-gpu-metrics#section-hh4-ss2-qbu)。\n\n[表格]\n\n指标名称\n\n说明\n\n单位\n\nDCGM_FI_DEV_GPU_UTIL\n\nGPU卡的利用率。该指标仅在独占GPU调度时有效。\n\n%\n\nDCGM_FI_DEV_FB_USED\n\nGPU卡显存使用量。该指标仅在独占GPU调度时有效。\n\nMiB\n\nDCGM_CUSTOM_PROCESS_SM_UTIL\n\n容器的GPU利用率。\n\n%\n\nDCGM_CUSTOM_PROCESS_MEM_USED\n\n容器的GPU显存使用量。\n\nMiB\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/)，在集群列表页面，单击目标集群名称。\n- \n\n在集群管理页的左侧导航栏，选择应用 > Helm。\n- \n\n在Helm列表的操作列，单击ack-alibaba-cloud-metrics-adapter对应的更新。\n\n请根据需要在cus"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-an-imagecache-crd", "page_type": "doc", "title": "部署ImageCache CRD", "keywords": "部署ImageCache CRD,配置ImageCache CRD,ImageCache CRD部署,ImageCache CRD配置", "last_modified_ms": 1723630029000, "last_modified_iso": "2024-08-14T18:07:09+08:00", "excerpt": "自建Kubernetes集群通过部署VNode来使用ECI时，在业务并发量大、对ECI Pod启动速度有要求的场景下，可以通过ECI的镜像缓存（即ImageCache）功能来加快Pod启动速度。使用镜像缓存功能前，您需要在自建Kubernetes集群中部署ImageCache CRD。本文介绍如何部署ImageCache CRD。\n\n## 前提条件\n\n- \n\n自建Kubernetes集群中已部署VNode。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已打通IDC与阿里云的网络。\n\n## 操作步骤\n\n- \n\n准备部署ImageCache CRD的YAML文件。\n\nvim imagecache-crd.yaml\n\n\nimagecache-crd.yaml的内容如下，配置时，需根据实际情况修改标有TODO的配置项。说明 \n\n如果镜像缓存需要拉取公网镜像，配置的交换机所属的VPC必须具有公网访问能力，且安全组需开放公网访问权限。\n\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: imagecaches.eci.alibabacloud.com\nspec:\n  group: eci.alibabacloud.com\n  scope: Cluster\n  names:\n    plural: imagecaches\n    singular: imagecache\n    kind: ImageCache\n    listKind: ImageCacheList\n    shortNames:\n      - imc\n    categories:\n      - all\n  versions:\n    - name: v1\n      served: true\n      storage: true\n      subresources:\n        status: {}\n      additionalPrinterColumns:\n        - name: Age\n          type: date\n          jsonPath: .metadata.creationTimestamp\n        - name: Id\n          type: string\n          jsonPath: .status.imageCacheId\n        - name: Phase\n          type: string\n          jsonPath: .status.phase\n        - name: Progress\n          type: string\n          jsonPath: .status.progress\n      schema:\n        openAPIV3Schema:\n          type: object\n          required:\n            - spec\n          description: \"Imagecache is an image acceleration capability provided by alibabacloud\"\n          properties:\n            status:\n              type: object\n              required:\n                - phase\n                - progress\n              properties:\n                events:\n                  type: array\n                  nullable: true\n                  items:\n                    type: object\n                    properties:\n                      name:\n                        type: string\n                      message:\n                        type: string\n                      type:\n                        type: string\n                      timestamp:\n                        type: string\n                        nullable: true\n                phase:\n                  type: string\n                  default: Pending\n                reason:\n                  type: string\n                  default: \"\"\n                progress:\n                  type: string\n                  default: \"0%\"\n                expireDateTime:\n                  type: string\n                  nullable: true\n                startTime:\n                  type: string\n                  nullable: true\n                lastUpdatedTime:\n                  type: string\n                  nullable: true\n                imageCacheId:\n                  type: string\n                  default: \"\"\n            spec:\n              type: object\n              required:\n                - images\n              properties:\n                images:\n                  type: array\n                  minItems: 1\n                  items:\n                    type: string\n                imagePullSecrets:\n                  type: array\n                  items:\n                    type: string\n                  default: []\n                imageCacheSize:\n                  type: integer\n                  default: 30\n                retentionDays:\n                  type: integer\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: alibabacloud-eci-imagecache-controller\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: alibabacloud:eci:imagecache-controller\nrules:\n  - apiGroups:\n      - apiextensions.k8s.io\n    resources:\n      - customresourcedefinitions\n    verbs:\n      - \"*\"\n  - apiGroups:\n      - \"eci.alibabacloud.com\"\n    resources:\n      - imagecaches\n    verbs:\n      - \"*\"\n  - apiGroups:\n      - \"eci.alibabacloud.com\"\n    resources:\n      - imagecaches/status\n    verbs:\n      - \"*\"\n  - apiGroups:\n      - \"\"\n    resources:\n      - events\n    verbs:\n      - create\n      - patch\n      - update\n  - apiGrou"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd", "page_type": "doc", "title": "部署DataCache CRD", "keywords": "部署DataCache CRD,了解DataCache CRD计费,DataCache CRD部署指南,DataCache CRD部署方法", "last_modified_ms": 1704699830000, "last_modified_iso": "2024-01-08T15:43:50+08:00", "excerpt": "阿里云以DataCache CRD的方式将ECI的数据缓存功能提供给Kubernetes用户，以便Kubernetes用户可以使用该功能来提前拉取大规模数据。本文介绍如何在Kubernetes集群中部署DataCache CRD。\n## 计费说明\n\n- \n\n如果是ACK集群，部署DataCache CRD会默认部署在已有ECS节点上，无需额外付费。\n- \n\n如果是ACK Serverless集群，部署DataCache CRD后会生成一个0.25 vCPU 、0.5 GiB的ECI Pod，收取ECI实例费用。费用=（0.25*vCPU单价+0.5*内存单价）*运行时长。关于ECI实例如何计费，以及vCPU和内存的具体单价，请参见[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances)。\n\n## 准备工作\n\n操作前，请准备好以下信息：\n\n- \n\nAccessKey ID和AccessKey Secret。获取方式请参见[创建AccessKey](https://help.aliyun.com/zh/ram/user-guide/create-an-accesskey-pair)。重要 \n\n请确保AccessKey所属阿里云账号或者RAM用户具有数据缓存相关API的权限。\n- \n\n集群所属的地域ID。\n\n## （推荐）通过Helm部署\n\n- \n\n连接Kubernetes集群。\n- \n\n确认Helm版本。\n\nhelm version\n\n\n- \n\n根据Helm版本选择以下一种方式部署DataCache CRD。\n#### Helm版本为3.7及以上版本\n\n- \n\n如果Helm版本为3.7，需开启实验功能。\n\nHelm版本为3.8及以上版本可跳过该步骤。\n\nexport HELM_EXPERIMENTAL_OCI=1\n\n\n- \n\n设置环境变量。说明 \n\n设置REPO时，请直接使用oci://eci-release-registry.cn-hangzhou.cr.aliyuncs.com/datacache/datacache-operator，无需修改地域ID。\n\nexport REPO=\"oci://eci-release-registry.cn-hangzhou.cr.aliyuncs.com/datacache/datacache-operator\"\nexport AK='<AccessKey ID>'\nexport SK='<AccessKey Secret>'\nexport REGION='<地域ID>'\n\n\n- \n\n部署DataCache CRD。\n\nhelm install datacache-operator $REPO --set accessKey=$AK --set secretKey=$SK --set regionId=$REGION\n\n\n#### Helm版本低于3.7\n\n- \n\n安装阿里云ACR插件。\n\nhelm plugin install https://github.com/AliyunContainerService/helm-acr\n\n\n如果您访问Github比较流畅，可以直接执行上述命令。如果网络不流畅，可以参考以下命令安装。\n\ngit clone https://github.com/AliyunContainerService/helm-acr.git\nsed -i 's/github.com/helm-acr-releases.oss-cn-hangzhou.aliyuncs.com/g' helm-acr/scripts/install_plugin.sh\nhelm plugin install helm-acr\n\n\n- \n\n添加Helm仓库到本地Helm客户端。\n\nhelm repo add datacache acr://eci-release-chart.cn-hangzhou.cr.aliyuncs.com/datacache/datacache-operator\nhelm repo update\n\n\n- \n\n设置环境变量。\n\nexport REPO=\"datacache/datacache-operator\"\nexport AK='<AccessKey ID>'\nexport SK='<AccessKey Secret>'\nexport REGION='<地域ID>'\n\n\n- \n\n部署DataCache CRD。\n\nhelm install datacache-operator $REPO --set accessKey=$AK --set secretKey=$SK --set regionId=$REGION\n\n\n## 通过YAML部署\n\n- \n\n连接Kubernetes集群。\n- \n\n准备DataCache CRD的YAML配置文件，命名为aliyun-datacache-controller.yaml。\n\nYAML配置文件内容如下，请根据实际修改代码中的AccessKey ID（第13行）、AccessKey Secret（第14行）和地域ID（第211行）。\n\n展开查看详细YAML\n\napiVersion: v1 \nkind: Namespace \nmetadata: \n  name: datacache-controller\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: accesskey.eci.aliyun.com\n  namespace: datacache-controller\ntype: Opaque\nstringData:\n  accessKey: ***            #请按实际填写AccessKey ID\n  secretKey: ***            #请按实际填写AccessKey Secret\n---\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  name: datacaches.eci.aliyun.com\nspec:\n  group: eci.aliyun.com\n  scope: Cluster\n  names:\n    kind: DataCache\n    plural: datacaches\n    singular: datacache\n    shortNames:\n      - edc\n    categories:\n      - all\n  versions:\n    - name: v1alpha1\n      served: true\n      storage: true\n      subresources:\n        status: {}\n      schema:\n        openAPIV3Schema:\n          type: object\n          required:\n            - spec\n          properties:\n            spec:\n              type: object\n              required:\n                - path\n                - dataSource\n              properties:\n                bucket:\n                  type: string\n                  default: default\n                  description: 对应一个bucket，缺省为default，eci-system为ECI公共缓存保留空间，不可使用\n                path:\n                  type: string\n                  description: 对应的bucket的目录\n                dataSource:\n                  type: object\n                  description: 缓存数据源\n                  properties:\n                    type:\n                      type: string\n                      description: 支持NAS/OSS/URL/SNAPSHOT等\n                    options:\n                      type: object\n                      description: 具体类型参数，详见DataCache文档\n                      x-kubernetes-preserve-unknown-fields: true\n                size:\n                  type: integer\n                  default: 20\n              "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-deepseek", "page_type": "doc", "title": "部署DeepSeek-R1系列模型", "keywords": "部署DeepSeek-R1模型,加速DeepSeek-R1部署,DeepSeek-R1部署实践,ECI部署DeepSeek-R1", "last_modified_ms": 1741845674000, "last_modified_iso": "2025-03-13T14:01:14+08:00", "excerpt": "本文以部署DeepSeek-R1-Distill-Qwen-7B模型为例，演示如何使用DataCache快速部署DeepSeek-R1系列模型。通过DataCache提前拉取DeepSeek相关模型数据，然后在部署DeepSeek模型推理服务时直接挂载模型数据，可以免去在Pod中拉取模型数据的等待时间，加速DeepSeek部署。\n## 为什么使用ECI部署DeepSeek\n\n- \n\nECI具有免运维、灵活部署、高弹性、低成本等优势。更多信息，请参见[产品优势](https://help.aliyun.com/zh/eci/product-overview/benefits)。\n- \n\nECI通过[数据缓存](https://help.aliyun.com/zh/eci/user-guide/data-cache-overview)和[镜像缓存](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-1)功能，可以节约镜像拉取和模型下载的时间，降低网络资源消耗，提升系统效率。说明 \n\n在容器化的大模型推理服务部署中，主要有几个阶段：容器创建与启动、镜像拉取、模型文件下载和推理服务加载模型并启动。由于大模型推理服务的镜像和模型都较大（例如vLLM镜像约16.5 GB，DeepSeek-R1-Distill-Qwen-7B模型约14 GB），需要花费大量时间与网络流量拉取。ECI通过镜像缓存和数据缓存功能，可以节约镜像拉取和模型下载的时间。\n\n## 前提条件\n\n- \n\n集群中已[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n- \n\n集群所属VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建DataCache和部署应用时绑定EIP，以便可以拉取公网数据。\n\n## 准备运行环境\n\n不同的DeepSeek模型对于运行环境的要求不同，本文以DeepSeek-R1-Distill-Qwen-7B模型为例。\n\n- \n\n规格推荐\n\n需使用的GPU规格要求如下。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。\n\n- \n\nCPU：无严格限制\n- \n\n内存：>16 GiB\n- \n\nGPU：≥1\n- \n\n显存：≥20 GB，例如A10（显存过低可能会出现OOM）\n\n- \n\n软件环境\n\n大模型部署依赖的库和配置较多，vLLM是目前一个主流的大模型推理引擎，本文使用vLLM进行推理服务的部署。ECI已经制作好了一个公共容器镜像，您可以直接使用该镜像或者将其作为基础镜像进行二次开发，镜像地址为registry.cn-hangzhou.aliyuncs.com/eci_open/vllm-openai:v0.7.2，镜像大小约为16.5 GB。\n\n## 步骤一：创建DataCache\n\n首次使用时，需要提前创建DataCache，以免去在Pod中拉取模型数据的等待时间，加速部署DeepSeek。\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本示例使用DeepSeek-R1-Distill-Qwen-7B模型的main版本。在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n编写DataCache的YAML配置文件，然后使用该YAML文件创建DataCache拉取DeepSeek-R1-Distill-Qwen-7B模型。\n\nkubectl create -f datacache-test.yaml\n\n\ndatacache-test.yaml的内容示例如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: deepseek-r1-distill-qwen-7b\nspec:\n  bucket: test\n  path: /model/deepseek-r1-distill-qwen-7b\n  dataSource:\n    type: URL\n    options:\n      repoSource: HuggingFace/Model                          # 指定数据源为HuggingFace的模型\n      repoId: deepseek-ai/DeepSeek-R1-Distill-Qwen-7B        # 指定模型ID\n      revision: main                                         # 指定模型版本\n  netConfig:\n    securityGroupId: sg-bp1***********\n    vSwitchId: vsw-bp1uo************                 # 指定已配置SNAT的交换机\n    # 如果交换机没有配置SNAT接入公网，需要自动创建并绑定EIP\n    eipCreateParam:                                  \n      bandwidth: 5                                   # EIP带宽\n\n\n- \n\n查询DataCache状态。\n\nkubectl get edc\n\n\n当数据下载完成，DataCache的状态为Available时，表示可以使用DataCache。阿里云为DeepSeek-R1系列模型提供了热加载能力，能实现DataCache秒级制作完成。\n\nNAME                          AGE   DATACACHEID                STATUS      PROGRESS   BUCKET    PATH\ndeepseek-r1-distill-qwen-7b   40s   edc-uf6btsb4q5j4b9ue****   Available   100%       test      /model/deepseek-r1-distill-qwen-7b\n\n\n## 步骤二：部署Deepseek模型推理服务\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件部署DeepSeek推理应用。\n\nkubectl create -f deepseek-qwen-server.yaml\n\n\ndeepseek-qwen-server.yaml的内容示例如下，Pod使用GPU规格，并挂载了DeepSeek-R1-Distill-Qwen-7B模型。Pod内的容器使用包含vLLM的镜像，容器启动后会运行vllm serve /deepseek-r1-7b --tensor-parallel-size 1 --max-model-len 24384 --enforce-eager 启动OpenAI-Compatible Server。说明 \n\n以下YAML示例中，系统会自动创建并为Pod绑定一个EIP。如果您的集群所属VPC已绑定公网NAT网关，可去掉该Annotation，在Pod创建成功后，您可以配置DNAT条目实现外部访问Pod。实际业务场景中，建议创建Service来统一提供Pod访问入口。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: deepseek-r1-7b-server\n  labels:\n    alibabacloud.com/eci: \"true\"\n  annotations:\n    k8s.aliyun.com/eci-use-specs: ecs.gn7i-c16g1.4xlarge,ecs.gn7i-c32g1.8xlarge  # 指定GPU实例规格，指定多规格可以降低库存不足的概率\n    k8s.aliyun.com/eci-with-eip: \"true\"                  # 自动创建并绑定EIP，以便外部可以访问\n    k8s.aliyun.com/eci-extra-ephemeral-storage: \"20Gi\"   # 启动依赖的框架较大，需要配置额外的临时存储空间（付费）\n    k8s.aliyun.com/eci-data-cache-bucket: \"test\"         # 指定DataCache Bucket\n    # 对加载速度有更高要求的可以开启AutoPL云盘\n    k8s.aliyun.com/eci-data-cache-provisionedIops: \"15000\"   # 设置ESSD AutoPL云盘预配置的读写IOPS\n    k8s.aliyun.com/eci-data-cache-burstingEnabled: \"true\"    # 设置ESSD AutoPL云盘开启Burst，加速应用启动\nspec:\n  containers:\n    -"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-deepseek-1", "page_type": "doc", "title": "部署DeepSeek-R1系列模型", "keywords": "部署DeepSeek-R1模型,创建模型数据缓存,测试模型推理服务,DeepSeek-R1部署教程,ECI数据缓存实践,vLLM推理服务部署", "last_modified_ms": 1758531782000, "last_modified_iso": "2025-09-22T17:03:02+08:00", "excerpt": "本文以部署DeepSeek-R1-Distill-Qwen-7B模型为例，演示如何使用数据缓存快速部署DeepSeek-R1系列模型。通过数据缓存提前拉取DeepSeek相关模型数据，然后在部署DeepSeek模型推理服务时直接挂载模型数据，可以免去在实例中拉取模型数据的等待时间，加速DeepSeek部署。\n## 为什么使用ECI部署DeepSeek\n\n- \n\nECI具有免运维、灵活部署、高弹性、低成本等优势。更多信息，请参见[产品优势](https://help.aliyun.com/zh/eci/product-overview/benefits)。\n- \n\nECI通过[数据缓存](https://help.aliyun.com/zh/eci/user-guide/data-cache-overview)和[镜像缓存](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-1)功能，可以节约镜像拉取和模型下载的时间，降低网络资源消耗，提升系统效率。说明 \n\n在容器化的大模型推理服务部署中，主要有几个阶段：容器创建与启动、镜像拉取、模型文件下载和推理服务加载模型并启动。由于大模型推理服务的镜像和模型都较大（例如vLLM镜像约16.5 GB，DeepSeek-R1-Distill-Qwen-7B模型约14 GB），需要花费大量时间与网络流量拉取。ECI通过镜像缓存和数据缓存功能，可以节约镜像拉取和模型下载的时间。\n\n## 前提条件\n\n您使用的VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建数据缓存和部署应用时绑定EIP，以便可以拉取公网数据。\n## 准备运行环境\n\n不同的DeepSeek模型对于运行环境的要求不同，本文以DeepSeek-R1-Distill-Qwen-7B模型为例。\n\n- \n\n规格推荐\n\n需使用的GPU规格要求如下。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。\n\n- \n\nCPU：无严格限制\n- \n\n内存：>16 GiB\n- \n\nGPU：≥1\n- \n\n显存：≥20 GB，例如A10（显存过低可能会出现OOM）\n\n- \n\n软件环境\n\n大模型部署依赖的库和配置较多，vLLM是目前一个主流的大模型推理引擎，本文使用vLLM进行推理服务的部署。ECI已经制作好了一个公共容器镜像，您可以直接使用该镜像或者将其作为基础镜像进行二次开发，镜像地址为registry.cn-hangzhou.aliyuncs.com/eci_open/vllm-openai:v0.7.2，镜像大小约为16.5 GB。\n\n## 步骤一：创建数据缓存\n\n首次使用时，需要提前创建数据缓存，以免去在实例中拉取模型数据的等待时间，加速部署DeepSeek。\n## 控制台\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本示例使用DeepSeek-R1-Distill-Qwen-7B模型的main版本。在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在左侧导航栏，单击数据缓存。\n- \n\n创建DeepSeek-R1-Distill-Qwen-7B的数据缓存。\n\n- \n\n单击创建数据缓存。\n- \n\n完成数据缓存参数配置。\n\n本文使用的参数示例如下，其中缓存数据源为拉取DeepSeek-R1-Distill-Qwen-7B模型的固定配置，其他参数可自定义配置，更多信息，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches#3c9228a032ffp)。\n\n[表格]\n\n配置项\n\n示例值\n\n缓存所属Bucket\n\ntest\n\n缓存所属目录\n\n/model/deepseek-r1-distill-qwen-7b\n\n缓存名\n\ndeepseek-qwen-7b\n\n缓存大小\n\n20 GiB\n\n缓存数据源\n\n- \n\n类型：URL\n- \n\n参数\n\n- \n\nrepoSource：HuggingFace/Model\n- \n\nrepoId：deepseek-ai/DeepSeek-R1-Distill-Qwen-7B\n- \n\nrevision：main\n\n- \n\n单击确定。\n\n- \n\n查看数据缓存状态。\n\n在数据缓存页面刷新查看数据缓存状态，当状态为Available时，表示可以使用该数据缓存。阿里云为DeepSeek-R1系列模型提供了热加载能力，能实现数据缓存秒级制作完成。\n\n## OpenAPI\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本示例使用DeepSeek-R1-Distill-Qwen-7B模型的main版本。在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n创建DeepSeek-R1-Distill-Qwen-7B的数据缓存。\n\n调用[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)接口创建数据缓存。建议您使用SDK，关于如何使用SDK，请参见[SDK概览](https://help.aliyun.com/zh/eci/developer-reference/overview-2)。\n\nJava SDK示例如下，表示从HuggingFace拉取指定模型数据，保存到名为test的Bucket的/model/deepseek-r1-distill-qwen-7b目录。\n\nCreateDataCacheRequest request = new CreateDataCacheRequest();\nrequest.setName(\"deepseek-qwen-7b\");\nrequest.setBucket(\"test\");\nrequest.setPath(\"/model/deepseek-r1-distill-qwen-7b\");\nrequest.setVSwitchId(\"vsw-bp1*********\");\nrequest.setSecurityGroupId(\"sg-bp1*********\");\nCreateDataCacheRequest.DataSource dataSource = new CreateDataCacheRequest.DataSource();\ndataSource.setType(\"URL\");\nHashMap<String, String> options = new HashMap<>();\noptions.put(\"repoId\", \"deepseek-ai/DeepSeek-R1-Distill-Qwen-7B\");\noptions.put(\"repoSource\", \"HuggingFace/Model\");\noptions.put(\"revision\", \"main\");\ndataSource.setOptions(options);\nrequest.setDataSource(dataSource);\n\n\n- \n\n查询数据缓存状态。\n\n根据返回的数据缓存ID调用[DescribeDataCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedatacaches)接口查询数据缓存信息，当数据缓存的状态（DataCaches.Status）为Available时，表示可以使用该数据缓存。\n\n## 步骤二：部署DeepSeek模型推理服务\n## 控制台\n\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com/)的容器组页面，单击创建弹性容器组。\n- \n\n填写实例相关配置信息，然后单击配置确认。\n\n本文使用的参数示例如下，实例使用GPU规格，并挂载了DeepSeek-R1-Distill-Qwen-7B模型。容器启动后会运行vllm serve /deepseek-r1-7b --tensor-parallel-size 1 --max-model-len 24384 --enforce-eager启动vLLM推理引擎。重要 \n\n当VPC已绑定公网NAT网关时，创建ECI实例时可以不绑定EIP。在实例创建完成后，您可以配置DNAT条目实现外部访问ECI实例。\n\n[表格]\n\n配置向导页\n\n配置区域\n\n配置项\n\n示例值\n\n基础配置\n\n容器组配置\n\n指定规格\n\necs.gn7i-c16g1.4xlarge\n\n名称\n\ndeepseek-r1-7b-server\n\n高级配置 > 临时存储大小\n\n20 GiB说明 \n\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-pods-in-multiple-zones", "page_type": "doc", "title": "多可用区创建Pod", "keywords": "多可用区创建ECI Pod,提高ECI Pod创建成功率,ECI Pod多可用区部署,ECI Pod库存不足规避", "last_modified_ms": 1731636622000, "last_modified_iso": "2024-11-15T10:10:22+08:00", "excerpt": "当您在应对突发流量，进行业务的快速水平扩容时，或者启动大量ECI Pod进行Job任务处理时，可能会遇到可用区对应规格实例库存不足或者指定的交换机IP耗尽等特殊情况，从而导致Pod创建失败，影响业务。此时，您可以采用指定多可用区的方式来创建ECI Pod（即ECI实例），以提高实例创建的成功率。\n## 前提条件\n\n已在要使用的专有网络VPC下创建多个不同可用区的交换机。\n\n- \n\n关于如何创建交换机，请参见[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n\n## 背景信息\n\n自建Kubernetes集群通过对接VNode来使用ECI时，ECI Pod将采用所属VNode配置的可用区信息（即交换机所属的可用区信息）。如果VNode配置了多个交换机，创建ECI Pod时，系统会随机把请求分散到对应的可用区中来分散压力，如果在某一个可用区遇到没有库存的情况，会自动切换到下一个可用区继续尝试创建。\n\n指定多可用区（交换机）时，需注意以下限制：\n\n- \n\n指定的交换机必须属于同一个VPC。\n- \n\n最多可以指定10个交换机。\n\n您可以配合使用多可用区和多规格的方式来创建ECI Pod，提高创建成功率。\n## 配置说明\n\n- \n\n新建VNode配置\n\n创建VNode时，您可以指定多个交换机实现多可用区功能。具体操作，请参见[创建虚拟节点](https://help.aliyun.com/zh/eci/user-guide/manually-connect-a-vnode-to-a-self-managed-kubernetes-cluster#section-h3v-ejq-xz0)。\n- \n\n已有VNode配置\n\n对于已有VNode，您可以调用UpdateVirtualNode接口更新VNode信息，在VSwitchId字段中可以传入多个交换机ID。更多信息，请参见[UpdateVirtualNode](https://help.aliyun.com/zh/eci/api-updatevirtualnode#section-yaq-p4c-h9o)。\n\n## 后续步骤\n\n如果您采用NAT网关来连接公网，配置多可用区（即多个交换机）后，您需要检查SNAT条目配置是否仍满足需求。\n\n例如：如果原有SNAT条目粒度为交换机粒度，则配置多个交换机后，您需要增加新增交换机对应的条目，保证新交换机下的ECI实例可以访问公网。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-qwq-32b-model", "page_type": "doc", "title": "部署QwQ-32B模型", "keywords": "部署QwQ-32B模型,加速QwQ-32B模型部署,QwQ-32B模型部署教程,QwQ-32B模型推理服务", "last_modified_ms": 1741918917000, "last_modified_iso": "2025-03-14T10:21:57+08:00", "excerpt": "本文以部署QwQ-32B模型为例，演示如何使用DataCache快速部署QwQ-32B模型。通过DataCache提前拉取QwQ-32B模型数据，然后在部署QwQ-32B模型推理服务时直接挂载模型数据，可以免去在Pod中拉取模型数据的等待时间，加速QwQ-32B部署。\n## 为什么使用ECI部署QwQ-32B\n\n- \n\nECI具有免运维、灵活部署、高弹性、低成本等优势。更多信息，请参见[产品优势](https://help.aliyun.com/zh/eci/product-overview/benefits)。\n- \n\nECI通过[数据缓存](https://help.aliyun.com/zh/eci/user-guide/data-cache-overview)和[镜像缓存](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-1)功能，可以节约镜像拉取和模型下载的时间，降低网络资源消耗，提升系统效率。说明 \n\n在容器化的大模型推理服务部署中，主要有几个阶段：容器创建与启动、镜像拉取、模型文件下载和推理服务加载模型并启动。由于大模型推理服务的镜像和模型都较大，需要花费大量时间与网络流量拉取。ECI通过镜像缓存和数据缓存功能，可以节约镜像拉取和模型下载的时间。\n\n## 前提条件\n\n- \n\n集群中已[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n- \n\n集群所属VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建DataCache和部署应用时绑定EIP，以便可以拉取公网数据。\n\n## 准备运行环境\n\n- \n\n规格推荐\n\n推荐使用ecs.gn7i-4x.8xlarge、ecs.gn7i-4x.16xlarge、ecs.gn7i-c32g1.32xlarge及以上GPU规格（4 * A10及以上）。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。说明 \n\n选择规格时，请先确认集群所在地域和可用区支持该规格。更多信息，请参见[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/?spm=a2c4g.11186623.0.0.5805dab1c5ugS2#/instanceTypeByRegion)。\n- \n\n软件环境\n\n大模型部署依赖的库和配置较多，vLLM是目前一个主流的大模型推理引擎，本文使用vLLM进行推理服务的部署。ECI已经制作好了一个公共容器镜像，您可以直接使用该镜像或者将其作为基础镜像进行二次开发，镜像地址为registry.cn-beijing.aliyuncs.com/eci_open/vllm-openai:v0.7.2，镜像大小约为16.5 GB。\n\n## 步骤一：创建DataCache\n\n首次使用时，需要提前创建DataCache，以免去在Pod中拉取模型数据的等待时间，加速部署QwQ-32B。\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用QwQ-32B模型的master版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n编写DataCache的YAML配置文件，然后使用该YAML文件创建DataCache拉取QwQ-32B模型。\n\nkubectl create -f datacache-test.yaml\n\n\ndatacache-test.yaml的内容示例如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: qwq-32b\nspec:\n  bucket: default\n  path: /models/qwq-32b\n  dataSource:\n    type: URL\n    options:\n      repoSource: ModelScope/Model                    # 指定数据源为ModelScope的模型\n      repoId: Qwen/QwQ-32B                            # 指定模型ID   \n  netConfig:\n    securityGroupId: sg-2ze***********\n    vSwitchId: vsw-2ze************\n    eipCreateParam:                                  # 如果交换机没有配置SNAT接入公网，需要自动创建并绑定EIP\n      bandwidth: 5                                   # EIP带宽\n\n\n- \n\n查询DataCache状态。\n\nkubectl get edc\n\n\n当数据下载完成，DataCache的状态为Available时，表示可以使用DataCache。阿里云为QwQ-32B模型提供了热加载能力，能实现DataCache秒级制作完成。\n\nNAME      AGE   DATACACHEID                STATUS      PROGRESS   BUCKET    PATH\nqwq-32b   21s   edc-2ze2qu723g5arodr****   Available   100%       default   /models/qwq-32b\n\n\n## 步骤二：部署QwQ-32B模型推理服务\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件部署QwQ-32B推理应用。\n\nkubectl create -f qwq-32b-server.yaml\n\n\nqwq-32b-server.yaml的内容示例如下，Pod使用GPU规格，并挂载了QwQ-32B模型。Pod内的容器使用包含vLLM的镜像，容器启动后会运行vllm serve /models/QwQ-32B --port 8000 --trust-remote-code --served-model-name qwq-32b --tensor-parallel=4 --max-model-len 8192 --gpu-memory-utilization 0.95 --enforce-eager启动OpenAI-Compatible Server。说明 \n\n以下YAML示例中，系统会自动创建并为Pod绑定一个EIP。如果您的集群所属VPC已绑定公网NAT网关，可去掉该Annotation，在Pod创建成功后，您可以配置DNAT条目实现外部访问Pod。实际业务场景中，建议创建Service来统一提供Pod访问入口。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: qwq-32b-server\n  labels:\n    alibabacloud.com/eci: \"true\"\n  annotations:\n    k8s.aliyun.com/eci-use-specs: ecs.gn7i-4x.8xlarge,ecs.gn7i-4x.16xlarge,ecs.gn7i-c32g1.32xlarge  # 指定GPU实例规格，指定多规格可以降低库存不足的概率\n    k8s.aliyun.com/eci-gpu-driver-version: tesla=535.161.08   # 指定使用的GPU驱动版本\n    k8s.aliyun.com/eci-with-eip: \"true\"                       # 自动创建并绑定EIP，以便外部可以访问\n    k8s.aliyun.com/eci-extra-ephemeral-storage: \"20Gi\"        # 启动依赖的框架较大，需要配置额外的存储空间（付费）\n    k8s.aliyun.com/eci-data-cache-bucket: \"default\"           # 指定DataCache Bucket\n    # 对加载速度有更高要求的可以开启AutoPL云盘\n    k8s.aliyun.com/eci-data-cache-provisionedIops: \"15000\"   # 设置ESSD AutoPL云盘预配置的读写IOPS\n    k8s.aliyun.com/eci-data-cache-burstingEnabled: \"true\"    # 设置ESSD AutoPL云盘开启Burst，加速应用启动\nspec:\n  containers:\n    - name: vllm-container\n      command:\n        - /bin/sh\n      args:\n        - -c\n        - vllm s"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-qwq-32b-model-1", "page_type": "doc", "title": "部署QwQ-32B模型", "keywords": "部署QwQ-32B模型,使用数据缓存加速部署,QwQ-32B模型部署教程,ECI数据缓存应用", "last_modified_ms": 1741918932000, "last_modified_iso": "2025-03-14T10:22:12+08:00", "excerpt": "本文以部署QwQ-32B模型为例，演示如何使用数据缓存快速部署QwQ-32B模型。通过数据缓存提前拉取QwQ-32B模型数据，然后在部署QwQ-32B模型推理服务时直接挂载模型数据，可以免去在实例中拉取模型数据的等待时间，加速QwQ-32B部署。\n## 为什么使用ECI部署QwQ-32B\n\n- \n\nECI具有免运维、灵活部署、高弹性、低成本等优势。更多信息，请参见[产品优势](https://help.aliyun.com/zh/eci/product-overview/benefits)。\n- \n\nECI通过[数据缓存](https://help.aliyun.com/zh/eci/user-guide/data-cache-overview)和[镜像缓存](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-1)功能，可以节约镜像拉取和模型下载的时间，降低网络资源消耗，提升系统效率。说明 \n\n在容器化的大模型推理服务部署中，主要有几个阶段：容器创建与启动、镜像拉取、模型文件下载和推理服务加载模型并启动。由于大模型推理服务的镜像和模型都较大，需要花费大量时间与网络流量拉取。ECI通过镜像缓存和数据缓存功能，可以节约镜像拉取和模型下载的时间。\n\n## 前提条件\n\n您使用的VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建数据缓存和部署应用时绑定EIP，以便可以拉取公网数据。\n## 准备运行环境\n\n- \n\n规格推荐\n\n推荐使用ecs.gn7i-4x.8xlarge、ecs.gn7i-4x.16xlarge、ecs.gn7i-c32g1.32xlarge及以上GPU规格（4 * A10及以上）。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。说明 \n\n选择规格时，请先确认集群所在地域和可用区支持该规格。更多信息，请参见[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/?spm=a2c4g.11186623.0.0.5805dab1c5ugS2#/instanceTypeByRegion)。\n- \n\n软件环境\n\n大模型部署依赖的库和配置较多，vLLM是目前一个主流的大模型推理引擎，本文使用vLLM进行推理服务的部署。ECI已经制作好了一个公共容器镜像，您可以直接使用该镜像或者将其作为基础镜像进行二次开发，镜像地址为registry.cn-beijing.aliyuncs.com/eci_open/vllm-openai:v0.7.2，镜像大小约为16.5 GB。\n\n## 步骤一：创建数据缓存\n## 控制台\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用QwQ-32B模型的master版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在左侧导航栏，单击数据缓存。\n- \n\n创建QwQ-32B的数据缓存。\n\n- \n\n单击创建数据缓存。\n- \n\n完成数据缓存参数配置。\n\n本文使用的参数示例如下，其中缓存数据源为拉取QwQ-32B模型的固定配置，其他参数可自定义配置，更多信息，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches#3c9228a032ffp)。\n\n[表格]\n\n配置项\n\n示例值\n\n缓存所属Bucket\n\ndefault\n\n缓存所属目录\n\n/models/qwq-32b\n\n缓存名\n\nqwq-32b\n\n缓存大小\n\n70 GiB\n\n缓存数据源\n\n- \n\n类型：URL\n- \n\n参数\n\n- \n\nrepoSource：ModelScope/Model\n- \n\nrepoId：Qwen/QwQ-32B\n\n- \n\n单击确定。\n\n- \n\n查看数据缓存状态。\n\n在数据缓存页面刷新查看数据缓存状态，当状态为Available时，表示可以使用该数据缓存。阿里云为QwQ-32B模型提供了热加载能力，能实现数据缓存秒级制作完成。\n\n## OpenAPI\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用QwQ-32B模型的master版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n创建QwQ-32B的数据缓存。\n\n调用[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)接口创建数据缓存。建议您使用[SDK](https://help.aliyun.com/zh/eci/developer-reference/overview-2)。\n\nJava SDK示例如下，表示从ModelScope拉取指定模型数据，保存到名为default的Bucket的/models/qwq-32b目录。\n\nCreateDataCacheRequest request = new CreateDataCacheRequest();\nrequest.setName(\"qwq-32b\");\nrequest.setBucket(\"default\");\nrequest.setPath(\"/models/qwq-32b\");\nrequest.setVSwitchId(\"vsw-2ze*********\");\nrequest.setSecurityGroupId(\"sg-2ze*********\");\nCreateDataCacheRequest.DataSource dataSource = new CreateDataCacheRequest.DataSource();\ndataSource.setType(\"URL\");\nHashMap<String, String> options = new HashMap<>();\noptions.put(\"repoId\", \"Qwen/QwQ-32B\");\noptions.put(\"repoSource\", \"ModelScope/Model\");\ndataSource.setOptions(options);\nrequest.setDataSource(dataSource);\n\n\n- \n\n查询数据缓存状态。\n\n根据返回的数据缓存ID调用[DescribeDataCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedatacaches)接口查询数据缓存信息，当数据缓存的状态（DataCaches.Status）为Available时，表示可以使用该数据缓存。\n\n## 步骤二：部署QwQ-32B模型推理服务说明 \n\n部署QwQ-32B模型推理服务时需要指定GPU驱动版本，控制台暂不支持该功能。\n\n- \n\n使用数据缓存创建ECI实例，部署QwQ-32B。\n\n调用[CreateContainerGroup - 创建一个容器组](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)接口创建ECI实例所采用的参数示例如下，实例使用GPU规格，并挂载了QwQ-32B模型。容器启动后会运行vllm serve /models/QwQ-32B --port 8000 --trust-remote-code --served-model-name qwq-32b --tensor-parallel=4 --max-model-len 8192 --gpu-memory-utilization 0.95 --enforce-eager启动vLLM推理引擎。说明 \n\n以下示例中，系统会自动创建并为ECI实例绑定一个EIP。当VPC已绑定公网NAT网关时，创建ECI实例时可以不绑定EIP。在实例创建完成后，您可以配置DNAT条目实现外部访问ECI实例。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze**************\",\n  \"VSwitchId\": \"vsw-2ze**************\",\n  \"ContainerGroupName\": \"qwq-32b-server\",\n  \"InstanceType\": \"ecs.gn7i-4x.8xlarge,ecs.gn7i-4x.16xlarge,ecs.gn7i-c32g1.32xlarge\",\n  \"DataCac"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploy-the-ccm", "page_type": "doc", "title": "部署CCM", "keywords": "部署CCM,CCM部署指南", "last_modified_ms": 1689734829000, "last_modified_iso": "2023-07-19T10:47:09+08:00", "excerpt": "CCM提供Kubernetes与阿里云基础产品（例如CLB、VPC等）对接的能力，支持在同一个CLB后端挂载集群内节点和集群外服务器，可以解决迁移过程中流量中断的难题，同时还支持将业务流量转发至多个Kubernetes集群，实现备份、容灾等需求，从而保障业务的高可用。本文介绍如何在自建的Kubernetes集群中部署CCM。\n## 前提条件\n\n- \n\n自建Kubernetes集群中已部署VNode。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已打通IDC与阿里云的网络。\n\n## 背景信息\n\nCCM（Cloud Controller Manager）是阿里云提供的一个用于Kubernetes与阿里云基础产品进行对接的组件，目前包括以下功能：\n\n- \n\n管理负载均衡\n\n当Service的类型设置为LoadBalancer时，CCM组件会为该Service创建并配置阿里云负载均衡CLB，包括CLB实例、监听、后端服务器组等资源。当Service对应的后端Endpoint或者集群节点发生变化时，CCM会自动更新CLB的后端服务器组。\n- \n\n实现跨节点通信\n\n当集群网络组件为Flannel时，CCM组件负责打通容器与节点间网络，将节点的Pod网段信息写入VPC的路由表中，从而实现容器的跨节点通信。该功能无需配置，安装即可使用。\n\n更多信息，请参见[Cloud Controller Manager](https://help.aliyun.com/zh/ack/product-overview/cloud-controller-manager#concept-wk1-grd-qfb)。说明 \n\nCCM已经开源，具体项目信息请参见[cloud-provider-alibaba-cloud](https://github.com/kubernetes/cloud-provider-alibaba-cloud)。\n## 准备工作\n\n如果您自建的Kubernetes集群中没有使用阿里云ECS作为节点，可跳过准备工作。如果使用了ECS作为集群节点，需要参考以下步骤配置ECS节点的providerID，使得CCM可以管理这些节点的路由。\n\n- \n\n部署OpenKurise以便使用BroadcastJob。\n\n命令参考如下：\n\nhelm repo add openkruise https://openkruise.github.io/charts/\nhelm repo update\nhelm install kruise openkruise/kruise --version 1.3.0\n\n\n更多信息，请参见[OpenKruise文档](https://openkruise.io/docs/installation)。\n- \n\n通过BroadcastJob为ECS节点配置providerID。\n\n- \n\n将以下内容保存为provider.yaml。\n\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: ecs-node-initor\nrules:\n  - apiGroups:\n      - \"\"\n    resources:\n      - nodes\n    verbs:\n      - get\n      - patch\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: ecs-node-initor\n---\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: ecs-node-initor\nsubjects:\n- kind: ServiceAccount\n  name: ecs-node-initor\n  namespace: default\nroleRef:\n  kind: ClusterRole\n  name: ecs-node-initor\n  apiGroup: rbac.authorization.k8s.io\n---\napiVersion: apps.kruise.io/v1alpha1\nkind: BroadcastJob\nmetadata:\n  name: create-ecs-node-provider-id\nspec:\n  template:\n    spec:\n      serviceAccount: ecs-node-initor\n      restartPolicy: OnFailure\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: type\n                operator: NotIn\n                values:\n                - virtual-kubelet\n      tolerations:\n      - operator: Exists\n      containers:\n        - name: create-ecs-node-provider-id\n          image: registry.cn-beijing.aliyuncs.com/eci-release/provider-initor:v1\n          command: [ \"/usr/bin/init\" ]\n          env:\n          - name: NODE_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: spec.nodeName\n  completionPolicy:\n    type: Never\n  failurePolicy:\n    type: FailFast\n    restartLimit: 3\n\n\n- \n\n部署BroadcastJob。\n\nkubectl apply -f provider.yaml\n\n\n- \n\n查看BroadcastJob执行结果。\n\nkubectl get pods -o wide\n\n\n如果create-ecs-node-provider-id相关的Pod均达到Completed状态，则表示相应ECS节点的ProviderID已经配置成功。返回示例如下：\n- \n\n（可选）清理BroadcastJob。\n\nkubectl delete -f provider.yaml\n\n\n## 操作步骤\n\n- \n\n创建ConfigMap。\n\n- \n\n将您的阿里云账号对应的AccessKey保存到环境变量。\n\nexport ACCESS_KEY_ID=LTAI********************\nexport ACCESS_KEY_SECRET=HAeS**************************\n\n\n关于如何获取AccessKey ID和AccessKey Secret，请参见[获取AccessKey](https://help.aliyun.com/document_detail/175967.html#task-354412)。\n- \n\n执行以下脚本创建ConfigMap。\n\n将以下内容保存为configmap-ccm.sh，并根据实际替换代码中的region值，然后执行脚本。\n\n#!/bin/bash\n\n## create ConfigMap kube-system/cloud-config for CCM.\naccessKeyIDBase64=echo -n \"$ACCESS_KEY_ID\" |base64 -w 0\naccessKeySecretBase64=echo -n \"$ACCESS_KEY_SECRET\"|base64 -w 0\n\ncat <<EOF >cloud-config.yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: cloud-config\n  namespace: kube-system\ndata:\n  cloud-config.conf: |-\n    {\n        \"Global\": {\n            \"accessKeyID\": \"$accessKeyIDBase64\",\n            \"accessKeySecret\": \"$accessKeySecretBase64\",\n            \"region\": \"cn-hangzhou\"\n        }\n    }\nEOF\n\nkubectl create -f cloud-config.yaml\n\n\nbash configmap-ccm.sh\n\n\n执行脚本后，系统将在Kube-system下创建一个名为cloud-config的ConfigMap。\n\n- \n\n部署CCM。\n\n- \n\n修改${ImageVersion}和{$C"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploying-tongyi-qiwen-application", "page_type": "doc", "title": "部署通义千问应用", "keywords": "部署通义千问应用,用DataCache加速部署,通义千问部署实践,DataCache使用方法,ECI部署大模型", "last_modified_ms": 1741845599000, "last_modified_iso": "2025-03-13T13:59:59+08:00", "excerpt": "本文以ModelScope社区的通义千问-7B-Chat模型为例，演示如何使用DataCache。通过DataCache提前拉取通义千问-7B-Chat模型数据，然后在创建通义千问的应用Pod时直接挂载模型数据，可以免去在Pod中拉取模型数据的等待时间，加速应用部署。\n## 背景信息\n\n通义千问-7B（Qwen-7B）是阿里云研发的通义千问大模型系列的70亿参数规模的模型。基于Transformer的大语言模型，在超大规模的预训练数据上进行训练得到了Qwen-7B。本文使用的通义千问-7B-Chat是在Qwen-7B的基础上，使用对齐机制打造了基于大语言模型的AI助手。更多信息，请参见[Qwen-7B-Chat](https://modelscope.cn/models/qwen/Qwen-7B-Chat/summary)。\n## 前提条件\n\n- \n\n集群中已[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n- \n\n集群所属VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建DataCache和部署应用时绑定EIP，以便可以拉取公网数据。\n\n## 准备运行环境\n\n- \n\n硬件要求\n\n需使用的GPU规格要求如下。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。\n\n- \n\nCPU：无严格限制\n- \n\n内存：>16 GiB\n- \n\nGPU：≥1\n- \n\n显存：>16 GB（显存过低可能会出现OOM）\n\n- \n\n软件环境\n\n通义千问-7B-Chat依赖的库和配置较多，ECI已经制作好了一个公共容器镜像，包含了一个基于Gradio的WebUI，您可以直接使用该镜像或者将其作为基础镜像进行二次开发。镜像地址为registry.cn-hangzhou.aliyuncs.com/eci_open/qwen-webui:1.0.0，大小约为15 GB。\n\n## 操作步骤\n### 创建DataCache\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用通义千问-7B-Chat模型的v1.1.4版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n编写DataCache的YAML配置文件，然后使用该YAML文件创建DataCache拉取通义千问-7B-Chat模型。\n\nkubectl create -f datacache-test.yaml\n\n\ndatacache-test.yaml的内容示例如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: qwen\nspec:\n  bucket: test  \n  path: /model/qwen/ \n  dataSource:\n    type: URL \n    options:\n      repoSource: ModelScope/Model              # 指定数据源为ModelScope的模型\n      repoId: qwen/Qwen-7B-Chat                 # 指定模型ID\n      revision: v1.1.4                          # 指定模型版本\n  retentionDays: 1\n  netConfig: \n    securityGroupId: sg-2ze63v3jtm8e6s******\n    vSwitchId: vsw-2ze94pjtfuj9vay******       # 指定已配置SNAT的交换机\n\n\n- \n\n查询DataCache状态。\n\nkubectl get edc\n\n\n当数据下载完成，DataCache的状态为Available时，表示可以使用DataCache。示例如下：\n\n### 部署通义千问应用\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件部署通义千问应用。\n\nkubectl create -f qwen.yaml\n\n\nqwen.yaml的内容示例如下，可以创建一个包含1个Pod副本的Deployment，Pod使用GPU规格，并挂载了通义千问模型。Pod内容器使用包含通义千问WebUI应用的镜像，容器启动后会运行python Qwen-7B/web_demo.py --server_port 8888启动WebUI。说明 \n\n以下YAML示例中，系统会自动创建并为Pod绑定一个EIP。如果您的集群所属VPC已绑定公网NAT网关，可去掉该Annotation，在Pod创建成功后，您可以配置DNAT条目实现外部访问Pod。实际业务场景中，建议创建Service来统一提供Pod访问入口。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: qwen-web\n  labels:\n    app: qwen\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: qwen\n  template:\n    metadata:\n      name: qwen\n      labels:\n        app: qwen\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.gn7i-c8g1.2xlarge\"    # 指定GPU规格\n        k8s.aliyun.com/eci-data-cache-bucket: \"test\"             # 指定DataCache Bucket\n        k8s.aliyun.com/eci-data-cache-provisionedIops: \"35000\"   # 设置ESSD AutoPL云盘预配置的读写IOPS\n        k8s.aliyun.com/eci-data-cache-burstingEnabled: \"true\"    # 设置ESSD AutoPL云盘开启Brust，加速应用启动\n        k8s.aliyun.com/eci-with-eip: \"true\"                      # 自动创建并绑定EIP，以便外部可以访问\n    spec:\n      containers:\n      - name: qwen\n        image: registry.cn-hangzhou.aliyuncs.com/eci_open/qwen-webui:1.0.0  # 使用制作好的通义千问镜像\n        resources:\n            limits:\n              nvidia.com/gpu: \"1\"           # 设置容器所需的GPU数\n        command: [\"/bin/sh\"]\n        args: [\"-c\",\"python Qwen-7B/web_demo.py --server_port 8888\"]    # 启动WebUI\n        volumeMounts:\n        - name: \"model-qwen\"\n          mountPath: \"/data/model/\"         # 模型数据在容器内的挂载路径\n      volumes: \n      - name: \"model-qwen\"\n        hostPath:             \n          path: \"/model/qwen/\"    # 挂载模型数据\n\n\n- \n\n确认应用部署状态。\n\nkubectl get deployment qwen-web\nkubectl get Pod\n\n\n示例如下，可以看到通义千问应用已经部署成功。\n\n- \n\n确认模型数据的挂载情况。\n\nkubectl exec -it <POD_NAME> -- bash\nls /data/model\n\n\n示例如下，可以看到容器的/data/model目录下已挂载模型数据。\n\n- \n\n查看Pod绑定的EIP地址。\n\nkubectl describe pod <pod_name>\n\n\n在返回的Pod详情的Annotations中可以获取Pod绑定的EIP地址。\n\n### 测试模型效果\n\n- \n\n在Pod所属安全组中添加入方向规则，开放8888端口。\n- \n\n打开浏览器，访问通义千问的Web页面。\n\n本文示例的通义千问应用已单独绑定了EIP，可以直接输入Pod的EIP地址和容器开放的端口进行访问，例如39.106.XX.XX:8888。\n- \n\n输入文本，测试通义千问-7B-Chat的模型效果。\n\n示例如下：\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/deploying-tongyi-qiwen-application-1", "page_type": "doc", "title": "部署通义千问应用", "keywords": "部署通义千问应用,创建模型数据缓存,通义千问部署实践,ECI数据缓存实践", "last_modified_ms": 1716255391000, "last_modified_iso": "2024-05-21T09:36:31+08:00", "excerpt": "本文以部署ModelScope社区的通义千问-7B-Chat模型为例，演示如何使用数据缓存。通过数据缓存提前拉取通义千问-7B-Chat模型数据，然后在创建通义千问的应用实例时直接挂载模型数据，可以免去在实例中拉取模型数据的等待时间，加速应用部署。\n## 背景信息\n\n通义千问-7B（Qwen-7B）是阿里云研发的通义千问大模型系列的70亿参数规模的模型。基于Transformer的大语言模型，在超大规模的预训练数据上进行训练得到了Qwen-7B。本文使用的通义千问-7B-Chat是在Qwen-7B的基础上，使用对齐机制打造了基于大语言模型的AI助手。更多信息，请参见[Qwen-7B-Chat](https://modelscope.cn/models/qwen/Qwen-7B-Chat/summary)。\n## 前提条件\n\n您使用的VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建数据缓存和部署应用时绑定EIP，以便可以拉取公网数据。\n## 准备运行环境\n\n- \n\n硬件要求\n\n需使用的GPU规格要求如下。ECI支持的GPU规格，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification#ec747e2059dco)。\n\n- \n\nCPU：无严格限制\n- \n\n内存：>16 GiB\n- \n\nGPU：≥1\n- \n\n显存：>16 GB（显存过低可能会出现OOM）\n\n- \n\n软件环境\n\n通义千问-7B-Chat依赖的库和配置较多，ECI已经制作好了一个公共容器镜像，包含了一个基于Gradio的WebUI，您可以直接使用该镜像或者将其作为基础镜像进行二次开发。镜像地址为registry.cn-hangzhou.aliyuncs.com/eci_open/qwen-webui:1.0.0，大小约为15 GB。\n\n## 操作步骤\n### 创建数据缓存\n## 控制台\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用通义千问-7B-Chat模型的v1.1.4版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/)。\n- \n\n在顶部菜单栏左上角处选择地域。\n- \n\n在左侧导航栏，单击数据缓存。\n- \n\n创建通义千问-7B-Chat的数据缓存。\n\n- \n\n单击创建数据缓存。\n- \n\n完成数据缓存参数配置。\n\n本文使用的参数示例如下，其中缓存数据源为拉取通义千问-7B-Chat模型的固定配置，其他参数可自定义配置，更多信息，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches#3c9228a032ffp)。\n\n[表格]\n\n配置项\n\n示例值\n\n缓存所属Bucket\n\ntest\n\n缓存所属目录\n\n/model/qwen/\n\n缓存名\n\nqwen\n\n缓存大小\n\n20 GiB\n\n缓存数据源\n\n- \n\n类型：URL\n- \n\n参数\n\n- \n\nrepoSource：ModelScope/Model\n- \n\nrepoId：qwen/Qwen-7B-Chat\n- \n\nrevision：v1.1.4\n\n- \n\n单击确定。\n\n- \n\n查看数据缓存状态。\n\n在数据缓存页面刷新查看数据缓存状态，当状态为Available时，表示可以使用该数据缓存。\n\n## OpenAPI\n\n- \n\n访问[ModelScope](https://www.modelscope.cn/home)，获取模型ID。\n\n本示例使用通义千问-7B-Chat模型的v1.1.4版本。在ModelScope找到目标模型后，在模型详情页面顶部可以复制模型ID。\n- \n\n创建通义千问-7B-Chat的数据缓存。\n\n调用[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)接口创建数据缓存所采用的参数示例如下，表示从ModelScope拉取指定模型数据，保存到名为test的Bucket的/model/qwen/目录。数据缓存名为qwen，保留时长为1天。重要 \n\n如果您通过SDK创建数据缓存，DataSource.Options中的各个参数前无需添加参数名的长度，例如#10#repoSource直接写成repoSource，#6#repoId直接写成repoId即可。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze7l1o0ql1cbk******\",\n  \"VSwitchId\": \"vsw-2ze23nqzig8inpr******\",\n  \"Bucket\": \"test\",\n  \"Path\": \"/model/qwen/\",\n  \"Name\": \"qwen\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#6#repoId\": \"qwen/Qwen-7B-Chat\",\n      \"#10#repoSource\": \"ModelScope/Model\"\n      \"#8#revision\": \"v1.1.4\"\n    }\n  },\n  \"RetentionDays\": 1\n}\n\n\n- \n\n查询数据缓存状态。\n\n根据返回的数据缓存ID调用[DescribeDataCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedatacaches)接口查询数据缓存信息，当数据缓存的状态（DataCaches.Status）为Available时，表示可以使用该数据缓存。\n\n### 部署通义千问应用\n## 控制台\n\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com/)的容器组页面，单击创建弹性容器组。\n- \n\n填写实例相关配置信息，然后单击配置确认。\n\n本文使用的参数示例如下，实例使用GPU规格，并挂载了通义千问模型。实例内容器使用包含通义千问WebUI应用的镜像，容器启动后会运行python Qwen-7B/web_demo.py --server_port 8888启动WebUI。重要 \n\n当VPC已绑定公网NAT网关时，创建ECI实例时可以不绑定EIP。在实例创建完成后，您可以配置DNAT条目实现外部访问ECI实例。\n\n[表格]\n\n配置区域\n\n配置项\n\n示例值\n\n容器组配置\n\n指定规格\n\necs.gn6i-c16g1.4xlarge\n\n名称\n\nqwen-web\n\n容器配置\n\n容器名称\n\nqwen\n\n镜像\n\n- \n\n镜像：registry.cn-hangzhou.aliyuncs.com/eci_open/qwen-webui\n- \n\n版本：1.0.0\n\n可执行命令\n\n/bin/sh\n\n参数\n\n- \n\n-c\n- \n\npython Qwen-7B/web_demo.py --server_port 8888\n\n数据缓存\n\n缓存Bucket\n\ntest\n\n单击添加，挂载通义千问-7B-Chat的数据缓存\n\n- \n\n缓存目录：/model/qwen/\n- \n\n目标容器：qwen\n- \n\n容器挂载目录：/data/model/\n\n开启Burst\n\n开启\n\n弹性公网IP\n\n弹性公网IP\n\n- \n\n自动创建\n- \n\n带宽峰值：5 Mbps\n\n- \n\n确认实例配置信息，阅读并选中服务协议，单击确认订单。\n- \n\n返回容器组页面，确认应用部署状态并查看实例的EIP地址。\n\n在容器组页面可以查看实例状态，单击实例ID进入实例详情页可以查看容器状态。当实例状态和容器状态均为运行中时，表示应用部署成功。您可以在IP地址列获取实例的EIP地址。\n\n## OpenAPI\n\n- \n\n使用数据缓存创建ECI实例，部署通义千问应用。\n\n调用[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)接口创建ECI实例所采用的参数示例如下，该实例使用GPU规格，并挂载了通义千问模型。实例内容器使用包含通义千问WebUI应用的镜像，容器启动后会运行python Qwen-7B/web_demo.py --server_port 8888启动WebUI。说明 \n\n以下示例中，系统会自动创建并为ECI实例绑定一个EIP。当VPC已绑定公网NAT网关时，创建ECI实例时可以不绑定EIP。在实例创建完成后，您可以配置DNAT条目实现外部访问ECI实例。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze7l1o0ql1cbk******\",\n  \"V"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/eci-custom-condition", "page_type": "doc", "title": "ECI自定义condition", "keywords": "查询ECI condition含义,理解ECI Pod状态,ECI condition说明,ECI Pod状态码", "last_modified_ms": 1705400031000, "last_modified_iso": "2024-01-16T18:13:51+08:00", "excerpt": "Pod status condition可以提供Pod状态和健康状况的信息。本文汇总了ECI Pod（即ECI实例）的condition并给出说明。\n## ContainerInstanceCreated\n\ncondition ContainerInstanceCreated用于表示ECI Pod的创建状态，reason、message及其说明如下：\n\n[表格]\n\nreason\n\nmessage\n\n说明\n\nCreating\n\nCreating\n\nECI Pod正在创建中。\n\nStockExhaust\n\nThe stock of the specified zones will be used up. %s\n\n当前可用区的ECI资源库存即将耗尽。建议更换可用区。\n\nNoStock\n\nCreate ECI failed because the specified instance is out of stock. %s\n\n当前可用区的ECI资源库存不足。您可以使用多可用区和多规格的方式创建ECI Pod来提高创建成功率。\n\nStockClose\n\nCreate ECI failed because current zone closed or limited without living instance. %s\n\n由于无法使用当前可用区，导致创建ECI Pod失败。请更换可用区。\n\nFailedScheduling\n\nUnknown error occurred.\n\n由于发生未知错误，导致调度ECI Pod失败。请提交工单。\n\nFailedScheduling\n\nSchedule eci failed:%s\n\n调度ECI Pod失败。请重新尝试。\n\nUnknownError\n\nThe ECI service is under heavy load while creating container group resources, please wait and try again later\n\nECI服务负载过大。请稍后再尝试创建ECI Pod。\n\nSpotToBeReleased\n\nSpot ECI will be released in %s minutes\n\n抢占式实例即将过期。请尽快在业务上进行兼容处理。\n\nDiskCapacityQuotaFull\n\nYour disk capacity quota is exceeded\n\n磁盘容量已达到配额限制。请至[配额中心](https://quotas.console.aliyun.com/products/ecs/quotas)申请提升配额。\n\nUnknownError\n\nAn unknown error occurred for %s\n\n发生未知错误。请提交工单。\n\nCpuOptionsNotSupported\n\nThe cpu options is not supported for your instanceType[%s] in current region\n\n当前可用区下，您的ECI Pod不支持自定义CPU选项。\n\nCpuOptionsNotValid\n\nThe cpu options is not valid for your instanceType[%s]\n\n您的ECI Pod不支持自定义CPU选项。\n\nSystemFailureReboot\n\nThe Specified ContainerGroup is rebooting\n\nECI Pod正在重新启动。\n\nSystemReboot\n\nIt is strongly recommended that you re-create this instance within 48 hours because of %s, otherwise, the pod will be forced to restart.\n\n建议您在48小时内重新创建该ECI Pod，否则系统会强制重启该ECI Pod。\n\nThrottling\n\nThe request was denied due to system flow control, please wait and try again later\n\n由于系统流量控制，请求被拒绝。请稍后再尝试操作。\n\nSpotDegraded\n\nSpot [%s] will be degraded because the specified instance is out of stock\n\n创建抢占式实例时，由于没有满足要求的库存，自动转为按量付费实例。\n\nAutoInstanceTypeMatch\n\nThe most-matched instanceType for current eci instance is %s\n\nECI Pod的规格已进行资源规整。\n\nMultiZoneRecommendations\n\n%s\n\n建议使用多可用区方式创建ECI Pod。\n## SandboxReady\n\ncondition SandboxReady用于表示沙箱是否可用。reason代表部分主动运维事件，message来自系统事件message。\n\n[表格]\n\nreason\n\nmessage\n\n说明\n\nSystemFailure.Reboot\n\n%s\n\n因系统错误重启ECI Pod。\n\nInstanceFailure.Reboot\n\n%s\n\n因操作系统错误重启ECI Pod。\n\nSystemFailure.Redeploy\n\n%s\n\n因系统错误重新部署ECI Pod。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/enable-internet-access", "page_type": "doc", "title": "为ECI实例配置公网连接", "keywords": "配置ECI公网连接,ECI实例绑定EIP,ECI公网连接配置,ECI公网连接方式", "last_modified_ms": 1704965107000, "last_modified_iso": "2024-01-11T17:25:07+08:00", "excerpt": "默认情况下，系统只为ECI实例分配一个私网IP，如果您的ECI实例有连接公网的需求，例如需要拉取公网镜像等，您可以为其绑定EIP，或者在所属VPC中创建NAT网关，以实现ECI实例与公网互通。\n## 背景信息\n\n为ECI实例配置公网连接时，支持以下两种方式：\n\n[表格]\n\n方式\n\n说明\n\n适用场景\n\n绑定EIP\n\nEIP是独立购买的可单独持有的公网IP地址，可以为绑定的ECI实例提供公网服务。更多信息，请参见[什么是弹性公网IP](https://help.aliyun.com/zh/eip/product-overview/what-is-eip)和[EIP计费概述](https://help.aliyun.com/zh/eip/product-overview/billing-overview/#concept-645525)。\n\n单个ECI实例。\n\n例如：您有一个ECI实例用于部署Nginx服务，在创建实例时，您需要为该实例绑定EIP。当Nginx启动时，将自动暴露80端口到EIP。您可以通过EIP地址加端口的方式访问Nginx服务。\n\n在所属VPC中创建公网NAT网关\n\nNAT网关是一种网络地址转换服务，提供NAT代理（SNAT和DNAT）能力。更多信息，请参见[什么是NAT网关](https://help.aliyun.com/zh/nat-gateway/product-overview/what-is-nat-gateway)和[公网NAT网关计费](https://help.aliyun.com/zh/nat-gateway/nat-gateway-billing#concept-z13-hty-ydb)。\n\n多个ECI实例。\n\n例如：您有多个ECI实例需要从Docker Hub拉取镜像，由于ECI默认不提供公网链接进行公网镜像的拉取，您需要在实例所属VPC中创建公网NAT网关并完成规则配置，否则无法拉取镜像。重要 \n\n为ECI实例配置公网连接时，请确保ECI实例所属的安全组已放行相关地址和端口。更多信息，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n## 为ECI实例绑定EIP\n\n创建ECI实例时，您可以直接为ECI实例绑定已有EIP，或者自动创建并绑定一个EIP。说明 \n\nEIP只支持为所绑定的ECI实例提供公网服务，一个EIP只能绑定一个ECI实例。如果您有多个ECI实例需要连接公网，您需要分别为其绑定EIP，或者在所属VPC中创建公网NAT网关。\n## OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过EipInstanceId参数来绑定已有EIP，或者通过AutoCreateEip和EipBandwidth参数来创建并绑定一个EIP。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup#undefined)。\n\n- \n\n绑定已有EIP\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nEipInstanceId\n\nString\n\neip-uf66jeqopgqa9hdn****\n\n指定EIP，将其绑定到ECI实例上。\n- \n\n自动创建并绑定EIP\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nAutoCreateEip\n\nBoolean\n\ntrue\n\n配置为true表示自动创建一个EIP，并将其绑定到ECI实例上。\n\nEipBandwidth\n\nInteger\n\n5\n\n设置EIP带宽。单位为Mbps。默认为5 Mbps。\n\nEipISP\n\nString\n\nBGP\n\n设置EIP线路类型，仅按量付费的EIP支持指定。取值范围：\n\n- \n\nBGP（默认值）：BGP（多线）线路\n- \n\nBGP_PRO：BGP（多线）精品线路\n\n更多信息，请参见[EIP线路类型](https://help.aliyun.com/zh/eip/product-overview/what-is-eip#section-vzi-lqi-chm)。\n\nEipCommonBandwidthPackage\n\nString\n\ncbwp-2zeukbj916scmj51m****\n\n绑定已有的共享带宽。更多信息，请参见[共享带宽](https://help.aliyun.com/zh/internet-shared-bandwidth/product-overview/what-is-internet-shared-bandwidth)。\n\n## 控制台\n\n创建ECI实例时，完成基础配置后，在其他设置处，您可以直接为ECI实例绑定EIP。支持使用已有EIP或者自动创建EIP。\n\n## 在所属VPC中创建公网NAT网关\n\n在VPC中创建公网NAT网关后，公网NAT网关可以提供NAT代理（SNAT和DNAT）功能，使得该VPC中的ECI实例可以连接公网。\n\n[表格]\n\n功能\n\n说明\n\nSNAT\n\n可以为VPC中没有公网IP的ECI实例提供访问公网的代理服务。\n\nDNAT\n\n可以将公网NAT网关绑定的EIP映射给VPC中的ECI实例使用，使其能够面向公网提供服务。\n\n- \n\n在[专有网络控制台](https://vpcnext.console.aliyun.com/vpc)创建公网NAT网关。具体操作，请参见[创建和管理公网NAT网关实例](https://help.aliyun.com/zh/nat-gateway/user-guide/use-internet-nat-gateway-for-public-network-access#section-zza-vu9-ppx)。\n- \n\n如果您的ECI实例需要访问公网，您需要创建SNAT条目。具体操作，请参见[创建和管理SNAT条目](https://help.aliyun.com/zh/nat-gateway/create-a-snat-entry#task-491135)。\n\n创建时需要注意的参数如下：\n\n[表格]\n\n参数\n\n描述\n\nSNAT条目粒度\n\n请结合业务组网和安全性等因素进行选择：\n\n- \n\nVPC粒度：NAT网关所属VPC内的所有ECI实例均可以通过SNAT功能访问公网。\n- \n\n交换机粒度：所选交换机下的ECI实例均可以通过SNAT功能访问公网。\n- \n\n自定义网段粒度：指定网段内的ECI实例均可以通过SNAT功能访问公网。\n\n选择交换机\n\n当SNAT条目粒度选择交换机粒度时，选择用于创建ECI实例的交换机，支持配置多个。\n\n自定义网段\n\n当SNAT条目粒度选择自定义网段粒度时，设置要访问公网的ECI实例的所属网段。\n\n选择公网IP地址\n\n选择NAT网关绑定的EIP（单个或多个），用于访问公网。说明 \n\n如果ECI实例已经绑定了EIP，则优先使用ECI实例绑定的EIP来访问公网，而不会使用NAT网关的SNAT功能访问公网。\n- \n\n如果您的ECI实例需要面向公网提供服务，您需要创建DNAT条目。具体操作，请参见[创建和管理DNAT条目](https://help.aliyun.com/zh/nat-gateway/create-a-dnat-entry#task-491131)。\n\n创建时需要注意的参数如下：\n\n[表格]\n\n参数\n\n描述\n\n选择公网IP地址\n\n选择NAT网关绑定的EIP，用于公网访问。\n\n选择私网IP地址\n\n选择要通过DNAT规则进行公网通信的ECI实例，支持指定ECI实例对应的弹性网卡，或者手动输入ECI实例的私网IP。\n\n端口设置\n\n选择DNAT映射的方式：\n\n- \n\n任意端口：该方式输入IP映射。任何访问NAT网关所绑定EIP的请求都将转发到目标ECI实例。\n- \n\n具体端口：该方式输入端口映射。NAT网关会将以指定协议和端口访问NAT网关所绑定EIP的请求转发到目标ECI实例的指定端口上。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/enable-internet-access-1", "page_type": "doc", "title": "为ECI Pod配置公网连接", "keywords": "配置ECI Pod公网连接,为ECI Pod绑定EIP,为ECI Pod配置NAT网关,ECI Pod公网连接方法,ECI Pod绑定EIP配置,ECI Pod公网NAT网关配置", "last_modified_ms": 1704965076000, "last_modified_iso": "2024-01-11T17:24:36+08:00", "excerpt": "默认情况下，系统只为ECI Pod（即ECI实例）分配一个私网IP，如果您的ECI Pod有连接公网的需求，例如需要拉取公网镜像等，您可以为其绑定EIP，或者在所属VPC中创建公网NAT网关，以实现ECI Pod与公网互通。\n## 背景信息\n\n为ECI实例配置公网连接时，支持以下两种方式：\n\n[表格]\n\n方式\n\n说明\n\n适用场景\n\n绑定EIP\n\nEIP是独立购买的可单独持有的公网IP地址，可以为绑定的ECI实例提供公网服务。更多信息，请参见[什么是弹性公网IP](https://help.aliyun.com/zh/eip/product-overview/what-is-eip)和[EIP计费概述](https://help.aliyun.com/zh/eip/product-overview/billing-overview/#concept-645525)。\n\n单个ECI实例。\n\n例如：您有一个ECI实例用于部署Nginx服务，在创建实例时，您需要为该实例绑定EIP。当Nginx启动时，将自动暴露80端口到EIP。您可以通过EIP地址加端口的方式访问Nginx服务。\n\n在所属VPC中创建公网NAT网关\n\nNAT网关是一种网络地址转换服务，提供NAT代理（SNAT和DNAT）能力。更多信息，请参见[什么是NAT网关](https://help.aliyun.com/zh/nat-gateway/product-overview/what-is-nat-gateway)和[公网NAT网关计费](https://help.aliyun.com/zh/nat-gateway/nat-gateway-billing#concept-z13-hty-ydb)。\n\n多个ECI实例。\n\n例如：您有多个ECI实例需要从Docker Hub拉取镜像，由于ECI默认不提供公网链接进行公网镜像的拉取，您需要在实例所属VPC中创建公网NAT网关并完成规则配置，否则无法拉取镜像。重要 \n\n为ECI实例配置公网连接时，请确保ECI实例所属的安全组已放行相关地址和端口。更多信息，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n## 为ECI实例绑定EIP\n\n创建ECI Pod时，您可以在Pod metadata中添加Annotation来绑定已有EIP，或者自动创建并绑定一个EIP。说明 \n\nEIP只支持为所绑定的ECI实例提供公网服务，一个EIP只能绑定一个ECI实例。如果您有多个ECI实例需要连接公网，您需要分别为其绑定EIP，或者在所属VPC中创建公网NAT网关。\n\n- \n\n绑定已有EIP\n\n[表格]\n\nAnnotation\n\n示例值\n\n说明\n\nk8s.aliyun.com/eci-eip-instanceid\n\n\"eip-bp1q5n8cq4p7f6dzu****\" \n\n指定EIP，将其绑定到ECI Pod上。\n- \n\n自动创建并绑定EIP\n\n[表格]\n\nAnnotation\n\n示例值\n\n说明\n\nk8s.aliyun.com/eci-with-eip\n\n\"true\"\n\n配置为true表示自动创建一个EIP，并将其绑定到ECI Pod上。\n\nk8s.aliyun.com/eip-bandwidth\n\n\"10\"\n\n设置EIP带宽。单位为Mbps。默认为5 Mbps。\n\nk8s.aliyun.com/eip-common-bandwidth-package-id\n\n\"cbwp-2zeukbj916scmj51m****\" \n\n绑定已有的共享带宽。更多信息，请参见[共享带宽](https://help.aliyun.com/zh/internet-shared-bandwidth/product-overview/what-is-internet-shared-bandwidth)。\n\nk8s.aliyun.com/eip-isp\n\nBGP\n\n设置EIP线路类型，仅按量付费的EIP支持指定。取值范围：\n\n- \n\nBGP（默认值）：BGP（多线）线路\n- \n\nBGP_PRO：BGP（多线）精品线路\n\n更多信息，请参见[EIP线路类型](https://help.aliyun.com/zh/eip/product-overview/what-is-eip#section-vzi-lqi-chm)。\n\nk8s.aliyun.com/eip-internet-charge-type\n\nPayByTraffic\n\n设置EIP的计量方式。取值范围：\n\n- \n\nPayByBandwidth：按带宽计费\n- \n\nPayByTraffic：按流量计费\n\n更多信息，请参见[EIP计费方式](https://help.aliyun.com/zh/eip/product-overview/billing-overview/#section-j0c-7wh-cko)。\n\nk8s.aliyun.com/eip-public-ip-address-pool-id\n\npippool-bp187arfugi543y1s****\n\n指定IP地址池ID。 EIP将从该IP地址池中分配。更多信息，请参见[创建和管理IP地址池](https://help.aliyun.com/zh/eip/create-and-manage-ip-address-pools)。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\n- \n\n示例一：绑定已有EIP\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-eip-instanceid: \"eip-bp1q5n8cq4p7f6dzu****\"    # 指定已有的EIP进行绑定\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n- \n\n示例二：自动创建EIP，并设置EIP带宽\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-with-eip: \"true\"   # 自动创建并绑定EIP\n        k8s.aliyun.com/eip-bandwidth: \"10\"   # 设置EIP带宽\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n- \n\n示例三：自动创建EIP，并绑定共享带宽\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-wit"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/enable-internet-access-2", "page_type": "doc", "title": "为ECI Pod配置公网连接", "keywords": "配置ECI Pod公网连接,ECI Pod公网连接方法", "last_modified_ms": 1705025262000, "last_modified_iso": "2024-01-12T10:07:42+08:00", "excerpt": "默认情况下，系统只为ECI Pod（即ECI实例）分配一个私网IP，如果您的ECI Pod有连接公网的需求，例如需要拉取公网镜像等，您可以为其绑定EIP，或者在所属VPC中创建公网NAT网关，以实现ECI Pod与公网互通。\n## 背景信息\n\n为ECI实例配置公网连接时，支持以下两种方式：\n\n[表格]\n\n方式\n\n说明\n\n适用场景\n\n绑定EIP\n\nEIP是独立购买的可单独持有的公网IP地址，可以为绑定的ECI实例提供公网服务。更多信息，请参见[什么是弹性公网IP](https://help.aliyun.com/zh/eip/product-overview/what-is-eip)和[EIP计费概述](https://help.aliyun.com/zh/eip/product-overview/billing-overview/#concept-645525)。\n\n单个ECI实例。\n\n例如：您有一个ECI实例用于部署Nginx服务，在创建实例时，您需要为该实例绑定EIP。当Nginx启动时，将自动暴露80端口到EIP。您可以通过EIP地址加端口的方式访问Nginx服务。\n\n在所属VPC中创建公网NAT网关\n\nNAT网关是一种网络地址转换服务，提供NAT代理（SNAT和DNAT）能力。更多信息，请参见[什么是NAT网关](https://help.aliyun.com/zh/nat-gateway/product-overview/what-is-nat-gateway)和[公网NAT网关计费](https://help.aliyun.com/zh/nat-gateway/nat-gateway-billing#concept-z13-hty-ydb)。\n\n多个ECI实例。\n\n例如：您有多个ECI实例需要从Docker Hub拉取镜像，由于ECI默认不提供公网链接进行公网镜像的拉取，您需要在实例所属VPC中创建公网NAT网关并完成规则配置，否则无法拉取镜像。重要 \n\n为ECI实例配置公网连接时，请确保ECI实例所属的安全组已放行相关地址和端口。更多信息，请参见[添加安全组规则](https://help.aliyun.com/zh/ecs/user-guide/add-a-security-group-rule#concept-sm5-2wz-xdb)。\n## 为ECI实例绑定EIP\n\n创建ECI Pod时，您可以在Pod metadata中添加Annotation来绑定已有EIP，或者自动创建并绑定一个EIP。说明 \n\nEIP只支持为所绑定的ECI实例提供公网服务，一个EIP只能绑定一个ECI实例。如果您有多个ECI实例需要连接公网，您需要分别为其绑定EIP，或者在所属VPC中创建公网NAT网关。\n\n- \n\n绑定已有EIP\n\n[表格]\n\nAnnotation\n\n示例值\n\n说明\n\nk8s.aliyun.com/eci-eip-instanceid\n\n\"eip-bp1q5n8cq4p7f6dzu****\" \n\n指定EIP，将其绑定到ECI Pod上。\n- \n\n自动创建并绑定EIP\n\n[表格]\n\nAnnotation\n\n示例值\n\n说明\n\nk8s.aliyun.com/eci-with-eip\n\n\"true\"\n\n配置为true表示自动创建一个EIP，并将其绑定到ECI Pod上。\n\nk8s.aliyun.com/eip-bandwidth\n\n\"10\"\n\n设置EIP带宽。单位为Mbps。默认为5 Mbps。\n\nk8s.aliyun.com/eip-common-bandwidth-package-id\n\n\"cbwp-2zeukbj916scmj51m****\" \n\n绑定已有的共享带宽。更多信息，请参见[共享带宽](https://help.aliyun.com/zh/internet-shared-bandwidth/product-overview/what-is-internet-shared-bandwidth)。\n\nk8s.aliyun.com/eip-isp\n\nBGP\n\n设置EIP线路类型，仅按量付费的EIP支持指定。取值范围：\n\n- \n\nBGP（默认值）：BGP（多线）线路\n- \n\nBGP_PRO：BGP（多线）精品线路\n\n更多信息，请参见[EIP线路类型](https://help.aliyun.com/zh/eip/product-overview/what-is-eip#section-vzi-lqi-chm)。\n\nk8s.aliyun.com/eip-internet-charge-type\n\nPayByTraffic\n\n设置EIP的计量方式。取值范围：\n\n- \n\nPayByBandwidth：按带宽计费\n- \n\nPayByTraffic：按流量计费\n\n更多信息，请参见[EIP计费方式](https://help.aliyun.com/zh/eip/product-overview/billing-overview/#section-j0c-7wh-cko)。\n\nk8s.aliyun.com/eip-public-ip-address-pool-id\n\npippool-bp187arfugi543y1s****\n\n指定IP地址池ID。 EIP将从该IP地址池中分配。更多信息，请参见[创建和管理IP地址池](https://help.aliyun.com/zh/eip/create-and-manage-ip-address-pools)。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n配置示例如下：\n\n- \n\n示例一：绑定已有EIP\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-eip-instanceid: \"eip-bp1q5n8cq4p7f6dzu****\"    # 指定已有的EIP进行绑定\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n- \n\n示例二：自动创建EIP，并设置EIP带宽\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-with-eip: \"true\"   # 自动创建并绑定EIP\n        k8s.aliyun.com/eip-bandwidth: \"10\"   # 设置EIP带宽\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n- \n\n示例三：自动创建EIP，并绑定共享带宽\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-wit"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/encrypt-temporary-storage-space", "page_type": "doc", "title": "加密临时存储空间", "keywords": "加密ECI临时存储空间,配置临时存储空间加密,临时存储空间加密方法,加密Annotation配置", "last_modified_ms": 1697441120000, "last_modified_iso": "2023-10-16T15:25:20+08:00", "excerpt": "如果您的镜像和业务数据带有敏感信息，需要遵守合规要求等，可以开启临时存储空间加密功能，以保证数据安全性和完整性，防止未经授权的访问和数据泄露。本文介绍如何加密ECI Pod的临时存储空间。\n## 功能说明\n\n每个ECI Pod默认提供30 GiB（可自定义增加）的临时存储空间，用于存放Pod启动使用的容器镜像以及运行Pod产生的业务数据等。如果您的镜像和业务数据带有敏感信息，需要遵守合规要求等，可以开启临时存储空间加密功能，以保证数据安全性和完整性，防止未经授权的访问和数据泄露。\n\n创建ECI Pod时，如果开启了临时存储空间加密功能，ECI会自动加密临时存储空间的数据，并在读取数据时自动解密。加密功能采用行业标准的AES-256加密算法，使用阿里云密钥管理服务KMS提供的服务密钥（默认密钥）对数据进行加密。\n## 前提条件\n\n已开通密钥管理服务KMS。具体操作，请参见[开通密钥管理服务](https://help.aliyun.com/zh/kms/key-management-service/support/purchase-a-dedicated-kms-instance#task-1962255)。说明 \n\n开通服务后，系统会自动代您创建并管理服务密钥，该密钥可以免费使用。\n## 使用限制\n\n本文提供的加密方式不适用于使用手动创建镜像缓存创建的ECI Pod。\n## 配置说明\n\n您可以在Pod metadata中添加以下Annotation来加密临时存储空间。相关Annotation说明如下：\n\n[表格]\n\nAnnotation\n\n示例值\n\n说明\n\nk8s.aliyun.com/eci-ephemeral-storage-options \n\n\"{\\\"encrypted\\\":\\\"true\\\"}\"\n\n取值为\"{\\\"encrypted\\\":\\\"true\\\"}\"}时，表示开启临时存储空间加密功能。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\n使用以下示例创建的Deployment包含1个ECI Pod，由于添加了Annotation开启临时存储空间加密功能，因此该Pod临时存储空间内的数据会被自动加密，并在读取数据时自动解密。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kms-test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      name: kms-test\n      labels:\n        app: test\n        alibabacloud.com/eci: \"true\"\n      annotations:\n        k8s.aliyun.com/eci-ephemeral-storage-options: \"{\\\"encrypted\\\":\\\"true\\\"}\"   # 加密临时存储空间\n    spec:\n      containers:\n      - name: test\n        image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.4.2\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/faq", "page_type": "doc", "title": "常见问题", "keywords": "查询ECI常见问题,解决ECI使用问题,ECI常见问题", "last_modified_ms": 1736851109000, "last_modified_iso": "2025-01-14T18:38:29+08:00", "excerpt": "本文汇总了使用ECI的常见问题，包括计费、实例、容器、镜像、网络、存储等问题。\n## 产品计费\n### Job任务类ECI实例如何收费？\n\nJob、CronJob等任务类容器在运行完成后，ECI实例会进入运行成功（Succeeded）或者运行失败（Failed）状态。此时，ECI实例不论是否删除，都不再进行计费。\n\nECI实例的计费时长从下载容器镜像（Pending状态）开始，至ECI实例运行结束（进入Succeeded或Failed状态）。更多信息，请参见[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances)。\n## 配额限制\n### 如何查看vCPU的使用配额？\n\n您可以创建的ECI的实例数依赖于对应地域您的vCPU配额（quota）和已使用量。如果当前的配额无法满足您的业务需求，请至[配额中心](https://quotas.console.aliyun.com/products/eci/quotas)申请提升配额。\n\n在控制台查看配额的方法如下：\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/welcome)。\n- \n\n在左侧导航栏，单击权益配额。\n\n权益配额包含已使用量和使用上限，如下图所示。\n\n### 如何处理ValueExceeded问题？\n\n当创建ECI实例时遇到ValueExceeded问题，则表示配额不足，您可以至[配额中心](https://quotas.console.aliyun.com/products/eci/quotas)申请提升配额。\n## 实例与容器\n### 如何创建GPU实例？\n\nECI支持指定ECS GPU规格来创建GPU实例，具体操作，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。说明 \n\n控制台暂不支持创建GPU实例，请采用OpenAPI方式。\n### 为什么ECI控制台和监控数据显示的实例规格不一致？\n\n问题描述\n\n创建了一个0.5 vCPU、1 GiB内存的ECI实例，但是在监控数据查到的ECI实例的规格为2vCPU、2 GiB内存。\n\n问题说明\n\n上述现象是正常的，2vCPU、2 GiB内存是虚拟机的规格，而非ECI实例的规格。如果您购买的是0.5 vCPU、1 GiB内存的ECI实例，最终也只能使用对应规格的资源。\n### 如何避免OperationDenied.NoStock问题？\n\n在创建ECI实例的时候，如果遇到OperationDenied.NoStock问题，表示当前地域和可用区的ECI实例已售罄。建议您采用多可用区、多规格的方式创建ECI实例。具体操作，请参见[多可用区创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-multiple-zones-to-create-an-elastic-container-instance)和[多规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-multiple-specifications-to-create-an-elastic-container-instance)。\n### 如何解决Back-off restarting failed container事件？\n\n如果ECI实例事件中一直出现Back-off restarting failed container的Warning事件，一般是由于通过指定的镜像启动容器后，容器内部没有常驻进程，导致容器启动成功后立即退出，从而进行了持续的重启。\n\n因此，对于CentOS、busybox等基础镜像，您需要在创建容器时设置启动命令。具体操作，请参见[使用CentOS 镜像创建ECI](https://help.aliyun.com/zh/eci/getting-started/use-a-centos-image-to-create-an-elastic-container-instance#topic1060)。\n## 镜像\n### 是否支持私有镜像？\n\n支持私有镜像。\n\n支持使用阿里云镜像仓库搭建私有镜像，也支持您自己搭建的镜像仓库。\n### 镜像缓存是否支持更新？\n\n支持更新。\n\n对于状态为创建完成（Ready）或者UpdateFailed（更新失败）的镜像缓存，支持调用UpdateImageCache接口来更新镜像缓存，包括更新容器镜像、保留时长、镜像仓库信息等。更多信息，请参见[UpdateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updateimagecache)。\n## 网络\n### ECI实例是否支持修改安全组？\n\nECI实例不支持修改安全组，如果您想要变更安全组，需要重新创建ECI实例。\n### 如何从外网访问容器组？\n\n如果您的ECI实例需要访问外网，或者被外网访问，您需要为ECI实例绑定EIP，或者为实例所属的VPC绑定NAT网关。更多信息，请参见[为ECI实例配置公网连接](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access#topic755)。\n### 是否支持端口映射？\n\nECI实例不支持端口映射。\n\n- \n\n在同一个VPC网络中，您可以直接通过ECI实例的IP+Port进行访问（默认会将容器的端口开放）。\n- \n\n如果需要支持外网访问，您可以为ECI实例绑定EIP，或者为实例所属的VPC绑定NAT网关。更多信息，请参见[为ECI实例配置公网连接](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access#topic755)。\n\n## 存储\n### ECI是否可以和ECS共享NAS文件存储？\n\n支持。\n\n为ECI实例和ECS实例挂载同一NAS文件系统，即可实现共享数据。\n### 是否支持数据持久化？\n\n支持数据持久化。\n\n针对一些在ECI实例运行期间对磁盘有较高的IO要求、同时有大量的临时数据需要存放的业务，如运行时产生的log文件，建议采用外置的数据卷来外挂存储。您可以根据业务需求的场景来选择创建ECI实例外挂的存储，支持云盘、NAS和OSS。\n\n您可以在创建ECI实例时挂载数据卷，将数据写到数据卷上，实现数据持久化。更多信息，请参见[数据卷](https://help.aliyun.com/zh/eci/user-guide/overview-of-volumes#topic2566)。\n## 其他\n### 通过控制台操作时，如何获取Request ID？\n\n通过弹性容器实例控制台使用ECI时，如果碰到问题，您可以通过浏览器的开发者工具获取Request ID，以便反馈给阿里云技术支持来定位问题。\n\n- \n\n打开浏览器的开发者工具页面。\n\n以Windows系统，Chrome浏览器为例，在浏览器页面按下F12键即可打开开发者工具页面。说明 \n\nmacOS系统可以单击浏览器的图标，选择更多工具>开发者工具打开开发者工具页面。\n- \n\n在开发者工具页面，单击Network页签。\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/welcome)执行相关操作请求（例如创建ECI实例等）。\n- \n\n在开发者工具页面的Network页面，单击Name列对应的API操作。\n\nAPI操作通常以api.json开头，action的值为API名称。例如创建ECI实例对应的API操作为api.json?action=CreateContainerGroup。\n- \n\n单击Response页签，获取目标请求的Request ID。\n", "aliases": ["https://help.aliyun.com/document_detail/194524.html"]}
{"url": "https://help.aliyun.com/zh/eci/user-guide/faq-1", "page_type": "doc", "title": "常见问题", "keywords": "解决ECI自建集群问题,查询ECI自建集群问题,ECI自建集群常见问题,ECI自建集群问题排查", "last_modified_ms": 1672111661000, "last_modified_iso": "2022-12-27T11:27:41+08:00", "excerpt": "本文介绍自建Kubernetes集群部署VNode来使用ECI的常见问题。\n\n- \n\n网络相关问题\n\n- \n\n[云上服务如何访问线下IDC的Pod IP？](#section-zjj-9wv-pon)\n- \n\n[线下IDC服务如何访问云上的Pod IP？](#section-wrq-yn8-4b9)\n- \n\n[内网域名无法解析怎么办？](#section-xbh-xf8-n3i)\n- \n\n[线下IDC服务如何访问云上服务？](#section-mff-8lf-42b)\n\n- \n\n镜像拉取相关问题\n\n- \n\n[使用自建的容器镜像仓库无法拉取镜像，怎么办？](#section-skt-hd4-l5h)\n\n- \n\nPod调度相关问题\n\n- \n\n[如何调度Pod到VNode？](#section-fym-1uh-pfk)\n- \n\n[为什么DaemonSet Pod调度到VNode后一直是Pending状态？](#section-3lu-nq6-b6a)\n- \n\n[使用配置Pod Label的方式调度Pod到VNode，为什么调度失败？](#section-jkj-qan-zd9)\n\n- \n\n存储相关问题\n\n- \n\n[挂载NAS目录超时，怎么办？](#section-lk5-b2k-7yl)\n\n- \n\n日志和监控相关问题\n\n- \n\n[如何采集日志到阿里云日志服务SLS？](#section-u85-8fp-qhv)\n- \n\n[metrics-server报404错误，如何处理？](#section-4fj-ub3-i64)\n\n## 云上服务如何访问线下IDC的Pod IP？\n\n如果您使用高速通道（专线）来打通线下和云上网络，则线下IDC和云上服务之间可以通过边界路由协议BGP相互学习路由规则，IDC可以将Pod IP的路由信息通过BGP广播给云上服务，实现云上服务可以访问线下IDC的Pod IP。具体操作，请参见[配置BGP](https://help.aliyun.com/zh/express-connect/user-guide/configure-and-manage-bgp#concept-ljj-4vx-dfb)。\n## 线下IDC服务如何访问云上的Pod IP？\n\n如果您使用高速通道（专线）来打通线下和云上网络，配置BGP后，线下IDC和云上服务之间可以相互学习路由规则，云上的Pod IP的路由信息可以部署CCM实现自动同步。更多关于CCM的信息，请参见[Cloud Controller Manager](https://help.aliyun.com/zh/ack/product-overview/cloud-controller-manager#concept-wk1-grd-qfb)。\n\n自建K8s集群部署CCM后，可以将K8s的Pod IP路由信息同步到VPC路由表。部署CCM时，请注意以下事项：\n\n- \n\n需要将K8s集群节点的providerID修改为<region-id>.<ecs-id>的格式，例如cn-shanghai.i-ankb8zjh2nzchf*******。\n- \n\n确保Pod IP与节点的Pod CIDR相匹配，即该节点上的Pod IP地址均在该节点定义的Pod CIDR网段内。例如：Calico IPAM需要配置为host-local才能使Pod IP与节点的Pod CIDR相匹配。\n\nPod CIDR网段可以在节点的spec信息中查看：\n\nspec:\n  podCIDR: 172.23.XX.0/26\n  podCIDRs:\n  - 172.23.XX.0/26\n  providerID: cn-shanghai.i-ankb8zjh2nzchfxxxxxxx\n\n\n## 内网域名无法解析怎么办？\n### 问题描述\n\n云上和线下服务由于无法解析内网域名，导致无法进行业务调用，包括：\n\n- \n\n云上服务无法解析IDC内网域名\n- \n\nIDC服务无法解析云上PrivateZone域名\n\n### 解决方案\n\n线下IDC和阿里云VPC分别属于两套网络环境，如果部署在线下IDC和云上的服务都需要通过DNS解析进行业务间调用，您可以配置PrivateZone云解析实现云上和线下服务通过内网域名方式实现相互访问。具体操作，请参见[PrivateZone&VPN网关联动实现云上访问云下资源](https://help.aliyun.com/document_detail/181219.html#topic-2036647)。\n## 线下IDC服务如何访问云上服务？\n### 问题描述\n\n线下IDC服务通过专线无法访问阿里云服务，例如IDC通过专线无法访问云数据库RDS、对象存储OSS、日志服务SLS等。\n### 解决方案\n\n您可以通过以下两种方式解决问题，推荐您使用方案一。\n\n- \n\n方案一\n\n在云上配置云服务域名，边界路由器VBR将通过边界路由协议BGP发布路由给线下IDC。具体操作，请参见[访问云服务](https://help.aliyun.com/zh/cen/user-guide/access-cloud-services#task-gsf-wly-pgb)。\n- \n\n方案二\n\n配置IDC添加静态路由，将100.64.0.0/10路由到专线。\n\n## 使用自建的容器镜像仓库无法拉取镜像，怎么办？\n### 问题描述\n\n使用自建的容器镜像仓库无法拉取镜像，报错如下：\n### 解决方案\n\n上述问题可能是因为镜像仓库使用的自签发的证书，拉取镜像时无法通过证书认证导致。在创建Pod时，您可以添加以下Annotation来跳过证书认证：\n\n\"k8s.aliyun.com/insecure-registry\": \"<host-name>\"\n\n\n例如：假设私有镜像仓库中的Nginx镜像的链接为test.example.com/test/nginx:apline，则可以添加\"k8s.aliyun.com/insecure-registry\": \"test.example.com\"的Annotation来跳过证书认证。\n## 如何调度Pod到VNode？\n\n您可以根据业务需要选择合适的方式将Pod调度到VNode，即在ECI上运行Pod。常用方式如下：\n\n- \n\n手动调度\n\n通过配置nodeSelector和tolerations、指定nodeName的方式，可以手动将Pod调度到VNode。具体操作，请参见[将Pod调度到VNode](https://help.aliyun.com/zh/eci/user-guide/schedule-pods-to-a-vnode#topic-2145262)。\n- \n\n自动调度\n\n部署eci-profile组件后，可以自定义配置Selector，将满足条件的Pod自动调度到VNode。具体操作，请参见[使用eci-profile调度Pod到VNode](https://help.aliyun.com/zh/eci/user-guide/use-eci-profile-to-schedule-pods-to-a-vnode)。\n\n## 为什么DaemonSet Pod调度到VNode后一直是Pending状态？\n\n由于VNode不是真实节点，并不支持DaemonSet，因此在创建DaemonSet时，您需要配置反亲和性调度策略，禁止DaemonSet Pod调度到VNode上。配置示例如下：\n\nspec:\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n        - matchExpressions:\n          - key: type\n            operator: NotIn\n            values:\n            - virtual-kubelet\n\n\n## 使用配置Pod Label的方式调度Pod到VNode，为什么调度失败？\n\n使用配置Pod Label的方式调度Pod到VNode时，需要确保K8s版本为1.16及以上版本。\n## 挂载NAS目录超时，怎么办？\n### 问题原因\n\n由于K8s的工作流程是挂载NAS后按照Pod指定的权限及归属，对相应NAS目录中的文件递归执行chmod/chown操作，因此如果NAS目录中文件较多，且在创建Pod时在安全上下文中配置了文件的权限及归属时，会产生NAS Volume挂载超时的问题。\n### 解决方案\n\n配置安全上下文时，将fsGroupChangePolicy配置为OnRootMismatch，实现当NAS中根目录权限及归属与Pod预期匹配时，跳过chmod/chown操作。更多信息，请参见[为Pod或容器配置安全上下文](https://kubernetes.io/zh/docs/tasks/configure-pod-container/security-context/)。\n## 如何采集日志到阿里云日志服务SLS？\n\n您可以在自建Kubernetes集群上安装Logtail组件（即安装alibaba-log-controller组件），以实现采集日志到SLS。在安装Logtail组件过程中，系统将自动完成以下操作：\n\n- \n\n创建alibaba-log-configuration ConfigMap，该ConfigMap"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/faq-2", "page_type": "doc", "title": "常见问题", "keywords": "解决ACK使用ECI问题,排查ECI Pod异常,ACK使用ECI常见问题", "last_modified_ms": 1702018429000, "last_modified_iso": "2023-12-08T14:53:49+08:00", "excerpt": "本文汇总了通过阿里云容器服务Kubernetes版使用ECI时的常见问题，包括ECI Pod、网络等问题。\n\n- \n\nECI Pod\n\n- \n\n[如何创建GPU实例？](#fcef31205eyn7)\n- \n\n[如何查看ECI实例ID？](#2bc517305ekmn)\n- \n\n[使用了镜像缓存，为什么创建ECI Pod的速度还是很慢？](#d8977de05el3k)\n- \n\n[创建ECI Pod后，Pod一直处于Pending状态怎么办？](#e95254205erk8)\n\n- \n\n调度\n\n- \n\n[Pod显示已调度至virtual-kubelet，但一直未成功，怎么办？](#d0fa2e705erp1)\n- \n\n[ACK+Virtual Node的场景下，kube-proxy、coredns被调度到了虚拟节点，启动失败怎么办？](#22550e205e8nv)\n\n- \n\n网络\n\n- \n\n[如何修改ECI Pod的ClusterDomain？](#691c38d06ch9k)\n- \n\n[在ACK Serverless集群的Ingress中设置了鉴权，但不生效是什么原因？](#352e7ea05e9bj)\n- \n\n[集群升级后，服务IP地址Ping不通怎么办？](#772b31e05eamv)\n\n- \n\n日志\n\n- \n\n[为什么采集不到ECI实例日志？](#c8f54e205e02r)\n\n- \n\n监控\n\n- \n\n[ACK+Virtual Node的场景下，Prometheus如何获取ECI Pod的监控指标？](#5602f6b0b225g)\n\n## 如何创建GPU实例？\n\nECI支持指定ECS GPU规格来创建GPU实例，具体操作，请参见[创建GPU实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod-1/#25eabc2021bek)。\n## 如何查看ECI实例ID？\n\nKubernetes场景下，一个Pod对应一个ECI实例。您可以通过以下两种方式查看ECI实例ID：\n\n- \n\n方式一：通过kubectl命令\n\n通过kubectl describe pod命令查看Pod详情，在Pod详情的Annotation中可以查看对应的ECI实例ID。\n\nk8s.aliyun.com/eci-instance-id字段对应的值即为ECI实例ID，格式为eci-xxxx，示例如下：\n\n- \n\n方式二：通过弹性容器实例控制台\n\n在[弹性容器实例控制台](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/welcome)的容器组页面，根据Pod名称可以查询对应的ECI实例，然后查看ECI实例ID。\n\n容器组ID即ECI实例ID，格式为eci-xxxx，示例如下：\n\n## 使用了镜像缓存，为什么创建ECI Pod的速度还是很慢？\n#### 问题描述\n\n在标准节点上创建一个Pod只需要两到三秒，而创建ECI实例时使用了镜像缓存，Pod却用了十几秒才启动。\n#### 问题说明\n\n这种情况是正常的。因为在标准节点上创建Pod时，不需要单独申请资源，可以直接在节点上创建容器，因此时间比较快。而在创建ECI实例时，系统需要申请资源，如果指定了多可用区，还需要在库存不足时逐个尝试各个可用区是否有库存，因此时间相对会慢一些。\n\n如果您指定了多可用区创建ECI实例，建议您把库存比较多的可用区ID放在第一个，这样可以避免由重试导致的启动延迟。\n## 创建ECI Pod后，Pod一直处于Pending状态怎么办？\n#### 问题描述\n\n创建Pod后几个小时内，Pod一直处于为Pending状态。查看Pod事件列表，显示在挂载Volume时，由于连接API Server超时导致失败。\n#### 解决方法\n\n该问题通常是由于实例与API Server网络不通导致，您可以按以下思路进行排查：\n\n- \n\n检查Pod与集群的API Server是否在同一个专有网络VPC中。\n- \n\n如果为集群SLB添加了访问控制，请确保已将Pod所处网段加入到访问控制列表中。\n\n## Pod显示已调度至virtual-kubelet，但一直未成功，怎么办？\n#### 问题描述\n\n在ACK+Virtual Node的场景下，可能会出现Pod显示已经调度到virtual-kubelet节点，但是一直没有新的事件更新的现象。 这种情况下，您需要获取对应的virtual-kubelet日志，根据报错信息进行问题排查。\n\n说明 \n\n如果有新的事件产生，您可以先根据产生的事件进行报错分析和处理。\n#### 解决方法\n\n- \n\n在容器服务控制台的集群页面，单击目录集群操作列下的更多>通过 Cloud Shell 管理集群。\n- \n\n运行以下命令获取virtual-kubelet Pod名称。\n\nkubectl -n kube-system get pods\n\n\n- \n\n运行以下命令获取对应Pod的日志信息。其中ack-virtual-node-controller-xxxxxxxxxx请替换为步骤2获取的Pod名称。\n\nkubectl -n kube-system logs ack-virtual-node-controller-xxxxxxxxxx\n\n\n- \n\n根据最新的日志报错进行处理，或者提供RequestID和报错信息，发起工单处理流程。\n\n## ACK+Virtual Node的场景下，kube-proxy、coredns被调度到了虚拟节点，启动失败怎么办？\n\nkube-proxy、coredns调度的时候是忽略taints的，所以有可能被调度到虚拟节点上。此时，您可以编辑kube-proxy、coredns的YAML解决问题，需要增加的YAML如下：\n\naffinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: type\n                operator: NotIn\n                values:\n                - virtual-kubelet\n\n\n## 如何修改ECI Pod的ClusterDomain？\n\n您可以修改VK对应的deployment，为容器增加环境变量CLUSTER_DOMAIN，从而修改VK创建的ECI Pod的ClusterDomain。建议您提交工单，联系阿里云技术支持进行操作。\n## 在ACK Serverless集群的Ingress中设置了鉴权，但不生效是什么原因？\n#### 问题描述\n\n在 nginx-ingress 中设置了注解 nginx.ingress.kubernetes.io/auth-url ，但不生效。\n#### 问题解释\n\nACK Serverless集群中基于SLB的Ingress Controller，不支持设置鉴权URL。\n\nACK集群是支持的。\n## 集群升级后，服务IP地址ping不通怎么办？\n\n在2020年10月之前，每个Service IP会对应一张虚拟网卡，所以能ping通。但在2020年10月份之后，为了优化高并发，Service IP只存在ipvs的规则中，所以无法ping通（ipvs是基于IP+Port做数据转发的，所以ping包无法做转发）。\n## 为什么采集不到ECI实例日志？\n\n如果您在Pod中设置了日志服务的环境变量aliyun_logs_{Logstore名称}，但在日志服务中却没有找到ECI实例的日志，可能是以下原因导致：\n\n- \n\nECI实例运行时间太短\n\nECI实例启动后，如果业务容器在20秒内执行完毕，这种情况下，日志服务可能还没有来得及收集日志，容器就已经退出且日志相关的Volume已经被卸载，因此日志服务无法收集到日志。\n- \n\n收集路径（Path）错误\n\n首次在Pod中指定环境变量收集日志时，ECI会自动在日志服务中创建Logstore和Path，后续再次创建Pod时也只能使用该Path。如果使用了其他Path，则会导致日志服务收集不到日志。如果您想要更换Path，可以将Logstore一起更换，此时ECI会自动在日志服务中创建新的Logstore。\n\n## ACK+Virtual Node的场景下，Prometheus如何获取ECI Pod的监控指标？\n\nVirtual Node和普通节点保持兼容，Prometheus（ARMS Prometheus或自建开源Prometheus）会自动获取Virtual Node管理的ECI Pod的基础监控指标，您无需做额外配置。\n\n关于ACK集群如何部署Prometheus，请参见[阿里云Prometheus监控](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/use-managed-service-for-prometheus-to-monitor-an-ack-cluster)或[开源Prometheus监控](https://help.aliyun.com/zh/ac"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/fine-grained-resource-control-using-resource-groups-25", "page_type": "doc", "title": "使用资源组进行精细化资源控制", "keywords": "授予资源组权限,了解资源组授权限制,资源组授权方法,ECI资源组支持", "last_modified_ms": 1769486472000, "last_modified_iso": "2026-01-27T12:01:12+08:00", "excerpt": "当您使用资源组对资源进行分组管理时，可以结合访问控制（RAM），在单个阿里云账号内实现资源的隔离和精细化权限管理。本文总结了弹性容器实例对资源组的支持情况，以及资源组级别的授权操作步骤。  说明  \n \n-  \n\n只有[支持资源组的资源类型](#a4133b8e06d0v)和支持资源组级别授权的操作，资源组级别授权才能生效。  \n-  \n\n对于不支持资源组的资源类型，授予资源组范围的权限将无效。在选择资源范围时，请选择账号级别，进行账号级别授权。具体操作，请参见[不支持资源组级别授权的操作](#2a99d29ff0e2t)。  \n   \n## 资源组授权的工作原理 \n\n您可以使用资源组（Resource Group）对阿里云账号内的资源进行分组管理。例如，为不同的项目创建对应的资源组，并将资源转移到对应的组中，以便集中管理各项目的资源。更多信息，请参见[什么是资源组](https://help.aliyun.com/zh/resource-management/resource-group/product-overview/resource-group-overview)。 \n\n在完成资源分组后，您可以为不同的RAM授权主体（RAM用户、RAM用户组或RAM角色）授予指定资源组范围的权限，从而限定这个授权主体只能管理该资源组内的资源。更多信息，请参见[资源分组和授权](https://help.aliyun.com/zh/resource-management/resource-group/use-cases/use-ram-to-create-and-authorize-resource-groups#DAS)。 \n\n这种授权方式的优点有： \n \n-  \n\n权限精细化：确保每个身份能获得最准确的资源访问权限，避免账号下的多个项目的资源混合管理。  \n-  \n\n良好的扩展性：后续新增资源时，只需将其加入该资源组，RAM身份便会自动获得新资源的相应权限，无需再次授权。  \n   \n## 为RAM用户授予资源组级别的权限 \n\n下面以RAM用户为例，介绍授予指定资源组内弹性容器实例资源权限的操作步骤。  \n### 1. 前置步骤 \n \n-  \n\n创建待使用的RAM用户，可参考：[创建RAM用户](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-user)  \n-  \n\n创建资源组并将已有资源划分到目标资源组，可参考：[创建资源组](https://help.aliyun.com/zh/resource-management/resource-group/user-guide/create-a-resource-group#task-xpl-kjm-4fb)，[资源自动转组](https://help.aliyun.com/zh/resource-management/resource-group/user-guide/automatic-resource-transfer/)及[资源手动转组](https://help.aliyun.com/zh/resource-management/resource-group/user-guide/resource-manual-transfer-group)。  \n   \n### 2. 进行资源组级别授权 \n\n您可以通过以下任一方式进行资源组级别授权。   \n### 方式一：在资源管理控制台中授权 \n\n通过资源组的权限管理功能为指定 RAM 用户授权。详情操作可参见[为RAM身份授予资源组范围的权限](https://help.aliyun.com/zh/resource-management/resource-group/user-guide/add-ram-authorization)。 \n \n-  \n\n登录[资源组控制台](https://resourcemanager.console.aliyun.com/resource-groups)。  \n-  \n\n在资源组页面，单击目标资源组操作列的权限管理。  \n-  \n\n在权限管理页签，单击新增授权。  \n-  \n\n在新增授权面板，设置授权主体和权限策略。 \n \n-  \n\n授权主体：选择已有RAM用户。  \n-  \n\n权限策略：选择系统策略或已创建的自定义策略，参考[创建自定义权限策略](https://help.aliyun.com/zh/ram/create-a-custom-policy)。  \n  \n-  \n\n单击确认新增授权。  \n   \n### 方式二：在 RAM 控制台中授权 \n\n通过RAM控制台为指定 RAM 用户进行资源组级别授权。详细操作可参见[为RAM用户授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-the-ram-user)。 \n \n-  \n\n使用阿里云账号（主账号）或RAM管理员登录[RAM控制台](https://ram.console.aliyun.com/)。  \n-  \n\n在左侧导航栏，选择身份管理 > 用户。在用户页面，单击目标RAM用户操作列的添加权限。  \n-  \n\n在新增授权面板，为RAM用户添加权限。 \n \n-  \n\n资源范围：选择资源组级别。  \n-  \n\n授权主体：选择已有 RAM 用户或前面步骤创建的 RAM 用户。  \n-  \n\n权限策略：选择系统策略或已创建的自定义策略，参考[创建自定义权限策略](https://help.aliyun.com/zh/ram/create-a-custom-policy)。  \n  \n-  \n\n单击确认新增授权。  \n      \n##  支持资源组的资源类型  \n\n弹性容器实例支持资源组的资源类型如下表所示： \n\n[表格]\n       \n\n云服务   \n\n云服务代码   \n\n资源类型     \n\n弹性容器实例   \n\neci   \n\ncontainergroup : 容器组     \n\n弹性容器实例   \n\neci   \n\nimagecache : 镜像缓存     说明  \n\n对于暂不支持资源组的资源类型，如有需要，您可以在[资源组控制台](https://resourcemanager.console.aliyun.com/resource-groups)提交反馈。 \n\n    \n## 不支持资源组级别授权的操作 \n\n弹性容器实例中不支持资源组级别授权的操作（Action）如下： \n\n[表格]\n      \n\n操作（Action）   \n\n操作描述     \n\neci:DeleteContainerGroups   \n\n-     \n\neci:DeleteLaunchTemplate   \n\n-     \n\neci:DescribeCommandResult   \n\n-     \n\neci:DescribeContainerGroupPrice   \n\n查询ECI实例的价格。     \n\neci:DescribeContainerInstanceStatus   \n\n-     \n\neci:DescribeImageCacheMetrics   \n\n-     \n\neci:DescribeUpdateConfigMapTask   \n\n-     \n\neci:DescribeUpdateSecretTask   \n\n-     \n\neci:DescribeVnodeCapacity   \n\n-     \n\neci:ListUsage   \n\n调用ListUsage查询指定地域的权益配额，包括已使用量和使用上限。     \n\neci:RunCommand   \n\n-     \n\neci:UpdateVirtualNodeStatusEvents   \n\n-     \n\neci:UploadVirtualNodeConfig   \n\n-     \n\n对于不支持资源组授权的操作，授权时资源范围选择资源组级别将无效。如果仍需要RAM用户有上述操作权限，您需要创建自定义权限策略，授权时资源范围选择账号级别。 \n\n以下是两个自定义权限策略示例，您可以根据实际需要调整策略内容。 \n \n-  \n\n允许不支持资源组级别授权的全部只读操作：Action中列举不支持资源组级别授权的所有只读操作。\n\n{\n  \"Version\": \"1\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eci:DescribeCommandResult\",\n        \"eci:DescribeContainerGroupPrice\",\n        \"eci:DescribeContainerInstanceStatus\",\n        \"eci:DescribeImageCacheMetrics\",\n        \"eci:DescribeUpdateConfigMapTask\",\n        \"eci:DescribeUpdateSecretTask\",\n        \"eci:DescribeVnodeCapacity\",\n        \"eci:ListUsage\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n\n\n  \n-  \n\n允许不支持资源组级别授权的全部操作：Action中列举不支"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users", "page_type": "doc", "title": "为RAM用户授权", "keywords": "为RAM用户授予ECI权限,RAM用户ECI授权,ECI权限策略说明", "last_modified_ms": 1733814591000, "last_modified_iso": "2024-12-10T15:09:51+08:00", "excerpt": "默认情况下，您可以使用阿里云账号完整操作该账号下的ECI资源，但如果您使用的是RAM用户，则需要进行授权，RAM用户才可以操作ECI资源。本文介绍如何为RAM用户授权。\n## 前提条件\n\n已创建RAM用户。具体操作，请参见[创建RAM用户](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-user#task-187540)。\n## 权限说明\n\n为RAM用户授权时，您可以根据使用需求为其授予相应的权限策略。ECI相关的权限如下：\n\n[表格]\n\n权限\n\n说明\n\nAliyunECIReadOnlyAccess\n\n只读访问ECI资源的权限。默认提供的系统权限策略，包含的权限如下：\n\n- \n\neci:Describe*：获取ECI相关资源列表\n- \n\neci:List*：获取ECI相关资源列表\n- \n\necs:DescribeSecurityGroups：获取安全组列表\n- \n\nvpc:DescribeVSwitches：获取交换机列表\n- \n\nvpc:DescribeVpcs：获取VPC列表\n\nAliyunECIFullAccess\n\n管理ECI资源的权限。默认提供的系统权限策略，包含的权限如下：\n\n- \n\neci：ECI相关资源的所有操作权限\n- \n\necs:DescribeSecurityGroups：获取安全组列表\n- \n\nvpc:DescribeVSwitches：获取交换机列表\n- \n\nvpc:DescribeVpcs：获取VPC列表\n- \n\nvpc:DescribeEipAddresses：获取EIP列表\n\n在ECI控制台操作时所需的其他权限\n\n如果您需要使用ECI控制台进行操作，则除了AliyunECIFullAccess默认的权限外，还需要以下权限：\n\n- \n\nram:ListRoles：获取实例的RAM角色\n- \n\nnas:DescribeFileSystems：获取NAS文件系统列表\n- \n\noss:ListBuckets：获取OSS Bucket列表\n- \n\nvpc:DescribeCommonBandwidthPackages：获取共享带宽包列表\n- \n\ncr:GetRepoList：获取镜像仓库列表\n- \n\ncr:GetRepoTags：获取镜像Tag\n- \n\ncr:GetImageManifest：获取镜像详情\n- \n\ncr:SearchRepo：搜索镜像仓库\n\n## 操作步骤\n\n- \n\n使用阿里云账号登录[RAM控制台](https://ram.console.aliyun.com/overview)。\n- \n\n如果想要为RAM用户授予在控制台操作ECI资源的权限，您需要创建对应的自定义权限策略。\n\n- \n\n在左侧导航栏选择权限管理 > 权限策略。\n- \n\n单击创建权限策略。\n- \n\n选择脚本编辑页签，复制以下脚本到策略内容中，然后单击确定。\n\n{\n    \"Statement\": [\n        {\n            \"Action\": \"ram:ListRoles\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": \"nas:DescribeFileSystems\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": \"oss:ListBuckets\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": \"vpc:DescribeCommonBandwidthPackages\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Action\": [\n                \"cr:GetRepoList\",\n                \"cr:GetRepoTags\",\n                \"cr:GetImageManifest\",\n                \"cr:SearchRepo\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n        }\n    ],\n    \"Version\": \"1\"\n}\n\n\n- \n\n输入策略名称，单击确定。\n\n- \n\n根据需要为RAM用户添加权限。\n\n- \n\n在左侧导航栏选择身份管理 > 用户。\n- \n\n找到待授权的RAM用户，单击对应操作列中的添加权限。\n- \n\n在弹出面板，完成相关配置。\n\n相关配置说明如下表所示。\n\n[表格]\n\n参数\n\n描述\n\n资源范围\n\n根据需要选择权限的生效范围：\n\n- \n\n账号级别：在当前阿里云账号内生效。\n- \n\n资源组级别：在指定的资源组内生效。\n\n授权主体\n\n需要授权的RAM用户。系统将自动填入您选择的RAM用户，您也可以手动添加其它用户。\n\n权限策略\n\n根据需要选择对应的权限。常见场景如下：\n\n- \n\n只查看ECI资源：在系统策略中选择AliyunECIReadOnlyAccess。\n- \n\n通过OpenAPI操作ECI资源：在系统策略中选择AliyunECIFullAccess。\n- \n\n通过控制台操作ECI资源：在系统策略中选择AliyunECIFullAccess，在自定义策略中选择第2步创建的自定义策略。\n\n- \n\n单击确认新增授权，然后按照页面提示完成后续操作。\n\n## 相关文档\n\n如果您想进一步控制RAM用户操作ECI资源的权限，可以通过资源组和标签实现分组分权限管理。更多信息，请参见：\n\n- \n\n[通过资源组实现RAM用户鉴权](https://help.aliyun.com/zh/eci/user-guide/use-resource-groups-to-control-the-permissions-of-a-ram-user)\n- \n\n[通过标签实现RAM用户鉴权](https://help.aliyun.com/zh/eci/user-guide/use-tags-to-authenticate-a-ram-user)\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-during-resource-adjustment", "page_type": "doc", "title": "配置资源规整忽略特定容器", "keywords": "配置ECI忽略特定容器,降低ECI资源规整成本,ECI资源规整原理,ECI忽略容器配置方法", "last_modified_ms": 1706754327000, "last_modified_iso": "2024-02-01T10:25:27+08:00", "excerpt": "创建ECI实例时，如果指定的vCPU和内存规格不满足ECI规格约束，系统会在满足资源需求的同时自动向最接近的ECI规格进行资源规整，规整后的规格过大可能会造成一定程度的资源浪费。对于一些不影响业务的容器（例如Sidecar容器），可以为其设置环境变量，实现资源规整时忽略该容器，以避免资源浪费，节约ECI使用成本。\n## 功能说明\n\n指定vCPU和内存创建ECI实例时，您可以自定义指定每个容器的vCPU和内存，但汇总到实例级别时，需满足ECI实例整体的vCPU和内存约束。如果实例级别没有配置vCPU和内存，则会汇总计算所有容器的规格之和，对于总和不满足ECI规格的情况，系统会自动进行资源规整。\n\n一般情况下，容器内指定的vCPU和内存为容器资源上限，实际运行实例时，系统会动态调整资源分配。因此对于实例内一些不影响业务的特定容器，您可以通过设置环境变量__ECI_RESOURCE_IGNORE__:TRUE的方式，实现实例资源规整时忽略这些容器，避免资源规整后创建的实例规格过大，出现资源浪费。\n\n示例如下：\n\n如上图所示，假设在华东1（杭州）地域创建一个ECI实例，该ECI实例包含3个容器，容器1和2（业务容器）均配置为2 vCPU、4 GiB内存，容器3（Sidecar容器）配置为0.25 vCPU、0.5 GiB内存。一般情况下，系统会自动将实例规格规整到6 vCPU、10 GiB内存。但实际情况下可能并不需要6 vCPU、10 GiB的资源，在不影响业务的基础上，您可以为Sidecar容器设置环境变量__ECI_RESOURCE_IGNORE__:TRUE。配置后，系统会忽略Sidecar容器，将实例规格规整到4 vCPU、8GiB内存。\n## 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，在未设置Cpu和Memory的情况下，通过Container.N.Cpu和Container.N.Memory可以指定容器的vCPU和内存。对于想要配置资源规整忽略的容器，可以通过Container.N.EnvironmentVar.N.Key和Container.N.EnvironmentVar.N.Value来设置环境变量（__ECI_RESOURCE_IGNORE__:TRUE）。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nCpu\n\nFloat\n\n不设置\n\n实例级别vCPU大小。单位：核。\n\nMemory\n\nFloat\n\n不设置\n\n实例级别内存大小。单位：GiB。\n\nContainer.N.Cpu\n\nFloat\n\n2\n\n容器的vCPU大小。单位：核。N表示第几个容器，最多20个。\n\nContainer.N.Memory\n\nFloat\n\n4\n\n容器的内存大小。单位：GiB。N表示第几个容器，最多20个。\n\nContainer.N.EnvironmentVar.N.Key\n\nString\n\n__ECI_RESOURCE_IGNORE__\n\n环境变量名。第一个N表示第几个容器，第二个N表示第几个环境变量。\n\nContainer.N.EnvironmentVar.N.Value\n\nString\n\nTRUE\n\n环境变量值。第一个N表示第几个容器，第二个N表示第几个环境变量。说明 \n\n使用控制台创建ECI实例时，必须要设置实例级别的vCPU和内存，因此不涉及资源规整。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-when-the-system-adjusts-resources", "page_type": "doc", "title": "配置资源规整时忽略特定容器", "keywords": "忽略容器进行规整,降低ECI Pod成本,ECI资源规整原理,ECI Pod成本优化,ECI环境变量配置", "last_modified_ms": 1706754374000, "last_modified_iso": "2024-02-01T10:26:14+08:00", "excerpt": "创建ECI Pod（即ECI实例）时，如果指定的vCPU和内存规格不满足ECI规格约束，系统会在满足资源需求的同时自动向最接近的ECI规格进行资源规整，规整后的规格过大可能会造成一定程度的资源浪费。对于一些不影响业务的容器（例如Sidecar容器），可以为其设置环境变量，实现资源规整时忽略该容器，以避免资源浪费，节约ECI使用成本。\n\n## 功能说明\n\n指定vCPU和内存创建ECI实例时，您可以自定义指定每个容器的vCPU和内存，但汇总到实例级别时，需满足ECI实例整体的vCPU和内存约束。如果实例级别没有配置vCPU和内存，则会汇总计算所有容器的规格之和，对于总和不满足ECI规格的情况，系统会自动进行资源规整。\n\n一般情况下，容器内指定的vCPU和内存为容器资源上限，实际运行实例时，系统会动态调整资源分配。因此对于实例内一些不影响业务的特定容器，您可以通过设置环境变量__ECI_RESOURCE_IGNORE__:TRUE的方式，实现实例资源规整时忽略这些容器，避免资源规整后创建的实例规格过大，出现资源浪费。\n\n示例如下：\n\n如上图所示，假设在华东1（杭州）地域创建一个ECI实例，该ECI实例包含3个容器，容器1和2（业务容器）均配置为2 vCPU、4 GiB内存，容器3（Sidecar容器）配置为0.25 vCPU、0.5 GiB内存。一般情况下，系统会自动将实例规格规整到6 vCPU、10 GiB内存。但实际情况下可能并不需要6 vCPU、10 GiB的资源，在不影响业务的基础上，您可以为Sidecar容器设置环境变量__ECI_RESOURCE_IGNORE__:TRUE。配置后，系统会忽略Sidecar容器，将实例规格规整到4 vCPU、8GiB内存。\n## 配置说明\n\n为ECI Pod内的容器设置以下环境变量可以配置ECI资源规整忽略该容器：\n\nenv: \n- name: \"__ECI_RESOURCE_IGNORE__\"\n  value: \"TRUE\"\n\n\n## 配置示例\n\n按以下YAML创建Deployment，每个ECI Pod的规格为2 vCPU、4 GiB内存，即采用nginx1容器的limits，忽略nginx2容器的limits。说明 \n\n如果nginx2容器没有设置环境变量__ECI_RESOURCE_IGNORE__:TRUE，汇总nginx1容器和nginx2容器的资源需求为3 vCPU、6 GiB。在华东1（杭州）地域创建该Deployment时，资源规整后实际创建的ECI Pod为4 vCPU、6 GiB内存。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx1\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n          limits:\n            cpu: \"2000m\"    \n            memory: \"4096Mi\"   \n      - name: nginx2\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n          limits:\n            cpu: \"1000m\"    \n            memory: \"2048Mi\"   \n        env: \n        - name: \"__ECI_RESOURCE_IGNORE__\"\n          value: \"TRUE\"\n      restartPolicy: Always\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-when-the-system-adjusts-resources-1", "page_type": "doc", "title": "配置资源规整时忽略特定容器", "keywords": "忽略容器资源规整,节省ECI资源成本,ECI资源规整配置,ECI成本优化", "last_modified_ms": 1706754356000, "last_modified_iso": "2024-02-01T10:25:56+08:00", "excerpt": "创建ECI Pod（即ECI实例）时，如果指定的vCPU和内存规格不满足ECI规格约束，系统会在满足资源需求的同时自动向最接近的ECI规格进行资源规整，规整后的规格过大可能会造成一定程度的资源浪费。对于一些不影响业务的容器（例如Sidecar容器），可以为其设置环境变量，实现资源规整时忽略该容器，以避免资源浪费，节约ECI使用成本。\n\n## 功能说明\n\n指定vCPU和内存创建ECI实例时，您可以自定义指定每个容器的vCPU和内存，但汇总到实例级别时，需满足ECI实例整体的vCPU和内存约束。如果实例级别没有配置vCPU和内存，则会汇总计算所有容器的规格之和，对于总和不满足ECI规格的情况，系统会自动进行资源规整。\n\n一般情况下，容器内指定的vCPU和内存为容器资源上限，实际运行实例时，系统会动态调整资源分配。因此对于实例内一些不影响业务的特定容器，您可以通过设置环境变量__ECI_RESOURCE_IGNORE__:TRUE的方式，实现实例资源规整时忽略这些容器，避免资源规整后创建的实例规格过大，出现资源浪费。\n\n示例如下：\n\n如上图所示，假设在华东1（杭州）地域创建一个ECI实例，该ECI实例包含3个容器，容器1和2（业务容器）均配置为2 vCPU、4 GiB内存，容器3（Sidecar容器）配置为0.25 vCPU、0.5 GiB内存。一般情况下，系统会自动将实例规格规整到6 vCPU、10 GiB内存。但实际情况下可能并不需要6 vCPU、10 GiB的资源，在不影响业务的基础上，您可以为Sidecar容器设置环境变量__ECI_RESOURCE_IGNORE__:TRUE。配置后，系统会忽略Sidecar容器，将实例规格规整到4 vCPU、8GiB内存。\n## 配置说明\n\n为ECI Pod内的容器设置以下环境变量可以配置ECI资源规整忽略该容器：\n\nenv: \n- name: \"__ECI_RESOURCE_IGNORE__\"\n  value: \"TRUE\"\n\n\n## 配置示例\n\n按以下YAML创建Deployment，每个ECI Pod的规格为2 vCPU、4 GiB内存，即采用nginx1容器的limits，忽略nginx2容器的limits。说明 \n\n如果nginx2容器没有设置环境变量__ECI_RESOURCE_IGNORE__:TRUE，汇总nginx1容器和nginx2容器的资源需求为3 vCPU、6 GiB。在华东1（杭州）地域创建该Deployment时，资源规整后实际创建的ECI Pod为4 vCPU、6 GiB内存。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx1\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n          limits:\n            cpu: \"2000m\"    \n            memory: \"4096Mi\"   \n      - name: nginx2\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        resources:\n          limits:\n            cpu: \"1000m\"    \n            memory: \"2048Mi\"   \n        env: \n        - name: \"__ECI_RESOURCE_IGNORE__\"\n          value: \"TRUE\"\n      restartPolicy: Always\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/ignore-the-noready-state-of-the-sidecar-container", "page_type": "doc", "title": "忽略Sidecar容器的NotReady状态", "keywords": "忽略Sidecar容器NotReady,Sidecar容器状态配置,ECI环境变量配置", "last_modified_ms": 1703820651000, "last_modified_iso": "2023-12-29T11:30:51+08:00", "excerpt": "当您采用Sidecar容器的形式实现类似DaemonSet的效果时，如果Sidecar容器的状态为NotReady，会导致Pod状态为NotReady。某些场景下，如果您不希望Sidecar容器的状态影响整个Pod状态，可以通过环境变量的方式，设置忽略Sidecar容器的NotReady状态，保证Pod状态不受Sidecar容器状态的影响。\n## 功能说明\n\n在ACK Serverless集群+ECI场景下，由于虚拟节点的限制，ECI不支持Kubernetes的DaemonSet功能。此时部分需要使用DaemonSet的场景可以采用为ECI Pod添加Sidecar容器的形式来实现类似效果。但添加Sidecar容器后，如果Sidecar容器的状态为NotReady，会导致Pod状态为NotReady。\n\n在某些场景下，您可能会不希望Sidecar容器状态影响整个Pod状态，例如：使用Sidecar容器用于收集日志，但日志容器出现问题，不应该影响业务容器对外提供服务。\n\n针对上述场景，ECI支持了忽略容器NotReady状态的功能。如果您不希望某一容器的状态影响整个Pod状态，可以为其添加忽略容器状态的环境变量。添加后，当该容器出现NotReady状态时，也不会影响Pod进入Ready状态。\n## 配置说明\n\n忽略容器状态的环境变量为ECI_CONTAINER_IGNORE_READY，取值为true表示忽略该容器状态。\n## 配置示例\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件创建Deployment。\n\nkubectl apply -f test-ignore.yaml\n\n\ntest-ignore.yaml的内容示例如下，表示创建一个包含1个Pod副本的Deployment。Pod内包含两个容器，c1容器可以正常运行，c2容器由于缺少启动命令无法进入Ready状态。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test-ignore\n  labels:\n    app: test\nspec:\n  replicas: 1 \n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      labels:\n        app: test\n    spec:\n      containers:\n      - name: c1\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/perl:5\n        command: [\"/bin/sh\", \"-c\", \"sleep 999\"] \n      - name: c2\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/centos:7\n        env:\n        - name: ECI_CONTAINER_IGNORE_READY\n          value: \"true\"\n\n\n- \n\n查看Pod的详细信息，确认容器状态。\n\nkubectk get pod <pod-name> -o yaml\n\n\n在返回信息的status conditions中确认Ready和ContainersReady字段，可以看到两者的status均为True，表示已经忽略了c2容器的NotReady状态。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/implement-eci-pod-zone-distribution-or-affinity-scheduling", "page_type": "doc", "title": "实现ECI Pod可用区打散或亲和调度", "keywords": "实现ECI Pod可用区打散,实现ECI Pod可用区亲和,ECI Pod可用区调度,ECI Pod调度配置", "last_modified_ms": 1732846665000, "last_modified_iso": "2024-11-29T10:17:45+08:00", "excerpt": "高可用以及高性能是分布式任务执行过程中的重要要求。在ACK Pro版集群或ACK Serverless集群Pro版中，您可以通过Kubernetes原生调度语义实现分布式任务的跨可用区打散，以达到高可用区部署的要求，或者通过Kubernetes原生调度语义实现分布式任务在指定可用区中的亲和性部署，以达到高性能部署的要求。本文介绍如何实现ECI Pod可用区打散或亲和调度。\n## 背景信息\n\n在某些情况下，您可能需要将Pod分散部署到多个不同的可用区，或者部署到某个指定可用区，以实现高可用或者高性能的需求。此时，您可以通过Kubernetes原生调度语义中的Pod拓扑分布约束（topologySpreadConstraints）、节点亲和性（nodeAffinity）和Pod亲和性（podAffinity）来实现。重要 \n\n仅当Pod中带有nodeAffinity、podAffinity、topologySpreadConstraints字段或存在匹配的ResourcePolicy时才会启用可用区打散或亲和调度。\n\n更多信息，请参见Kubernetes官方文档：\n\n- \n\n[拓扑分布约束](https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/topology-spread-constraints/)\n- \n\n[将Pod指派给节点](https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)\n- \n\n[NodeAffinity](https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)\n- \n\n[PodAffinity](https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity)\n- \n\n[maxSkew](https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/topology-spread-constraints/#spread-constraint-definition)\n\n## 前提条件\n\n- \n\n已有ACK Pro版集群或ACK Serverless集群Pro版，并且满足以下要求：\n\n- \n\n集群版本为1.22及以上。\n- \n\n集群中的[ACK Virtual Node](https://help.aliyun.com/zh/ack/product-overview/ack-virtual-node)组件版本为v2.10.0及以上。\n- \n\n集群中的[kube-scheduler](https://help.aliyun.com/zh/ack/product-overview/kube-scheduler)组件版本为5.9及以上，并且已开启虚拟节点调度功能。更多信息，请参见[开启集群虚拟节点调度策略](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/enable-ack-serverless-cluster-virtual-node-scheduling-policy)。\n\n- \n\n已在eci-profile中配置多个期望调度的目标可用区（即配置多个交换机）。具体操作，请参见[多可用区创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-in-multiple-zones)。\n\n## 注意事项\n\n- \n\n目前仅支持设置topologyKey为topology.kubernetes.io/zone的用法。\n- \n\n如果ECI Pod通过k8s.aliyun.com/eci-schedule-strategy: \"VSwitchOrdered\"的Annotation声明了多可用区调度策略为按照交换机的指定顺序，当前功能将不生效。\n- \n\n如果ECI Pod通过k8s.aliyun.com/eci-fail-strategy: \"fail-fast\"的Annotation设置了Pod故障处理策略为fail-fast，当前功能将不生效。\n\n## 配置示例\n\n下文将在1.22版本的ACK Serverless集群Pro版本集群中演示ECI Pod可用区打散和亲和调度功能。\n### 示例一：通过topologySpreadConstraints实现可用区打散说明 \n\n以下为一个配置了拓扑打散约束的示例。默认情况下，Scheduler会将所有Pod均匀调度到所有可用区上，但并不会考虑Pod的生产结果。更多信息，请参见[ECI严格拓扑打散功能介绍](#7d1302c130i29)。\n\n- \n\n在工作负载声明中增加拓扑分布约束。\n\nPod的Spec字段中或Deployment、Job等工作负载的PodTemplate的Spec字段中，可以通过以下方式声明一个拓扑分布约束。\n\n  topologySpreadConstraints:\n    - maxSkew: <integer>\n      minDomains: <integer> # 可选，从v1.25开始成为Beta。\n      topologyKey: <string>\n      whenUnsatisfiable: <string>\n      labelSelector: <object>\n      matchLabelKeys: <list> # 可选，从v1.27开始成为Beta。\n      nodeAffinityPolicy: [Honor|Ignore] # 可选，从v1.26开始成为Beta。\n      nodeTaintsPolicy: [Honor|Ignore] # 可选，从v1.26开始成为Beta。\n\n\n本示例将创建一个在多个可用区上均匀分布的Deployment。关于参数的详细信息，请参见[topologySpreadConstraints字段](https://kubernetes.io/zh-cn/docs/concepts/scheduling-eviction/topology-spread-constraints/#topologyspreadconstraints-field)。以下为该Deployment的YAML文件。\n\n展开查看YAML文件\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: with-pod-topology-spread\n  labels:\n    app: with-pod-topology-spread\nspec:\n  replicas: 10\n  selector:\n    matchLabels:\n      app: with-pod-topology-spread\n  template:\n    metadata:\n      labels:\n        app: with-pod-topology-spread\n    spec:\n      topologySpreadConstraints:\n        - maxSkew: 1\n          topologyKey: topology.kubernetes.io/zone\n          whenUnsatisfiable: DoNotSchedule\n          labelSelector:\n            matchLabels:\n              app: with-pod-topology-spread\n      containers:\n      - name: with-pod-topology-spread\n        image: registry.k8s.io/pause:2.0\n        resources:\n          requests:\n            cpu: \"1\"\n            memory: \"256Mi\"\n\n\n- \n\n创建工作负载。\n\n将上面的代码保存为deployment.yaml，并执行以下命令将Deployment提交到集群中。\n\nkubectl apply -f deployment.yaml\n\n\n- \n\n验证工作负载调度结果。\n\n- \n\n通过以下命令查看生产出的Pod所在的节点。\n\nkubectl get po -lapp=with-pod-topology-spread -ocustom-columns=NAME:.metadata.name,NODE:.spec.nodeName --no-headers | grep -v \"<none>\"\n\n\n- \n\n通过以下命令查看生产出的Pod在各个可用区中的数量。\n\nkubectl get po -lapp=with-pod-topology-spread -ocustom-columns=NODE:.spec.nodeName --no-headers | grep"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/implementation-of-text-light-and-shadow-by-stable-diffusion-extension", "page_type": "doc", "title": "通过Stable Diffusion扩展插件实现文字光影图", "keywords": "实现文字光影图,部署Stable Diffusion,Stable Diffusion实践教程,数据缓存实践教程", "last_modified_ms": 1758531189000, "last_modified_iso": "2025-09-22T16:53:09+08:00", "excerpt": "本文以部署Stable Diffusion和ControlNet扩展插件实现文字光影效果图为例，演示如何使用数据缓存。通过数据缓存提前拉取Stable Diffusion和ControlNet模型数据，然后在创建Stable Diffusion应用实例时直接挂载模型数据，可以免去在实例中拉取模型数据的等待时间，加速应用部署。\n## 背景信息\n\nStable Diffusion是一个可以根据文字描述生成和修改图像的模型，支持扩展插件来丰富绘图效果。ControlNet是一个用于控制AI图像生成的插件。在Stable Diffusion上安装ControlNet扩展插件后，可以使用ControlNet来控制生成的图像效果，使得AI生成更贴近需求的图像。重要 \n\n- \n\n阿里云不对第三方模型的合法性、安全性、准确性进行任何保证，阿里云不对由此引发的任何损害承担责任。\n- \n\n您应自觉遵守第三方模型的用户协议、使用规范和相关法律法规，并就使用第三方模型的合法性、合规性自行承担相关责任。\n\n## 操作步骤\n### 创建数据缓存\n## 控制台\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本文使用以下模型作为示例，在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n\n- \n\nStable Diffusion模型：hanafuusen2001/BeautyProMix\n- \n\nControlNet模型：ioclab/ioc-controlnet\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/)。\n- \n\n在顶部菜单栏左上角处选择地域。重要 \n\n如业务部署在中国内地地域，可能会因为网络原因导致无法缓存HuggingFace的模型数据，建议在中国香港地域创建数据缓存，然后拷贝数据缓存到需要的地域。\n- \n\n在左侧导航栏，单击数据缓存。\n- \n\n创建数据缓存。\n\n单击创建数据缓存，分别创建hanafuusen2001/BeautyProMix和ioclab/ioc-controlnet的数据缓存。本文使用的参数示例如下，其中缓存数据源为拉取两个模型数据的固定配置，其他参数可自定义配置，更多信息，请参见[创建数据缓存](https://help.aliyun.com/zh/eci/user-guide/create-and-manage-data-caches#3c9228a032ffp)。\n\n[表格]\n\n配置项\n\nhanafuusen2001/BeautyProMix\n\nioclab/ioc-controlnet\n\n缓存所属Bucket\n\ntest\n\ntest\n\n缓存所属目录\n\n/model/beautypromix/\n\n/model/ioc/\n\n缓存名\n\nbeautypromix\n\nioc\n\n缓存大小\n\n20 GiB\n\n20 GiB\n\n缓存数据源\n\n- \n\n类型：URL\n- \n\n参数\n\n- \n\nrepoSource：HuggingFace/Model\n- \n\nrepoId：hanafuusen2001/BeautyProMix\n\n- \n\n类型：URL\n- \n\n参数\n\n- \n\nrepoSource：HuggingFace/Model\n- \n\nrepoId：ioclab/ioc-controlnet\n\n弹性公网IP\n\n- \n\n自动创建\n- \n\n带宽峰值：5 Mbps\n\n- \n\n自动创建\n- \n\n带宽峰值：5 Mbps\n\n- \n\n查看数据缓存状态。\n\n在数据缓存页面刷新查看数据缓存状态，当状态为Available时，表示可以使用该数据缓存。\n- \n\n拷贝数据缓存。\n\n如果当前数据缓存所在地域和要部署应用的地域不一致，可在数据缓存页面单击目标数据缓存的复制，将数据缓存拷贝到需要的地域。\n\n## OpenAPI\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本文使用以下模型作为示例，在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n\n- \n\nStable Diffusion模型：hanafuusen2001/BeautyProMix\n- \n\nControlNet模型：ioclab/ioc-controlnet\n\n- \n\n调用[CreateDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createdatacache)接口创建数据缓存。重要 \n\n- \n\n如业务部署在中国内地地域，可能会因为网络原因导致无法缓存HuggingFace的模型数据，建议在中国香港地域创建数据缓存，然后拷贝数据缓存到需要的地域。\n- \n\n如果您通过SDK创建数据缓存，DataSource.Options中的各个参数前无需添加参数名的长度，例如#10#repoSource直接写成repoSource，#6#repoId直接写成repoId即可。\n\n- \n\n创建hanafuusen2001/BeautyProMix的数据缓存。\n\n参数示例如下，表示从HuggingFace拉取指定模型数据，保存到名为test的Bucket的/model/beautypromix/目录。数据缓存名为beautypromix，保留时长为1天。拉取模型数据的过程中，会自动创建并绑定EIP。数据缓存创建完成后，EIP会被自动释放。\n\n{\n  \"RegionId\": \"cn-hongkong\",\n  \"Path\": \"/model/beautypromix/\",\n  \"Name\": \"beautypromix\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#10#repoSource\": \"HuggingFace/Model\",\n      \"#6#repoId\": \"hanafuusen2001/BeautyProMix\"\n    }\n  },\n  \"RetentionDays\": 1,\n  \"EipCreateParam\": {\n    \"Bandwidth\": 5\n  },\n  \"Bucket\": \"test\"\n}\n\n\n- \n\n创建ioclab/ioc-controlnet的数据缓存。\n\n参数示例如下，表示从HuggingFace拉取指定模型数据，保存到名为test的Bucket的/model/ioc/目录。数据缓存名为ioc，保留时长为1天。拉取模型数据的过程中，会自动创建并绑定EIP。数据缓存创建完成后，EIP会被自动释放。\n\n{\n  \"RegionId\": \"cn-hongkong\",\n  \"Path\": \"/model/ioc/\",\n  \"Name\": \"ioc\",\n  \"DataSource\": {\n    \"Type\": \"URL\",\n    \"Options\": {\n      \"#10#repoSource\": \"HuggingFace/Model\",\n      \"#6#repoId\": \"ioclab/ioc-controlnet\"\n    }\n  },\n  \"RetentionDays\": 1,\n  \"EipCreateParam\": {\n    \"Bandwidth\": 5\n  },\n  \"Bucket\": \"test\"\n}\n\n\n- \n\n查询数据缓存状态。\n\n根据返回的数据缓存ID调用[DescribeDataCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describedatacaches)接口查询数据缓存信息，当数据缓存的状态（DataCaches.Status）为Available时，表示可以使用该数据缓存。\n- \n\n拷贝数据缓存。\n\n如果当前数据缓存所在地域和要部署应用的地域不一致，可调用[CopyDataCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-copydatacache)接口将数据缓存拷贝到需要的地域。\n\n### 部署Stable Diffusion应用和插件\n## 控制台\n\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com/)的容器组页面，单击创建弹性容器组。\n- \n\n填写实例相关配置信息，然后单击配置确认。\n\n本文使用的参数示例如下，实例使用GPU规格，并挂载了hanafuusen2001/BeautyProMix和ioclab/ioc-controlnet的数据缓存。实例内容器使用ECI提供的包含Stable Diffusion应用的镜像，容器启动后会运行python3 launch.py --listen --skip-torch-cuda-test --port 8888 --no-half启动WebUI。重要 \n\n当VPC已绑定公网NAT网关时，创建ECI实例时可以不绑定EIP。在实例创建完成后，您可以配置DNAT条目实现外部访问ECI实例。\n\n[表格]\n\n配置区域\n\n配置项\n\n示例值\n\n容器组配置\n\n指定规格\n\necs.gn6i-c16g1.4xlarge\n\n名称\n\nsd-webui\n\n容器配置"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space", "page_type": "doc", "title": "增加临时存储空间大小", "keywords": "增加ECI临时存储,配置ECI临时存储,ECI临时存储配置,ECI临时存储原理", "last_modified_ms": 1723514231000, "last_modified_iso": "2024-08-13T09:57:11+08:00", "excerpt": "ECI Pod（即ECI实例）默认提供30 GiB的免费的临时存储空间，如果该存储空间大小无法满足您的需求，您可以自定义增加临时存储空间大小。\n## 背景信息\n\n每个ECI实例默认提供30 GiB的临时存储空间（免费），如下图所示。\n\n重要 \n\nECI实例启动所使用的容器镜像会占用该30 GiB空间。容器镜像需要占用的空间大小至少为容器镜像大小*2，具体大小视镜像的压缩率决定。\n\n如果您的存储需求大于30 GiB，可以自定义增加临时存储空间大小。新增加的临时存储空间会按容量大小和使用时长收取费用。更多信息，请参见[临时存储空间计费](https://help.aliyun.com/zh/eci/product-overview/temporary-storage-space)。\n## 配置说明\n\nKubernetes场景下，支持通过以下方式自定义增加临时存储空间大小：\n说明 \n\n两种方式均可以设置临时存储空间大小，但是语义有所差异：\n\n- \n\n方式一为limit语义，创建的临时存储空间大小是准确的。\n- \n\n方式二为request语义，创建临时存储空间时，可能还需要考虑镜像缓存因素，即实际创建的临时存储空间大小可能和request声明的不一致。更多信息，请参见[临时存储空间与镜像缓存的关系](#2a99047058of3)。\n\n如果同时使用两种方式，则取两者配置的较大值生效。\n\n### 方式一：添加Annotation\n\n在ECI Pod添加k8s.aliyun.com/eci-extra-ephemeral-storage的Annotation可以为其增加临时存储空间大小，设置的值即为增加的临时存储空间大小。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n### 方式二：设置容器的resource\n\n在容器的resource中可以声明ephemeral-storage相关request，如果声明的ephemeral-storage大小不超30 GiB，则不会增加临时存储空间；如果超出了30 GiB，则超出的部分即为增加的临时存储空间大小。\n## 配置示例\n\n- \n\n准备YAML文件。\n\n假设您要创建的ECI Pod需要增加20 GiB的临时存储空间，对应的YAML文件命名为extra-storage.yaml，YAML示例如下：\n\n- \n\n示例一：添加Annotation\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\n  annotations:\n    k8s.aliyun.com/eci-extra-ephemeral-storage: \"20Gi\"  # 自定义设置要增加的临时存储空间大小\nspec:\n  containers:\n  - name: nginx\n    image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: IfNotPresent\n  restartPolicy: Always\n\n\n- \n\n示例二：设置容器的resource\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n  - name: nginx\n    image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: IfNotPresent\n    resources: \n      requests: \n        ephemeral-storage: 50Gi   # 超出30 GiB的部分为增加的临时存储空间\n  restartPolicy: Always\n\n\n- \n\n创建Pod。\n\nkubectl apply -f extra-storage.yaml\n\n\n- \n\n查看临时存储空间是否生效。\n\n- \n\n查看增加的临时存储空间大小。\n\nkubectl describe pod test | grep k8s.aliyun.com/eci-extra-ephemeral-storage\n\n\n返回结果如下，已增加20 GiB的临时存储空间。\n\nk8s.aliyun.com/eci-extra-ephemeral-storage: 20Gi\n\n\n- \n\n通过exec命令进入容器，然后执行df -h命令查看容器的文件系统分区是否扩容成功。\n\nkubectl exec -it test -- sh\n\n\ndf -h\n\n\n返回结果如下，实际可用空间（overlay ）为增加的20 GiB加上默认可用的30 GiB，共50 GiB。\n\nFilesystem      Size  Used Avail Use% Mounted on\noverlay          50G  2.1G   48G   5% /\ntmpfs            64M     0   64M   0% /dev\ntmpfs           1.9G     0  1.9G   0% /sys/fs/cgroup\n/dev/vda4        50G  2.1G   48G   5% /etc/hosts\nshm              64M     0   64M   0% /dev/shm\ntmpfs           4.0G   12K  4.0G   1% /run/secrets/kubernetes.io/serviceaccount\ntmpfs           1.9G     0  1.9G   0% /proc/acpi\ntmpfs           1.9G     0  1.9G   0% /sys/firmware\n\n\n## 临时存储空间与镜像缓存的关系\n\n根据镜像缓存的创建方式的不同，生成的临时存储空间存在差异。\n\n- \n\n自动创建的镜像缓存基于系统盘实现。创建ECI实例时，如果使用的镜像缓存为自动创建的，则临时存储空间会在系统盘。此时，系统盘分区（/dev/vda5）大小即为临时存储空间大小，如下图所示。\n\n- \n\n手动创建的镜像缓存基于数据盘实现。创建ECI实例时，如果使用的镜像缓存为手动创建的，则临时存储空间会在数据盘。此时，系统盘分区（/dev/vda5）大小保持默认的30 GiB，且不会被使用。如下图所示。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space-1", "page_type": "doc", "title": "增加临时存储空间大小", "keywords": "增加ECI临时存储空间,ECI临时存储空间配置,ECI临时存储空间计费,ECI临时存储与镜像缓存", "last_modified_ms": 1721972117000, "last_modified_iso": "2024-07-26T13:35:17+08:00", "excerpt": "ECI实例默认提供30 GiB的免费的临时存储空间，如果该存储空间大小无法满足您的需求，您可以自定义增加临时存储空间大小。\n## 背景信息\n\n每个ECI实例默认提供30 GiB的临时存储空间（免费），如下图所示。\n\n重要 \n\nECI实例启动所使用的容器镜像会占用该30 GiB空间。容器镜像需要占用的空间大小至少为容器镜像大小*2，具体大小视镜像的压缩率决定。\n\n如果您的存储需求大于30 GiB，可以自定义增加临时存储空间大小。新增加的临时存储空间会按容量大小和使用时长收取费用。更多信息，请参见[临时存储空间计费](https://help.aliyun.com/zh/eci/product-overview/temporary-storage-space)。\n## 配置说明\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过EphemeralStorage参数来增加临时存储空间大小。EphemeralStorage的参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nEphemeralStorage\n\nInteger\n\n20\n\n增加的临时存储空间大小。单位：GiB。\n## 控制台\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-beijing)创建ECI实例时，在容器组配置区域，展开高级配置，可以输入要增加的临时存储空间的大小。\n\n## 临时存储空间与镜像缓存的关系\n\n根据镜像缓存的创建方式的不同，生成的临时存储空间存在差异。\n\n- \n\n自动创建的镜像缓存基于系统盘实现。创建ECI实例时，如果使用的镜像缓存为自动创建的，则临时存储空间会在系统盘。此时，系统盘分区（/dev/vda5）大小即为临时存储空间大小，如下图所示。\n\n- \n\n手动创建的镜像缓存基于数据盘实现。创建ECI实例时，如果使用的镜像缓存为手动创建的，则临时存储空间会在数据盘。此时，系统盘分区（/dev/vda5）大小保持默认的30 GiB，且不会被使用。如下图所示。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space-2", "page_type": "doc", "title": "增加临时存储空间大小", "keywords": "增加ECI临时存储,ECI临时存储配置,ECI临时存储原理", "last_modified_ms": 1723514246000, "last_modified_iso": "2024-08-13T09:57:26+08:00", "excerpt": "ECI Pod（即ECI实例）默认提供30 GiB的免费的临时存储空间，如果该存储空间大小无法满足您的需求，您可以自定义增加临时存储空间大小。\n## 背景信息\n\n每个ECI实例默认提供30 GiB的临时存储空间（免费），如下图所示。\n\n重要 \n\nECI实例启动所使用的容器镜像会占用该30 GiB空间。容器镜像需要占用的空间大小至少为容器镜像大小*2，具体大小视镜像的压缩率决定。\n\n如果您的存储需求大于30 GiB，可以自定义增加临时存储空间大小。新增加的临时存储空间会按容量大小和使用时长收取费用。更多信息，请参见[临时存储空间计费](https://help.aliyun.com/zh/eci/product-overview/temporary-storage-space)。\n## 配置说明\n\nKubernetes场景下，支持通过以下方式自定义增加临时存储空间大小：\n说明 \n\n两种方式均可以设置临时存储空间大小，但是语义有所差异：\n\n- \n\n方式一为limit语义，创建的临时存储空间大小是准确的。\n- \n\n方式二为request语义，创建临时存储空间时，可能还需要考虑镜像缓存因素，即实际创建的临时存储空间大小可能和request声明的不一致。更多信息，请参见[临时存储空间与镜像缓存的关系](#2a99047058of3)。\n\n如果同时使用两种方式，则取两者配置的较大值生效。\n\n### 方式一：添加Annotation\n\n在ECI Pod添加k8s.aliyun.com/eci-extra-ephemeral-storage的Annotation可以为其增加临时存储空间大小，设置的值即为增加的临时存储空间大小。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n### 方式二：设置容器的resource\n\n在容器的resource中可以声明ephemeral-storage相关request，如果声明的ephemeral-storage大小不超30 GiB，则不会增加临时存储空间；如果超出了30 GiB，则超出的部分即为增加的临时存储空间大小。\n## 配置示例\n\n- \n\n准备YAML文件。\n\n假设您要创建的ECI Pod需要增加20 GiB的临时存储空间，对应的YAML文件命名为extra-storage.yaml，YAML示例如下：\n\n- \n\n示例一：添加Annotation\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\n  annotations:\n    k8s.aliyun.com/eci-extra-ephemeral-storage: \"20Gi\"  # 自定义设置要增加的临时存储空间大小\nspec:\n  containers:\n  - name: nginx\n    image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: IfNotPresent\n  restartPolicy: Always\n\n\n- \n\n示例二：设置容器的resource\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test\nspec:\n  containers:\n  - name: nginx\n    image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: IfNotPresent\n    resources: \n      requests: \n        ephemeral-storage: 50Gi   # 超出30 GiB的部分为增加的临时存储空间\n  restartPolicy: Always\n\n\n- \n\n创建Pod。\n\nkubectl apply -f extra-storage.yaml\n\n\n- \n\n查看临时存储空间是否生效。\n\n- \n\n查看增加的临时存储空间大小。\n\nkubectl describe pod test | grep k8s.aliyun.com/eci-extra-ephemeral-storage\n\n\n返回结果如下，已增加20 GiB的临时存储空间。\n\nk8s.aliyun.com/eci-extra-ephemeral-storage: 20Gi\n\n\n- \n\n通过exec命令进入容器，然后执行df -h命令查看容器的文件系统分区是否扩容成功。\n\nkubectl exec -it test -- sh\n\n\ndf -h\n\n\n返回结果如下，实际可用空间（overlay ）为增加的20 GiB加上默认可用的30 GiB，共50 GiB。\n\nFilesystem      Size  Used Avail Use% Mounted on\noverlay          50G  2.1G   48G   5% /\ntmpfs            64M     0   64M   0% /dev\ntmpfs           1.9G     0  1.9G   0% /sys/fs/cgroup\n/dev/vda4        50G  2.1G   48G   5% /etc/hosts\nshm              64M     0   64M   0% /dev/shm\ntmpfs           4.0G   12K  4.0G   1% /run/secrets/kubernetes.io/serviceaccount\ntmpfs           1.9G     0  1.9G   0% /proc/acpi\ntmpfs           1.9G     0  1.9G   0% /sys/firmware\n\n\n## 临时存储空间与镜像缓存的关系\n\n根据镜像缓存的创建方式的不同，生成的临时存储空间存在差异。\n\n- \n\n自动创建的镜像缓存基于系统盘实现。创建ECI实例时，如果使用的镜像缓存为自动创建的，则临时存储空间会在系统盘。此时，系统盘分区（/dev/vda5）大小即为临时存储空间大小，如下图所示。\n\n- \n\n手动创建的镜像缓存基于数据盘实现。创建ECI实例时，如果使用的镜像缓存为手动创建的，则临时存储空间会在数据盘。此时，系统盘分区（/dev/vda5）大小保持默认的30 GiB，且不会被使用。如下图所示。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/kubernetes-imagecache-api", "page_type": "doc", "title": "kubernetes ImageCache API", "keywords": "创建ImageCache,查询ImageCache,删除ImageCache,ImageCache API参考,ImageCache数据类型", "last_modified_ms": 1672111578000, "last_modified_iso": "2022-12-27T11:26:18+08:00", "excerpt": "本文提供ImageCache API供您参考使用。\n## 数据类型\n### ImageCacheList\n\n[表格]\n\n字段\n\n类型\n\n描述\n\napiVersion\n\nString\n\nAPI版本。取值为eci.alibabacloud.com/v1。\n\nkind\n\nString\n\n资源类别。取值为ImageCacheList。\n\nmetadata\n\nListMeta\n\n元数据列表（Standard list metadata）。\n\nItems\n\nImageCache[]\n\n镜像缓存列表。\n### ImageCache\n\n[表格]\n\n字段\n\n类型\n\n描述\n\napiVersion\n\nString\n\nAPI版本。取值为eci.alibabacloud.com/v1。\n\nkind\n\nString\n\n资源类别。取值为ImageCache。\n\nmetadata\n\nObjectMeta\n\n对象metadata。\n\nspec\n\nImageCacheSpec\n\n镜像缓存详细信息。\n\nstatus\n\nImageCacheStatus\n\n镜像缓存状态信息。\n### ImageCacheSpec\n\n[表格]\n\n字段\n\n类型\n\n是否必选\n\n描述\n\nimages\n\nString[]\n\n是\n\n镜像缓存的镜像列表。\n\nimagePullSecrets\n\nString[]\n\n否\n\n私有镜像仓库对应的Secret列表，格式：namespace:secretName。\n\nimageCacheSize\n\nInt\n\n否\n\n镜像缓存的大小，取值范围为20~32768，单位为GB。默认为20 GB。\n\nretentionDays\n\nInt\n\n否\n\n镜像缓存保留时间，取值范围为1~65536，单位为天，默认永不过期。\n### ImageCacheStatus\n\n[表格]\n\n字段\n\n类型\n\n描述\n\nphase\n\nString\n\n镜像缓存状态。\n\nprogress\n\nString\n\n镜像缓存的制作进度。\n\nimageCacheId\n\nString\n\n镜像缓存ID。\n\nstartTime\n\nTime\n\n镜像缓存创建时间。\n\nlastUpdatedTime\n\nTime\n\n镜像缓存最后更新时间。\n\nevents\n\nEvent[]\n\n创建镜像缓存过程中的事件信息。\n\nexpireDateTime\n\nTime\n\n镜像缓存的过期时间。包括以下两种来源：\n\n- \n\n创建镜像缓存时设置的retentionDays。\n- \n\n创建失败的镜像缓存将自动在24小时后过期。\n\n## CreateImageCache\n\n本接口用于创建镜像缓存。\n### HTTP request\n\nPOST /apis/eci.alibabacloud.com/v1/imagecaches\n\n\n### curl request example\n\ncurl -X POST -H 'Content-Type: application/yaml' --data '\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-secrets-test\nspec:\n  images:\n  - registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\n  imagePullSecrets:\n  - default:acr-test\n' http://127.0.0.1:8001/apis/eci.alibabacloud.com/v1/imagecaches\n\n\n### curl response example\n\n{\n  \"apiVersion\": \"eci.alibabacloud.com/v1\",\n  \"kind\": \"ImageCache\",\n  \"metadata\": {\n    \"creationTimestamp\": \"2019-10-10T03:50:47Z\",\n    \"generation\": 1,\n    \"name\": \"imagecache-secrets-test\",\n    \"resourceVersion\": \"647052328\",\n    \"selfLink\": \"/apis/eci.alibabacloud.com/v1/imagecaches/imagecache-secrets-test11\",\n    \"uid\": \"2506ba37-eb11-11e9-9576-f2ef49bf****\"\n  },\n  \"spec\": {\n    \"imagePullSecrets\": [\n      \"default:acr-test\"\n    ],\n    \"images\": [\n      \"registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\"\n    ]\n  }\n}\n\n\n## ListImageCache\n\n本接口用于获取镜像缓存列表。\n### HTTP request\n\nGET /apis/eci.alibabacloud.com/v1/imagecaches\n\n\n### curl request example\n\ncurl -X GET 'http://127.0.0.1:8001/apis/eci.alibabacloud.com/v1/imagecaches'\n\n\n### curl response example\n\n{\n  \"apiVersion\": \"eci.alibabacloud.com/v1\",\n  \"items\": [\n    {\n      \"apiVersion\": \"eci.alibabacloud.com/v1\",\n      \"kind\": \"ImageCache\",\n      \"metadata\": {\n        \"annotations\": {\n          \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"eci.alibabacloud.com/v1\\\",\\\"kind\\\":\\\"ImageCache\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"imagecache-secrets-test\\\"},\\\"spec\\\":{\\\"imagePullSecrets\\\":[\\\"default:acr-test\\\"],\\\"images\\\":[\\\"registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\\\"]}}\\n\"\n        },\n        \"creationTimestamp\": \"2019-10-10T01:43:48Z\",\n        \"generation\": 1,\n        \"name\": \"imagecache-secrets-test\",\n        \"resourceVersion\": \"646375979\",\n        \"selfLink\": \"/apis/eci.alibabacloud.com/v1/imagecaches/imagecache-secrets-test\",\n        \"uid\": \"67460461-eaff-11e9-9774-b2c06862****\"\n      },\n      \"spec\": {\n        \"imagePullSecrets\": [\n          \"default:acr-test\"\n        ],\n        \"images\": [\n          \"registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\"\n        ]\n      },\n      \"status\": {\n        \"imageCacheId\": \"imc-2ze5xnx4yiply807****\",\n        \"lastUpdatedTime\": \"2019-10-10T01:47:14Z\",\n        \"phase\": \"Ready\",\n        \"progress\": \"100%\",\n        \"startTime\": \"2019-10-10T01:43:49Z\"\n      }\n    }\n  ],\n  \"kind\": \"ImageCacheList\",\n  \"metadata\": {\n    \"continue\": \"\",\n    \"resourceVersion\": \"647062964\",\n    \"selfLink\": \"/apis/eci.alibabacloud.com/v1/imagecaches\"\n  }\n}\n\n\n## GetImageCache\n\n本接口用于获取某一个镜像缓存的相关信息。\n### HTTP request\n\nGET /apis/eci.alibabacloud.com/v1/imagecaches/{name}\n\n\n### curl request example\n\ncurl -X GET 'http://127.0.0.1:8001/apis/eci.alibabacloud.com/v1/imagecaches/imagecache-secrets-test'\n\n\n### curl response exa"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/kubernetes-imagecache-api-2", "page_type": "doc", "title": "kubernetes ImageCache API", "keywords": "ImageCache API,调用ImageCache API,查询ImageCache API参数,ImageCache API参考,ImageCache API数据类型", "last_modified_ms": 1672111627000, "last_modified_iso": "2022-12-27T11:27:07+08:00", "excerpt": "本文提供ImageCache API供您参考使用。\n## 数据类型\n### ImageCacheList\n\n[表格]\n\n字段\n\n类型\n\n描述\n\napiVersion\n\nString\n\nAPI版本。取值为eci.alibabacloud.com/v1。\n\nkind\n\nString\n\n资源类别。取值为ImageCacheList。\n\nmetadata\n\nListMeta\n\n元数据列表（Standard list metadata）。\n\nItems\n\nImageCache[]\n\n镜像缓存列表。\n### ImageCache\n\n[表格]\n\n字段\n\n类型\n\n描述\n\napiVersion\n\nString\n\nAPI版本。取值为eci.alibabacloud.com/v1。\n\nkind\n\nString\n\n资源类别。取值为ImageCache。\n\nmetadata\n\nObjectMeta\n\n对象metadata。\n\nspec\n\nImageCacheSpec\n\n镜像缓存详细信息。\n\nstatus\n\nImageCacheStatus\n\n镜像缓存状态信息。\n### ImageCacheSpec\n\n[表格]\n\n字段\n\n类型\n\n是否必选\n\n描述\n\nimages\n\nString[]\n\n是\n\n镜像缓存的镜像列表。\n\nimagePullSecrets\n\nString[]\n\n否\n\n私有镜像仓库对应的Secret列表，格式：namespace:secretName。\n\nimageCacheSize\n\nInt\n\n否\n\n镜像缓存的大小，取值范围为20~32768，单位为GB。默认为20 GB。\n\nretentionDays\n\nInt\n\n否\n\n镜像缓存保留时间，取值范围为1~65536，单位为天，默认永不过期。\n### ImageCacheStatus\n\n[表格]\n\n字段\n\n类型\n\n描述\n\nphase\n\nString\n\n镜像缓存状态。\n\nprogress\n\nString\n\n镜像缓存的制作进度。\n\nimageCacheId\n\nString\n\n镜像缓存ID。\n\nstartTime\n\nTime\n\n镜像缓存创建时间。\n\nlastUpdatedTime\n\nTime\n\n镜像缓存最后更新时间。\n\nevents\n\nEvent[]\n\n创建镜像缓存过程中的事件信息。\n\nexpireDateTime\n\nTime\n\n镜像缓存的过期时间。包括以下两种来源：\n\n- \n\n创建镜像缓存时设置的retentionDays。\n- \n\n创建失败的镜像缓存将自动在24小时后过期。\n\n## CreateImageCache\n\n本接口用于创建镜像缓存。\n### HTTP request\n\nPOST /apis/eci.alibabacloud.com/v1/imagecaches\n\n\n### curl request example\n\ncurl -X POST -H 'Content-Type: application/yaml' --data '\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-secrets-test\nspec:\n  images:\n  - registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\n  imagePullSecrets:\n  - default:acr-test\n' http://127.0.0.1:8001/apis/eci.alibabacloud.com/v1/imagecaches\n\n\n### curl response example\n\n{\n  \"apiVersion\": \"eci.alibabacloud.com/v1\",\n  \"kind\": \"ImageCache\",\n  \"metadata\": {\n    \"creationTimestamp\": \"2019-10-10T03:50:47Z\",\n    \"generation\": 1,\n    \"name\": \"imagecache-secrets-test\",\n    \"resourceVersion\": \"647052328\",\n    \"selfLink\": \"/apis/eci.alibabacloud.com/v1/imagecaches/imagecache-secrets-test11\",\n    \"uid\": \"2506ba37-eb11-11e9-9576-f2ef49bf****\"\n  },\n  \"spec\": {\n    \"imagePullSecrets\": [\n      \"default:acr-test\"\n    ],\n    \"images\": [\n      \"registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\"\n    ]\n  }\n}\n\n\n## ListImageCache\n\n本接口用于获取镜像缓存列表。\n### HTTP request\n\nGET /apis/eci.alibabacloud.com/v1/imagecaches\n\n\n### curl request example\n\ncurl -X GET 'http://127.0.0.1:8001/apis/eci.alibabacloud.com/v1/imagecaches'\n\n\n### curl response example\n\n{\n  \"apiVersion\": \"eci.alibabacloud.com/v1\",\n  \"items\": [\n    {\n      \"apiVersion\": \"eci.alibabacloud.com/v1\",\n      \"kind\": \"ImageCache\",\n      \"metadata\": {\n        \"annotations\": {\n          \"kubectl.kubernetes.io/last-applied-configuration\": \"{\\\"apiVersion\\\":\\\"eci.alibabacloud.com/v1\\\",\\\"kind\\\":\\\"ImageCache\\\",\\\"metadata\\\":{\\\"annotations\\\":{},\\\"name\\\":\\\"imagecache-secrets-test\\\"},\\\"spec\\\":{\\\"imagePullSecrets\\\":[\\\"default:acr-test\\\"],\\\"images\\\":[\\\"registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\\\"]}}\\n\"\n        },\n        \"creationTimestamp\": \"2019-10-10T01:43:48Z\",\n        \"generation\": 1,\n        \"name\": \"imagecache-secrets-test\",\n        \"resourceVersion\": \"646375979\",\n        \"selfLink\": \"/apis/eci.alibabacloud.com/v1/imagecaches/imagecache-secrets-test\",\n        \"uid\": \"67460461-eaff-11e9-9774-b2c06862****\"\n      },\n      \"spec\": {\n        \"imagePullSecrets\": [\n          \"default:acr-test\"\n        ],\n        \"images\": [\n          \"registry.cn-shanghai.aliyuncs.com/baz/nginx:1.0\"\n        ]\n      },\n      \"status\": {\n        \"imageCacheId\": \"imc-2ze5xnx4yiply807****\",\n        \"lastUpdatedTime\": \"2019-10-10T01:47:14Z\",\n        \"phase\": \"Ready\",\n        \"progress\": \"100%\",\n        \"startTime\": \"2019-10-10T01:43:49Z\"\n      }\n    }\n  ],\n  \"kind\": \"ImageCacheList\",\n  \"metadata\": {\n    \"continue\": \"\",\n    \"resourceVersion\": \"647062964\",\n    \"selfLink\": \"/apis/eci.alibabacloud.com/v1/imagecaches\"\n  }\n}\n\n\n## GetImageCache\n\n本接口用于获取某一个镜像缓存的相关信息。\n### HTTP request\n\nGET /apis/eci.alibabacloud.com/v1/imagecaches/{name}\n\n\n### curl request example\n\ncurl -X GET 'http://127.0.0.1:8001/apis/eci.alibabacloud.com/v1/imagecaches/imagecache-secrets-test'\n\n\n### curl response exa"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance", "page_type": "doc", "title": "ECI Pod生命周期", "keywords": "了解ECI Pod生命周期,查询ECI Pod状态含义,ECI Pod生命周期,ECI Pod状态与计费", "last_modified_ms": 1688629996000, "last_modified_iso": "2023-07-06T15:53:16+08:00", "excerpt": "本文介绍ECI Pod（即ECI实例）的生命周期状态，您可以根据Pod状态，设计和实现符合您业务逻辑的处理逻辑。ECI已经跟Kubernetes完成对接，如果您是通过Kubernetes集群使用ECI，无需做额外的实现。\n\n## ECI Pod状态\n\n在ECI Pod的生命周期中，不同的阶段有其固有的状态，具体如下表所示。\n\n[表格]\n\nECI Pod状态\n\n说明\n\n对应Kubernetes Pod状态\n\n是否收费\n\n创建中（Scheduling）\n\nECI Pod正在创建。\n\nPending\n\n否\n\n启动中（Pending）\n\nECI Pod中有一个或多个容器还在启动中，并且没有处于运行中的容器。\n\nPending\n\n是\n\n运行中（Running）\n\nECI Pod中所有容器均已经创建成功，并且至少有一个容器正在运行中，或者正在重启。\n\nRunning\n\n是\n\n重启中（Restarting）\n\nECI Pod正在重启。\n\nPending\n\n是\n\n更新中（Updating）\n\nECI Pod正在更新。\n\nPending\n\n是\n\n终止中（Terminating）\n\nECI Pod正在终止。对于运行中的ECI Pod，如果配置了preStop，则在删除Pod时，Pod将进入Terminating状态。执行完preStop后，ECI Pod将自动删除。\n\nRunning\n\n是\n\n运行成功（Succeeded）\n\nECI Pod中所有容器均已运行成功终止，并且不会再重启。\n\nSucceeded\n\n否\n\n运行失败（Failed）\n\nECI Pod中所有容器均已运行终止，并且至少有一个容器是运行失败终止，即容器以非0状态退出或者被系统终止。\n\nFailed\n\n否\n\n过期（Expired）\n\nECI Pod属于抢占式实例，因资源到期回收而被终止。\n\nFailed\n\n否\n\n创建失败（ScheduleFailed）\n\nECI Pod创建失败。系统将在24小时后自动删除ECI Pod，不收取任何费用。\n\nFailed\n\n否重要 \n\nECI实例的重启策略仅决定实例内容器的行为，ECI实例不会被自动重启。\n\nECI实例的生命周期状态转换如下图所示。说明 \n\n- \n\n当ECI实例运行终止后，底层计算资源将会被回收。随实例一起创建的其它资源（例如EIP等）默认随实例一起释放。\n- \n\n终态（处于Failed、Succeeded或Expired状态）实例的元数据信息的保留情况如下：\n\n- \n\n1小时内的实例信息全部保留。\n- \n\n超出1小时的实例仅保留最近的100条（单个地域分别计算）。\n\n## 容器状态\n\n[表格]\n\n状态\n\n说明\n\n启动中（Waiting）\n\n容器正在等待创建，还未开始运行。\n\n一般在InitContainer运行时，应用容器会处于Waiting状态，直到InitContainer退出。\n\n运行中（Running）\n\n容器已经成功创建，并且正在运行。\n\n运行终止（Terminated）\n\n容器运行终止并退出，包括运行成功终止和运行失败终止。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-1", "page_type": "doc", "title": "ECI实例生命周期介绍", "keywords": "了解ECI实例生命周期,查询ECI实例状态含义,判断ECI实例是否收费,ECI实例生命周期,ECI实例状态说明", "last_modified_ms": 1688629971000, "last_modified_iso": "2023-07-06T15:52:51+08:00", "excerpt": "本文介绍ECI实例的生命周期状态，您可以根据实例状态，设计和实现符合您业务逻辑的处理逻辑。\n## ECI实例状态\n\n在实例的生命周期中，不同的阶段有其固有的状态，具体如下表所示。\n\n[表格]\n\nECI实例状态\n\n说明\n\n是否收费\n\n创建中（Scheduling）\n\n实例正在创建。\n\n否\n\n启动中（Pending）\n\n实例中有一个或多个容器还在启动中，并且没有处于运行中的容器。\n\n是\n\n运行中（Running）\n\n实例中所有容器均已经创建成功，并且至少有一个容器正在运行中，或者正在重启。\n\n是\n\n重启中（Restarting）\n\n实例正在重启。\n\n是\n\n更新中（Updating）\n\n实例正在更新。\n\n是\n\n终止中（Terminating）\n\n实例正在终止。对于运行中的实例，如果配置了preStop，则在删除实例时，实例将进入Terminating状态。执行完preStop后，实例将自动删除。\n\n是\n\n运行成功（Succeeded）\n\n实例中所有容器均已运行成功终止，并且不会再重启。\n\n否\n\n运行失败（Failed）\n\n实例中所有容器均已运行终止，并且至少有一个容器是运行失败终止，即容器以非0状态退出或者被系统终止。\n\n否\n\n过期（Expired）\n\n实例属于抢占式实例，因资源到期回收而被终止。\n\n否\n\n创建失败（ScheduleFailed）\n\n实例创建失败。系统将在24小时后自动删除实例，不收取任何费用。\n\n否重要 \n\nECI实例的重启策略仅决定实例内容器的行为，ECI实例不会被自动重启。\n\nECI实例的生命周期状态转换如下图所示。说明 \n\n- \n\n当ECI实例运行终止后，底层计算资源将会被回收。随实例一起创建的其它资源（例如EIP等）默认随实例一起释放。\n- \n\n终态（处于Failed、Succeeded或Expired状态）实例的元数据信息的保留情况如下：\n\n- \n\n1小时内的实例信息全部保留。\n- \n\n超出1小时的实例仅保留最近的100条（单个地域分别计算）。\n\n## 容器状态\n\n[表格]\n\n状态\n\n说明\n\n启动中（Waiting）\n\n容器正在等待创建，还未开始运行。\n\n一般在InitContainer运行时，应用容器会处于Waiting状态，直到InitContainer退出。\n\n运行中（Running）\n\n容器已经成功创建，并且正在运行。\n\n运行终止（Terminated）\n\n容器运行终止并退出，包括运行成功终止和运行失败终止。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-2", "page_type": "doc", "title": "ECI Pod生命周期", "keywords": "了解ECI Pod生命周期,查询ECI Pod状态含义,ECI Pod生命周期,ECI Pod状态说明,ECI Pod状态转换", "last_modified_ms": 1736851075000, "last_modified_iso": "2025-01-14T18:37:55+08:00", "excerpt": "本文介绍ECI Pod（即ECI实例）的生命周期状态，您可以根据Pod状态，设计和实现符合您业务逻辑的处理逻辑。ECI已经跟Kubernetes完成对接，如果您是通过Kubernetes集群使用ECI，无需做额外的实现。\n\n## ECI Pod状态\n\n在ECI Pod的生命周期中，不同的阶段有其固有的状态，具体如下表所示。\n\n[表格]\n\nECI Pod状态\n\n说明\n\n对应Kubernetes Pod状态\n\n是否收费\n\n创建中（Scheduling）\n\nECI Pod正在创建。\n\nPending\n\n否\n\n启动中（Pending）\n\nECI Pod中有一个或多个容器还在启动中，并且没有处于运行中的容器。\n\nPending\n\n是\n\n运行中（Running）\n\nECI Pod中所有容器均已经创建成功，并且至少有一个容器正在运行中，或者正在重启。\n\nRunning\n\n是\n\n重启中（Restarting）\n\nECI Pod正在重启。\n\nPending\n\n是\n\n更新中（Updating）\n\nECI Pod正在更新。\n\nPending\n\n是\n\n终止中（Terminating）\n\nECI Pod正在终止。对于运行中的ECI Pod，如果配置了preStop，则在删除Pod时，Pod将进入Terminating状态。执行完preStop后，ECI Pod将自动删除。\n\nRunning\n\n是\n\n运行成功（Succeeded）\n\nECI Pod中所有容器均已运行成功终止，并且不会再重启。\n\nSucceeded\n\n否\n\n运行失败（Failed）\n\nECI Pod中所有容器均已运行终止，并且至少有一个容器是运行失败终止，即容器以非0状态退出或者被系统终止。\n\nFailed\n\n否\n\n过期（Expired）\n\nECI Pod属于抢占式实例，因资源到期回收而被终止。\n\nFailed\n\n否\n\n创建失败（ScheduleFailed）\n\nECI Pod创建失败。系统将在24小时后自动删除ECI Pod，不收取任何费用。\n\nFailed\n\n否重要 \n\nECI实例的重启策略仅决定实例内容器的行为，ECI实例不会被自动重启。\n\nECI实例的生命周期状态转换如下图所示。说明 \n\n- \n\n当ECI实例运行终止后，底层计算资源将会被回收。随实例一起创建的其它资源（例如EIP等）默认随实例一起释放。\n- \n\n终态（处于Failed、Succeeded或Expired状态）实例的元数据信息的保留情况如下：\n\n- \n\n1小时内的实例信息全部保留。\n- \n\n超出1小时的实例仅保留最近的100条（单个地域分别计算）。\n\n## 容器状态\n\n[表格]\n\n状态\n\n说明\n\n启动中（Waiting）\n\n容器正在等待创建，还未开始运行。\n\n一般在InitContainer运行时，应用容器会处于Waiting状态，直到InitContainer退出。\n\n运行中（Running）\n\n容器已经成功创建，并且正在运行。\n\n运行终止（Terminated）\n\n容器运行终止并退出，包括运行成功终止和运行失败终止。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/limit-the-bandwidth-of-an-elastic-container-instance", "page_type": "doc", "title": "限制ECI实例的出入带宽", "keywords": "限制ECI实例带宽,ECI实例带宽限制,ECI实例网络配置", "last_modified_ms": 1705025229000, "last_modified_iso": "2024-01-12T10:07:09+08:00", "excerpt": "出于网络稳定性、安全性和QoS等考虑，如果您的业务有网络限速的需求，可以在创建ECI实例时，为其指定入方向和出方向的带宽，从而对出入流量进行限速。\n## 配置说明说明 \n\n仅支持通过OpenAPI配置，控制台暂不支持。\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过IngressBandwidth和EgressBandwidth参数来指定ECI实例的入方向和出方向的带宽值。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nIngressBandwidth\n\nLong\n\n102400\n\n入方向带宽，单位：字节。\n\nEgressBandwidth\n\nLong\n\n102400\n\n出方向带宽，单位：字节。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/manage-an-image-cache", "page_type": "doc", "title": "管理镜像缓存", "keywords": "管理镜像缓存,创建镜像缓存,镜像缓存管理,镜像缓存操作指南", "last_modified_ms": 1713318357000, "last_modified_iso": "2024-04-17T09:45:57+08:00", "excerpt": "镜像缓存可以加速拉取镜像，减少ECI实例启动耗时。本文介绍如何创建、查询、更新和删除镜像缓存。\n## 创建镜像缓存\n\n您可以通过控制台或者OpenAPI手动创建镜像缓存。说明 \n\nECI支持自动创建镜像缓存。在创建ECI实例时，如果开启了自动匹配镜像缓存，则在未匹配到镜像缓存的情况下，系统将自动创建镜像缓存。\n### 注意事项\n\n- \n\n创建镜像缓存涉及资源计费。建议您提前了解相关计费信息。更多信息，请参见[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches)。\n- \n\n创建镜像缓存前，您需要评估待缓存镜像的总大小，如果镜像总大小超过设置的缓存大小，将会创建失败。\n- \n\n创建镜像缓存时，系统将自动创建一个ECI实例和一块云盘用于中转创建镜像缓存。创建过程中请勿删除ECI实例和云盘，否则镜像缓存将创建失败。\n- \n\n创建镜像缓存将生成对应的快照。请勿删除快照，否则镜像缓存将会失效。\n\n### 通过OpenAPI创建\n\n您可以调用CreateImageCache接口来创建镜像缓存，主要参数说明如下表所示。更多信息，请参见[CreateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createimagecache)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nRegionId\n\nstring\n\ncn-hangzhou\n\n地域ID。\n\nSecurityGroupId\n\nstring\n\nsg-uf66jeqopgqa9hdn****\n\n安全组ID。\n\nVSwitchId\n\nstring\n\nvsw-uf6h3rbwbm90urjwa****\n\n交换机ID。\n\nImageCacheName\n\nstring\n\ntestcache\n\n镜像缓存名称。\n\nImage.N\n\narray\n\nregistry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10-perl\n\n用于制作镜像缓存的容器镜像。\n\nImageCacheSize\n\ninteger\n\n20\n\n镜像缓存大小。默认为20 GiB。\n\nRetentionDays\n\ninteger\n\n7\n\n镜像缓存保留时长，过期将会被清理。单位为：天。\n\nAutoMatchImageCache\n\nboolean\n\nfalse\n\n是否开启镜像缓存复用。开启后，新创建的镜像缓存可以复用已有镜像缓存的镜像层，加快镜像缓存的制作速度。默认为false。\n\nFlash\n\nboolean\n\ntrue\n\n是否开启极速镜像缓存功能。开启后，可以加速镜像缓存创建。默认为false。说明 \n\n创建镜像缓存时，支持设置AcrRegistryInfo相关参数，通过ACR企业版来免密拉取镜像。更多信息，请参见[配置ACR企业版免密](https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret-2#topic-1986148)。\n### 通过控制台创建\n\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com)的镜像缓存页面，单击创建镜像缓存。\n- \n\n在弹出页面，配置相关参数。\n\n相关参数说明如下：\n\n- \n\n基本参数：设置地域、可用区、专有网络和安全组等参数，用于创建中转实例。重要 \n\n如果镜像需要公网拉取，在专有网络没有配置NAT网关的情况下，请绑定弹性公网IP。\n- \n\n镜像缓存：输入镜像缓存名称，选择镜像地址和版本号，按需设置大小和保留时长。\n- \n\n镜像仓库访问凭证：如果镜像是私有镜像，请填写镜像仓库的地址、访问用户名和密码。\n\n- \n\n选中服务协议，单击确认创建，并根据提示完成后续操作。\n- \n\n在镜像缓存页面查看创建结果。\n\n状态列显示创建进度，当状态变为创建完成时，表示镜像缓存创建成功。单击镜像缓存ID，可以打开详情页面，查看基本信息和相关事件。\n\n## 查询镜像缓存\n\n创建镜像缓存后，您可以查询镜像缓存信息。当镜像缓存状态为创建完成（Ready）时，可以使用该镜像缓存。\n\n查询方式如下：\n\n- \n\n调用DescribeImageCaches接口可以查询镜像缓存信息。更多信息，请参见[DescribeImageCaches](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeimagecaches)。\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com)的镜像缓存页面查看镜像缓存的名称、状态等信息，单击镜像缓存ID可以查看事件等详细信息。\n\n## 更新镜像缓存\n\n对于状态为创建完成（Ready）或者UpdateFailed（更新失败）的镜像缓存，支持调用UpdateImageCache接口来更新镜像缓存，包括更新容器镜像、保留时长、镜像仓库信息等。更多信息，请参见[UpdateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updateimagecache)。\n## 删除镜像缓存\n\n镜像缓存对应一份快照，保留镜像缓存需要支付相应的快照费用。对于不再使用的镜像缓存，如果在创建时未设置保留时长，建议您及时手动删除。说明 \n\n自动创建的镜像缓存由阿里云管理，在一定时长后会被自动删除。\n\n- \n\n对于自动创建后从未使用过的镜像缓存，7天后会被自动删除。\n- \n\n对于自动创建后使用过的镜像缓存，当距离上一次使用的时间超过30天时，会被自动删除。\n\n删除方式如下：\n\n- \n\n调用DeleteImageCache接口可以删除镜像缓存。更多信息，请参见[DeleteImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-deleteimagecache)。\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com)的镜像缓存页面，选中目标镜像缓存，单击底部的删除镜像缓存即可删除。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/manage-image-caches", "page_type": "doc", "title": "管理ImageCache", "keywords": "管理ImageCache,创建ImageCache,配置ImageCache,ImageCache操作指南,ImageCache配置说明,ImageCache参数说明", "last_modified_ms": 1736851091000, "last_modified_iso": "2025-01-14T18:38:11+08:00", "excerpt": "阿里云以ImageCache CRD的方式将ECI的镜像缓存功能提供给Kubernetes用户，以便Kubernetes用户也可以使用该功能来加速创建Pod。本文介绍ImageCache资源，以及如何创建、查询和删除ImageCache。\n\n## 前提条件\n\n自建Kubernetes集群中已部署ImageCache CRD。具体操作，请参见[部署ImageCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-an-imagecache-crd#b6834d5024z9m)。\n\n## ImageCache配置说明\n\nImageCache的YAML配置文件如下，更多信息，请参见[kubernetes ImageCache API](https://help.aliyun.com/zh/eci/user-guide/kubernetes-imagecache-api-2#title-5jm-ltu-mfd)。\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/imc-enable-reuse: \"true\" #开启镜像缓存复用\nspec:\n  images:\n  - centos:latest\n  - busybox:latest\n  imagePullSecrets:\n  - default:secret1\n  - default:secret2\n  - kube-system:secret3\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n相关参数说明如下：\n\n[表格]\n\n名称\n\n类型\n\n是否必选\n\n描述\n\nspec.images\n\nString[]\n\n是\n\n用于创建镜像缓存的容器镜像列表。\n\nspec.imagePullSecrets\n\nString[]\n\n否\n\n镜像仓库对应的Secret列表。\n\n- \n\n如果镜像列表中包含私有仓库的镜像，则需要为私有镜像仓库创建Secret，然后按照namespace:secretName的格式设置该参数。\n- \n\n如果镜像列表中的镜像均为公有镜像，则无需设置该参数。\n\nspec.imageCacheSize\n\nint\n\n否\n\n镜像缓存大小。默认为20 GiB。取值范围为20~32768 GiB。\n\n请根据镜像的大小进行设置，镜像缓存的大小需≥镜像大小*2。\n\nspec.retentionDays\n\nint\n\n否\n\n镜像缓存保留时长，过期会被清理。单位为天。默认永不过期。说明 \n\nImageCache支持添加Annotation来充分使用镜像缓存功能，例如：在上述YAML示例中，添加了k8s.aliyun.com/imc-enable-reuse: \"true\" 的Annotation来开启镜像缓存复用。更多信息，请参见[ImageCache Annotation](https://help.aliyun.com/zh/eci/user-guide/annotations-that-can-be-added-to-create-an-image-cache-1#title-vrq-61t-bj0)。\n## 创建ImageCache\n\n- \n\n创建ImageCache。\n\nkubectl create -f imagecache-test.yaml\n\n\nimagecache-test.yaml的内容示例如下：\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample-test\n  annotations:\n    k8s.aliyun.com/imc-enable-reuse: \"true\" #开启镜像缓存复用\nspec:\n  images:\n  - registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n  - registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n- \n\n查看ImageCache状态。\n\nkubectl get imagecache imagecache-sample-test\n\n\n返回结果示例如下，当状态为Ready时，表示ImageCache创建完成，可以使用该ImageCache。\n\nNAME                     AGE     CACHEID                    PHASE   PROGRESS\nimagecache-sample-test   5m30s   imc-2ze2kbf9l1onf03z****   Ready   100%\n\n\n## 查询ImageCache\n\n创建ImageCache后，您可以根据需要查询集群下所有ImageCache列表或者查看某个ImageCache的详细信息：\n\n- \n\n查询集群下所有ImageCache列表\n\nkubectl get imagecache\n\n\n- \n\n查看某个ImageCache的详细信息\n\nkubectl get imagecache <imagecache-name> -o yaml\n\n\n## 删除ImageCache\n\nImageCache对应一份快照。对于手动创建的ImageCache，保留需要支付快照费用，如果不再使用，建议您及时手动删除。\n\n如果想要删除某个ImageCache，可执行如下命令：\n\nkubectl delete imagecache <imagecache-name>\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/manage-image-caches-1", "page_type": "doc", "title": "管理ImageCache", "keywords": "管理ImageCache资源,创建ImageCache,配置ImageCache,ImageCache操作指南,ImageCache配置说明", "last_modified_ms": 1732604402000, "last_modified_iso": "2024-11-26T15:00:02+08:00", "excerpt": "阿里云以ImageCache CRD的方式将ECI的镜像缓存功能提供给Kubernetes用户，以便Kubernetes用户也可以使用该功能来加速创建ECI Pod。本文介绍ImageCache资源，以及如何创建、查询和删除ImageCache。\n## 准备工作\n\n登录Kubernetes集群，执行以下命令，验证您的Kubernetes集群是否已经支持ImageCache。\n\nkubectl get crd/imagecaches.eci.alibabacloud.com\n\n\n- \n\n如果返回Error信息，则表示您的Kubernetes集群不支持ImageCache，返回示例如下：\n\nError from server (NotFound): customresourcedefinitions.apiextensions.k8s.io \"imagecaches.eci.alibabacloud.com\" not found\n\n\n如果您的Kubernetes集群不支持ImageCache，您需要升级VK（ack-virtual-node组件）到相应支持ImageCache的版本。说明 \n\n建议您升级VK到最新版本，以便更好地使用新功能。\n\n- \n\n关于ack-virtual-node组件的版本信息，请参见[ack-virtual-node](https://help.aliyun.com/zh/ack/product-overview/ack-virtual-node)。\n- \n\n关于如何升级组件，请参见[管理组件](https://help.aliyun.com/zh/ack/manage-system-components)。\n\n- \n\n如果返回imagecaches.eci.alibabacloud.com的信息，则表示您的Kubernetes集群已经支持ImageCache，返回示例如下：\n\nNAME                               CREATED AT\nimagecaches.eci.alibabacloud.com   2024-01-23T05:54:44Z\n\n\n如果您的Kubernetes集群的ImageCache CRD不是最新的，建议您执行kubectl apply命令重新部署。\n\nkubectl apply -f imagecache-crd-sample.yaml\n\n\n展开查看imagecache-crd-sample.yaml\n\napiVersion: apiextensions.k8s.io/v1beta1\nkind: CustomResourceDefinition\nmetadata:\n  name: imagecaches.eci.alibabacloud.com\nspec:\n  group: eci.alibabacloud.com\n  version: v1\n  names:\n    kind: ImageCache\n    plural: imagecaches\n    shortNames:\n    - ic\n    categories:\n    - all\n  scope: Cluster\n  subresources:\n    status: {}\n  validation:\n    openAPIV3Schema:\n      required:\n      - spec\n      properties:\n        spec:\n          type: object\n          required:\n          - images\n          properties:\n            imagePullSecrets:\n              type: array\n              items:\n                type: string\n            images:\n              minItems: 1\n              type: array\n              items:\n                type: string\n            imageCacheSize:\n              type: integer\n            retentionDays:\n              type: integer\n  additionalPrinterColumns:\n  - name: Age\n    type: date\n    JSONPath: .metadata.creationTimestamp\n  - name: CacheId\n    type: string\n    JSONPath: .status.imageCacheId\n  - name: Phase\n    type: string\n    JSONPath: .status.phase\n  - name: Progress\n    type: string\n    JSONPath: .status.progress\n\n\n## ImageCache配置说明\n\nImageCache的YAML配置文件如下，更多信息，请参见[kubernetes ImageCache API](https://help.aliyun.com/zh/eci/user-guide/kubernetes-imagecache-api#topic-2059054)。\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/imc-enable-reuse: \"true\" #开启镜像缓存复用\nspec:\n  images:\n  - centos:latest\n  - busybox:latest\n  imagePullSecrets:\n  - default:secret1\n  - default:secret2\n  - kube-system:secret3\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n相关参数说明如下：\n\n[表格]\n\n名称\n\n类型\n\n是否必选\n\n描述\n\nspec.images\n\nString[]\n\n是\n\n用于创建镜像缓存的容器镜像列表。\n\nspec.imagePullSecrets\n\nString[]\n\n否\n\n镜像仓库对应的Secret列表。\n\n- \n\n如果镜像列表中包含私有仓库的镜像，则需要为私有镜像仓库创建Secret，然后按照namespace:secretName的格式设置该参数。\n- \n\n如果镜像列表中的镜像均为公有镜像，则无需设置该参数。\n\nspec.imageCacheSize\n\nint\n\n否\n\n镜像缓存大小。默认为20 GiB。取值范围为20~32768 GiB。\n\n请根据镜像的大小进行设置，镜像缓存的大小需≥镜像大小*2。\n\nspec.retentionDays\n\nint\n\n否\n\n镜像缓存保留时长，过期会被清理。单位为天。默认永不过期。说明 \n\nImageCache支持添加Annotation来充分使用镜像缓存功能，例如在上述YAML示例中，添加了k8s.aliyun.com/imc-enable-reuse: \"true\" 的Annotation来开启镜像缓存复用。更多信息，请参见[ImageCache Annotation](https://help.aliyun.com/zh/eci/user-guide/annotations-that-can-be-added-to-create-an-image-cache#topic-2113932)。\n## 创建ImageCache\n\n- \n\n创建ImageCache。\n\nkubectl create -f imagecache-test.yaml\n\n\nimagecache-test.yaml的内容示例如下：\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample-test\n  annotations:\n    k8s.aliyun.com/imc-enable-reuse: \"true\" #开启镜像缓存复用\nspec:\n  images:\n  - registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n  - registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n- \n\n查看ImageCache状态。\n\nkubectl get imagecache imagecache-sample-test\n\n\n返回结果示例如下，当状态为Ready时，表示ImageCache创建完成，可以使用该ImageCache。\n\nNAME                     AGE     CACHEID                  "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/manually-connect-a-vnode-to-a-self-managed-kubernetes-cluster", "page_type": "doc", "title": "接入VNode（手动）", "keywords": "手动接入VNode,创建VNode,调度Pod到VNode,VNode接入指南,自建K8s对接ECI,VNode证书配置", "last_modified_ms": 1750403030000, "last_modified_iso": "2025-06-20T15:03:50+08:00", "excerpt": "如果您在线下IDC或者阿里云ECS上自建了Kubernetes集群，您需要在集群中部署虚拟节点（VNode）来使用ECI。本文为您介绍如何配置证书并手动创建VNode，以便在自建Kubernetes集群中可以使用ECI。\n## 前提条件\n\n- \n\n已部署好Kubernetes集群，且集群的版本属于1.16~1.30版本。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已通过高速通道、智能接入网关或者VPN网关打通IDC和云上网络。相关参考如下：\n\n- \n\n[高速通道](https://help.aliyun.com/zh/express-connect/product-overview/what-is-express-connect/#concept-ipg-pry-xdb)\n- \n\n[智能接入网关](https://help.aliyun.com/zh/sag/product-overview/what-is-sag#concept-2403019)\n- \n\n[VPN网关](https://help.aliyun.com/zh/vpn/product-overview/what-is-vpn-gateway#concept-r5s-gzv-wdb)\n\n## 准备工作\n\n操作前，请准备创建VNode所需的参数信息，并了解VNode所需的权限信息。需要准备的参数如下表所示。\n\n[表格]\n\n参数\n\n描述\n\n操作\n\n地域（Region）\n\n地域指的是物理的数据中心。请根据您以及您目标用户所在的地理位置，资源价格等因素选择合适的地域。更多信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n\nECI及其相关资源将创建在选择的地域下。\n\n您可以通过[弹性容器实例控制台](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/welcome)或者调用[DescribeRegions](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeregions)获取ECI支持的地域信息。\n\n专有网络（VPC）\n\n专有网络是您基于阿里云创建的自定义私有网络，不同的专有网络之间逻辑上彻底隔离。更多信息，请参见[什么是专有网络](https://help.aliyun.com/zh/vpc/what-is-vpc#concept-kbk-cpz-ndb)。\n\nECI及其相关资源将创建在您配置的专有网络中。说明 \n\n如果您的Kubernetes集群部署在线下IDC，请确保IDC网络与该VPC网络之间已实现网络互通。\n\n您可以在[专有网络控制台](https://vpc.console.aliyun.com/vpc/cn-hangzhou/vpcs)的专有网络页面创建并查看专有网络。\n\n交换机（vSwitch）\n\n交换机是组成专有网络的基础网络设备。交换机可以连接不同的云资源。在专有网络中创建ECI及其相关资源时，需要指定交换机（支持指定多个，系统将自动选择）。\n\n您可以在[专有网络控制台](https://vpc.console.aliyun.com/vpc/cn-hangzhou/switches)的交换机页面创建并查看交换机，根据已选的VPC来选择对应的交换机。\n\n安全组（Security Group）\n\n安全组是一种虚拟防火墙，可以控制组内资源的进出流量，从而提高网络安全性。更多信息，请参见[安全组概述](https://help.aliyun.com/zh/ecs/user-guide/overview-44#concept-o2y-mqw-ydb)。\n\nECI及其相关资源将加入到安全组中。说明 \n\n推荐使用企业安全组，并添加以下入方向的安全组规则：\n\n- \n\n允许VPC对应网段访问全部端口（1/65535）。\n- \n\n允许K8s API Server对应地址访问VNode服务端口（10250和10255端口）。\n\n您可以在[ECS管理控制台](https://ecs.console.aliyun.com/?#/securityGroup/region/cn-hangzhou)的安全组页面创建并查看安全组，根据已选的VPC来选择对应的安全组。\n\n创建VNode时，需要配置相关权限，包括原生K8s节点使用的标准权限，以及VNode所需的额外权限，具体如下表所示。\n\n[表格]\n\n类型\n\n权限\n\n说明\n\n标准权限\n\nsystem:node\n\nNode标准权限。\n\nsystem:node-proxier\n\nkube-proxy标准权限。\n\nsystem:certificates.k8s.io:certificatesigningrequests:nodeclient\n\nNode发起创建证书请求的权限。\n\nsystem:certificates.k8s.io:certificatesigningrequests:selfnodeclient\n\nNode基于已有证书发起创建证书请求的权限，即证书轮换权限。\n\n额外权限\n\npods update和pods patch\n\n更新Pod的Annotation。例如为Pod增加k8s.aliyun.com/eci-instance-id等Computed Annotation。\n\npvc update和pvc patch\n\n更新PVC的Annotation。\n## 配置集群\n\nVNode需要使用kubeconfig来接入集群。因此，创建VNode前需要为VNode签发证书（即kubeconfig）。 说明 \n\n如果使用集群admin证书，可跳过本节。\n\n- \n\n连接集群。\n- \n\n下载并执行配置脚本，选择TLS Bootstrap或ServiceAccount方式生成kubeconfig。\n## TLS Bootstrap\n\n如果有安全性要求，建议采用TLS Bootstrap方式。采用该方式时，将自动部署vnode-approver组件。vnode-approver组件用于签发Vnode提交的CSR请求，目前已开源至GitHub。更多信息，请参见[vnode-approver](https://github.com/aliyuneci/vnode-approver)。\n\ncurl -fsSL https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnode-deploy.sh | bash -s -- bootstrap\n\n\n## ServiceAccount\n\n该方式不支持证书轮换。签发证书时需确保token有足够的有效期（或者设置为不过期），防止因证书过期导致VNode无法正常工作。\n\ncurl -fsSL https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnode-deploy.sh | bash -s -- common\n\n\n- \n\n检查kubeconfig。\n\n生成的kubeconfig名为vnode-config。执行以下命令查看kubeconfig。\n\ncat vnode-config\n\n\n检查时，请注意以下几点：\n\n- \n\n确认待创建VNode的VPC网络能够连接到server地址（处于同一VPC或已打通网络）。\n\n- \n\n如果server地址是IP地址，需确保VNode所在VPC能够访问该IP地址。\n- \n\n如果server地址是域名，需确保阿里云VPC内能够解析该域名，且VNode所在VPC可以访问域名解析后的IP地址。\n\n- \n\n如果certificate-authority-data的内容为空，请检查~/.kube/config中的相应字段是否使用了PATH。\n\nkubeconfig的内容示例如下：\n## TLS Bootstrap\n\napiVersion: v1\nkind: Config\ncurrent-context: kubernetes-admin@kubernetes\ncontexts:\n- name: kubernetes-admin@kubernetes\n  context:\n    cluster: kubernetes-admin@kubernetes\n    user: vnode\n    namespace: kube-system\nclusters:\n- name: kubernetes-admin@kubernetes\n  cluster:\n    certificate-authority-data: \"*****************************************==\"\n    server: https://10.16.XX.XX:6443\nusers:\n- name: vnode\n  user:\n    token: ******.****************\n\n\n## ServiceAccount\n\napiVersion: v1\nkind: Config\ncurrent-context: kubernetes-admin@kubernetes\ncontexts:\n- name: kubernetes-admin@kubernetes\n  context:\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-a-configfile-volume", "page_type": "doc", "title": "挂载ConfigFile数据卷", "keywords": "为ECI挂载ConfigFile数据卷,注入ECI实例配置数据,ConfigFile数据卷挂载,ConfigFile数据卷配置", "last_modified_ms": 1731636185000, "last_modified_iso": "2024-11-15T10:03:05+08:00", "excerpt": "ConfigFile数据卷是一种用于存储配置文件的数据卷，可以向ECI实例注入配置数据。本文介绍如何为ECI实例挂载ConfigFile数据卷。\n## 使用限制\n\nConfigFile数据卷中，单个配置文件不能大于32 KB，多个配置文件的总和不能大于60 KB。\n## 配置说明（OpenAPI）\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Volume相关参数声明数据卷，然后通过Container.VolumeMount相关参数为容器挂载数据卷。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/api-createcontainergroup)。\n#### 声明数据卷\n\n通过Volume相关参数声明数据卷时，需要先明确Volume的名称和类型。再根据Volume.N.Type的取值，进一步配置该类型数据卷的相关参数。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVolume.N.Name\n\nString\n\ntest-volume\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nConfigFileVolume\n\n取值为ConfigFileVolume，表示声明一个ConfigFile类型的数据卷。\n\nVolume.N.ConfigFileVolume.ConfigFileToPath.N.Path\n\nString\n\ntest/config-test.cnf\n\n相对于挂载目录，配置文件所在的相对文件路径。\n\nVolume.N.ConfigFileVolume.ConfigFileToPath.N.Content\n\nString\n\nbGl1bWk=\n\n配置文件内容。需要将内容进行Base64编码。\n\nVolume.N.ConfigFileVolume.DefaultMode\n\nInteger\n\n0644\n\n配置文件的默认权限，采用四位八进制数表示。\n\n例如0644表示权限为-rw-r--r--，0对应-，表示文件类型为普通文件，644对应后续9位字符，表示3组权限，即用户权限为rw-，用户所在组权限为r--，其他用户权限为r--。\n\n权限说明如下：\n\n- \n\n---：没有任何权限，八进制值为0。\n- \n\n--x：只有执行权限，八进制值为1。\n- \n\n-w-：只有写入权限，八进制值为2。\n- \n\n-wx：有写入和执行权限，八进制值为3。\n- \n\nr--：只有读取权限，八进制值为4。\n- \n\nr-x：有读取和执行权限，八进制值为5。\n- \n\nrw-：有读取和写入权限，八进制值为6。\n- \n\nrwx：具有读取、写入和执行权限，八进制值为7。\n\nVolume.N.ConfigFileVolume.ConfigFileToPath.N.Mode\n\nInteger\n\n0644\n\n配置文件的权限，如果没有设置，则采用ConfigFileVolume.DefaultMode的值。采用四位八进制数表示。\n\n例如0644表示权限为-rw-r--r--，0对应-，表示文件类型为普通文件，644对应后续9位字符，表示3组权限，即用户权限为rw-，用户所在组权限为r--，其他用户权限为r--。\n\n权限说明如下：\n\n- \n\n---：没有任何权限，八进制值为0。\n- \n\n--x：只有执行权限，八进制值为1。\n- \n\n-w-：只有写入权限，八进制值为2。\n- \n\n-wx：有写入和执行权限，八进制值为3。\n- \n\nr--：只有读取权限，八进制值为4。\n- \n\nr-x：有读取和执行权限，八进制值为5。\n- \n\nrw-：有读取和写入权限，八进制值为6。\n- \n\nrwx：具有读取、写入和执行权限，八进制值为7。\n\n##### 挂载数据卷\n\n声明数据卷后，可以通过VolumeMount相关参数将数据卷挂载到容器中。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.VolumeMount.N.Name\n\nString\n\ntest-volume\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/usr/share\n\n挂载目录。\n\n容器挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n\nContainer.N.VolumeMount.N.SubPath\n\nString\n\n/usr/sub\n\n数据卷下的子目录。方便实例将同一个数据卷下的不同目录挂载到容器的不同目录。\n\nContainer.N.VolumeMount.N.ReadOnly\n\nBoolean\n\nfalse\n\n挂载目录是否只读。默认为false。\n\nContainer.N.VolumeMount.N.MountPropagation\n\nString\n\nNone\n\n数据卷的挂载传播设置。挂载传播允许将容器挂载的卷共享到同一ECI实例中的其他容器，甚至可以共享到同一宿主机上的其他ECI实例。取值范围：\n\n- \n\nNone：该卷不感知任何后续在此卷或其子目录上执行的挂载操作。\n- \n\nHostToContainer：该卷将会感知到后续在此卷或其子目录上的挂载操作。\n- \n\nBidirectional：和HostToContainer类似，能感知挂载操作。另外，该卷将被传播回宿主机和使用同一卷的所有ECI实例的所有容器。\n\n默认值：None。说明 \n\nInit容器也支持挂载数据卷，参数与上表类似，只需要将Container改为InitContainer。\n## 配置说明（控制台）\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-beijing)创建ECI实例时，您可以在容器组配置区域声明数据卷，然后在容器配置区域，将数据卷挂载到容器中。\n#### 声明数据卷\n\n- \n\n在容器组配置区域，展开高级配置。\n- \n\n在存储处选择配置项页签，单击添加。\n- \n\n配置ConfigFile数据卷的相关参数。\n\n- \n\n名称：ConfigFile数据卷的名称。\n- \n\n配置文件Path：配置文件所在的相对文件路径。\n- \n\n文件内容：配置文件的内容。请明文输入，控制台会自动进行Base64编码。\n\n#### 挂载数据卷\n\n- \n\n在容器配置区域选择容器，展开该容器的高级配置。\n- \n\n打开存储开关后单击添加。\n\n此处可添加的数据卷为配置容器组时声明的数据卷。\n\n说明 \n\n如果要为多个容器挂载数据卷，请选择其他容器，重复上述操作。\n## 配置示例\n\n调用CreateContainerGroup接口创建ECI实例，并为其挂载ConfigFile数据卷。参数示例如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\nContainerGroupName=test-configfile\n#声明数据卷\nVolume.1.Name=configfile-demo\nVolume.1.Type=HostPathVolume\nVolume.1.ConfigFileVolume.ConfigFileToPath.1.Path=test/config-test.cnf\nVolume.1.ConfigFileVolume.ConfigFileToPath.1.Content=c2VydmVyLnBvcnQgPSA4MDgw\nVolume.1.ConfigFileVolume.DefaultMode=0644\n#为容器挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=configfile-demo\nContainer.1.VolumeMount.1.MountPath=/data\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-a-disk-volume", "page_type": "doc", "title": "挂载云盘数据卷", "keywords": "为ECI实例挂载云盘,配置ECI云盘数据卷,ECI挂载云盘配置,ECI挂载云盘限制", "last_modified_ms": 1728539067000, "last_modified_iso": "2024-10-10T13:44:27+08:00", "excerpt": "云盘是阿里云提供的数据块级别的存储产品，具有低时延、高性能、持久性、高可靠等特点。通过FlexVolume插件，ECI支持挂载云盘作为数据卷。本文介绍如何为ECI实例挂载云盘数据卷。\n## 使用限制\n\n- \n\n待挂载的云盘必须是按量付费。更多信息，请参见[块存储计费](https://help.aliyun.com/zh/ecs/block-storage-devices)。\n- \n\n云盘为非共享存储，一个云盘只能挂载到一个实例上。\n- \n\n一个ECI实例最多可以挂载6个云盘数据卷。\n- \n\n云盘只能挂载到相同可用区的实例上，不支持跨可用区挂载。\n- \n\n不支持挂载开启多重挂载功能的云盘（即NVMe共享盘）。\n- \n\n不支持挂载已创建分区的云盘。\n\n## 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Volume相关参数声明数据卷，然后通过Container.VolumeMount相关参数为容器挂载数据卷。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/api-createcontainergroup)。\n#### 声明数据卷\n\n通过Volume相关参数声明数据卷时，需要先明确Volume的名称和类型。再根据Volume.N.Type的取值，进一步配置该类型数据卷的相关参数。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVolume.N.Name\n\nString\n\ndisk-demo\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nFlexVolume\n\n取值为FlexVolume，表示创建一个通过FlexVolume插件挂载的数据卷。\n\nVolume.N.FlexVolume.Driver\n\nString\n\nalicloud/disk\n\n使用FlexVolume插件挂载数据卷时的驱动类型。目前支持alicloud/disk，表示挂载阿里云云盘。\n\nVolume.N.FlexVolume.FsType\n\nString\n\next4\n\n文件系统类型。您可以选择以哪种数据类型将数据存储到云盘上，支持的类型包括ext4、ext3、xfs、vfat。默认为ext4。\n\nVolume.N.FlexVolume.Options\n\nString\n\n{\"volumeSize\":\"50\",\"tags\":\"test:eci\"}\n\nFlexVolume对象选项列表。为键值对形式，采用JSON传递。\n\n通过FlexVolume挂载云盘时，Options表示云盘数据卷的配置参数，可配置的参数如下：重要 \n\n当volumeId为空，volumeSize字段为必填；当volumeId有值时，volumeSize等云盘属性相关参数值均会被忽略。\n\n- \n\n静态指定已有云盘\n\n- \n\nvolumeId：已有云盘ID。\n\n- \n\n动态创建新的云盘\n\n- \n\nvolumeSize：云盘大小，单位为GiB。取值范围为20~32768。说明 \n\n如果基于快照创建云盘（配置了snapshotId参数），则实际创建的云盘大小为以下两者的较大值：\n\n- \n\n此处配置的值\n- \n\n快照来源云盘大小\n\n- \n\nperformanceLevel：云盘性能等级。默认采用ESSD云盘，暂不支持指定云盘类型。更多信息，请参见[ESSD云盘](https://help.aliyun.com/zh/ecs/user-guide/essds)。\n- \n\ndeleteWithInstance：是否随实例释放云盘，默认为true。\n- \n\nencrypted：是否加密云盘，默认为false。更多信息，请参见[加密概述](https://help.aliyun.com/zh/ecs/user-guide/encryption-overview)。\n- \n\nkmsKeyId：加密云盘时，云盘使用的KMS密钥ID。\n- \n\ntags：云盘要绑定的标签，最多可以绑定20个。格式为\"tagkey1:tagvalue1,tagkey2:tagvalue2\"。\n- \n\nsnapshotId：快照ID。快照是某一时间点云盘数据状态的备份文件，基于快照创建云盘可以获取快照包含的数据。更多信息，请参见[快照概述](https://help.aliyun.com/zh/ecs/user-guide/snapshot-overview)。说明 \n\n如果快照来源云盘已创建过分区，则不支持使用该快照创建云盘挂载到ECI实例。\n\n##### 挂载数据卷\n\n声明数据卷后，可以通过VolumeMount相关参数将数据卷挂载到容器中。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.VolumeMount.N.Name\n\nString\n\ntest-volume\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/usr/share\n\n挂载目录。\n\n容器挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n\nContainer.N.VolumeMount.N.SubPath\n\nString\n\n/usr/sub\n\n数据卷下的子目录。方便实例将同一个数据卷下的不同目录挂载到容器的不同目录。\n\nContainer.N.VolumeMount.N.ReadOnly\n\nBoolean\n\nfalse\n\n挂载目录是否只读。默认为false。\n\nContainer.N.VolumeMount.N.MountPropagation\n\nString\n\nNone\n\n数据卷的挂载传播设置。挂载传播允许将容器挂载的卷共享到同一ECI实例中的其他容器，甚至可以共享到同一宿主机上的其他ECI实例。取值范围：\n\n- \n\nNone：该卷不感知任何后续在此卷或其子目录上执行的挂载操作。\n- \n\nHostToContainer：该卷将会感知到后续在此卷或其子目录上的挂载操作。\n- \n\nBidirectional：和HostToContainer类似，能感知挂载操作。另外，该卷将被传播回宿主机和使用同一卷的所有ECI实例的所有容器。\n\n默认值：None。说明 \n\nInit容器也支持挂载数据卷，参数与上表类似，只需要将Container改为InitContainer。\n## 配置示例\n\n调用CreateContainerGroup接口创建ECI实例，并为其挂载云盘数据卷。所采用的参数示例如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n- \n\n示例一：静态\n\nContainerGroupName=test-disk1\nSecurityGroupId=sg-bp1daxpbz9lzpvvc****\nVSwitchId=vsw-bp1gds63lmlm7ib05****\n#声明数据卷\nVolume.1.Name=disk-demo\nVolume.1.Type=FlexVolume\nVolume.1.FlexVolume.Driver=alicloud/disk\nVolume.1.FlexVolume.FsType=ext4\nVolume.1.FlexVolume.Options={\"volumeId\":\"d-2zebuamrpar7xnj****\"}\n#为容器挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=disk-demo\nContainer.1.VolumeMount.1.MountPath=/data\n\n说明 \n\n静态挂载时，指定的云盘必须处于待挂载状态，且与待创建的ECI实例处于同一可用区。\n- \n\n示例二：动态\n\nContainerGroupName=test-disk2\n#声明数据卷\nVolume.1.Name=disk-demo\nVolume.1.Type=FlexVolume\nVolume.1.FlexVolume.Driver=alicloud/disk\nVolume.1.FlexVolume.FsType=ext4\nVolume.1.FlexVolume.Options={\"volumeSize\":\"50\",\"tags\":\"test:eci\"}\n#为容器挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=disk-demo\nContainer.1.VolumeMount.1.MountPath=/data\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-a-disk-volume-3", "page_type": "doc", "title": "挂载云盘", "keywords": "静态挂载云盘,动态挂载云盘,ECI使用云盘,云盘挂载方法", "last_modified_ms": 1707184720000, "last_modified_iso": "2024-02-06T09:58:40+08:00", "excerpt": "云盘是阿里云提供的数据块级别的存储产品，具有低时延、高性能、持久性、高可靠等特点。部署阿里云CSI插件后，您可以在自建的Kubernetes集群使用阿里云云盘作为Volume。使用PVC方式挂载云盘时，支持静态数据卷和动态数据卷，本文为您介绍如何使用PVC方式，挂载云盘到ECI Pod上。\n## 前提条件\n\n- \n\n自建Kubernetes集群中已部署VNode。\n- \n\n集群版本为1.16及以上版本，且已部署CSI-Provisioner组件。重要 \n\n关于如何部署CSI-Provisioner组件，请参见[alibaba-cloud-csi-driver](https://github.com/kubernetes-sigs/alibaba-cloud-csi-driver/tree/master/deploy)。如果部署过程中出现问题，请在GitHub提交issue。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已打通IDC与阿里云的网络。\n\n## 注意事项\n\n挂载云盘时，请注意以下事项：\n\n- \n\n云盘为非共享存储，一个云盘只能挂载到一个Pod。\n- \n\n云盘只能挂载到相同可用区的VNode节点下的ECI Pod，不支持跨可用区挂载。\n\n## 静态挂载云盘\n\n- \n\n创建云盘。\n\n- \n\n登录[ECS管理控制台](https://ecs.console.aliyun.com/disk/region/cn-hangzhou)。\n- \n\n在VNode对应的地域和可用区下，创建一个按量付费的云盘。\n\n关于如何创建云盘，请参见[创建云盘](https://help.aliyun.com/zh/ecs/user-guide/create-a-disk#concept-jx1-tx1-ydb)。创建完成后，请记录云盘ID。说明 \n\n如果您使用已有云盘，请确保该云盘所属的地域和可用区与VNode一致，且该云盘未进行分区格式化。\n\n- \n\n创建PV。\n\n- \n\n参考参数说明表修改以下YAML内容，并保存为static-disk-pv.yaml。\n\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: static-disk-pv\n  labels:\n    alicloud-pvname: static-disk-pv\nspec:\n  capacity:\n    storage: 25Gi\n  accessModes:\n    - ReadWriteOnce\n  persistentVolumeReclaimPolicy: Retain\n  csi:\n    driver: diskplugin.csi.alibabacloud.com\n    volumeHandle: \"<your disk-id>\"    #替换为云盘ID\n  nodeAffinity:\n    required:\n      nodeSelectorTerms:\n      - matchExpressions:\n        - key: topology.diskplugin.csi.alibabacloud.com/zone\n          operator: In\n          values:\n          - \"<your-node-zone-id>\"   #替换为VNode所在可用区\n\n\n相关参数说明如下表所示：\n\n[表格]\n\n参数\n\n描述\n\ndriver\n\n驱动类型。此处配置为diskplugin.csi.alibabacloud.com，表示使用阿里云云盘CSI插件。\n\nvolumeHandle\n\n云盘ID。\n- \n\n执行以下命令创建PV。\n\nkubectl create -f static-disk-pv.yaml\n\n\n- \n\n创建PVC。\n\n- \n\n将以下内容保存为static-disk-pvc.yaml。\n\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: static-disk-pvc\nspec:\n  accessModes:\n  - ReadWriteOnce\n  resources:\n    requests:\n      storage: 25Gi\n  selector:\n    matchLabels:\n      alicloud-pvname: static-disk-pv\n\n\n- \n\n执行以下命令创建PVC。\n\nkubectl create -f static-disk-pvc.yaml\n\n\n- \n\n将云盘挂载到ECI Pod。\n\n- \n\n将以下内容保存为static-disk-test.yaml。\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: static-disk-test\n  labels:\n    alibabacloud.com/eci: \"true\"\nspec:\n  nodeSelector:\n    k8s.aliyun.com/vnode: \"true\"\n  tolerations:\n  - key: k8s.aliyun.com/vnode\n    operator: \"Equal\"\n    value: \"true\"\n    effect: \"NoSchedule\"\n  containers:\n  - name: nginx\n    image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n    ports:\n    - containerPort: 80\n      name: web\n    volumeMounts:\n    - name: pvc-disk\n      mountPath: /data\n  volumes:\n    - name: pvc-disk\n      persistentVolumeClaim:\n        claimName: static-disk-pvc\n\n\n- \n\n执行以下命令创建Pod。\n\nkubectl create -f static-disk-test.yaml\n\n\n- \n\n查看结果。\n\nkubectl get pods -o wide\n\n\n预期返回：\n\nNAME                 READY   STATUS    RESTARTS   AGE   IP            NODE                                  NOMINATED NODE   READINESS GATES\nstatic-disk-test     1/1     Running   0          44s   172.16.XX.XX   cn-beijing.vnd-2ze8nd8xcl33t4pa****   <none>           <none>\n\n\n查看Pod中的文件目录，可以看到已生成云盘对应的挂载目录/data。\n\n## 动态挂载云盘\n\n- \n\n创建StorageClass。\n\n- \n\n参考参数说明表修改以下YAML内容，并保存为disk-sc.yaml。\n\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: alicloud-disk-essd\nprovisioner: diskplugin.csi.alibabacloud.com\nparameters:\n  type: cloud_essd\n  regionId: cn-beijing \n  zoneId: cn-beijing-l \n  fstype: ext4\n  readonly: \"true\"\n  mkfsOptions: \"-O project,quota\"\n  diskTags: \"key1:value1,key2:value2\"\n  encrypted: \"false\"\n  performanceLevel: PL1\nvolumeBindingMode: Immediate\nreclaimPolicy: Delete\nallowVolumeExpansion: true\n\n\n相关参数说明如下表所示：\n\n[表格]\n\n参数\n\n描述\n\nprovisioner\n\n驱动类型。此处配置为diskplugin.csi.alibabacloud.com，表示使用阿里云云盘CSI插件。\n\ntype\n\n云盘类型。取值：\n\n- \n\ncloud_essd：ESSD云盘。\n- \n\ncloud_ssd：SSD云盘。\n- \n\ncloud_efficiency：高效云盘。\n- \n\navailable：优先创建SSD云盘，若可用区内SSD云盘没有资源，则创建高效云盘。\n说明 \n\n除available外，支持任意组合其它三种参数，例如：type: cloud_efficiency, cloud_ssd, cloud_essd，此时将依次尝试创建指定类型的云盘，直到创建成功。\n\nregionId、zoneId\n\n云盘所属的地域和可用区，需与VNode相同。\n\nfstype\n\n云盘的文件系统，默认为ext4。\n\nreadonly\n\n挂载自动创建云盘的权限是否为可读。默认为false。\n\n- \n\ntrue：云盘具有只读权限。\n- \n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-a-local-disk-to-a-pod", "page_type": "doc", "title": "挂载本地盘", "keywords": "为ECI挂载本地盘,配置ECI本地盘,ECI本地盘挂载方法,ECI本地盘配置示例", "last_modified_ms": 1705642289000, "last_modified_iso": "2024-01-19T13:31:29+08:00", "excerpt": "本地盘是实例所在物理机上的本地硬盘设备，具有低时延、高随机IOPS、高吞吐量和高性价比的优势。本文介绍如何指定ECS本地盘规格创建ECI Pod，并将本地盘挂载到ECI Pod上。\n## 配置说明\n\n您可以在Pod metadata中添加Annotation（如k8s.aliyun.com/eci-use-specs: ecs.i2g.2xlarge）来指定本地盘规格。挂载本地盘时，通过将EmptyDir Volume的medium设置为LocalRaid0的方式，可以自动把本地盘组成RAID 0，并挂载到Pod的指定路径上。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n创建ECI Pod时，支持指定的ECS本地盘规格族如下：\n\n- \n\n大数据型实例规格族d1，例如：ecs.d1.2xlarge。\n- \n\n大数据网络增强型实例规格族d1ne，例如：ecs.d1ne.2xlarge。\n- \n\n本地SSD型实例规格族i2，例如：ecs.i2.xlarge。\n- \n\n本地SSD型实例规格族i2g，例如：ecs.i2g.2xlarge。\n- \n\nGPU计算型实例规格族gn5，例如：ecs.gn5-c4g1.xlarge。说明 \n\ngn5为GPU规格，除了本地盘相关参数外，您还需要指定GPU相关参数。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置示例\n\n- \n\n准备YAML文件。\n\nvim localdis.yaml\n\n\nlocaldis.yaml的内容示例如下，示例中通过设置k8s.aliyun.com/eci-use-specs: ecs.i2g.2xlarge指定ECI Pod的规格为ecs.i2g.2xlarge，该规格带有一块本地盘，可以通过EmptyDir Volume的方式挂载到ECI Pod上。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: localdisk-test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.i2g.2xlarge  #指定支持的ECS本地盘规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts:\n          - name: localdisk\n            mountPath: /localdisk-test\n      volumes:\n        - name: localdisk\n          emptyDir:\n            medium: LocalRaid0\n\n\n- \n\n部署Deployment。\n\nkubectl create -f localdis.yaml\n\n\n- \n\n查看结果。\n\n创建完成后查看Pod信息，可以看到本地盘已生成RAID 0（/dev/md0），且已挂载到指定的/localdisk-test路径。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-a-nas-file-system-1", "page_type": "doc", "title": "挂载NAS", "keywords": "静态挂载NAS,动态挂载NAS,ECI使用NAS存储", "last_modified_ms": 1707184739000, "last_modified_iso": "2024-02-06T09:58:59+08:00", "excerpt": "NAS是阿里云提供的一种可共享访问、弹性扩展、高可靠以及高性能的分布式文件系统。部署阿里云CSI插件后，您可以在自建的Kubernetes集群使用阿里云NAS作为Volume。挂载NAS时，支持静态数据卷和动态数据卷，本文为您介绍如何使用PVC方式，挂载NAS到ECI Pod上。\n\n## 前提条件\n\n- \n\n自建Kubernetes集群中已部署VNode。\n- \n\n集群版本为1.16及以上版本，且已部署CSI-Provisioner组件。重要 \n\n关于如何部署CSI-Provisioner组件，请参见[alibaba-cloud-csi-driver](https://github.com/kubernetes-sigs/alibaba-cloud-csi-driver/tree/master/deploy)。如果部署过程中出现问题，请在GitHub提交issue。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已打通IDC与阿里云的网络。\n\n## 注意事项\n\n- \n\nNAS为共享存储，一个NAS可以挂载到多个Pod上。此时，如果多个Pod同时修改相同数据，需要应用自行执行数据同步。\n- \n\n在卸载NAS前，请勿删除NAS挂载点，否则可能会造成操作系统无响应。\n\n## 静态挂载NAS\n\n- \n\n创建NAS文件系统和挂载点。\n\n- \n\n登录[NAS控制台](https://nas.console.aliyun.com/)。\n- \n\n创建NAS文件系统，并添加挂载点。\n\nNAS文件系统和挂载点必须与VNode处于同一VPC内。具体操作，请参见[创建文件系统](https://help.aliyun.com/zh/nas/user-guide/create-a-file-system#task-27530-zh)和[管理挂载点](https://help.aliyun.com/zh/nas/user-guide/manage-mount-targets#task-27531-zh)。\n\n- \n\n创建PV。\n\n- \n\n参考参数说明表修改以下YAML内容，并保存为static-nas-pv.yaml。\n\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: static-nas-pv\n  labels:\n    alicloud-pvname: static-nas-pv\nspec:\n  capacity:\n    storage: 25Gi\n  accessModes:\n    - ReadWriteMany\n  csi:\n    driver: nasplugin.csi.alibabacloud.com\n    volumeHandle: static-nas-pv\n    volumeAttributes:\n      server: \"2564f4****-ysu87.cn-beijing.nas.aliyuncs.com\"\n      path: \"/test\"\n  mountOptions:\n  - nolock,tcp,noresvport\n  - vers=3\n\n\n相关参数说明如下表所示：\n\n[表格]\n\n参数\n\n描述\n\ndriver\n\n驱动类型。此处配置为nasplugin.csi.alibabacloud.com，表示使用阿里云NAS CSI插件。\n\nvolumeHandle\n\nPV的唯一标识符，与metedata中定义的name保持一致。\n\nserver\n\nNAS的挂载点地址。\n\npath\n\n挂载子目录。极速型NAS需要以/share为父目录，例如/share/path1。\n\nvers\n\n挂载NAS的NFS协议版本号。推荐使用v3，极速型NAS仅支持v3。\n- \n\n执行以下命令创建PV。\n\nkubectl create -f static-nas-pv.yaml\n\n\n- \n\n创建PVC。\n\n- \n\n将以下内容保存为static-nas-pvc.yaml。\n\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: static-nas-pvc\nspec:\n  accessModes:\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 25Gi\n  selector:\n    matchLabels:\n      alicloud-pvname: static-nas-pv \n\n\n- \n\n执行以下命令创建PVC。\n\nkubectl create -f static-nas-pvc.yaml\n\n\n- \n\n将NAS挂载到ECI Pod。\n\n- \n\n将以下内容保存为static-nas-test.yaml。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: static-nas-test\n  labels:\n    app: nginx\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      nodeSelector:    \n        k8s.aliyun.com/vnode: \"true\"\n      tolerations:     \n      - key: k8s.aliyun.com/vnode\n        operator: \"Equal\"\n        value: \"true\"\n        effect: \"NoSchedule\"\n      containers:\n      - name: nginx\n        image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts:\n          - name: pvc-nas\n            mountPath: /data\n      volumes:\n        - name: pvc-nas\n          persistentVolumeClaim:\n            claimName: static-nas-pvc\n\n\n- \n\n执行以下命令创建Deployment。\n\nkubectl create -f static-nas-test.yaml\n\n\n- \n\n查看结果。\n\nkubectl get pods -o wide\n\n\n预期返回：\n\nNAME                              READY   STATUS    RESTARTS   AGE   IP            NODE                                  NOMINATED NODE   READINESS GATES\n\nstatic-nas-test-5c4b6d4bd-4kggt   1/1     Running   0          95s   172.16.XX.XX   cn-beijing.vnd-2ze8nd8xcl33t4pa****   <none>           <none>\nstatic-nas-test-5c4b6d4bd-ql6m4   1/1     Running   0          95s   172.16.XX.XX   cn-beijing.vnd-2ze8nd8xcl33t4pa****   <none>           <none>\n\n\n查看Pod中的文件目录，可以看到已生成NAS对应的挂载目录/data，且第一个Pod中写入的文件可以在第二个Pod中查看，即两个Pod共享使用NAS存储。\n\n## 动态挂载NAS\n\n- \n\n创建NAS文件系统和挂载点。\n\n- \n\n登录[NAS控制台](https://nas.console.aliyun.com/)。\n- \n\n创建NAS文件系统，并添加挂载点。\n\nNAS文件系统和挂载点必须与VNode处于同一VPC内。具体操作，请参见[创建文件系统](https://help.aliyun.com/zh/nas/user-guide/create-a-file-system#task-27530-zh)和[管理挂载点](https://help.aliyun.com/zh/nas/user-guide/manage-mount-targets#task-27531-zh)。\n\n- \n\n创建StorageClass。\n\n- \n\n参考参数说明表修改以下YAML内容，并保存为nas-sc.yaml。\n\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: alicloud-nas-subpath\nmountOptions:\n- nolock,tcp,noresvport\n- vers=3\nparameters:\n  volumeAs: subpath"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-a-nas-volume", "page_type": "doc", "title": "挂载NAS数据卷", "keywords": "为ECI挂载NAS卷,ECI挂载NAS卷方法,ECI挂载NAS卷配置", "last_modified_ms": 1721885696000, "last_modified_iso": "2024-07-25T13:34:56+08:00", "excerpt": "NAS是阿里云提供的一种可共享访问、弹性扩展、高可靠以及高性能的分布式文件系统。本文介绍如何为ECI实例挂载NAS数据卷。\n## 注意事项\n\n- \n\nNAS按照使用量进行计费，支持按量付费、资源包和SCU付费方式。更多信息，请参见[NAS计费概述](https://help.aliyun.com/zh/nas/product-overview/overview-1)。\n- \n\nNAS文件系统必须和实例处于同一VPC内。\n- \n\nNAS为共享存储，一个NAS可以挂载到多个实例上。此时，如果多个实例同时修改相同数据，需要应用自行执行数据同步。\n- \n\n在卸载NAS前，请勿删除NAS挂载点，否则可能会造成操作系统无响应。\n\n## 准备工作\n\n使用阿里云文件存储NAS作为数据卷前，请先创建NAS文件系统和挂载点。具体操作，请参见[创建文件系统](https://help.aliyun.com/zh/nas/user-guide/create-a-file-system)和[管理挂载点](https://help.aliyun.com/zh/nas/user-guide/manage-mount-targets)。\n## 配置说明（OpenAPI）\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Volume相关参数声明数据卷，然后通过Container.VolumeMount相关参数为容器挂载数据卷。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/api-createcontainergroup)。\n#### 声明数据卷\n\n通过Volume相关参数声明数据卷时，需要先明确Volume的名称和类型。再根据Volume.N.Type的取值，进一步配置该类型数据卷的相关参数。\n\n声明NAS数据卷时，支持以下两种方式：\n\n- \n\n挂载NFS类型的数据卷\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVolume.N.Name\n\nString\n\nnas-demo\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nNFSVolume\n\n取值为NFSVolume，表示创建一个NFS类型的数据卷。\n\nVolume.N.NFSVolume.Server\n\nString\n\n3f9cd4****-na***.cn-shanghai.nas.aliyuncs.com\n\nNFS服务器地址。\n\n如果使用阿里云文件存储NAS，则此处为NAS文件系统的挂载点地址。\n\nVolume.N.NFSVolume.Path\n\nString\n\n/share\n\nNFS数据卷路径。\n\nVolume.N.NFSVolume.ReadOnly\n\nBoolean\n\nfalse\n\nNFS数据卷的读取权限。取值范围：\n\n- \n\ntrue：只读\n- \n\nfalse：可读可写\n\n默认为false。\n\n- \n\n通过FlexVolume插件挂载数据卷\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVolume.N.Name\n\nString\n\nnas-demo\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nFlexVolume\n\n取值为FlexVolume，表示通过FlexVolume插件挂载数据卷。\n\nVolume.N.FlexVolume.Driver\n\nString\n\nalicloud/nas\n\n使用FlexVolume插件挂载数据卷时的驱动类型。取值为alicloud/nas时，表示挂载阿里云文件存储NAS。\n\nVolume.N.FlexVolume.Options\n\nString\n\n{\"server\":\"3f9cd4****-na***.cn-shanghai.nas.aliyuncs.com\",\"path\": \"/share\",\"vers\":\"3\",\"options\":\"nolock,tcp,noresvport\"}\n\nFlexVolume对象选项列表。为KV形式，采用JSON传递。\n\n通过FlexVolume挂载NAS时，Options表示NAS数据卷的配置参数，可配置的参数如下：\n\n- \n\nserver：NAS的挂载点地址。\n- \n\npath：NAS路径下的子目录，以 / 开头。\n\n- \n\n请填写NAS中已存在的子目录。如果NAS根目录下没有此子目录，会在创建后再挂载。\n- \n\n极速型NAS的子目录需要以/share开头。\n- \n\n可以不填此项，默认挂载到NAS根目录。\n\n- \n\nvers：挂载NAS的NFS协议版本号。推荐使用v3，极速型NAS仅支持v3。\n- \n\noptions：挂载NAS时定制化参数，格式为\"xxx,xxx,xxx\"，例如nolock,tcp,noresvport。\n\n##### 挂载数据卷\n\n声明数据卷后，可以通过VolumeMount相关参数将数据卷挂载到容器中。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.VolumeMount.N.Name\n\nString\n\ntest-volume\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/usr/share\n\n挂载目录。\n\n容器挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n\nContainer.N.VolumeMount.N.SubPath\n\nString\n\n/usr/sub\n\n数据卷下的子目录。方便实例将同一个数据卷下的不同目录挂载到容器的不同目录。\n\nContainer.N.VolumeMount.N.ReadOnly\n\nBoolean\n\nfalse\n\n挂载目录是否只读。默认为false。\n\nContainer.N.VolumeMount.N.MountPropagation\n\nString\n\nNone\n\n数据卷的挂载传播设置。挂载传播允许将容器挂载的卷共享到同一ECI实例中的其他容器，甚至可以共享到同一宿主机上的其他ECI实例。取值范围：\n\n- \n\nNone：该卷不感知任何后续在此卷或其子目录上执行的挂载操作。\n- \n\nHostToContainer：该卷将会感知到后续在此卷或其子目录上的挂载操作。\n- \n\nBidirectional：和HostToContainer类似，能感知挂载操作。另外，该卷将被传播回宿主机和使用同一卷的所有ECI实例的所有容器。\n\n默认值：None。说明 \n\nInit容器也支持挂载数据卷，参数与上表类似，只需要将Container改为InitContainer。\n## 配置说明（控制台）\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-beijing)创建ECI实例时，您可以在容器组配置区域声明数据卷，然后在容器配置区域，将数据卷挂载到容器中。\n#### 声明数据卷\n\n- \n\n在容器组配置区域，展开高级配置。\n- \n\n在存储处选择NAS持久化存储页签，单击添加。\n- \n\n配置NAS数据卷的相关参数。\n\n- \n\n名称：NAS数据卷的名称。\n- \n\n挂载点：NAS文件系统的挂载点。\n- \n\nPath：NAS文件系统中要挂载的路径。\n- \n\n只读：数据读取权限。默认可读可写，可按需选中只读。\n\n#### 挂载数据卷\n\n- \n\n在容器配置区域选择容器，展开该容器的高级配置。\n- \n\n打开存储开关后单击添加。\n\n此处可添加的数据卷为配置容器组时声明的数据卷。\n\n说明 \n\n如果要为多个容器挂载数据卷，请选择其他容器，重复上述操作。\n## 配置示例\n\n- \n\n创建一台ECI实例A，并为其挂载NAS数据卷。\n\n调用CreateContainerGroup接口创建实例A所采用的参数示例如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\nContainerGroupName=test-nas-a\nSecurityGroupId=sg-bp1daxpbz9lzpvvc****\nVSwitchId=vsw-bp1gds63lmlm7ib05****\n#声明数据卷\nVolume.1.Name=nas-demo\nVolume.1.Type=NFSVolume\nVolume.1.NFSVolume.Server=3f9cd4****-na***.cn-shanghai.nas.aliyuncs.com\nVolume.1.NFSVolume.Path=/share\n#为容器挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=nas-demo\nContainer.1.VolumeMount.1.MountPath=/data-a\n\n\n- \n\n连接实例A，在挂载目录下新增一个文件。\n\n关于如何连接ECI实例，请参见[连接ECI实例](https://help.aliyun.com/zh/eci/getting-sta"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-an-emptydir-volume", "page_type": "doc", "title": "挂载EmptyDir数据卷", "keywords": "挂载ECI的EmptyDir数据卷,ECI EmptyDir数据卷配置,ECI EmptyDir数据卷挂载", "last_modified_ms": 1723707136000, "last_modified_iso": "2024-08-15T15:32:16+08:00", "excerpt": "EmptyDir数据卷是一个空的目录，用于临时存放数据，便于容器之间共享数据。本文介绍如何为ECI实例挂载EmptyDir数据卷。\n## 注意事项\n\nEmptyDir为临时存储，当ECI实例删除或重启时，EmptyDir数据卷中保存的数据均会被清空。\n## 配置说明（OpenAPI）\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Volume相关参数声明数据卷，然后通过Container.VolumeMount相关参数为容器挂载数据卷。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/api-createcontainergroup)。\n#### 声明数据卷\n\n通过Volume相关参数声明数据卷时，需要先明确Volume的名称和类型。再根据Volume.N.Type的取值，进一步配置该类型数据卷的相关参数。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVolume.N.Name\n\nString\n\nemptydir-demo\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nEmptyDirVolume\n\n取值为EmptyDirVolume，表示创建一个EmptyDir类型的数据卷。\n\nVolume.N.EmptyDirVolume.Medium\n\nString\n\nMemory\n\nEmptyDir数据卷的存储媒介。默认为空，表示使用node文件系统。支持配置为以下值：\n\n- \n\nMemory：表示使用内存。\n- \n\nLocalRaid0：表示将本地盘组成RAID 0。\n\n该取值仅适用于创建本地盘实例并挂载本地盘的场景。更多信息，请参见[指定本地盘规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-a-local-disk-type)。\n\nVolume.N.EmptyDirVolume.SizeLimit\n\nString\n\n256Mi\n\nEmptyDir数据卷的大小。取值请带上单位，建议使用Gi或Mi。说明 \n\n对于Medium为Memory的EmptyDirVolume，支持设置SizeLimit来修改实例的shm大小。设置Medium和SizeLimit后，需要将EmptyDirVolume挂载到容器的/dev/shm目录。\n##### 挂载数据卷\n\n声明数据卷后，可以通过VolumeMount相关参数将数据卷挂载到容器中。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.VolumeMount.N.Name\n\nString\n\ntest-volume\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/usr/share\n\n挂载目录。\n\n容器挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n\nContainer.N.VolumeMount.N.SubPath\n\nString\n\n/usr/sub\n\n数据卷下的子目录。方便实例将同一个数据卷下的不同目录挂载到容器的不同目录。\n\nContainer.N.VolumeMount.N.ReadOnly\n\nBoolean\n\nfalse\n\n挂载目录是否只读。默认为false。\n\nContainer.N.VolumeMount.N.MountPropagation\n\nString\n\nNone\n\n数据卷的挂载传播设置。挂载传播允许将容器挂载的卷共享到同一ECI实例中的其他容器，甚至可以共享到同一宿主机上的其他ECI实例。取值范围：\n\n- \n\nNone：该卷不感知任何后续在此卷或其子目录上执行的挂载操作。\n- \n\nHostToContainer：该卷将会感知到后续在此卷或其子目录上的挂载操作。\n- \n\nBidirectional：和HostToContainer类似，能感知挂载操作。另外，该卷将被传播回宿主机和使用同一卷的所有ECI实例的所有容器。\n\n默认值：None。说明 \n\nInit容器也支持挂载数据卷，参数与上表类似，只需要将Container改为InitContainer。\n## 配置说明（控制台）\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-beijing)创建ECI实例时，您可以在容器组配置区域声明数据卷，然后在容器配置区域，将数据卷挂载到容器中。\n#### 声明数据卷\n\n- \n\n在容器组配置区域，展开高级配置。\n- \n\n在存储处选择临时目录页签，单击添加。\n- \n\n输入EmptyDir数据卷的名称。\n\n#### 挂载数据卷\n\n- \n\n在容器配置区域选择容器，展开该容器的高级配置。\n- \n\n打开存储开关后单击添加。\n\n此处可添加的数据卷为配置容器组时声明的数据卷。\n\n说明 \n\n如果要为多个容器挂载数据卷，请选择其他容器，重复上述操作。\n## 配置示例\n\n调用CreateContainerGroup接口创建ECI实例，并为其挂载EmptyDir数据卷。参数示例如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n- \n\n示例一：容器之间共享数据\n\nContainerGroupName=test-emptydir\n# 声明数据卷\nVolume.1.Name=emptydir-demo\nVolume.1.Type=EmptyDirVolume\n#为容器1挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=emptydir-demo\nContainer.1.VolumeMount.1.MountPath=/data1\n# 为容器2挂载数据卷\nContainer.2.Name=busybox\nContainer.2.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/busybox:1.30\nContainer.2.Command.1=sleep\nContainer.2.Arg.1=999999\nContainer.2.VolumeMount.1.Name=emptydir-demo\nContainer.2.VolumeMount.1.MountPath=/data2\n\n\n上述示例中，容器1和容器2共享使用了EmptyDir数据卷，容器1的/data1目录和容器2的/data2目录下默认为空。在任一容器内，在EmptyDir数据卷中新增的文件，在另一容器内也可以访问。\n- \n\n示例二：修改实例shm大小\n\nContainerGroupName=test-emptydir\n# 声明数据卷\nVolume.1.Name=emptydir-shm\nVolume.1.Type=EmptyDirVolume\nVolume.1.EmptyDirVolume.Medium=Memory\nVolume.1.EmptyDirVolume.SizeLimit=256Mi\n# 为容器1挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=emptydir-shm\nContainer.1.VolumeMount.1.MountPath=/dev/shm\n\n\n上述示例中，通过设置EmptyDirVolume.Medium为Memory，EmptyDirVolume.SizeLimit为256Mi，并将EmptyDirVolume挂载到/dev/shm目录，从而实现将ECI实例的shm大小改为256 MiB。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-an-emptydir-volume-to-modify-the-shm-size-of-a-pod", "page_type": "doc", "title": "挂载EmptyDir Volume以修改shm大小", "keywords": "修改shm大小,解决共享内存不足,挂载EmptyDir Volume,shm大小修改方法,EmptyDir Volume挂载,ECI Pod共享内存", "last_modified_ms": 1708652652000, "last_modified_iso": "2024-02-23T09:44:12+08:00", "excerpt": "本文介绍如何设置Memory类型的emptyDir Volume的sizeLimit，并将其挂载到/dev/shm，从而修改ECI Pod的shm大小，解决共享内存不够用的问题。\n## 功能场景\n\n默认情况下，Kubernetes创建的Pod，其共享内存默认为64 MiB（即/dev/shm大小为64 MiB），且不支持更改。\n\nKubernetes没有提供设置shm大小的途径，您可以通过将Memory类型的emptyDir Volume挂载到/dev/shm的方式，解决共享内存不够用的问题。\n## 配置示例\n\n- \n\n准备YAML文件。\n\nvim emptydir-shm.yaml\n\n\nemprydir-shm.yaml的内容示例如下，示例中通过设置EmptyDir Volume的medium为Memory，sizeLimit为256Mi，并将EmptyDir Volume挂载到/dev/shm目录，从而修改了Pod的shm大小为256 MiB。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts:\n        - mountPath: /dev/shm\n          name: cache-volume\n      volumes:\n      - emptyDir:\n          medium: Memory\n          sizeLimit: 256Mi\n        name: cache-volume\n\n\n- \n\n部署Deployment。\n\nkubectl create -f emptydir-shm.yaml\n\n\n- \n\n查看结果。\n\n进入到容器内部执行df -h命令查看磁盘空间，可以看到/dev/shm的大小已增加到256 MiB。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-an-oss-bucket-as-a-volume-1", "page_type": "doc", "title": "挂载OSS", "keywords": "挂载OSS到ECI Pod,OSS静态挂载方法,ECI使用OSS存储", "last_modified_ms": 1707184752000, "last_modified_iso": "2024-02-06T09:59:12+08:00", "excerpt": "OSS是阿里云提供的一个海量、安全、低成本、高可靠的存储空间，适合存储非结构化数据（如图片、音视频等）。部署阿里云CSI插件后，您可以在自建的Kubernetes集群使用阿里云OSS作为Volume。挂载OSS时，仅支持静态数据卷，本文为您介绍如何使用PVC方式，静态挂载OSS到ECI Pod上。\n## 前提条件\n\n- \n\n自建Kubernetes集群中已部署VNode。\n- \n\n集群版本为1.16及以上版本，且已部署CSI-Provisioner组件。重要 \n\n关于如何部署CSI-Provisioner组件，请参见[alibaba-cloud-csi-driver](https://github.com/kubernetes-sigs/alibaba-cloud-csi-driver/tree/master/deploy)。如果部署过程中出现问题，请在GitHub提交issue。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已打通IDC与阿里云的网络。\n\n## 注意事项\n\n- \n\nOSS为共享存储，一个OSS可以挂载到多个Pod上。\n- \n\n不支持动态挂载OSS，即OSS不支持动态创建PV。\n- \n\n挂载目录中建议存放的文件数不要超过1000个。文件数量过多时，OSSFS会占用大量内存，可能会导致Pod发生OOM（Out Of Memory）事件。\n\n## 操作步骤\n\nOSS类型的存储卷目前仅支持静态挂载。\n\n- \n\n创建OSS Bucket。\n\n- \n\n登录[OSS管理控制台](https://oss.console.aliyun.com/bucket)。\n- \n\n创建OSS Bucket。\n\n关于如何创建OSS Bucket，请参见[创建存储空间](https://help.aliyun.com/zh/oss/manage-buckets-create-buckets#task-bcz-sbz-5db)。\n\n- \n\n选择授权方式。\n\n- \n\n使用RAM角色授权。\n\n请创建RAM角色并为该角色授权。创建时，可信实体类型为阿里云服务，角色类型为普通服务角色，受信服务为云服务器；为角色授权时，请选择AliyunOSSFullAccess权限策略。\n\n具体操作，请参见[创建RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service#task-2448632)和[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role#task-187801)。\n- \n\n（不推荐）使用AccessKey直接授权。\n\n请获取AccessKey ID和AccessKey Secret。具体操作，请参见[获取AccessKey](https://help.aliyun.com/document_detail/175967.html#task-354412)。\n\n- \n\n创建PV。\n\n- \n\n将以下内容保存为oss-pv.yaml。\n\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: oss-pv\n  labels:\n    alicloud-pvname: oss-pv\nspec:\n  capacity:\n    storage: 25Gi\n  accessModes:\n    - ReadWriteMany\n  persistentVolumeReclaimPolicy: Retain\n  csi:\n    driver: ossplugin.csi.alibabacloud.com\n    volumeHandle: oss-pv\n    volumeAttributes:\n      bucket: \"oss-test\"\n      url: \"oss-cn-beijing-internal.aliyuncs.com\"\n      otherOpts: \"-o max_stat_cache_size=0 -o allow_other\"\n      path: \"/\"\n      ramRole: \"<your RAM Role Name>\"\n\n\n上述示例采用RAM角色来授权。如果您想要使用AccessKey直接授权，请将 ramRole: \"<your RAM Role Name>\"替换为以下YAML：\n\n      akId: \"<your AccessKey ID>\"\n      akSecret: \"<your AccessKey Secret>\"\n\n\n相关参数说明如下表所示：\n\n[表格]\n\n参数\n\n描述\n\ndriver\n\n驱动类型。此处配置为ossplugin.csi.alibabacloud.com，表示使用阿里云OSS CSI插件。\n\nvolumeHandle\n\nPV的唯一标识符，与metadata中定义的name保持一致。\n\nbucket\n\nOSS Bucket的名称。\n\n目前只支持挂载Bucket，不支持挂载Bucket下的子目录或者文件。\n\nurl\n\nOSS的接入域名（Endpoint）。\n\n- \n\n挂载节点（即VNode）和Bucket相同地域时，请使用私网地址。\n- \n\n挂载节点（即VNode）和Bucket不同地域时，请使用公网地址。\n\notherOpts\n\n挂载OSS时支持输入定制化参数，格式为-o *** -o ***，例如：-o max_stat_cache_size=0 -o allow_other。\n\npath\n\n挂载时相对Bucket根文件的目录结构，默认为/。\n\nramRole\n\n使用RAM角色授权时，对应的RAM角色。\n\nakId和akSecret\n\n使用AccessKey直接授权时，对应的AccessKey ID和AccessKey Secret。\n- \n\n执行以下命令创建PV。\n\nkubectl create -f oss-pv.yaml\n\n\n- \n\n创建PVC。\n\n- \n\n将以下内容保存为oss-pvc.yaml。\n\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: oss-pvc\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 25Gi\n  selector:\n    matchLabels:\n      alicloud-pvname: oss-pv\n\n\n- \n\n执行以下命令创建PVC。\n\nkubectl create -f oss-pvc.yaml\n\n\n- \n\n将OSS挂载到ECI实例。\n\n- \n\n将以下内容保存为oss-test.yaml。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: oss-test\n  labels:\n    app: nginx\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      nodeSelector:    \n        k8s.aliyun.com/vnode: \"true\"\n      tolerations:     \n      - key: k8s.aliyun.com/vnode\n        operator: \"Equal\"\n        value: \"true\"\n        effect: \"NoSchedule\"\n      containers:\n      - name: nginx\n        image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts:\n          - name: pvc-oss\n            mountPath: \"/data\"\n      volumes:\n        - name: pvc-oss\n          persistentVolumeClaim:\n            claimName: oss-pvc\n\n\n- \n\n执行以下命令创建Deployment。\n\nkubectl create -f oss-test.yaml\n\n\n- \n\n查看结果。\n\nkubectl get pods -o wide\n\n\n预期返回：\n\nNAME                              READY   STATUS    RESTARTS   AGE     IP             NODE                                  NOMINATED NODE   READINESS GATES\n\noss-test-647bf5d6b-ms9fx  "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-an-oss-bucket-to-an-elastic-container-instance-as-a-volume", "page_type": "doc", "title": "挂载OSS数据卷", "keywords": "挂载ECI的OSS数据卷,配置ECI挂载OSS,ECI挂载OSS操作指南,ECI的OSS数据卷挂载", "last_modified_ms": 1722240111000, "last_modified_iso": "2024-07-29T16:01:51+08:00", "excerpt": "OSS是阿里云提供的一个海量、安全、低成本、高可靠的存储空间，适合存储非结构化数据（如图片、音视频等）。本文介绍如何为ECI实例挂载OSS数据卷。\n## 注意事项\n\n- \n\nOSS按照使用量进行计费，支持按量付费、资源包和SCU等付费方式。更多信息，请参见[OSS计费概述](https://help.aliyun.com/zh/oss/billing-overview)。\n- \n\nOSS为共享存储，一个OSS可以挂载到多个实例上。\n- \n\n挂载目录中建议存放的文件数不要超过1000个。\n\n文件数量过多时，OSS客户端会占用大量内存，可能会导致实例发生OOM（Out Of Memory）事件。\n\n## 准备工作\n\n- \n\n创建OSS Bucket。\n\n- \n\n登录[OSS管理控制台](https://oss.console.aliyun.com/bucket)。\n- \n\n创建OSS Bucket。\n\n关于如何创建OSS Bucket，请参见[创建存储空间](https://help.aliyun.com/zh/oss/manage-buckets-create-buckets#task-bcz-sbz-5db)。\n\n- \n\n选择授权方式。\n\n- \n\n使用RAM角色授权。\n\n请创建RAM角色并为该角色授权。具体操作，请参见[创建RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service#task-2448632)和[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role#task-187801)。\n\n创建时，可信实体类型为阿里云服务，角色类型为普通服务角色，受信服务为云服务器；为角色授权时，请选择AliyunOSSFullAccess权限策略。\n- \n\n（不推荐）使用AccessKey直接授权。\n\n请获取AccessKey ID和AccessKey Secret。具体操作，请参见[获取AccessKey](https://help.aliyun.com/document_detail/175967.html#task-354412)。\n\n## 配置说明（OpenAPI）\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Volume相关参数声明数据卷，然后通过Container.VolumeMount相关参数为容器挂载数据卷。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/api-createcontainergroup)。\n#### 声明数据卷\n\n通过Volume相关参数声明数据卷时，需要先明确Volume的名称和类型。再根据Volume.N.Type的取值，进一步配置该类型数据卷的相关参数。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVolume.N.Name\n\nString\n\noss-demo\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nFlexVolume\n\n取值为FlexVolume，表示创建一个通过FlexVolume插件挂载的数据卷。\n\nVolume.N.FlexVolume.Driver\n\nString\n\nalicloud/oss\n\n使用FlexVolume插件挂载数据卷时的驱动类型。取值为alicloud/oss时，表示挂载阿里云对象存储OSS。\n\nVolume.N.FlexVolume.Options\n\nString\n\n{\"bucket\":\"test-***\",\"url\":\"oss-cn-hangzhou.aliyuncs.com\",\"ramRole\":\"ram-***\"}\n\nFlexVolume对象选项列表。为键值对形式，采用JSON传递。\n\n通过FlexVolume挂载OSS时，Options表示OSS数据卷的配置参数，可配置的参数如下：\n\n- \n\nbucket：OSS Bucket的名称。\n- \n\nurl：OSS Bucket的访问域名（Endpoint）。可以登录OSS管理控制台，在目标Bucket的概览页面获取。更多信息，请参见[访问域名和数据中心](https://help.aliyun.com/zh/oss/user-guide/regions-and-endpoints)。\n- \n\npath：挂载时相对Bucket根文件的目录结构，默认为/。\n- \n\notherOpts：挂载OSS时支持输入定制化参数，格式为-o *** -o ***，例如-o max_stat_cache_size=0 -o allow_other。\n- \n\nakId：使用AccessKey直接授权时，对应的AccessKey ID。\n- \n\nakSecret：使用AccessKey直接授权时，对应的和AccessKey Secret。\n- \n\nramRole：使用RAM角色授权时，对应的RAM角色名称。\n\n##### 挂载数据卷\n\n声明数据卷后，可以通过VolumeMount相关参数将数据卷挂载到容器中。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.VolumeMount.N.Name\n\nString\n\ntest-volume\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/usr/share\n\n挂载目录。\n\n容器挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n\nContainer.N.VolumeMount.N.SubPath\n\nString\n\n/usr/sub\n\n数据卷下的子目录。方便实例将同一个数据卷下的不同目录挂载到容器的不同目录。\n\nContainer.N.VolumeMount.N.ReadOnly\n\nBoolean\n\nfalse\n\n挂载目录是否只读。默认为false。\n\nContainer.N.VolumeMount.N.MountPropagation\n\nString\n\nNone\n\n数据卷的挂载传播设置。挂载传播允许将容器挂载的卷共享到同一ECI实例中的其他容器，甚至可以共享到同一宿主机上的其他ECI实例。取值范围：\n\n- \n\nNone：该卷不感知任何后续在此卷或其子目录上执行的挂载操作。\n- \n\nHostToContainer：该卷将会感知到后续在此卷或其子目录上的挂载操作。\n- \n\nBidirectional：和HostToContainer类似，能感知挂载操作。另外，该卷将被传播回宿主机和使用同一卷的所有ECI实例的所有容器。\n\n默认值：None。说明 \n\nInit容器也支持挂载数据卷，参数与上表类似，只需要将Container改为InitContainer。\n## 配置说明（控制台）\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-beijing)创建ECI实例时，您可以在容器组配置区域声明数据卷，然后在容器配置区域，将数据卷挂载到容器中。\n#### 声明数据卷\n\n- \n\n在容器组配置区域，展开高级配置。\n- \n\n在存储处选择OSS持久化存储页签，单击添加。\n- \n\n配置OSS数据卷的相关参数。\n\n- \n\n名称：OSS数据卷的名称。\n- \n\nBucket：OSS Bucket名称。\n- \n\nRAM角色：具备OSS权限的RAM角色。\n\n#### 挂载数据卷\n\n- \n\n在容器配置区域选择容器，展开该容器的高级配置。\n- \n\n打开存储开关后单击添加。\n\n此处可添加的数据卷为配置容器组时声明的数据卷。\n\n说明 \n\n如果要为多个容器挂载数据卷，请选择其他容器，重复上述操作。\n## 配置示例\n\n- \n\n创建一台ECI实例A，并为其挂载OSS数据卷。\n\n调用CreateContainerGroup接口创建实例A所采用的参数示例如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\nContainerGroupName=test-oss-a\n#声明数据卷\nVolume.1.Name=oss-demo\nVolume.1.Type=FlexVolume\nVolume.1.FlexVolume.Driver=alicloud/oss\nVolume.1.FlexVolume.Options={\"bucket\":\"test-***\",\"url\":\"oss-cn-hangzhou-internal.aliyuncs.com\",\"ramRole\":\"ram-***\"}\n#为容器挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=oss-demo\nContainer.1.VolumeMount."}
{"url": "https://help.aliyun.com/zh/eci/user-guide/mount-stdlog", "page_type": "doc", "title": "挂载stdlog实现挂载容器标准输出日志", "keywords": "挂载容器标准输出日志,配置stdlog挂载,stdlog挂载配置,ECI日志挂载", "last_modified_ms": 1693362118000, "last_modified_iso": "2023-08-30T10:21:58+08:00", "excerpt": "本文介绍如何挂载stdlog，实现将容器的标准输出日志以root权限挂载到ECI Pod内。\n## 配置示例\n\nECI支持通过CSI存储插件，将容器的标准输出日志以root权限挂载到ECI Pod内。配置示例如下：\n\n- \n\n准备YAML配置文件。\n\nvim stdlog_demo.yaml\n\n\nstdlog_demo.yaml的内容如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: test-stdlog-demo\nspec:\n  containers:\n  - image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n    name: test-container\n    volumeMounts:\n    - mountPath: /cache-test\n      name: cache-volume\n  volumes:\n  - name: cache-volume\n    csi:\n      driver: stdlogplugin.csi.alibabacloud.com\n\n\n- \n\n部署Pod。\n\nkubectl create -f stdlog_demo.yaml\n\n\n- \n\n确认挂载结果。\n\n查看Pod内的文件目录，可以看到容器的标准日志已经以root权限挂载到/cache-test目录下，您可以在容器内使用相关日志。\n\nkubectl get pod test-stdlog-demo\nkubectl exec -it test-stdlog-demo bash\nls -l /cache-test\nls -l /cache-test/test-container\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/obtain-the-metadata-from-a-container", "page_type": "doc", "title": "在容器内获取元数据", "keywords": "获取ECI容器元数据,ECI元数据获取方法,ECI元数据项列表", "last_modified_ms": 1722494105000, "last_modified_iso": "2024-08-01T14:35:05+08:00", "excerpt": "ECI实例的元数据可以提供关于ECI实例及其容器的信息用于管理和使用容器，例如名称、ID等基本信息，以及IP地址、网卡等网络信息等。本文介绍如何在容器内获取元数据，将ECI实例信息和容器Meta数据呈现给运行中的容器。\n## 方式一：通过MetaServer访问元数据\n\n- \n\n连接容器。具体操作，请参见[连接ECI实例](https://help.aliyun.com/zh/eci/getting-started/connect-to-an-elastic-container-instance#topic-1860104)。\n- \n\n访问元数据。说明 \n\n如果容器环境没有安装curl，请先安装curl。\n\ncurl http://100.100.100.200/latest/meta-data/<metadata>\n\n\n<metadata>请替换为具体要查询的实例元数据。例如执行以下命令获取实例ID。\n\ncurl http://100.100.100.200/latest/meta-data/instance-id\n\n\nECI实例目前能获取的基本实例元数据项如下表所示：\n\n[表格]\n\n实例元数据项\n\n说明\n\n/dns-conf/nameservers\n\n实例的DNS配置。\n\n/eipv4\n\n实例的弹性公网IP（IPv4类型）。\n\n/hostname\n\n实例的主机名，对应ContainerGroupName。\n\n/instance-id\n\n实例ID。\n\n/mac\n\n实例的MAC地址。\n\n/network/interfaces/\n\n网卡的MAC地址列表。\n\n/network/interfaces/macs/[mac]/network-interface-id\n\n网卡的标识ID，其中[mac]参数需要替换为实例MAC地址。\n\n/network/interfaces/macs/[mac]/netmask\n\n网卡对应的子网掩码。\n\n/network/interfaces/macs/[mac]/vswitch-cidr-block\n\n网卡所属的虚拟交换机IPv4 CIDR段。\n\n/network/interfaces/macs/[mac]/vpc-cidr-block\n\n网卡所属的VPC IPv4 CIDR段。\n\n/network/interfaces/macs/[mac]/private-ipv4s\n\n网卡分配的私网IPv4地址列表。\n\n/network/interfaces/macs/[mac]/vpc-ipv6-cidr-blocks\n\n网卡所属的VPC IPv6 CIDR段，仅支持已配置了IPv6的VPC类型实例。\n\n/network/interfaces/macs/[mac]/vswitch-id\n\n网卡所属安全组的虚拟交换机ID。\n\n/network/interfaces/macs/[mac]/vpc-id\n\n网卡所属安全组的VPC ID。\n\n/network/interfaces/macs/[mac]/primary-ip-address\n\n网卡主私有IP地址。\n\n/network/interfaces/macs/[mac]/gateway\n\n网卡对应的IPv4网关地址。\n\n/instance/max-netbw-egress\n\n实例规格的出方向内网最大带宽。单位：Kbit/s。\n\n/instance/max-netbw-ingerss\n\n实例规格的入方向内网最大带宽。单位：Kbit/s。\n\n/network/interfaces/macs/[mac]/ipv6s\n\n网卡分配的IPv6地址列表，仅支持已配置了IPv6的VPC类型实例。\n\n/network/interfaces/macs/[mac]/ipv6-gateway\n\n网卡所属的VPC的IPv6网关地址。\n\n/network/interfaces/macs/[mac]/vswitch-ipv6-cidr-block\n\n网卡所属的虚拟交换机IPv6 CIDR段，仅支持已配置了IPv6的VPC类型实例。\n\n/private-ipv4\n\n实例的私网IPv4地址。\n\n/ntp-conf/ntp-servers\n\nNTP服务器地址。\n\n/owner-account-id\n\n实例拥有者的阿里云账号ID。\n\n/region-id\n\n实例所属地域。\n\n/serial-number\n\n实例所对应的序列号。\n\n/vpc-id\n\n实例所属VPC ID。\n\n/vpc-cidr-block\n\n实例所属VPC的CIDR网段。\n\n/vswitch-cidr-block\n\n实例所属虚拟交换机的CIDR网段。\n\n/vswitch-id\n\n实例所属虚拟交换机ID。\n\n/zone-id\n\n实例所属可用区。\n\n/ram/security-credentials/[role-name]\n\n实例RAM角色策略所生成的STS临时凭证。只有在实例指定了RAM角色后，您才能获取STS临时凭证。其中[role-name]参数需要替换为实例RAM角色的名称。如果未指定[role-name]，将返回实例RAM角色名称。\n\n## 方式二：配置容器环境变量\n\n通过配置ECI实例容器环境变量的Value便可获取实例相关信息，ECI实例目前可以获取到实例ID、实例名称、实例所属地域、实例所属可用区、实例容器名称等元数据项。\n\n[表格]\n\nKey\n\nValue\n\n说明\n\neci_id\n\n__ECI_ID__\n\n实例ID。\n\neci_name\n\n__ECI_NAME__\n\n实例名称。\n\nregion_id\n\n__REGION_ID__\n\n实例所属地域。\n\nzone_id\n\n__ZONE_ID__\n\n实例所属可用区。\n\ncontainer_name\n\n__CONTAINER_NAME__\n\n容器名称。\n\n配置示例如下：\n## OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，可以通过Container.N.EnvironmentVar.N.Key和Container.N.EnvironmentVar.N.Value来设置环境变量。示例如下：\n\nContainerGroupName=test-env\nContainer.1.Image=registry-vpc.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.Name=container-1\n# 自定义环境变量\nContainer.1.EnvironmentVar.1.Key=eci_id\nContainer.1.EnvironmentVar.2.Key=eci_name\nContainer.1.EnvironmentVar.3.Key=region_id\nContainer.1.EnvironmentVar.4.Key=zone_id\nContainer.1.EnvironmentVar.5.Key=container_name\nContainer.1.EnvironmentVar.1.Value=__ECI_ID__\nContainer.1.EnvironmentVar.2.Value=__ECI_NAME__\nContainer.1.EnvironmentVar.3.Value=__REGION_ID__\nContainer.1.EnvironmentVar.4.Value=__ZONE_ID__\nContainer.1.EnvironmentVar.5.Value=__CONTAINER_NAME__\n\n\n## 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建ECI实例时，您可以在容器配置区域选择容器，展开该容器的高级配置，然后打开环境变量开关，添加环境变量。示例如下：\n\n创建ECI实例后，您可以连接容器查看是否生效。具体操作，请参见[连接ECI实例](https://help.aliyun.com/zh/eci/getting-started/connect-to-an-elastic-container-instance#topic-1860104)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/obtain-the-metadata-from-a-container-1", "page_type": "doc", "title": "在容器内获取元数据", "keywords": "获取容器内元数据,查询ECI实例元数据,ECI元数据获取方法,ECI元数据项参考,Downward API用法", "last_modified_ms": 1728871911000, "last_modified_iso": "2024-10-14T10:11:51+08:00", "excerpt": "ECI Pod（即ECI实例）的元数据可以提供关于Pod及其容器的信息用于管理和使用容器，例如名称、ID等基本信息，以及IP地址、网卡等网络信息等。本文介绍如何在容器内获取元数据，将ECI Pod信息和容器Meta数据呈现给运行中的容器。\n## 方式一：通过MetaServer访问元数据\n\n- \n\n连接容器。具体操作，请参见[连接ECI实例](https://help.aliyun.com/zh/eci/getting-started/connect-to-an-elastic-container-instance#topic-1860104)。\n- \n\n访问元数据。说明 \n\n如果容器环境没有安装curl，请先安装curl。\n\ncurl http://100.100.100.200/latest/meta-data/<metadata>\n\n\n<metadata>请替换为具体要查询的实例元数据。例如执行以下命令获取实例ID。\n\ncurl http://100.100.100.200/latest/meta-data/instance-id\n\n\nECI实例目前能获取的基本实例元数据项如下表所示：\n\n[表格]\n\n实例元数据项\n\n说明\n\n/dns-conf/nameservers\n\n实例的DNS配置。\n\n/eipv4\n\n实例的弹性公网IP（IPv4类型）。\n\n/hostname\n\n实例的主机名，对应ContainerGroupName。\n\n/instance-id\n\n实例ID。\n\n/mac\n\n实例的MAC地址。\n\n/network/interfaces/\n\n网卡的MAC地址列表。\n\n/network/interfaces/macs/[mac]/network-interface-id\n\n网卡的标识ID，其中[mac]参数需要替换为实例MAC地址。\n\n/network/interfaces/macs/[mac]/netmask\n\n网卡对应的子网掩码。\n\n/network/interfaces/macs/[mac]/vswitch-cidr-block\n\n网卡所属的虚拟交换机IPv4 CIDR段。\n\n/network/interfaces/macs/[mac]/vpc-cidr-block\n\n网卡所属的VPC IPv4 CIDR段。\n\n/network/interfaces/macs/[mac]/private-ipv4s\n\n网卡分配的私网IPv4地址列表。\n\n/network/interfaces/macs/[mac]/vpc-ipv6-cidr-blocks\n\n网卡所属的VPC IPv6 CIDR段，仅支持已配置了IPv6的VPC类型实例。\n\n/network/interfaces/macs/[mac]/vswitch-id\n\n网卡所属安全组的虚拟交换机ID。\n\n/network/interfaces/macs/[mac]/vpc-id\n\n网卡所属安全组的VPC ID。\n\n/network/interfaces/macs/[mac]/primary-ip-address\n\n网卡主私有IP地址。\n\n/network/interfaces/macs/[mac]/gateway\n\n网卡对应的IPv4网关地址。\n\n/instance/max-netbw-egress\n\n实例规格的出方向内网最大带宽。单位：Kbit/s。\n\n/instance/max-netbw-ingerss\n\n实例规格的入方向内网最大带宽。单位：Kbit/s。\n\n/network/interfaces/macs/[mac]/ipv6s\n\n网卡分配的IPv6地址列表，仅支持已配置了IPv6的VPC类型实例。\n\n/network/interfaces/macs/[mac]/ipv6-gateway\n\n网卡所属的VPC的IPv6网关地址。\n\n/network/interfaces/macs/[mac]/vswitch-ipv6-cidr-block\n\n网卡所属的虚拟交换机IPv6 CIDR段，仅支持已配置了IPv6的VPC类型实例。\n\n/private-ipv4\n\n实例的私网IPv4地址。\n\n/ntp-conf/ntp-servers\n\nNTP服务器地址。\n\n/owner-account-id\n\n实例拥有者的阿里云账号ID。\n\n/region-id\n\n实例所属地域。\n\n/serial-number\n\n实例所对应的序列号。\n\n/vpc-id\n\n实例所属VPC ID。\n\n/vpc-cidr-block\n\n实例所属VPC的CIDR网段。\n\n/vswitch-cidr-block\n\n实例所属虚拟交换机的CIDR网段。\n\n/vswitch-id\n\n实例所属虚拟交换机ID。\n\n/zone-id\n\n实例所属可用区。\n\n/ram/security-credentials/[role-name]\n\n实例RAM角色策略所生成的STS临时凭证。只有在实例指定了RAM角色后，您才能获取STS临时凭证。其中[role-name]参数需要替换为实例RAM角色的名称。如果未指定[role-name]，将返回实例RAM角色名称。\n\n## 方式二：配置容器的环境变量\n\n通过容器环境变量的Value可以获取ECI实例的元数据。支持配置环境变量获取的元数据项如下：\n\n[表格]\n\nKey\n\nValue\n\n说明\n\neci_id\n\n__ECI_ID__\n\n实例ID。\n\neci_name\n\n__ECI_NAME__\n\n实例名称。\n\nregion_id\n\n__REGION_ID__\n\n实例所属地域。\n\nzone_id\n\n__ZONE_ID__\n\n实例所属可用区。\n\ncontainer_name\n\n__CONTAINER_NAME__\n\n容器名称。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        env:  \n          - name: eci_id\n            value: __ECI_ID__\n          - name: eci_name\n            value: __ECI_NAME__\n          - name: region_id\n            value: __REGION_ID__\n          - name: zone_id\n            value: __ZONE_ID__\n          - name: container_name\n            value: __CONTAINER_NAME__\n\n\n\n登入容器查看环境变量，可以看到环境变量已经生效。示例如下：\n\n## 方式三：Downward API\n\nKubernetes Downward API提供了以下两种方式：\n\n- \n\n环境变量\n\n用于单个变量，可以将Pod信息直接注入容器内部。\n- \n\nVolume挂载\n\n可以将Pod信息生成为文件，直接挂载到容器内部。\n\n目前ACK+ECI已经支持了Downward API的大部分常用字段，下文将为您介绍使用方式。\n### 环境变量方式\n\n您可以通过Downward API将Pod的名称、命名空间、IP等信息注入到容器的环境变量中。通过环境变量可以获得的元数据项如下表所示。\n\n[表格]\n\n参数\n\n描述\n\nmetadata.name\n\nPod名称。\n\nmetadata.namespace\n\nPod命名空间。\n\nmetadata.uid\n\nPod的UID。\n\nmetadata.labels['<KEY>']\n\nPod的标签值。\n\nmetadata.annotations['<KEY>']\n\nPod的注解值。具体请参见[ECI Pod Annotation](https://help.aliyun.com/zh/eci/user-guide/pod-annotations-1)。\n\nspec.serviceAccountName\n\nPod服务账号名称。\n\nspec.nodeName\n\n节点名称。\n\nstatus.podIP\n\n节点IP。\n\nDeployment示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: downward-env\n  labels:\n    app: nginx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n   "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/obtain-the-metadata-from-a-container-2", "page_type": "doc", "title": "在容器内获取元数据", "keywords": "获取ECI容器元数据,容器元数据获取方法,ECI元数据项参考", "last_modified_ms": 1722494153000, "last_modified_iso": "2024-08-01T14:35:53+08:00", "excerpt": "ECI Pod（即ECI实例）的元数据可以提供关于Pod及其容器的信息用于管理和使用容器，例如名称、ID等基本信息，以及IP地址、网卡等网络信息等。本文介绍如何在容器内获取元数据，将ECI Pod信息和容器Meta数据呈现给运行中的容器。\n## 方式一：通过MetaServer访问元数据\n\n- \n\n连接容器。具体操作，请参见[连接ECI实例](https://help.aliyun.com/zh/eci/getting-started/connect-to-an-elastic-container-instance#topic-1860104)。\n- \n\n访问元数据。说明 \n\n如果容器环境没有安装curl，请先安装curl。\n\ncurl http://100.100.100.200/latest/meta-data/<metadata>\n\n\n<metadata>请替换为具体要查询的实例元数据。例如执行以下命令获取实例ID。\n\ncurl http://100.100.100.200/latest/meta-data/instance-id\n\n\nECI实例目前能获取的基本实例元数据项如下表所示：\n\n[表格]\n\n实例元数据项\n\n说明\n\n/dns-conf/nameservers\n\n实例的DNS配置。\n\n/eipv4\n\n实例的弹性公网IP（IPv4类型）。\n\n/hostname\n\n实例的主机名，对应ContainerGroupName。\n\n/instance-id\n\n实例ID。\n\n/mac\n\n实例的MAC地址。\n\n/network/interfaces/\n\n网卡的MAC地址列表。\n\n/network/interfaces/macs/[mac]/network-interface-id\n\n网卡的标识ID，其中[mac]参数需要替换为实例MAC地址。\n\n/network/interfaces/macs/[mac]/netmask\n\n网卡对应的子网掩码。\n\n/network/interfaces/macs/[mac]/vswitch-cidr-block\n\n网卡所属的虚拟交换机IPv4 CIDR段。\n\n/network/interfaces/macs/[mac]/vpc-cidr-block\n\n网卡所属的VPC IPv4 CIDR段。\n\n/network/interfaces/macs/[mac]/private-ipv4s\n\n网卡分配的私网IPv4地址列表。\n\n/network/interfaces/macs/[mac]/vpc-ipv6-cidr-blocks\n\n网卡所属的VPC IPv6 CIDR段，仅支持已配置了IPv6的VPC类型实例。\n\n/network/interfaces/macs/[mac]/vswitch-id\n\n网卡所属安全组的虚拟交换机ID。\n\n/network/interfaces/macs/[mac]/vpc-id\n\n网卡所属安全组的VPC ID。\n\n/network/interfaces/macs/[mac]/primary-ip-address\n\n网卡主私有IP地址。\n\n/network/interfaces/macs/[mac]/gateway\n\n网卡对应的IPv4网关地址。\n\n/instance/max-netbw-egress\n\n实例规格的出方向内网最大带宽。单位：Kbit/s。\n\n/instance/max-netbw-ingerss\n\n实例规格的入方向内网最大带宽。单位：Kbit/s。\n\n/network/interfaces/macs/[mac]/ipv6s\n\n网卡分配的IPv6地址列表，仅支持已配置了IPv6的VPC类型实例。\n\n/network/interfaces/macs/[mac]/ipv6-gateway\n\n网卡所属的VPC的IPv6网关地址。\n\n/network/interfaces/macs/[mac]/vswitch-ipv6-cidr-block\n\n网卡所属的虚拟交换机IPv6 CIDR段，仅支持已配置了IPv6的VPC类型实例。\n\n/private-ipv4\n\n实例的私网IPv4地址。\n\n/ntp-conf/ntp-servers\n\nNTP服务器地址。\n\n/owner-account-id\n\n实例拥有者的阿里云账号ID。\n\n/region-id\n\n实例所属地域。\n\n/serial-number\n\n实例所对应的序列号。\n\n/vpc-id\n\n实例所属VPC ID。\n\n/vpc-cidr-block\n\n实例所属VPC的CIDR网段。\n\n/vswitch-cidr-block\n\n实例所属虚拟交换机的CIDR网段。\n\n/vswitch-id\n\n实例所属虚拟交换机ID。\n\n/zone-id\n\n实例所属可用区。\n\n/ram/security-credentials/[role-name]\n\n实例RAM角色策略所生成的STS临时凭证。只有在实例指定了RAM角色后，您才能获取STS临时凭证。其中[role-name]参数需要替换为实例RAM角色的名称。如果未指定[role-name]，将返回实例RAM角色名称。\n\n## 方式二：配置容器的环境变量\n\n通过容器环境变量的Value可以获取ECI实例的元数据。支持配置环境变量获取的元数据项如下：\n\n[表格]\n\nKey\n\nValue\n\n说明\n\neci_id\n\n__ECI_ID__\n\n实例ID。\n\neci_name\n\n__ECI_NAME__\n\n实例名称。\n\nregion_id\n\n__REGION_ID__\n\n实例所属地域。\n\nzone_id\n\n__ZONE_ID__\n\n实例所属可用区。\n\ncontainer_name\n\n__CONTAINER_NAME__\n\n容器名称。\n\n配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        env:  \n          - name: eci_id\n            value: __ECI_ID__\n          - name: eci_name\n            value: __ECI_NAME__\n          - name: region_id\n            value: __REGION_ID__\n          - name: zone_id\n            value: __ZONE_ID__\n          - name: container_name\n            value: __CONTAINER_NAME__\n\n\n\n登入容器查看环境变量，可以看到环境变量已经生效。示例如下：\n\n## 方式三：Downward API\n\nKubernetes Downward API提供了以下两种方式：\n\n- \n\n环境变量\n\n用于单个变量，可以将Pod信息直接注入容器内部。\n- \n\nVolume挂载\n\n可以将Pod信息生成为文件，直接挂载到容器内部。\n\n目前阿ACK+ECI已经支持了Downward API的大部分常用字段，下文将为您介绍使用方式。\n### 环境变量方式\n\n您可以通过Downward API将Pod的名称、命名空间、IP等信息注入到容器的环境变量中。通过环境变量可以获得的元数据项如下表所示。\n\n[表格]\n\n参数\n\n描述\n\nmetadata.name\n\nPod名称。\n\nmetadata.namespace\n\nPod命名空间。\n\nmetadata.uid\n\nPod的UID。\n\nmetadata.labels['<KEY>']\n\nPod的标签值。\n\nmetadata.annotations['<KEY>']\n\nPod的注解值。具体请参见[ECI Pod Annotation](https://help.aliyun.com/zh/eci/user-guide/pod-annotations-1)。\n\nspec.serviceAccountName\n\nPod服务账号名称。\n\nspec.nodeName\n\n节点名称。\n\nstatus.podIP\n\n节点IP。\n\nDeployment示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: downward-env\n  labels:\n    app: nginx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n  "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview", "page_type": "doc", "title": "实例概述", "keywords": "了解ECI实例,创建ECI实例,ECI实例概述,ECI实例基本配置", "last_modified_ms": 1729231035000, "last_modified_iso": "2024-10-18T13:57:15+08:00", "excerpt": "每个ECI实例对应一个容器组，由vCPU、内存、网络等基础组件组成，用于运行一个或多个容器。本文介绍ECI实例的基本配置、创建方式和生命周期等。\n## 基本配置\n\nECI实例包含实例规格、容器镜像、网络、存储等基础组件，您可以方便地定制、更改实例的配置。您对该ECI实例拥有完全的控制权，不需要进行底层服务器的管理和配置操作，只需要提供打包好的容器镜像，即可运行容器。\n\n- \n\n实例规格\n\n一个ECI实例主要包括vCPU和内存规格。创建实例时，可以指定ECI规格（直接指定vCPU和内存），也可以指定ECS规格来满足GPU、增强网络能力等特殊需求。\n- \n\n容器镜像\n\n一个ECI实例由一个或者多个容器组成，部署容器应用时，需要准备好容器镜像。容器镜像包含容器应用运行所需的程序、库文件、配置等。拉取镜像时，需要保证网络畅通，推荐您使用镜像缓存功能来节约实例的启动耗时。\n- \n\n网络\n\n一个ECI实例将占用所属VPC下的交换机的一个弹性网卡资源，默认具备一个内网IP地址。如果需要连接公网，例如需要拉取公网镜像。则需要为ECI实例绑定EIP，或者为所属VPC绑定NAT网关。\n- \n\n存储\n\n一个ECI实例默认有30 GiB的临时存储空间，您可以根据需要增加临时存储空间。如果想要保留存储的文件，建议使用外挂数据卷，支持挂载云盘、NAS和OSS等阿里云存储数据卷。\n\n## 创建方式\n### 创建方式概述\n\n根据业务场景和使用场景，ECI支持两种实例的定义方式，对应到不同的计费模式。更多关于ECI实例计费的信息，请参见[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances#topic-2240704)。\n\n[表格]\n\n创建方式\n\n计费说明\n\n相关文档\n\n指定vCPU和内存\n\n根据您创建时指定的vCPU和内存进行计费。在此基础上，如果您对成本或者性能有更多要求，可以进一步指定算力类别。对于不满足ECI要求的vCPU和内存规格，系统将自动进行规整，并按自动规整后的规格进行计费。\n\n- \n\n[指定vCPU和内存创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-an-elastic-container-instance#topic-1860129)\n- \n\n[指定算力类别创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-an-instance)\n- \n\n[配置资源规整忽略特定容器](https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-during-resource-adjustment#topic-2241520)\n\n指定ECS规格\n\n根据您创建时指定的ECS规格进行计费。您可以根据业务需要，指定ECI Pod底层使用具体的某一ECS规格，来获取相应规格的指定能力，例如：指定使用ecs.gn6i-c4g1.xlarge规格来获取GPU能力。\n\n- \n\n[指定x86规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-of-the-specified-x86-type)\n- \n\n[指定GPU规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-the-gpu-type)\n- \n\n[指定本地盘规格创建实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-a-local-disk-type)\n重要 \n\nECI实例默认的CPU架构为x86，支持Arm架构。关于如何创建Arm架构的ECI实例，请参见[创建Arm架构的实例](https://help.aliyun.com/zh/eci/user-guide/create-an-instance-by-specifying-the-arm-type)。\n### 优化使用成本\n\n根据您的业务特征，在按量付费使用ECI的基础上，您还可以结合使用抢占式实例、预留实例券和节省计划来降低资源使用成本。\n\n- \n\n对于无状态且可容错的业务负载，您可以使用抢占式实例。具体操作，请参见[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance#topic-1876161)。\n- \n\n对于长时间运行的稳定业务负载，推荐使用预留实例券或者节省计划来抵扣ECI实例账单。根据ECI的计费模式，支持抵扣的情况如下：\n\n- \n\n按vCPU和内存计费的ECI实例：支持使用通用型节省计划。\n- \n\n按ECS规格计费的ECI实例：支持使用通用型节省计划、ECS计算型节省计划和预留实例券。\n\n您可以根据使用的ECI实例情况选择合适的方式。具体操作，请参见[使用预留实例券](https://help.aliyun.com/zh/eci/user-guide/use-reserved-instances#topic-1860114)和[使用节省计划](https://help.aliyun.com/zh/eci/user-guide/apply-savings-plans-2#topic-2044352)。\n\n### 应对库存不足\n\nECI提供容器的云上运行资源，在大规模创建实例的场景下，您所在地域和可用区可能会存在指定资源售罄的情况，建议您使用多可用区和多规格的方式创建资源，保证创建成功率。具体操作，请参见：\n\n- \n\n[多可用区创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-multiple-zones-to-create-an-elastic-container-instance#topic-1876030)\n- \n\n[多规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-multiple-specifications-to-create-an-elastic-container-instance#topic-1860149)\n\n## 生命周期\n\n如果您没有通过Kubernetes集群来对接使用ECI，为保证业务的健壮性和避免资源浪费，需要您对ECI实例进行生命周期管理，根据不同状态进行业务逻辑处理。更多信息，请参见[ECI实例生命周期](https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-1#topic-1860137)。\n## 实例管理\n\n您可以使用标签来标记有相同管理或者业务需求的ECI实例，便于后续进行筛选和操作。更多信息，请参见[使用标签管理ECI实例](https://help.aliyun.com/zh/eci/user-guide/use-tags-to-manage-elastic-container-instances#topic-1860115)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview-1", "page_type": "doc", "title": "ECI Pod概述", "keywords": "了解ECI Pod,创建ECI Pod,ECI Pod概述,ECI Pod基本配置,ECI Pod创建方式", "last_modified_ms": 1736850772000, "last_modified_iso": "2025-01-14T18:32:52+08:00", "excerpt": "ECI能为Kubernetes提供基础的容器Pod运行环境，每个ECI实例相当于一个Pod。本文介绍ECI Pod的配置、创建方式和生命周期。\n## 基本配置\n\n基于Kubernetes社区的Virtual Kubelet技术，ECI支持以虚拟节点（VNode）的形式接入到Kubernetes集群中。一个ECI实例相当于一个Pod，包含以下几部分配置：\n\n- \n\n规格\n\n规格包括vCPU、内存等配置，定义了ECI Pod的计算性能等。创建ECI Pod时，您可以指定ECI规格（直接指定vCPU和内存），也可以指定ECS规格来满足GPU、本地盘等特殊需求。\n- \n\n容器镜像\n\n一个ECI Pod最多可以包含20个容器。部署容器应用时，需要准备好容器镜像。容器镜像包含容器应用运行所需的程序、库文件、配置等。拉取镜像时，需要保证网络畅通，推荐您使用镜像缓存功能来节约实例的启动耗时。\n- \n\n网络\n\n一个ECI Pod将占用所属VPC下的交换机的一个弹性网卡资源，默认具备一个内网IP地址。如果需要连接公网，例如需要拉取公网镜像。则需要为ECI Pod绑定EIP，或者为所属VPC绑定NAT网关。\n- \n\n存储\n\n一个ECI Pod默认有30 GiB的临时存储空间，您可以根据需要增加临时存储空间。如果想要保留存储的文件，建议使用外挂数据卷，支持挂载云盘、NAS和OSS等阿里云存储数据卷。\n\n## 创建方式\n### 创建方式概述\n\n根据业务场景和使用场景，ECI Pod支持不同的创建方式，对应到不同的计费模式。更多关于ECI Pod的计费信息，请参见[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances#title-aw3-7hi-pol)。\n\n[表格]\n\n创建方式\n\n计费模式\n\n说明\n\n相关文档\n\n指定vCPU和内存\n\n按vCPU和内存\n\n根据您创建时指定的vCPU和内存进行计费。在此基础上，如果您对成本或者性能有更多要求，可以进一步指定算力类别。对于不满足ECI要求的vCPU和内存规格，系统将自动进行规整，并按自动规整后的规格进行计费。\n\n- \n\n[指定vCPU和内存创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod#4b4c0a4021isz)\n- \n\n[配置资源规整时忽略特定容器](https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-when-the-system-adjusts-resources#04377f8021wis)\n\n指定ECS规格\n\n按ECS规格\n\n根据您创建时指定的ECS规格进行计费。您可以根据业务需要，指定ECI Pod底层使用具体的某一ECS规格，来获取相应规格的指定能力，例如：指定使用ecs.gn6i-c4g1.xlarge规格来获取GPU能力。\n\n[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod/#6fc00c30216bw)\n\n指定vCPU和内存的同时设置ECS规格族或规格代数进行过滤\n\n按ECS规格\n\n根据您创建时指定的vCPU和内存，以及关于规格族或者规格代数的过滤条件，系统会自动选择合适的ECS规格，并按实际生成的ECS规格进行计费。\n\n- \n\n[指定或排除ECS规格族创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod)\n- \n\n[指定或排除ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod-1)\n\n### 优化使用成本\n\n根据您的业务特征，在按量付费使用ECI的基础上，您还可以结合使用抢占式实例、预留实例券和节省计划来降低资源使用成本。\n\n- \n\n对于无状态且可容错的业务负载，您可以使用抢占式实例。具体操作，请参见[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-2#e2f99d20217x1)。\n- \n\n对于长时间运行的稳定业务负载，推荐使用预留实例券或者节省计划来抵扣ECI实例账单。根据ECI的计费模式，支持抵扣的情况如下：\n\n- \n\n按vCPU和内存计费的ECI Pod：支持使用通用型节省计划。\n- \n\n按ECS规格计费的ECI Pod：支持使用通用型节省计划、ECS计算型节省计划和预留实例券。\n\n您可以根据使用的ECI实例情况选择合适的方式。具体操作，请参见[使用预留实例券](https://help.aliyun.com/zh/eci/user-guide/use-reserved-instances-2#title-quq-fv2-6j9)和[使用节省计划](https://help.aliyun.com/zh/eci/user-guide/apply-savings-plans#title-npr-pu5-d45)。\n\n### 应对库存不足\n\nECI提供容器的云上运行资源，在大规模创建ECI Pod的场景下，您所在地域和可用区可能会存在指定资源售罄的情况，建议您使用多可用区和多规格的方式创建资源，保证创建成功率。具体操作，请参见：\n\n- \n\n[多可用区创建Pod](https://help.aliyun.com/zh/eci/user-guide/deploy-pods-in-multiple-zones#title-cvo-l2k-epo)\n- \n\n[多规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-by-specifying-multiple-specifications#fb2cc3c0228p0)\n\n## 生命周期\n\n在ECI Pod的生命周期中，不同的阶段有其固有的状态。关于ECI Pod状态的变化过程，以及与Kubernetes Pod状态的对应关系，请参见[ECI Pod生命周期](https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance#9dadbd8021qdw)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview-3", "page_type": "doc", "title": "自建Kubernetes集群对接ECI", "keywords": "自建K8s对接ECI,了解VNode计费,了解对接功能限制,自建K8s对接ECI方法,VNode计费说明,对接ECI功能限制", "last_modified_ms": 1741076421000, "last_modified_iso": "2025-03-04T16:20:21+08:00", "excerpt": "ECI能为Kubernetes提供基础的容器Pod运行环境，但业务间的依赖、负载均衡、弹性伸缩、定期调度等能力依然需要Kubernetes来提供。本文为您介绍自建Kubernetes集群如何与ECI对接，以及如何使用ECI。\n## 对接方式\n\nECI为Kubernetes提供一种层次化的解决方案：即ECI负责底层Pod容器资源的调度和管理工作，Kubernetes在ECI之上作为PaaS层来管理业务负载，例如管理Deployment、Service、StatefulSet、CronJob等。\n\nECI在接管Pod容器底层基础设施的管理工作后，Kubernetes不再需要直接负责单个Pod的放置、启动等工作，也不再需要关心底层虚拟机的资源情况，通过ECI即可确保Pod需要的资源随时可用。对于长时间运行的业务负载，您可以将此类负载的弹性流量部分调度至ECI，缩短弹性扩容的时间，减少弹性部分的扩容成本，并尽可能充分利用已有资源。当业务流量下降后，可以快速释放部署在ECI上的Pod，从而降低您的使用成本。\n\n如果您在本地IDC，或者阿里云的ECS上自建了Kubernetes集群，则可以通过部署虚拟节点（VNode）的方式来使用ECI。VNode对标原生kubernetes节点，内置了virtual-kubelet、kube-proxy等组件，兼容原生kubernetes节点API。当有Pod调度到VNode上时，VNode会自动创建并管理底层的ECI资源。在VNode上运行的每个Pod都对应一个ECI实例，架构如下图所示：\n\n关于自建集群如何接入VNode，请参见：\n\n- \n\n（推荐）[接入VNode（VNodectl工具）](https://help.aliyun.com/zh/eci/user-guide/use-vnodectl-to-connect-a-vnode-to-a-self-managed-kubernetes-cluster)\n- \n\n[接入VNode（手动）](https://help.aliyun.com/zh/eci/user-guide/manually-connect-a-vnode-to-a-self-managed-kubernetes-cluster)\n\n## 计费说明\n\nVNode按个数计费。每个VNode会有一个常驻节点，相当于2 vCPU，8 GiB的ECI实例，收取相关实例费用。说明 \n\nVNode支持标签功能，您可以为VNode绑定特定标签，以便区分VNode实例费用和普通ECI实例费用。\n\n费用计算公式为：单个VNode费用=（2*vCPU单价+8*内存单价）*运行时长。\n\n- \n\n关于ECI实例如何计费，以及vCPU和内存的具体单价，请参见[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances)。\n- \n\n运行时长从VNode常驻节点Ready后开始计时。\n\nVNode常驻节点的状态并不等同于集群中的Node状态。您可以在[弹性容器实例控制台的虚拟节点页面](https://eci.console.aliyun.com/#/eci/cn-shanghai/vnode)确认VNode常驻节点的状态。\n\n## 功能限制\n\n基于公有云的安全性和虚拟节点本身带来的限制，ECI目前还不支持Kubernetes中HostPath、DaemonSet等功能，具体如下表所示。\n\n[表格]\n\n不支持的功能\n\n说明\n\n推荐替代方案\n\nHostPath\n\n挂载本地宿主机文件到容器中\n\n使用emptyDir、云盘或者NAS文件系统\n\nHostNetwork\n\n将宿主机端口映射到容器上\n\n使用type=LoadBalancer的负载均衡\n\nDaemonSet\n\n在容器所在宿主机上部署Static Pod\n\n通过sidecar形式在Pod中部署多个镜像\n\ntype=NodePort的Service\n\n将宿主机端口映射到容器上\n\n使用type=LoadBalancer的负载均衡\n## 调度方式\n\n对于混合使用普通节点和虚拟节点的Kubernetes集群，您可以根据需要将Pod调度到VNode，以ECI来运行。主要方式如下：\n\n- \n\n手动调度\n\n通过配置nodeSelector和tolerations、指定nodeName的方式，可以手动将Pod调度到VNode。具体操作，请参见[将Pod调度到VNode](https://help.aliyun.com/zh/eci/user-guide/schedule-pods-to-a-vnode#topic-2145262)。\n- \n\n自动调度\n\n部署eci-profile组件后，可以自定义配置Selector，将满足条件的Pod自动调度到VNode。具体操作，请参见[使用eci-profile调度Pod到VNode](https://help.aliyun.com/zh/eci/user-guide/use-eci-profile-to-schedule-pods-to-a-vnode)。\n\n## 使用ECI功能\n\n在Kubernetes集群中创建Pod到ECI时，为充分使用ECI提供的功能，在不改变Kubernetes语义的前提下，您可以根据需求为Pod添加Annotation。Annotation需添加到Pod级别的metadata中，支持的Annotation列表以及配置示例，请参见[ECI Pod Annotation](https://help.aliyun.com/zh/eci/user-guide/pod-annotations-1#topic-1860148)。说明 \n\n您可以在创建Pod时手动添加Annotation，也可以配置eci-proflie，实现自动添加Annotation到Label能够匹配上的Pod。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview-4", "page_type": "doc", "title": "ECI Pod概述", "keywords": "了解ECI Pod概念,了解ECI Pod创建方式,ECI Pod产品概述,ECI Pod基本配置,ECI Pod创建方式", "last_modified_ms": 1741744802000, "last_modified_iso": "2025-03-12T10:00:02+08:00", "excerpt": "ECI能为Kubernetes提供基础的容器Pod运行环境，每个ECI实例相当于一个Pod。本文介绍ECI Pod的配置、创建方式和生命周期。\n\n## 基本配置\n\n基于Kubernetes社区的Virtual Kubelet技术，ECI支持以虚拟节点（VK）的形式接入到Kubernetes集群中。一个ECI实例相当于一个Pod，包含以下几部分配置：\n\n- \n\n规格\n\n规格包括vCPU、内存等配置，定义了ECI Pod的计算性能等。创建ECI Pod时，您可以指定ECI规格（直接指定vCPU和内存），也可以指定ECS规格来满足GPU、本地盘等特殊需求。\n- \n\n容器镜像\n\n一个ECI Pod最多可以包含20个容器。部署容器应用时，需要准备好容器镜像。容器镜像包含容器应用运行所需的程序、库文件、配置等。拉取镜像时，需要保证网络畅通，推荐您使用镜像缓存功能来节约实例的启动耗时。\n- \n\n网络\n\n一个ECI Pod将占用所属VPC下的交换机的一个弹性网卡资源，默认具备一个内网IP地址。如果需要连接公网，例如需要拉取公网镜像。则需要为ECI Pod绑定EIP，或者为所属VPC绑定NAT网关。\n- \n\n存储\n\n一个ECI Pod默认有30 GiB的临时存储空间，您可以根据需要增加临时存储空间。如果想要保留存储的文件，建议使用外挂数据卷，支持挂载云盘、NAS和OSS等阿里云存储数据卷。\n\n## 创建方式\n### 创建方式概述\n\n根据业务场景和使用场景，ECI Pod支持不同的创建方式，对应到不同的计费模式。更多关于ECI Pod的计费信息，请参见[ECI实例计费](https://help.aliyun.com/zh/eci/product-overview/elastic-container-instances#title-aw3-7hi-pol)。\n\n[表格]\n\n创建方式\n\n计费模式\n\n说明\n\n相关文档\n\n指定vCPU和内存\n\n按vCPU和内存\n\n根据您创建时指定的vCPU和内存进行计费。在此基础上，如果您对成本或者性能有更多要求，可以进一步指定算力类别。对于不满足ECI要求的vCPU和内存规格，系统将自动进行规整，并按自动规整后的规格进行计费。\n\n- \n\n[指定vCPU和内存创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod-1#4b4c0a4021isz)\n- \n\n[指定算力类别创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-a-pod)\n- \n\n[配置资源规整时忽略特定容器](https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-when-the-system-adjusts-resources-1#04377f8021wis)\n\n指定ECS规格\n\n按ECS规格\n\n根据您创建时指定的ECS规格进行计费。您可以根据业务需要，指定ECI Pod底层使用具体的某一ECS规格，来获取相应规格的指定能力，例如：指定使用ecs.gn6i-c4g1.xlarge规格来获取GPU能力。\n\n- \n\n[指定x86规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specifying-the-x86-specification-to-create-a-pod)\n- \n\n[指定GPU规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-gpu-specification)\n- \n\n[指定本地盘规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-specifications-of-a-local-disk)\n- \n\n[指定Arm规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-arm-specification)\n\n指定vCPU和内存的同时设置ECS规格族或规格代数进行过滤\n\n按ECS规格\n\n根据您创建时指定的vCPU和内存，以及关于规格族或者规格代数的过滤条件，系统会自动选择合适的ECS规格，并按实际生成的ECS规格进行计费。\n\n- \n\n[指定ECS规格族创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod-1)\n- \n\n[指定ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod)\n重要 \n\nECI Pod的CPU架构默认为x86，但也支持Arm架构。关于如何创建Arm架构的ECI Pod，请参见[调度Pod到Arm架构的虚拟节点](https://help.aliyun.com/zh/eci/user-guide/scheduling-pods-to-virtual-nodes-in-the-arm-architecture)。\n### 优化使用成本\n\n根据您的业务特征，在按量付费使用ECI的基础上，您还可以结合使用抢占式实例、预留实例券和节省计划来降低资源使用成本。\n\n- \n\n对于无状态且可容错的业务负载，您可以使用抢占式实例。具体操作，请参见[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-1#e2f99d20217x1)。\n- \n\n对于长时间运行的稳定业务负载，推荐使用预留实例券或者节省计划来抵扣ECI实例账单。根据ECI的计费模式，支持抵扣的情况如下：\n\n- \n\n按vCPU和内存计费的ECI Pod：支持使用通用型节省计划。\n- \n\n按ECS规格计费的ECI Pod：支持使用通用型节省计划、ECS计算型节省计划和预留实例券。\n\n您可以根据使用的ECI实例情况选择合适的方式。具体操作，请参见[使用预留实例券](https://help.aliyun.com/zh/eci/user-guide/use-reserved-instances-1#title-quq-fv2-6j9)和[使用节省计划](https://help.aliyun.com/zh/eci/user-guide/apply-savings-plans-1#title-npr-pu5-d45)。\n\n### 应对库存不足\n\nECI提供容器的云上运行资源，在大规模创建ECI Pod的场景下，您所在地域和可用区可能会存在指定资源售罄的情况，建议您使用多可用区和多规格的方式创建资源，保证创建成功率。具体操作，请参见：\n\n- \n\n[多可用区创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-in-multiple-zones#df3445d022znq)\n- \n\n[多规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-by-specifying-multiple-specifications-1#fb2cc3c0228p0)\n\n## 生命周期\n\n在ECI Pod的生命周期中，不同的阶段有其固有的状态。关于ECI Pod状态的变化过程，以及与Kubernetes Pod状态的对应关系，请参见[ECI Pod生命周期](https://help.aliyun.com/zh/eci/user-guide/lifecycle-of-an-elastic-container-instance-2#9dadbd8021qdw)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches", "page_type": "doc", "title": "镜像缓存概述", "keywords": "了解镜像缓存功能,对比镜像缓存创建方式,了解镜像缓存计费,镜像缓存功能介绍,镜像缓存创建方式,镜像缓存计费", "last_modified_ms": 1732604591000, "last_modified_iso": "2024-11-26T15:03:11+08:00", "excerpt": "使用镜像缓存（ImageCache）创建ECI实例可以加速拉取镜像，减少ECI实例的启动耗时。本文介绍镜像缓存的基本功能、创建和使用方式、以及计费说明等。\n## 功能简介\n\n在运行容器前，ECI需要先拉取您指定的容器镜像，但因网络和容器镜像大小等因素，镜像拉取耗时往往成了ECI实例启动的主要耗时。为加速实例的创建速度，ECI提供镜像缓存功能。您可以预先将需要使用的镜像制作成缓存快照，然后基于该快照来创建ECI实例，避免或者减少镜像层的下载，从而提升实例的创建速度。\n\n经实测，以使用Docker Hub的flink镜像（约386.26 MB）创建ECI实例为例，正常创建过程中，镜像准备阶段需要耗时50s，使用镜像缓存后，镜像准备阶段无需耗时，可以极大节约实例启动耗时。重要 \n\n具体提升速度由ECI实例中使用的镜像个数、镜像大小和镜像仓库网络因素等决定。\n## 创建方式\n\n镜像缓存的创建分为手动创建和自动创建两种方式。重要 \n\n推荐使用自动创建的镜像缓存，可以节约使用成本。但对于首次创建就需要加速创建ECI实例的场景，需提前手动创建镜像缓存。\n### 手动创建\n\n您可以根据需要，自行设置名称、大小等参数来创建镜像缓存。过程如下：\n\n- \n\n一个镜像缓存对应一份快照，手动创建的镜像缓存快照由您自行管理。\n- \n\n创建过程中，系统将创建一个ECI实例（2 vCPU、4 GiB内存），并挂载一块ESSD PL1类型的云盘用于中转创建镜像缓存对应的快照。创建完成后，该实例和云盘将被自动释放。\n- \n\n极速镜像缓存功能用于缩短镜像缓存的创建时长。开启该功能后，系统将启用快照极速可用能力，临时创建一份本地快照。本地快照创建完成即可使用镜像缓存功能。说明 \n\n本地快照创建完成后，系统将自动开始创建标准快照，在此期间，镜像缓存对应使用本地快照；待标准快照创建完成后，系统将自动删除本地快照，在此之后，镜像缓存对应使用标准快照。\n- \n\n镜像缓存复用功能用于加快镜像缓存的制作速度。开启该功能后，在创建镜像缓存的过程中，系统将自动匹配已有镜像缓存，如果新的镜像缓存与已有镜像缓存存在重复的镜像层，新的镜像缓存将复用已有镜像缓存的镜像层，从而加速镜像缓存的创建。\n\n### 自动创建\n\n创建ECI实例时，如果开启了自动匹配镜像缓存，则在未匹配到镜像缓存的情况下，系统会在创建ECI实例的同时，自动创建一个镜像缓存。过程如下：\n\n- \n\n一个镜像缓存对应一份快照，自动创建的镜像缓存快照由阿里云管理。\n- \n\n创建过程中，系统将创建一个ECI实例，并使用ECI实例自带的存储空间来中转创建镜像缓存对应的快照。创建完成后，该实例将被自动释放。说明 \n\n每个ECI实例默认有30 GiB的临时存储空间可用于创建镜像缓存，如果您的镜像大小超出了30 GiB，需要额外声明临时存储空间。具体操作，请参见[增加临时存储空间大小](https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space-2)。\n\n### 对比\n\n手动创建和自动创建的镜像缓存在大小、保留时长等方面均有差异，对比如下表所示。\n\n[表格]\n\n对比项\n\n手动创建\n\n自动创建\n\n名称\n\n可以自定义设置名称。\n\n名称由系统自动生成，格式为auto-create-for-实例ID。\n\n大小\n\n默认为20 GiB，可以自定义设置大小。\n\n默认为30 GiB。如果创建ECI实例时声明了临时存储空间，则镜像缓存大小=30 GiB+临时存储空间大小。\n\n保留时长\n\n默认永久保留，可以自行设置保留时长（单位为天），过期后将被自动删除。\n\n默认由阿里云管理保留时长。\n\n- \n\n对于自动创建后从未使用过的镜像缓存，7天后会被自动删除。\n- \n\n对于自动创建后使用过的镜像缓存，当距离上一次使用的时间超过30天时，会被自动删除。\n\n镜像缓存复用\n\n可以开启镜像缓存复用来复用已有镜像层，加快镜像缓存的制作速度。\n\n不支持配置该功能。\n\n极速镜像缓存\n\n可以开启极速镜像缓存来临时创建一份本地快照，缩短镜像缓存的创建时长。\n\n不支持配置该功能。\n\n配额限制\n\n可以调用[ListUsage](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listusage)接口，或者在控制台的权益配额页面查看配额。\n\n如果配额无法满足需求，请提交工单申请提升配额。\n\n可以调用[ListUsage](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listusage)接口查看配额。\n\n如果配额无法满足需求，请提交工单申请提升配额。\n\n淘汰策略\n\n默认情况下，当数量达到配额限制时，无法继续手动创建镜像缓存。\n\n支持通过OpenAPI（CreateImageCache或UpdateImageCache接口）将某个镜像缓存的淘汰策略（EliminationStrategy参数）配置为LRU，表示当数量达到配额限制时，系统可以自动删除最不常用的LRU镜像缓存。\n\n当数量达到配额限制时，系统会遵循LRU规则，自动删除最不常用的镜像缓存。\n\n使用成本\n\n收取创建费用和使用费用。\n\n仅收取使用费用，不收取创建费用。\n## 使用方式\n\n使用镜像缓存可以加快ECI实例的创建。创建ECI实例时，支持自动匹配和明确指定镜像缓存两种方式：\n\n[表格]\n\n使用方式\n\n说明\n\n自动匹配\n\n自动匹配使用最优的镜像缓存。系统将按照以下顺序进行匹配：\n\n- \n\n过滤筛选出您在当前地域下的所有镜像缓存，且镜像缓存的大小满足ECI实例临时存储空间大小的限制。\n- \n\n根据匹配策略选择最优的镜像缓存，匹配策略的优先级从高到低依次为：镜像匹配度、镜像大小、创建时间。\n\n- \n\n镜像匹配度：优先选择匹配度高的镜像缓存，匹配度指的是ECI实例和镜像缓存在镜像仓库和版本上的匹配情况。\n- \n\n镜像大小：优先选择镜像大小最接近的镜像缓存。\n- \n\n创建时间：优先选择最新创建的镜像缓存。\n\n说明 \n\n如果没有匹配到镜像缓存，系统将在创建ECI实例的同时自动创建镜像缓存。创建时将正常拉取镜像，建议您将容器的镜像拉取策略配置为按需拉取（IfNotPresent），以避免镜像层重复下载，影响镜像缓存的使用效果。\n\n明确指定\n\n明确指定使用的镜像缓存。该镜像缓存必须为创建完成（Ready）状态。\n## 注意事项\n\n- \n\n单个镜像缓存最多包含20个镜像。\n- \n\n创建镜像缓存需要拉取容器镜像，因此创建时长由镜像个数、镜像大小、网络等多种因素决定。\n- \n\n手动创建镜像缓存时采用您指定的容器镜像，自动创建镜像缓存时采用实例中所声明的容器镜像。\n\n- \n\n如果镜像为私有镜像（非阿里云容器镜像服务ACR托管的镜像），则需要提供私有镜像仓库的访问凭证，包括地址、用户名和密码。\n- \n\n如果镜像需要通过公网拉取（如Docker官方镜像），则需要配置EIP或者NAT来访问公网。更多信息，请参见[为ECI Pod配置公网连接](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access-2)。\n- \n\n如果镜像由于远程仓库超时等原因导致拉取失败，推荐您使用容器镜像服务ACR，将镜像上传至阿里云仓库。\n\n- \n\n对于手动创建的镜像缓存，建议在创建时设置保留时长，以免产生不必要的快照费用。对于自动创建的镜像缓存，由阿里云管理对应的快照，您无需关注保留时长。\n- \n\n创建镜像缓存后，您可以通过其制作事件了解镜像缓存的制作过程，系统最多可以保留最新的50条制作事件。\n\n## 计费说明\n\n[表格]\n\n操作阶段\n\n手动创建的镜像缓存\n\n自动创建的镜像缓存\n\n创建镜像缓存\n\n涉及以下计费项：\n\n- \n\n临时资源（ECI实例和云盘）费用\n- \n\n快照费用\n\n不收费\n\n使用镜像缓存\n\n云盘费用\n\n如果镜像缓存大于30 GiB，需增加临时存储空间并为其付费。\n\n更多信息，请参见[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches#topic-2240706)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-1", "page_type": "doc", "title": "镜像缓存概述", "keywords": "了解镜像缓存,创建镜像缓存,使用镜像缓存,镜像缓存概述,镜像缓存创建方式,镜像缓存计费说明", "last_modified_ms": 1732604558000, "last_modified_iso": "2024-11-26T15:02:38+08:00", "excerpt": "使用镜像缓存（ImageCache）创建ECI实例可以加速拉取镜像，减少ECI实例的启动耗时。本文介绍镜像缓存的基本功能、创建和使用方式、以及计费说明等。\n## 功能简介\n\n在运行容器前，ECI需要先拉取您指定的容器镜像，但因网络和容器镜像大小等因素，镜像拉取耗时往往成了ECI实例启动的主要耗时。为加速实例的创建速度，ECI提供镜像缓存功能。您可以预先将需要使用的镜像制作成缓存快照，然后基于该快照来创建ECI实例，避免或者减少镜像层的下载，从而提升实例的创建速度。\n\n经实测，以使用Docker Hub的flink镜像（约386.26 MB）创建ECI实例为例，正常创建过程中，镜像准备阶段需要耗时50s，使用镜像缓存后，镜像准备阶段无需耗时，可以极大节约实例启动耗时。重要 \n\n具体提升速度由ECI实例中使用的镜像个数、镜像大小和镜像仓库网络因素等决定。\n## 创建方式\n\n镜像缓存的创建分为手动创建和自动创建两种方式。重要 \n\n推荐使用自动创建的镜像缓存，可以节约使用成本。但对于首次创建就需要加速创建ECI实例的场景，需提前手动创建镜像缓存。\n### 手动创建\n\n您可以根据需要，自行设置名称、大小等参数来创建镜像缓存。过程如下：\n\n- \n\n一个镜像缓存对应一份快照，手动创建的镜像缓存快照由您自行管理。\n- \n\n创建过程中，系统将创建一个ECI实例（2 vCPU、4 GiB内存），并挂载一块ESSD PL1类型的云盘用于中转创建镜像缓存对应的快照。创建完成后，该实例和云盘将被自动释放。\n- \n\n极速镜像缓存功能用于缩短镜像缓存的创建时长。开启该功能后，系统将启用快照极速可用能力，临时创建一份本地快照。本地快照创建完成即可使用镜像缓存功能。说明 \n\n本地快照创建完成后，系统将自动开始创建标准快照，在此期间，镜像缓存对应使用本地快照；待标准快照创建完成后，系统将自动删除本地快照，在此之后，镜像缓存对应使用标准快照。\n- \n\n镜像缓存复用功能用于加快镜像缓存的制作速度。开启该功能后，在创建镜像缓存的过程中，系统将自动匹配已有镜像缓存，如果新的镜像缓存与已有镜像缓存存在重复的镜像层，新的镜像缓存将复用已有镜像缓存的镜像层，从而加速镜像缓存的创建。\n\n### 自动创建\n\n创建ECI实例时，如果开启了自动匹配镜像缓存，则在未匹配到镜像缓存的情况下，系统会在创建ECI实例的同时，自动创建一个镜像缓存。过程如下：\n\n- \n\n一个镜像缓存对应一份快照，自动创建的镜像缓存快照由阿里云管理。\n- \n\n创建过程中，系统将创建一个ECI实例，并使用ECI实例自带的存储空间来中转创建镜像缓存对应的快照。创建完成后，该实例将被自动释放。说明 \n\n每个ECI实例默认有30 GiB的临时存储空间可用于创建镜像缓存，如果您的镜像大小超出了30 GiB，需要额外声明临时存储空间。具体操作，请参见[增加临时存储空间大小](https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space)。\n\n### 对比\n\n手动创建和自动创建的镜像缓存在大小、保留时长等方面均有差异，对比如下表所示。\n\n[表格]\n\n对比项\n\n手动创建\n\n自动创建\n\n名称\n\n可以自定义设置名称。\n\n名称由系统自动生成，格式为auto-create-for-实例ID。\n\n大小\n\n默认为20 GiB，可以自定义设置大小。\n\n默认为30 GiB。如果创建ECI实例时声明了临时存储空间，则镜像缓存大小=30 GiB+临时存储空间大小。\n\n保留时长\n\n默认永久保留，可以自行设置保留时长（单位为天），过期后将被自动删除。\n\n默认由阿里云管理保留时长。\n\n- \n\n对于自动创建后从未使用过的镜像缓存，7天后会被自动删除。\n- \n\n对于自动创建后使用过的镜像缓存，当距离上一次使用的时间超过30天时，会被自动删除。\n\n镜像缓存复用\n\n可以开启镜像缓存复用来复用已有镜像层，加快镜像缓存的制作速度。\n\n不支持配置该功能。\n\n极速镜像缓存\n\n可以开启极速镜像缓存来临时创建一份本地快照，缩短镜像缓存的创建时长。\n\n不支持配置该功能。\n\n配额限制\n\n可以调用[ListUsage](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listusage)接口，或者在控制台的权益配额页面查看配额。\n\n如果配额无法满足需求，请提交工单申请提升配额。\n\n可以调用[ListUsage](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listusage)接口查看配额。\n\n如果配额无法满足需求，请提交工单申请提升配额。\n\n淘汰策略\n\n默认情况下，当数量达到配额限制时，无法继续手动创建镜像缓存。\n\n支持通过OpenAPI（CreateImageCache或UpdateImageCache接口）将某个镜像缓存的淘汰策略（EliminationStrategy参数）配置为LRU，表示当数量达到配额限制时，系统可以自动删除最不常用的LRU镜像缓存。\n\n当数量达到配额限制时，系统会遵循LRU规则，自动删除最不常用的镜像缓存。\n\n使用成本\n\n收取创建费用和使用费用。\n\n仅收取使用费用，不收取创建费用。\n## 使用方式\n\n使用镜像缓存可以加快ECI实例的创建。创建ECI实例时，支持自动匹配和明确指定镜像缓存两种方式：\n\n[表格]\n\n使用方式\n\n说明\n\n自动匹配\n\n自动匹配使用最优的镜像缓存。系统将按照以下顺序进行匹配：\n\n- \n\n过滤筛选出您在当前地域下的所有镜像缓存，且镜像缓存的大小满足ECI实例临时存储空间大小的限制。\n- \n\n根据匹配策略选择最优的镜像缓存，匹配策略的优先级从高到低依次为：镜像匹配度、镜像大小、创建时间。\n\n- \n\n镜像匹配度：优先选择匹配度高的镜像缓存，匹配度指的是ECI实例和镜像缓存在镜像仓库和版本上的匹配情况。\n- \n\n镜像大小：优先选择镜像大小最接近的镜像缓存。\n- \n\n创建时间：优先选择最新创建的镜像缓存。\n\n说明 \n\n如果没有匹配到镜像缓存，系统将在创建ECI实例的同时自动创建镜像缓存。创建时将正常拉取镜像，建议您将容器的镜像拉取策略配置为按需拉取（IfNotPresent），以避免镜像层重复下载，影响镜像缓存的使用效果。\n\n明确指定\n\n明确指定使用的镜像缓存。该镜像缓存必须为创建完成（Ready）状态。\n## 注意事项\n\n- \n\n单个镜像缓存最多包含20个镜像。\n- \n\n创建镜像缓存需要拉取容器镜像，因此创建时长由镜像个数、镜像大小、网络等多种因素决定。\n- \n\n手动创建镜像缓存时采用您指定的容器镜像，自动创建镜像缓存时采用实例中所声明的容器镜像。\n\n- \n\n如果镜像为私有镜像（非阿里云容器镜像服务ACR托管的镜像），则需要提供私有镜像仓库的访问凭证，包括地址、用户名和密码。\n- \n\n如果镜像需要通过公网拉取（如Docker官方镜像），则需要配置EIP或者NAT来访问公网。更多信息，请参见[为ECI Pod配置公网连接](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access-1)。\n- \n\n如果镜像由于远程仓库超时等原因导致拉取失败，推荐您使用容器镜像服务ACR，将镜像上传至阿里云仓库。\n\n- \n\n对于手动创建的镜像缓存，建议在创建时设置保留时长，以免产生不必要的快照费用。对于自动创建的镜像缓存，由阿里云管理对应的快照，您无需关注保留时长。\n- \n\n创建镜像缓存后，您可以通过其制作事件了解镜像缓存的制作过程，系统最多可以保留最新的50条制作事件。\n\n## 计费说明\n\n[表格]\n\n操作阶段\n\n手动创建的镜像缓存\n\n自动创建的镜像缓存\n\n创建镜像缓存\n\n涉及以下计费项：\n\n- \n\n临时资源（ECI实例和云盘）费用\n- \n\n快照费用\n\n不收费\n\n使用镜像缓存\n\n云盘费用\n\n如果镜像缓存大于30 GiB，需增加临时存储空间并为其付费。\n\n更多信息，请参见[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches#topic-2240706)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2", "page_type": "doc", "title": "镜像缓存概述", "keywords": "了解镜像缓存功能,创建镜像缓存,了解镜像缓存计费,镜像缓存概述,镜像缓存创建方式,镜像缓存计费说明", "last_modified_ms": 1732604529000, "last_modified_iso": "2024-11-26T15:02:09+08:00", "excerpt": "使用镜像缓存（ImageCache）创建ECI实例可以加速拉取镜像，减少ECI实例的启动耗时。本文介绍镜像缓存的基本功能、创建和使用方式、以及计费说明等。\n## 功能简介\n\n在运行容器前，ECI需要先拉取您指定的容器镜像，但因网络和容器镜像大小等因素，镜像拉取耗时往往成了ECI实例启动的主要耗时。为加速实例的创建速度，ECI提供镜像缓存功能。您可以预先将需要使用的镜像制作成缓存快照，然后基于该快照来创建ECI实例，避免或者减少镜像层的下载，从而提升实例的创建速度。\n\n经实测，以使用Docker Hub的flink镜像（约386.26 MB）创建ECI实例为例，正常创建过程中，镜像准备阶段需要耗时50s，使用镜像缓存后，镜像准备阶段无需耗时，可以极大节约实例启动耗时。重要 \n\n具体提升速度由ECI实例中使用的镜像个数、镜像大小和镜像仓库网络因素等决定。\n## 创建方式\n\n镜像缓存的创建分为手动创建和自动创建两种方式。重要 \n\n推荐使用自动创建的镜像缓存，可以节约使用成本。但对于首次创建就需要加速创建ECI实例的场景，需提前手动创建镜像缓存。\n### 手动创建\n\n您可以根据需要，自行设置名称、大小等参数来创建镜像缓存。过程如下：\n\n- \n\n一个镜像缓存对应一份快照，手动创建的镜像缓存快照由您自行管理。\n- \n\n创建过程中，系统将创建一个ECI实例（2 vCPU、4 GiB内存），并挂载一块ESSD PL1类型的云盘用于中转创建镜像缓存对应的快照。创建完成后，该实例和云盘将被自动释放。\n- \n\n极速镜像缓存功能用于缩短镜像缓存的创建时长。开启该功能后，系统将启用快照极速可用能力，临时创建一份本地快照。本地快照创建完成即可使用镜像缓存功能。说明 \n\n本地快照创建完成后，系统将自动开始创建标准快照，在此期间，镜像缓存对应使用本地快照；待标准快照创建完成后，系统将自动删除本地快照，在此之后，镜像缓存对应使用标准快照。\n- \n\n镜像缓存复用功能用于加快镜像缓存的制作速度。开启该功能后，在创建镜像缓存的过程中，系统将自动匹配已有镜像缓存，如果新的镜像缓存与已有镜像缓存存在重复的镜像层，新的镜像缓存将复用已有镜像缓存的镜像层，从而加速镜像缓存的创建。\n\n### 自动创建\n\n创建ECI实例时，如果开启了自动匹配镜像缓存，则在未匹配到镜像缓存的情况下，系统会在创建ECI实例的同时，自动创建一个镜像缓存。过程如下：\n\n- \n\n一个镜像缓存对应一份快照，自动创建的镜像缓存快照由阿里云管理。\n- \n\n创建过程中，系统将创建一个ECI实例，并使用ECI实例自带的存储空间来中转创建镜像缓存对应的快照。创建完成后，该实例将被自动释放。说明 \n\n每个ECI实例默认有30 GiB的临时存储空间可用于创建镜像缓存，如果您的镜像大小超出了30 GiB，需要额外声明临时存储空间。具体操作，请参见[增加临时存储空间大小](https://help.aliyun.com/zh/eci/user-guide/increase-the-capacity-of-the-temporary-storage-space-1)。\n\n### 对比\n\n手动创建和自动创建的镜像缓存在大小、保留时长等方面均有差异，对比如下表所示。\n\n[表格]\n\n对比项\n\n手动创建\n\n自动创建\n\n名称\n\n可以自定义设置名称。\n\n名称由系统自动生成，格式为auto-create-for-实例ID。\n\n大小\n\n默认为20 GiB，可以自定义设置大小。\n\n默认为30 GiB。如果创建ECI实例时声明了临时存储空间，则镜像缓存大小=30 GiB+临时存储空间大小。\n\n保留时长\n\n默认永久保留，可以自行设置保留时长（单位为天），过期后将被自动删除。\n\n默认由阿里云管理保留时长。\n\n- \n\n对于自动创建后从未使用过的镜像缓存，7天后会被自动删除。\n- \n\n对于自动创建后使用过的镜像缓存，当距离上一次使用的时间超过30天时，会被自动删除。\n\n镜像缓存复用\n\n可以开启镜像缓存复用来复用已有镜像层，加快镜像缓存的制作速度。\n\n不支持配置该功能。\n\n极速镜像缓存\n\n可以开启极速镜像缓存来临时创建一份本地快照，缩短镜像缓存的创建时长。\n\n不支持配置该功能。\n\n配额限制\n\n可以调用[ListUsage](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listusage)接口，或者在控制台的权益配额页面查看配额。\n\n如果配额无法满足需求，请提交工单申请提升配额。\n\n可以调用[ListUsage](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-listusage)接口查看配额。\n\n如果配额无法满足需求，请提交工单申请提升配额。\n\n淘汰策略\n\n默认情况下，当数量达到配额限制时，无法继续手动创建镜像缓存。\n\n支持通过OpenAPI（CreateImageCache或UpdateImageCache接口）将某个镜像缓存的淘汰策略（EliminationStrategy参数）配置为LRU，表示当数量达到配额限制时，系统可以自动删除最不常用的LRU镜像缓存。\n\n当数量达到配额限制时，系统会遵循LRU规则，自动删除最不常用的镜像缓存。\n\n使用成本\n\n收取创建费用和使用费用。\n\n仅收取使用费用，不收取创建费用。\n## 使用方式\n\n使用镜像缓存可以加快ECI实例的创建。创建ECI实例时，支持自动匹配和明确指定镜像缓存两种方式：\n\n[表格]\n\n使用方式\n\n说明\n\n自动匹配\n\n自动匹配使用最优的镜像缓存。系统将按照以下顺序进行匹配：\n\n- \n\n过滤筛选出您在当前地域下的所有镜像缓存，且镜像缓存的大小满足ECI实例临时存储空间大小的限制。\n- \n\n根据匹配策略选择最优的镜像缓存，匹配策略的优先级从高到低依次为：镜像匹配度、镜像大小、创建时间。\n\n- \n\n镜像匹配度：优先选择匹配度高的镜像缓存，匹配度指的是ECI实例和镜像缓存在镜像仓库和版本上的匹配情况。\n- \n\n镜像大小：优先选择镜像大小最接近的镜像缓存。\n- \n\n创建时间：优先选择最新创建的镜像缓存。\n\n说明 \n\n如果没有匹配到镜像缓存，系统将在创建ECI实例的同时自动创建镜像缓存。创建时将正常拉取镜像，建议您将容器的镜像拉取策略配置为按需拉取（IfNotPresent），以避免镜像层重复下载，影响镜像缓存的使用效果。\n\n明确指定\n\n明确指定使用的镜像缓存。该镜像缓存必须为创建完成（Ready）状态。\n## 注意事项\n\n- \n\n单个镜像缓存最多包含20个镜像。\n- \n\n创建镜像缓存需要拉取容器镜像，因此创建时长由镜像个数、镜像大小、网络等多种因素决定。\n- \n\n手动创建镜像缓存时采用您指定的容器镜像，自动创建镜像缓存时采用实例中所声明的容器镜像。\n\n- \n\n如果镜像为私有镜像（非阿里云容器镜像服务ACR托管的镜像），则需要提供私有镜像仓库的访问凭证，包括地址、用户名和密码。\n- \n\n如果镜像需要通过公网拉取（如Docker官方镜像），则需要配置EIP或者NAT来访问公网。更多信息，请参见[为ECI实例配置公网连接](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access#topic-1860106)。\n- \n\n如果镜像由于远程仓库超时等原因导致拉取失败，推荐您使用容器镜像服务ACR，将镜像上传至阿里云仓库。\n\n- \n\n对于手动创建的镜像缓存，建议在创建时设置保留时长，以免产生不必要的快照费用。对于自动创建的镜像缓存，由阿里云管理对应的快照，您无需关注保留时长。\n- \n\n创建镜像缓存后，您可以通过其制作事件了解镜像缓存的制作过程，系统最多可以保留最新的50条制作事件。\n\n## 计费说明\n\n[表格]\n\n操作阶段\n\n手动创建的镜像缓存\n\n自动创建的镜像缓存\n\n创建镜像缓存\n\n涉及以下计费项：\n\n- \n\n临时资源（ECI实例和云盘）费用\n- \n\n快照费用\n\n不收费\n\n使用镜像缓存\n\n云盘费用\n\n如果镜像缓存大于30 GiB，需增加临时存储空间并为其付费。\n\n更多信息，请参见[镜像缓存计费](https://help.aliyun.com/zh/eci/product-overview/image-caches#topic-2240706)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/overview-of-volumes", "page_type": "doc", "title": "数据卷概述", "keywords": "了解ECI数据卷类型,了解ECI数据卷配置,选择ECI数据卷,ECI数据卷概述,ECI数据卷类型,ECI持久化存储", "last_modified_ms": 1703559468000, "last_modified_iso": "2023-12-26T10:57:48+08:00", "excerpt": "ECI实例支持挂载数据卷作为持久化存储。本文介绍ECI支持的数据卷及其配置方式。\n\n## 数据卷介绍\n\n容器中的文件在磁盘上是临时存放的，这给容器中运行的应用程序带来一些问题：\n\n- \n\n当容器崩溃时，容器重建不会保留容器运行过程中产生的文件，会导致文件丢失。\n- \n\n当一个ECI实例中同时运行多个容器时，无法在这些容器之间共享文件。\n\n对于上述问题，ECI支持通过数据卷（Volume）的方式来解决。目前ECI支持挂载以下几类数据卷：\n\n[表格]\n\n数据卷类型\n\n说明\n\nOpenAPI\n\n控制台\n\n云盘\n\n云盘是阿里云提供的数据块级别的存储产品，具有低时延、高性能、持久性、高可靠等特点。更多信息，请参见[云盘概述](https://help.aliyun.com/zh/ecs/user-guide/disks-2)。\n\n云盘数据卷适用于以下场景：\n\n- \n\n高I/O、低延时场景\n\n云盘具有低时延、高性能等特点，适合对I/O、延迟要求较高的应用场景，例如：数据库、中间件等。\n- \n\n非共享场景\n\n云盘为非共享存储，仅支持挂载到一个实例上。\n\n支持\n\n不支持\n\nNAS\n\nNAS是阿里云提供的一种可共享访问、弹性扩展、高可靠以及高性能的分布式文件系统。更多信息，请参见[文件存储NAS概述](https://help.aliyun.com/zh/nas/product-overview/what-is-nas)。\n\nNAS数据卷适用于以下场景：\n\n- \n\n共享数据场景\n\nNAS为共享存储，支持多个实例同时访问一份数据。NAS数据卷中的数据不会随实例删除而清空，可用于实例之间共享数据。\n- \n\n大数据分析场景\n\nNAS提供了较高的数据吞吐能力，能满足大批量作业对共享存储访问的需求。\n- \n\nWeb应用场景\n\n为Web应用、内容管理系统提供存储支撑。\n- \n\n保存日志场景\n\n如果您希望将日志持久化存储，推荐使用NAS数据卷。\n\n支持\n\n支持\n\nOSS\n\nOSS是阿里云提供的一个海量、安全、低成本、高可靠的存储空间，适合存储非结构化数据（如图片、音视频等）。更多信息，请参见[对象存储OSS概述](https://help.aliyun.com/zh/oss/user-guide/what-is-oss)。\n\nOSS数据卷适用于以下场景：\n\n- \n\n共享数据场景\n\nOSS为共享存储，支持多个实例同时访问一份数据。OSS数据卷中的数据不会随实例删除而清空，可用于实例之间共享数据。\n- \n\n网页、应用配置文件只读场景\n\nossfs网络性能欠佳，可以支撑一些小文件的读场景。\n- \n\n图片、音视频等媒体文件只读场景\n\nOSS适合存储非结构化数据，您可以通过OSS数据卷读取图片、音视频等。说明 \n\nOSS数据卷通过ossfs挂载，是一种通过FUSE方式模拟实现的用户态文件系统。对于写场景稳定性欠佳，因此在写场景中推荐使用其他类型数据卷（如NAS）。\n\n支持\n\n支持\n\nEmptyDir\n\n临时目录，用于临时存放数据，便于容器之间共享数据。EmptyDir数据卷中的数据会随实例删除而清空。重要 \n\nEmptyDir为临时存储，重启ECI实例时，EmptyDir数据卷中保存的数据也会被清空。\n\n支持\n\n支持\n\nConfigFile\n\n配置文件，用于向ECI实例注入配置数据。\n\n支持\n\n支持\n## 配置说明\n\n使用数据卷时，需要先声明数据卷，然后将数据卷挂载到容器中。\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Volume.N.Name和Volume.N.Type参数，明确数据卷的名称和类型。根据Volume.N.Type的取值，可创建不同类型的数据卷，各类型数据卷需要进一步配置相关参数。\n\n[表格]\n\nVolume.N.Type取值\n\n说明\n\n相关文档\n\nEmptyDirVolume\n\nEmptyDir类型的数据卷，表示临时目录。\n\n[挂载EmptyDir数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-an-emptydir-volume)\n\nConfigFileVolume\n\nConfigFile类型的数据卷，表示配置文件。\n\n[挂载ConfigFile数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-configfile-volume)\n\nNFSVolume\n\nNFS类型的数据卷，表示网络文件系统，例如NAS。\n\n[挂载NAS数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-nas-volume)\n\nFlexVolume\n\n使用FlexVolume插件扩展存储类型，支持挂载云盘、NAS和OSS。\n\n- \n\n[挂载云盘数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-disk-volume)\n- \n\n[挂载NAS数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-a-nas-volume)\n- \n\n[挂载OSS数据卷](https://help.aliyun.com/zh/eci/user-guide/mount-an-oss-bucket-to-an-elastic-container-instance-as-a-volume)\n说明 \n\nVolume.N.Type取值还支持DiskVolume，表示云盘数据卷，目前不推荐使用。建议您使用FlexVolume挂载云盘。\n\n声明数据卷后，可以通过Container.VolumeMount相关参数将数据卷挂载到容器中。\n### 控制台\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-beijing)创建ECI实例时，您可以在容器组配置区域声明数据卷，然后在容器配置区域，将数据卷挂载到容器中。\n\n- \n\n在容器组配置区域的高级配置处，声明数据卷。\n\n目前控制台仅支持配置以下几类数据卷：\n\n- \n\n配置项（ConfigFile）\n- \n\n临时目录（EmptyDir）\n- \n\nNAS持久化存储（NFS）\n- \n\nOSS持久化存储（FlexVolume）\n\n- \n\n在容器配置区域，在某一容器的高级配置处，将数据卷挂载到该容器。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/pod-annotations", "page_type": "doc", "title": "ECI Pod Annotation", "keywords": "查询ECI Pod Annotation,配置ECI Pod Annotation,ECI Pod Annotation参考,ECI Pod Annotation列表", "last_modified_ms": 1745474587000, "last_modified_iso": "2025-04-24T14:03:07+08:00", "excerpt": "在Kubernetes集群中创建ECI类型的Pod（即ECI实例）时，为充分使用ECI提供的功能，在不改变Kubernetes语义的前提下，您可以根据需求为Pod添加Annotation。本文为您介绍创建ECI Pod时支持添加的Annotation，以及ECI Pod调度完成后会追加的Annotation。\n## ECI Pod支持的Annotation\n\n创建ECI Pod时，支持添加的Annotation如下表所示。说明 \n\n- \n\n以下列举的Annotation仅适用于创建到虚拟节点上的Pod，即ECI实例，调度到普通节点上的Pod不受这些Annotation影响。\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n### 实例\n\n[表格]\n\n功能及相关文档\n\n参数\n\n示例值\n\n描述\n\n- \n\n[多规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-by-specifying-multiple-specifications)\n- \n\n[指定vCPU和内存创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod)\n- \n\n[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod/)\n\nk8s.aliyun.com/eci-use-specs\n\n2-4Gi,4-8Gi,ecs.c6.xlarge\n\n指定ECI实例规格，支持指定多规格，包括指定vCPU和内存，或者ECS规格。\n\nk8s.aliyun.com/eci-gpu-driver-version\n\ntesla=525.85.12\n\n指定GPU驱动版本。\n\n创建GPU实例时，如果指定了支持多个驱动和CUDA版本的GPU规格，可配置该Annotation指定驱动和CUDA版本。\n\n[指定或排除ECS规格族创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod)\n\nk8s.aliyun.com/eci-instance-family\n\n\"ecs.c6,ecs.g6\"\n\n指定vCPU和内存创建ECI实例时，支持指定或排除ECS规格族。\n\n[指定或排除ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod-1)\n\nk8s.aliyun.com/eci-instance-generation\n\n\"6,5\"\n\n指定vCPU和内存创建ECI实例时，支持指定或排除ECS规格代数。\n\n[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-2)\n\nk8s.aliyun.com/eci-spot-strategy\n\nSpotAsPriceGo\n\n抢占式实例的出价策略。可根据需要配置为：\n\n- \n\nSpotWithPriceLimit：自定义设置抢占实例价格上限。此时必须设置k8s.aliyun.com/eci-spot-price-limit。\n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格。\n\nk8s.aliyun.com/eci-spot-price-limit\n\n\"0.5\"\n\n抢占式实例的每小时价格上限，最多支持精确到小数点后三位。\n\n仅当k8s.aliyun.com/eci-spot-strategy设置为SpotWithPriceLimit时有效。\n\nk8s.aliyun.com/eci-spot-duration\n\n\"0\"\n\n抢占式实例的保护期。默认为1，可设置为0，表示无保护期。\n\nk8s.aliyun.com/eci-spot-fallback\n\n\"true\"\n\n抢占式实例没有库存时，是否自动转为按量付费。默认为false。\n### 镜像\n\n[表格]\n\n功能及相关文档\n\n参数\n\n示例值\n\n描述\n\n[使用ImageCache加速创建Pod](https://help.aliyun.com/zh/eci/user-guide/use-imagecache-to-accelerate-the-creation-of-pods-2)\n\nk8s.aliyun.com/eci-auto-imc\n\n\"true\"\n\n自动匹配镜像缓存。\n\nk8s.aliyun.com/imc-perfect-match\n\n\"true\"\n\n自动匹配镜像缓存时，Pod内所有容器镜像是否均要完全匹配。\n\nk8s.aliyun.com/imc-match-count-request\n\n\"2\"\n\n自动匹配镜像缓存时，Pod内要完全匹配的容器镜像个数。\n\nk8s.aliyun.com/eci-imc-id\n\nimc-2zebxkiifuyzzlhl****\n\n指定镜像缓存ID。\n\n[免密拉取ACR镜像](https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret)\n\nk8s.aliyun.com/acr-instance-ids\n\ncri-j36zhodptmyq****\n\nACR企业版实例ID。\n\n支持跨地域指定ACR企业版实例，此时需在实例ID前加上所属地域，例如\"cn-beijing:cri-j36zhodptmyq****\"。\n\nk8s.aliyun.com/acr-service-arns\n\nacs:ram::1609982529******:role/role-assume\n\nECI资源归属账号下的RAM角色的ARN。\n\n指定RAM角色创建资源时需配置。\n\nk8s.aliyun.com/acr-user-arns\n\nacs:ram::1298452580******:role/role-acr\n\nACR实例归属账号下的RAM角色的ARN。\n\n跨账号拉取ACR镜像时需配置。\n\n[拉取自建镜像仓库的镜像](https://help.aliyun.com/zh/eci/user-guide/use-self-managed-image-repositories-2)\n\nk8s.aliyun.com/plain-http-registry\n\nharbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\n\n使用HTTP协议的自建镜像仓库中的镜像创建ECI实例时，需配置该Annotation，使得ECI使用HTTP协议拉取镜像，避免因协议不同而导致镜像拉取失败。\n\nk8s.aliyun.com/insecure-registry\n\nharbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\n\n使用自签发证书的自建镜像仓库中的镜像创建ECI实例时，需配置该Annotation来跳过证书认证，避免因证书认证失败而导致镜像拉取失败。\n\n### 网络\n\n[表格]\n\n功能及相关文档\n\n参数\n\n示例值\n\n描述\n\n[配置安全组](https://help.aliyun.com/zh/eci/user-guide/assign-a-security-group)\n\nk8s.aliyun.com/eci-security-group\n\nsg-bp1dktddjsg5nktv****\n\n指定安全组ID。要求如下：\n\n- \n\n支持指定一个或多个安全组，最多可以指定5个安全组。\n- \n\n指定的安全组必须属于同一VPC。\n- \n\n指定的安全组的类型必须相同。\n\n[为ECI实例绑定EIP](https://help.aliyun.com/zh/eci/user-guide/enable-internet-access-2#bee1b6c029sty)\n\nk8s.aliyun.com/eci-eip-instanceid\n\neip-bp1q5n8cq4p7f6dzu****\n\n绑定的EIP实例ID。\n\nk8s.aliyun.com/eci-with-eip\n\n\"true\"\n\n配置为true表示自动创建并绑定EIP。\n\nk8s.aliyun.com/eip-bandwidth\n\n\"5\"\n\n设置EIP带宽。单位为Mbps。默认为5 Mbps。\n\nk8s.aliyun.co"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/pod-annotations-1", "page_type": "doc", "title": "ECI Pod Annotation", "keywords": "查询ECI Pod Annotation,ECI Pod Annotation参考,ECI Pod Annotation参数", "last_modified_ms": 1745474149000, "last_modified_iso": "2025-04-24T13:55:49+08:00", "excerpt": "在Kubernetes集群中创建ECI类型的Pod（即ECI实例）时，为充分使用ECI提供的功能，在不改变Kubernetes语义的前提下，您可以根据需求为Pod添加Annotation。本文为您介绍创建ECI Pod时支持添加的Annotation，以及ECI Pod调度完成后会追加的Annotation。\n## ECI Pod支持的Annotation\n\n创建ECI Pod时，支持添加的Annotation如下：重要 \n\n- \n\n以下列举的Annotation仅适用于创建到虚拟节点上的Pod，即ECI实例，调度到普通节点上的Pod不受这些Annotation影响。\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n### 实例\n\n[表格]\n\n功能及相关文档\n\n参数\n\n示例值\n\n描述\n\n[多可用区创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-in-multiple-zones)\n\nk8s.aliyun.com/eci-vswitch\n\nvsw-bp1xpiowfm5vo8o3c****\n\n指定交换机ID，支持指定多个交换机实现多可用区功能。\n\nk8s.aliyun.com/eci-schedule-strategy\n\nVSwitchOrdered\n\n多可用区调度策略。取值范围：\n\n- \n\nVSwitchOrdered：按顺序\n- \n\nVSwitchRandom：随机\n\n- \n\n[多规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-by-specifying-multiple-specifications-1)\n- \n\n[指定vCPU和内存创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod-1)\n- \n\n[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod-1/)\n\nk8s.aliyun.com/eci-use-specs\n\n2-4Gi,4-8Gi,ecs.c6.xlarge\n\n指定ECI实例规格，支持指定多规格，包括指定vCPU和内存，或者ECS规格。\n\nk8s.aliyun.com/eci-gpu-driver-version\n\ntesla=525.85.12\n\n指定GPU驱动版本。\n\n创建GPU实例时，如果指定了支持多个驱动和CUDA版本的GPU规格，可配置该Annotation指定驱动和CUDA版本。\n\n[指定或排除ECS规格族创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod-1)\n\nk8s.aliyun.com/eci-instance-family\n\n\"ecs.c6,ecs.g6\"\n\n指定vCPU和内存创建ECI实例时，支持指定或排除ECS规格族。\n\n[指定或排除ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod)\n\nk8s.aliyun.com/eci-instance-generation\n\n\"6,5\"\n\n指定vCPU和内存创建ECI实例时，支持指定或排除ECS规格代数。\n\n[指定算力类别创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-a-pod)\n\nk8s.aliyun.com/eci-compute-category\n\neconomy\n\n指定vCPU和内存创建ECI实例时，支持进一步指定算力类别。\n\n- \n\n取值为economy（表示经济型）和general（表示通用型）。\n- \n\n支持设置多个算力类别，系统会按照设置顺序创建。\n\n[创建抢占式实例](https://help.aliyun.com/zh/eci/user-guide/create-a-preemptible-elastic-container-instance-1)\n\nk8s.aliyun.com/eci-spot-strategy\n\nSpotAsPriceGo\n\n抢占式实例的出价策略。取值范围：\n\n- \n\nSpotWithPriceLimit：自定义设置抢占实例价格上限。此时必须设置k8s.aliyun.com/eci-spot-price-limit。\n- \n\nSpotAsPriceGo：系统自动出价，跟随当前市场实际价格。\n\nk8s.aliyun.com/eci-spot-price-limit\n\n\"0.5\"\n\n抢占式实例的每小时价格上限，最多支持精确到小数点后三位。\n\n仅当k8s.aliyun.com/eci-spot-strategy设置为SpotWithPriceLimit时有效。\n\nk8s.aliyun.com/eci-spot-duration\n\n\"0\"\n\n抢占式实例的保护期。默认为1，可设置为0，表示无保护期。\n\nk8s.aliyun.com/eci-spot-fallback\n\n\"true\"\n\n抢占式实例没有库存时，是否自动转为按量付费。默认为false。\n\n[使用弹性保障的私有资源池创建Pod](https://help.aliyun.com/zh/eci/user-guide/use-the-private-pool-of-an-elasticity-assurance-to-create-a-pod)\n\nk8s.aliyun.com/eci-privatepool-matchcriteria\n\n\"Open\"\n\n配置私有池的匹配模式。取值范围：\n\n- \n\nOpen：开放模式。该模式下系统自动为实例匹配开放的私有池。\n- \n\nTarget：指定模式。该模式下必须同时指定私有池ID。当私有池类型为专有时，必须使用该模式。\n\nk8s.aliyun.com/eci-privatepool-id\n\neap-2ze1g68k2melxkkl****\n\n指定私有池ID（即弹性保障ID）。您可以在[ECS管理控制台的资源预定页面](https://ecs.console.aliyun.com/#/resourceAssuranceV2/region/cn-beijing?tabKey=RESOURCE_RESERVATION)的资源预定或者私有资源池页签下获取。\n\n- \n\n当k8s.aliyun.com/eci-privatepool-matchcriteria配置为Target时，必须配置该Annotation。\n- \n\n当k8s.aliyun.com/eci-privatepool-matchcriteria配置为Open时，该Annotation无效。\n\n[设置ECI Pod的故障处理策略](https://help.aliyun.com/zh/eci/user-guide/configure-a-fault-handling-policy-for-a-pod)\n\nk8s.aliyun.com/eci-fail-strategy\n\nfail-back\n\nECI Pod的故障处理策略，取值如下：\n\n- \n\nfail-back：失败自动恢复。即Pod创建失败后自动尝试重新创建。\n- \n\nfail-over：失败转移。效果等同于fail-back。\n- \n\nfail-fast：快速失败。即Pod创建失败后直接报错。\n\n[自定义设置ECI Pod的最大Pending时长](https://help.aliyun.com/zh/eci/user-guide/customize-the-maximum-pending-duration-of-the-eci-pod)\n\nk8s.aliyun.com/eci-max-pending-minute\n\n\"30\"\n\n自定义设置Pod对应ECI实例的最大Pending时长，超时后系统会自动终止实例。\n\n取值范围为10~1440的整数，单位为分钟。默认为4小时。\n\n[自定义设置ECI Pod的hosts](https://help.aliyun.com/zh/eci/user-guide/configure-hosts-for-a-pod)\n\nk8s.aliyun.com/eci-custom-hosts\n\n\"[{\\\"host\\\":\\\"example.com\\\",\\\"ip\\\":\\\"100.100.XX.XX\\\"},{\\\"host\\\":\\\"aliyundoc.co"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret", "page_type": "doc", "title": "免密拉取ACR镜像", "keywords": "配置ACR镜像免密拉取,配置跨账号拉取镜像,ACR镜像免密拉取配置,ACR免密拉取场景,跨账号免密拉取配置", "last_modified_ms": 1740971384000, "last_modified_iso": "2025-03-03T11:09:44+08:00", "excerpt": "对于阿里云容器镜像服务ACR的镜像，ECI支持免密拉取，以提升效率和安全性。本文介绍如何免密拉取ACR镜像。\n## 背景信息\n\n阿里云容器镜像服务ACR分为个人版和企业版。其中，企业版是企业级云原生应用制品管理平台，提供容器镜像、Helm Chart以及符合OCI规范制品的生命周期管理，适用于业务大规模部署场景，帮助企业降低交付复杂度。更多信息，请参见[容器镜像服务ACR简介](https://help.aliyun.com/zh/acr/product-overview/what-is-container-registry#concept-2058233)。\n\n创建ECI实例或镜像缓存时，如果要拉取的镜像属于ACR镜像，可以配置免密来简化流程，提升效率，同时避免密码泄露的风险，加强安全性。说明 \n\n非ACR镜像（例如Docker镜像）不支持免密。\n## 前提条件\n\n配置ECI实例等资源免密拉取ACR镜像前，请确保您已经完成以下操作：\n\n- \n\n已创建ACR实例，并完成镜像仓库、镜像等相关配置。\n\n- \n\n关于如何配置ACR个人版实例，请参见[使用个人版实例推送拉取镜像](https://help.aliyun.com/zh/acr/user-guide/use-a-container-registry-personal-edition-instance-to-push-and-pull-images)。\n- \n\n关于如何配置ACR企业版实例，请参见[使用企业版实例推送和拉取镜像](https://help.aliyun.com/zh/acr/getting-started/use-a-container-registry-enterprise-edition-instance-to-push-and-pull-images)。\n\n- \n\n如果使用ACR企业版实例，需要配置免密访问。\n\n新创建的ACR企业版实例默认处于非连接状态，需要配置相应的ACL策略后，才可以通过公网或者专有网络访问该实例。\n\n- \n\n公网访问：开启公网访问入口后，可以直接通过公网域名地址来访问ACR企业版实例的镜像（可跨域）。具体操作，请参见[配置公网的访问控制](https://help.aliyun.com/zh/acr/user-guide/configure-access-over-the-internet#task484)。\n- \n\n专有网络访问：使用专有网络VPC访问ACR企业版实例，需要开启相关授权。具体操作，请参见[配置专有网络的访问控制](https://help.aliyun.com/zh/acr/user-guide/configure-access-over-vpcs#task1305)。\n\n## 配置说明\n\n对于ACR镜像，根据ACR实例是否与待创建的ECI实例等资源属于同一阿里云账号，以及ACR实例的类型，免密拉取镜像的支持情况如下：\n\n[表格]\n\n账号情况\n\nACR类型\n\n免密支持情况\n\n同账号\n\n- \n\n个人版\n- \n\n企业版（默认域名）\n\n默认自动免密，支持配置RAM角色来限制免密范围。\n\n同账号\n\n企业版（自定义域名）\n\n无法自动免密，需要指定ACR实例来实现免密。\n\n跨账号\n\n- \n\n个人版\n- \n\n企业版\n\n无法自动免密，需要配置RAM角色来实现免密。\n\n请根据您的账号和ACR实例情况选择对应的配置：\n### 指定RAM角色以限制免密范围\n\n在ACR实例与待创建的ECI实例等资源属于同一阿里云账号的前提下，如果ACR实例是个人版ACR，或者是使用默认域名的企业版ACR，则默认自动免密。此时，您可以按需配置RAM角色来限制免密范围，例如只允许某一ACR实例自动免密。说明 \n\n默认情况下，ECI使用服务关联角色AliyunServiceRoleForECI来获取其他云服务的访问权限，以便创建ECI资源，该角色包含了拉取ACR镜像的权限，适用于同账号下的所有个人版ACR和使用默认域名的企业版ACR，无法进行细粒度控制。\n\n配置步骤包含以下两步：\n#### 步骤一：创建RAM角色并授权\n\n- \n\n创建一个可信实体为阿里云服务的RAM角色。具体操作，请参见[创建可信实体为阿里云服务的RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service)。\n\n需要注意的配置项如下：\n\n- \n\n信任主体类型：云服务\n- \n\n信任主体名称：弹性容器实例ECI\n- \n\n角色名称：示例为acr-test\n\n- \n\n创建自定义权限策略。具体操作，请参见[创建自定义权限策略](https://help.aliyun.com/zh/ram/create-a-custom-policy)。\n\n权限策略的内容示例如下，表示只允许拉取指定ACR实例的镜像。关于如何编写权限策略，请参见[权限策略基本元素](https://help.aliyun.com/zh/ram/policy-elements)。\n\n{\n    \"Version\": \"1\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cr:Get*\",\n                \"cr:List*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cr:Pull*\"\n            ],\n            \"Resource\": [\n                \"acs:cr:cn-hangzhou:1609982529******:instance/cri-nwj395hgf6f3****\"\n            ]\n        }\n    ]\n}\n\n\n- \n\n为RAM角色绑定自定义权限策略。具体操作，请参见[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role)。\n- \n\n找到新创建的acr-test角色，单击角色名称进入详情页面，确认权限并获取ARN。\n\n#### 步骤二：指定RAM角色\n\n创建ECI Pod和ImageCache时，您可以添加Annotation（k8s.aliyun.com/acr-service-arns）来指定创建资源时使用的RAM角色。\n\n以创建ECI Pod为例，YAML如下：重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:                  \n        k8s.aliyun.com/acr-service-arns: \"acs:ram::1609982529******:role/acr-test\" #指定使用的RAM角色\n    spec:\n      containers:\n      - name: nginx\n        image: test****-registry.cn-hangzhou.cr.aliyuncs.com/eci_test/nginx:1.0   #镜像需属于RAM角色允许的ACR实例\n        ports:\n        - containerPort: 80\n\n\n### 指定ACR实例来配置ACR企业版免密\n\n在ACR实例与待创建的ECI实例属于同一阿里云账号的前提下，如果ACR企业版实例使用自定义域名，则需要指定ACR企业版实例来配置免密。配置方式为添加k8s.aliyun.com/acr-instance-ids的Annotation来指定ACR实例ID。说明 \n\nACR企业版实例支持跨地域使用，即指定的ACR企业版实例与Pod的所属地域可以不同。指定时，需在ACR实例ID前加上所属地域，例如cn-beijing:cri-j36zhodptmyq****。\n#### 创建ECI Pod\n\n创建ECI Pod时，您可以在Pod metadata中添加Annotation（k8s.aliyun.com"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret-1", "page_type": "doc", "title": "免密拉取ACR镜像", "keywords": "配置ACR镜像免密,实现跨账号拉取镜像,ACR镜像免密配置,ECI拉取ACR镜像", "last_modified_ms": 1740971401000, "last_modified_iso": "2025-03-03T11:10:01+08:00", "excerpt": "对于阿里云容器镜像服务ACR的镜像，ECI支持免密拉取，以提升效率和安全性。本文介绍如何免密拉取ACR镜像。\n## 背景信息\n\n阿里云容器镜像服务ACR分为个人版和企业版。其中，企业版是企业级云原生应用制品管理平台，提供容器镜像、Helm Chart以及符合OCI规范制品的生命周期管理，适用于业务大规模部署场景，帮助企业降低交付复杂度。更多信息，请参见[容器镜像服务ACR简介](https://help.aliyun.com/zh/acr/product-overview/what-is-container-registry#concept-2058233)。\n\n创建ECI实例或镜像缓存时，如果要拉取的镜像属于ACR镜像，可以配置免密来简化流程，提升效率，同时避免密码泄露的风险，加强安全性。说明 \n\n非ACR镜像（例如Docker镜像）不支持免密。\n## 前提条件\n\n配置ECI实例等资源免密拉取ACR镜像前，请确保您已经完成以下操作：\n\n- \n\n已创建ACR实例，并完成镜像仓库、镜像等相关配置。\n\n- \n\n关于如何配置ACR个人版实例，请参见[使用个人版实例推送拉取镜像](https://help.aliyun.com/zh/acr/user-guide/use-a-container-registry-personal-edition-instance-to-push-and-pull-images)。\n- \n\n关于如何配置ACR企业版实例，请参见[使用企业版实例推送和拉取镜像](https://help.aliyun.com/zh/acr/getting-started/use-a-container-registry-enterprise-edition-instance-to-push-and-pull-images)。\n\n- \n\n如果使用ACR企业版实例，需要配置免密访问。\n\n新创建的ACR企业版实例默认处于非连接状态，需要配置相应的ACL策略后，才可以通过公网或者专有网络访问该实例。\n\n- \n\n公网访问：开启公网访问入口后，可以直接通过公网域名地址来访问ACR企业版实例的镜像（可跨域）。具体操作，请参见[配置公网的访问控制](https://help.aliyun.com/zh/acr/user-guide/configure-access-over-the-internet#task484)。\n- \n\n专有网络访问：使用专有网络VPC访问ACR企业版实例，需要开启相关授权。具体操作，请参见[配置专有网络的访问控制](https://help.aliyun.com/zh/acr/user-guide/configure-access-over-vpcs#task1305)。\n\n## 配置说明\n\n对于ACR镜像，根据ACR实例是否与待创建的ECI实例等资源属于同一阿里云账号，以及ACR实例的类型，免密拉取镜像的支持情况如下：\n\n[表格]\n\n账号情况\n\nACR类型\n\n免密支持情况\n\n同账号\n\n- \n\n个人版\n- \n\n企业版（默认域名）\n\n默认自动免密，支持配置RAM角色来限制免密范围。\n\n同账号\n\n企业版（自定义域名）\n\n无法自动免密，需要指定ACR实例来实现免密。\n\n跨账号\n\n- \n\n个人版\n- \n\n企业版\n\n无法自动免密，需要配置RAM角色来实现免密。\n\n请根据您的账号和ACR实例情况选择对应的配置：\n### 指定RAM角色以限制免密范围\n\n在ACR实例与待创建的ECI实例等资源属于同一阿里云账号的前提下，如果ACR实例是个人版ACR，或者是使用默认域名的企业版ACR，则默认自动免密。此时，您可以按需配置RAM角色来限制免密范围，例如只允许某一ACR实例自动免密。说明 \n\n默认情况下，ECI使用服务关联角色AliyunServiceRoleForECI来获取其他云服务的访问权限，以便创建ECI资源，该角色包含了拉取ACR镜像的权限，适用于同账号下的所有个人版ACR和使用默认域名的企业版ACR，无法进行细粒度控制。\n\n配置步骤包含以下两步：\n#### 步骤一：创建RAM角色并授权\n\n- \n\n创建一个可信实体为阿里云服务的RAM角色。具体操作，请参见[创建可信实体为阿里云服务的RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service)。\n\n需要注意的配置项如下：\n\n- \n\n信任主体类型：云服务\n- \n\n信任主体名称：弹性容器实例ECI\n- \n\n角色名称：示例为acr-test\n\n- \n\n创建自定义权限策略。具体操作，请参见[创建自定义权限策略](https://help.aliyun.com/zh/ram/create-a-custom-policy)。\n\n权限策略的内容示例如下，表示只允许拉取指定ACR实例的镜像。关于如何编写权限策略，请参见[权限策略基本元素](https://help.aliyun.com/zh/ram/policy-elements)。\n\n{\n    \"Version\": \"1\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cr:Get*\",\n                \"cr:List*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cr:Pull*\"\n            ],\n            \"Resource\": [\n                \"acs:cr:cn-hangzhou:1609982529******:instance/cri-nwj395hgf6f3****\"\n            ]\n        }\n    ]\n}\n\n\n- \n\n为RAM角色绑定自定义权限策略。具体操作，请参见[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role)。\n- \n\n找到新创建的acr-test角色，单击角色名称进入详情页面，确认权限并获取ARN。\n\n#### 步骤二：指定RAM角色\n\n创建ECI Pod和ImageCache时，您可以添加Annotation（k8s.aliyun.com/acr-service-arns）来指定创建资源时使用的RAM角色。\n\n以创建ECI Pod为例，YAML如下：重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:                  \n        k8s.aliyun.com/acr-service-arns: \"acs:ram::1609982529******:role/acr-test\" #指定使用的RAM角色\n    spec:\n      containers:\n      - name: nginx\n        image: test****-registry.cn-hangzhou.cr.aliyuncs.com/eci_test/nginx:1.0   #镜像需属于RAM角色允许的ACR实例\n        ports:\n        - containerPort: 80\n\n\n### 指定ACR实例来配置ACR企业版免密\n\n在ACR实例与待创建的ECI实例属于同一阿里云账号的前提下，如果ACR企业版实例使用自定义域名，则需要指定ACR企业版实例来配置免密。配置方式为添加k8s.aliyun.com/acr-instance-ids的Annotation来指定ACR实例ID。说明 \n\nACR企业版实例支持跨地域使用，即指定的ACR企业版实例与Pod的所属地域可以不同。指定时，需在ACR实例ID前加上所属地域，例如cn-beijing:cri-j36zhodptmyq****。\n#### 创建ECI Pod\n\n创建ECI Pod时，您可以在Pod metadata中添加Annotation（k8s.aliyun.com"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/pull-images-from-a-container-registry-enterprise-edition-instance-without-using-a-secret-2", "page_type": "doc", "title": "免密拉取ACR镜像", "keywords": "配置ACR镜像免密,跨账号拉取ACR镜像,ACR镜像拉取权限,ECI拉取ACR镜像", "last_modified_ms": 1740971368000, "last_modified_iso": "2025-03-03T11:09:28+08:00", "excerpt": "对于阿里云容器镜像服务ACR的镜像，ECI支持免密拉取，以提升效率和安全性。本文介绍如何免密拉取ACR镜像。\n## 背景信息\n\n阿里云容器镜像服务ACR分为个人版和企业版。其中，企业版是企业级云原生应用制品管理平台，提供容器镜像、Helm Chart以及符合OCI规范制品的生命周期管理，适用于业务大规模部署场景，帮助企业降低交付复杂度。更多信息，请参见[容器镜像服务ACR简介](https://help.aliyun.com/zh/acr/product-overview/what-is-container-registry#concept-2058233)。\n\n创建ECI实例或镜像缓存时，如果要拉取的镜像属于ACR镜像，可以配置免密来简化流程，提升效率，同时避免密码泄露的风险，加强安全性。说明 \n\n非ACR镜像（例如Docker镜像）不支持免密。\n## 前提条件\n\n配置ECI实例等资源免密拉取ACR镜像前，请确保您已经完成以下操作：\n\n- \n\n已创建ACR实例，并完成镜像仓库、镜像等相关配置。\n\n- \n\n关于如何配置ACR个人版实例，请参见[使用个人版实例推送拉取镜像](https://help.aliyun.com/zh/acr/user-guide/use-a-container-registry-personal-edition-instance-to-push-and-pull-images)。\n- \n\n关于如何配置ACR企业版实例，请参见[使用企业版实例推送和拉取镜像](https://help.aliyun.com/zh/acr/getting-started/use-a-container-registry-enterprise-edition-instance-to-push-and-pull-images)。\n\n- \n\n如果使用ACR企业版实例，需要配置免密访问。\n\n新创建的ACR企业版实例默认处于非连接状态，需要配置相应的ACL策略后，才可以通过公网或者专有网络访问该实例。\n\n- \n\n公网访问：开启公网访问入口后，可以直接通过公网域名地址来访问ACR企业版实例的镜像（可跨域）。具体操作，请参见[配置公网的访问控制](https://help.aliyun.com/zh/acr/user-guide/configure-access-over-the-internet#task484)。\n- \n\n专有网络访问：使用专有网络VPC访问ACR企业版实例，需要开启相关授权。具体操作，请参见[配置专有网络的访问控制](https://help.aliyun.com/zh/acr/user-guide/configure-access-over-vpcs#task1305)。\n\n## 配置说明\n\n对于ACR镜像，根据ACR实例是否与待创建的ECI实例等资源属于同一阿里云账号，以及ACR实例的类型，免密拉取镜像的支持情况如下：\n\n[表格]\n\n账号情况\n\nACR类型\n\n免密支持情况\n\n同账号\n\n- \n\n个人版\n- \n\n企业版（默认域名）\n\n默认自动免密，支持配置RAM角色来限制免密范围。\n\n同账号\n\n企业版（自定义域名）\n\n无法自动免密，需要指定ACR实例来实现免密。\n\n跨账号\n\n- \n\n个人版\n- \n\n企业版\n\n无法自动免密，需要配置RAM角色来实现免密。\n\n请根据您的账号和ACR实例情况选择对应的配置：\n### 配置RAM角色限制免密范围\n\n在ACR实例与待创建的ECI实例等资源属于同一阿里云账号的前提下，如果ACR实例是个人版ACR，或者是使用默认域名的企业版ACR，则默认自动免密。此时，您可以按需配置RAM角色来限制免密范围，例如只允许某一ACR实例自动免密。说明 \n\n默认情况下，ECI使用服务关联角色AliyunServiceRoleForECI来获取其他云服务的访问权限，以便创建ECI资源，该角色包含了拉取ACR镜像的权限，适用于同账号下的所有个人版ACR和使用默认域名的企业版ACR，无法进行细粒度控制。\n\n配置步骤包含以下两步：\n#### 步骤一：创建RAM角色并授权\n\n- \n\n创建一个可信实体为阿里云服务的RAM角色。具体操作，请参见[创建可信实体为阿里云服务的RAM角色](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-role-for-a-trusted-alibaba-cloud-service)。\n\n需要注意的配置项如下：\n\n- \n\n信任主体类型：云服务\n- \n\n信任主体名称：弹性容器实例ECI\n- \n\n角色名称：示例为acr-test\n\n- \n\n创建自定义权限策略。具体操作，请参见[创建自定义权限策略](https://help.aliyun.com/zh/ram/create-a-custom-policy)。\n\n权限策略的内容示例如下，表示只允许拉取指定ACR实例的镜像。关于如何编写权限策略，请参见[权限策略基本元素](https://help.aliyun.com/zh/ram/policy-elements)。\n\n{\n    \"Version\": \"1\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cr:Get*\",\n                \"cr:List*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cr:Pull*\"\n            ],\n            \"Resource\": [\n                \"acs:cr:cn-hangzhou:1609982529******:instance/cri-nwj395hgf6f3****\"\n            ]\n        }\n    ]\n}\n\n\n- \n\n为RAM角色绑定自定义权限策略。具体操作，请参见[为RAM角色授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-a-ram-role)。\n- \n\n找到新创建的acr-test角色，单击角色名称进入详情页面，确认权限并获取ARN。\n\n#### 步骤二：指定RAM角色\n\n调用CreateContainerGroup接口创建ECI实例，以及调用CreateImageCache接口创建镜像缓存时，您可以设置AcrRegistryInfo.N.ArnService参数来指定创建资源时使用的RAM角色。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)和[CreateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createimagecache)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nAcrRegistryInfo.N.ArnService\n\nstring\n\nacs:ram::1609982529******:role/acr-test\n\nECI实例等资源归属账号下的RAM角色的ARN。\n\n以创建ECI实例为例，您可以通过OpenAPI传入以下参数：\n\nContainerGroupName=test-acr\n\n#Container\nContainer.1.Name=test\nContainer.1.Image=test****-registry.cn-hangzhou.cr.aliyuncs.com/eci_test/nginx:1.0\n\n#AcrRegistryInfo\nAcrRegistryInfo.1.ArnService=acs:ram::1609982529******:role/acr-test\n\n\n### 指定ACR实例实现ACR企业版免密\n\n在ACR实例与待创建的ECI实例等资源属于同一阿里云账号的前提下，如果ACR企业版实例使用自定义域名，则需要指定ACR企业版实例来实现免密。\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例，以及调用CreateImageCache接口创建镜像缓存时，您可以设置AcrRegistryInfo相关参数来指定ACR实例。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)和[CreateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createimagecache)。\n\n[表格]\n\n名称\n\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/schedule-pods-to-a-vnode", "page_type": "doc", "title": "将Pod调度到VNode", "keywords": "调度Pod到VNode,Pod调度到VNode方法,Pod调度到VNode配置", "last_modified_ms": 1666755509000, "last_modified_iso": "2022-10-26T11:38:29+08:00", "excerpt": "对于自建的Kubernetes集群，即混合使用普通节点和虚拟节点（VNode）的模式下，您可以通过配置nodeSelector和tolerations，或者指定nodeName的方式，将Pod调度到VNode上，以ECI来运行。本文介绍如何将Pod调度到VNode。\n## 调度方式概述\n\nVNode对标原生kubernetes节点，在混合使用普通节点和VNode的模式下，一般可以通过以下几种方式将Pod调度到VNode：说明 \n\n下述方式均需要对存量资源做一定的修改，无法做到零侵入，建议您部署eci-profile组件，可以自定义配置Selector，将满足条件的Pod自动调度到VNode。具体操作，请参见[使用eci-profile调度Pod到VNode](https://help.aliyun.com/zh/eci/user-guide/use-eci-profile-to-schedule-pods-to-a-vnode)。\n\n- \n\n配置nodeSelector和tolerations\n\nVNode默认配置了Label和Taint，因此可以通过配置nodeSelector和tolerations，将Pod调度到VNode，以ECI来运行。\n- \n\n指定nodeName\n\n支持指定nodeName，将Pod调度到某个特定的VNode，以ECI来运行。\n\n## 方式一：配置nodeSelector和tolerations\n\nVNode默认配置了Label和Taint：\n\n...\n  labels:\n    k8s.aliyun.com/vnode: \"true\"\n...\n  taints:\n  - effect: NoSchedule\n    key: k8s.aliyun.com/vnode\n    value: \"true\"\n\n\n因此可以通过配置nodeSelector和tolerations，将Pod调度到VNode，以ECI来运行。配置示例如下：\n\n- \n\n将以下内容保存为deploy-vnode-test1.yaml。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vnode-nginx-test1\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: uid\n  template:\n    metadata:\n      labels:\n        app: uid\n    spec:\n      nodeSelector:     #配置特定的nodeSelector\n        k8s.aliyun.com/vnode: \"true\"\n      tolerations:      #配置特定的tolerations\n      - key: k8s.aliyun.com/vnode\n        operator: \"Equal\"\n        value: \"true\"\n        effect: \"NoSchedule\"\n      containers:\n      - name: nginx\n        image: registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\n\n\n- \n\n部署Deployment。\n\nkubectl apply -f deploy-vnode-test1.yaml\n\n\n## 方式二：指定nodeName\n\n支持指定nodeName，将Pod调度到某个特定的VNode。配置示例如下：\n\n- \n\n查询VNode信息。\n\nkubectl get nodes\n\n\n从返回信息中获取VNode名称。默认情况下，VNode的名称格式为[region].[VNode ID]。返回示例如下：\n\nNAME                                    STATUS   ROLES                  AGE    VERSION\ncn-hangzhou.vnd-2ze2qhf8lmp5kgsx****    Ready    agent                  132m   v1.20.6\nk8s-master                              Ready    control-plane,master   169m   v1.20.6\n\n\n- \n\n将以下内容保存为deploy-vnode-test2.yaml。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vnode-nginx-test2\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: uid\n  template:\n    metadata:\n      labels:\n        app: uid\n    spec:\n      containers:\n      - name: nginx\n        image: registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\n      nodeName: cn-hangzhou.vnd-2ze2qhf8lmp5kgsx****   #指定VNode名称\n\n\n- \n\n部署Deployment。\n\nkubectl apply -f deploy-vnode-test2.yaml\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/schedule-pods-to-virtual-kubelet", "page_type": "doc", "title": "调度Pod到x86架构的虚拟节点", "keywords": "调度Pod到x86虚拟节点,配置Pod调度Label,Pod调度方式概述,ACK Pod调度到ECI", "last_modified_ms": 1747980016000, "last_modified_iso": "2025-05-23T14:00:16+08:00", "excerpt": "对于ACK Serverless集群，所有Pod均运行在虚拟节点（默认x86架构）上，无需进行调度；对于ACK集群，即混合使用标准节点（ECS）和虚拟节点（ECI，基于VK）的模式下，默认会将Pod调度到ECS节点，您可以根据需要将Pod调度到虚拟节点。本文介绍如何将ACK集群中的Pod调度到x86架构的虚拟节点上，以ECI来运行。\n## 调度方式概述\n\n您可以通过以下几种方式将Pod调度到x86架构的虚拟节点：说明 \n\n- \n\n下述方式均需要对存量资源做一定的修改，无法做到零侵入，建议您[配置eci-profile](https://help.aliyun.com/zh/eci/user-guide/configure-an-eci-profile#topic-2061718)实现将Label匹配的Pod自动调度到ECI。\n- \n\n如果采用添加Lable或者指定nodeName的调度方式，则ECI Pod挂载云盘动态存储卷时，不支持使用WaitForFirstConsumer类型的Storageclass。更多信息，请参见[使用云盘动态存储卷](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/use-dynamically-provisioned-disk-volumes)。\n\n- \n\n配置Pod Label\n\n如果您有个别Pod需要调度到ECI上运行，可以直接为Pod添加特定的Label，则该Pod将运行在x86架构的虚拟节点上。\n- \n\n配置Namespace Label\n\n如果您有一类Pod需要调度到ECI上运行，可以创建一个Namespace并添加特定的Label，则该Namespace下的所有Pod将运行在x86架构的虚拟节点上。\n- \n\n配置nodeSelector和tolerations、指定nodeName等其它方式\n\nx86架构的虚拟节点默认配置了Label和Taint，因此可以为Pod配置对应的nodeSelector和tolerations将Pod调度到x86架构的虚拟节点上，或者也可以采用指定nodeName的方式进行调度。\n\n## 方式一：配置Pod Label\n\n您可以为Pod添加alibabacloud.com/eci=true的Label，将Pod调度到ECI上运行。说明 \n\n仍支持添加eci=true的Label，但不推荐。\n\n配置示例如下：\n\n- \n\n创建Pod的YAML配置文件。\n\nvim test-pod.yaml\n\n\ntest-pod.yaml的内容示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx1\n  labels: \n    alibabacloud.com/eci: \"true\"   # 添加特定Label\nspec:\n  containers:\n  - image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: Always\n    name: nginx\n\n\n- \n\n创建Pod。\n\nkubectl create -f test-pod.yaml \n\n\n## 方式二：配置Namespace Label\n\n您可以创建一个Namespace并添加alibabacloud.com/eci=true的Label，则该Namespace下的所有Pod将调度到ECI上运行。说明 \n\n仍支持添加virtual-node-affinity-injection=enabled的Label，但不推荐。\n\n配置示例如下：\n\n- \n\n创建Namespace。\n\nkubectl create ns vk\n\n\n- \n\n为Namespace添加Label。\n\nkubectl label namespace vk alibabacloud.com/eci=true\n\n\n- \n\n创建Pod的YAML配置文件。\n\nvim test-pod.yaml\n\n\ntest-pod.yaml的内容示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  namespace: vk  # 指定添加了特定Label的Namespace\nspec:\n  containers:\n  - image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: Always\n    name: nginx\n\n\n- \n\n创建Pod。\n\nkubectl create -f test-pod.yaml \n\n\n## （不推荐）其它方式\n\n您可以通过配置nodeSelector和tolerations、指定nodeName等方式将Pod调度到ECI上运行。\n\n配置示例如下：\n\n- \n\n创建Pod的YAML配置文件。\n\nvim test-pod.yaml\n\n\ntest-pod.yaml的内容示例如下：\n\n- \n\n配置nodeSelector和tolerations\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n  - image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: Always\n    name: nginx\n  nodeSelector:    # 配置nodeSelector\n    type: virtual-kubelet\n  tolerations:     # 配置tolerations\n  - key: virtual-kubelet.io/provider\n    operator: Exists\n\n\n- \n\n指定nodeName\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n  - image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n    imagePullPolicy: Always\n    name: nginx\n  nodeName: virtual-kubelet-cn-beijing-g # 指定nodeName\n\n\n- \n\n创建Pod。\n\nkubectl create -f test-pod.yaml\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/scheduling-pods-to-virtual-nodes-in-the-arm-architecture", "page_type": "doc", "title": "调度Pod到Arm架构的虚拟节点", "keywords": "调度Pod到Arm虚拟节点,添加Arm架构虚拟节点,ECI Arm节点调度,Pod调度YAML示例", "last_modified_ms": 1721642176000, "last_modified_iso": "2024-07-22T17:56:16+08:00", "excerpt": "将Pod调度到虚拟节点以ECI运行时，ACK集群和ACK Serverless集群均默认将Pod调度到x86架构的虚拟节点上。如果您的应用采用Arm架构，需要您额外添加nodeSelector来指定Arm架构的虚拟节点。本文介绍如何将Pod调度到Arm架构的虚拟节点。\n## 前提条件\n\n请确认集群满足以下要求：\n\n- \n\n集群所属地域支持Arm实例。\n\n目前ECI支持的Arm架构规格族为g8y、c8y和r8y，支持的地域请参见[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)。\n- \n\n集群版本为1.20及以上。\n- \n\n集群中的[ACK Virtual Node](https://help.aliyun.com/zh/ack/product-overview/ack-virtual-node)组件版本支持Arm节点。\n- \n\n集群中的[kube-scheduler](https://help.aliyun.com/zh/ack/product-overview/kube-scheduler)组件版本支持Arm节点。\n\n## 注意事项\n\n将Pod调度到Arm架构的虚拟节点上时，对应的ECI实例按照实际生成的Arm规格进行计费，不按vCPU和内存计费。说明 \n\nECI Pod创建成功后，您可以通过kubectl describe pod <pod name>命令查看Pod详情，通过k8s.aliyun.com/eci-instance-spec字段确认Pod实际使用的ECS规格。\n## 添加Arm架构的虚拟节点\n\n您可以通过以下步骤修改eci-profile，在集群中添加Arm架构的虚拟节点。\n\n- \n\n修改eci-profile。\n\nkubectl edit configmap eci-profile -n kube-system\n\n\n在eci-profile的data中将enableLinuxArm64Node配置为true，同时确保配置的可用区中至少有一个可用区开放了Arm规格。示例如下：\n\ndata:\n  enableClusterIp: \"true\"\n  enableHybridMode: \"false\"\n  enableLinuxArm64Node: \"true\"    #开启Arm节点\n  enableLogController: \"false\"\n  enablePVCController: \"false\"\n  enablePrivateZone: \"false\"\n  enableReuseSSLKey: \"false\"\n  featureGates: MetricsVpcNet=true,ProtectionFinalizers=false,WaitForFirstConsumer=false\n  resourceGroupId: \"\"\n  securityGroupId: sg-2zeg1fci0oq1hljo6h0a\n  selectors: \"\"\n  slsMachineGroup: \"\"\n  vSwitchIds: vsw-2zewa5mb19wr45g63****,vsw-2zevanrscmoiaxryx****,vsw-2ze94pjtfuj9vaymf****   #配置的可用区中包含已开放Arm规格的可用区\n  vpcId: vpc-2zeghwzptn5zii0w7****\n\n\n- \n\n查看生成的节点。\n\n配置enableLinuxArm64Node为true后，通过kubectl get node命令查看节点信息时，您可以看到集群已自动生成Arm节点。\n\n## 将Pod调度到Arm架构的虚拟节点\n### 通过nodeSelector调度\n\n在ACK集群和ACK Serverless集群中，Arm架构的节点均带有kubernetes.io/arch: arm64 的标签，创建ECI Pod时，可以通过nodeSelector来指定Arm架构的节点，将Pod调度到Arm架构的虚拟节点上运行。\n\nnodeSelector:\n  kubernetes.io/arch: arm64 \n\n\nYAML示例如下：\n\n- \n\n不指定规格\n\n没有指定任何规格时，系统默认采用2 vCPU和4 GiB内存的Arm规格，即ecs.c8y.large。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\"    # 调度到虚拟节点。\n    spec:\n      containers:\n      - name: nginx\n        image: arm64v8/centos:7.9.2009   # 使用基于Arm架构的镜像。\n        command: [\"sleep\"]\n        args: [\"999999\"]\n      nodeSelector:\n        kubernetes.io/arch: arm64  # 指定Arm架构的节点。\n\n\n- \n\n指定vCPU和内存规格\n\n指定vCPU和内存规格时，系统会从ECI支持的ECS Arm规格中自动选择一个符合vCPU和内存条件的Arm规格。说明 \n\n指定vCPU和内存规格时，可以直接定义Containers的limits或requests来指定（建议使用limits），也可以添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\"    # 调度到虚拟节点。\n    spec:\n      containers:\n      - name: nginx\n        image: arm64v8/centos:7.9.2009   # 使用基于Arm架构的镜像。\n        command: [\"sleep\"]\n        args: [\"999999\"]\n        resources:\n          limits:\n            cpu: \"1000m\"      # 指vCPU为1 vCPU。\n            memory: \"4096Mi\"   # 指定nginx容器的内存为4 GiB。\n      nodeSelector:\n        kubernetes.io/arch: arm64  # 指定Arm架构的节点。\n\n\n- \n\n指定ECS Arm规格\n\n如果您对规格有特殊需求，可以通过k8s.aliyun.com/eci-use-specs的Annotation来指定具体的Arm规格。关于ECI支持的Arm规格，请参见[指定Arm规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-arm-specification)。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"ecs.c8y.large,ecs.g8y.large\"   # 指定支持的ECS Arm规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: arm64v8/centos:7.9.2009   # 使用基于Arm架构的镜像。\n        command: [\"sleep\"]\n        args: [\"999999\"]\n      nodeSelector:\n        ku"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/set-container-start-and-exit-order", "page_type": "doc", "title": "设置容器启动和退出顺序", "keywords": "控制ECI容器启停顺序,ECI容器启停顺序配置,ECI容器启停顺序原理", "last_modified_ms": 1692669436000, "last_modified_iso": "2023-08-22T09:57:16+08:00", "excerpt": "本文介绍如何通过环境变量的方式，为一个ECI实例（即ECI Pod）内的各个容器设置启动和退出优先级，实现容器按顺序启动和退出。\n## 功能说明\n\n默认情况下，ECI实例内的各个容器是并发进行启动和退出的，没有固定的前后顺序。在某些场景下，一个实例内的多个容器之间可能存在依赖关系，某一容器需要在另一容器启动后再启动，或者某一容器需要在另一容器退出后再退出。例如：\n\n- \n\nistio服务治理场景，需要保证在业务容器产生流量时，istio-proxy容器已经Ready；在业务容器退出后，istio-proxy容器才退出。\n- \n\n采集日志时，需要保证在业务容器产生日志前，日志容器已经Ready；在业务容器退出后，日志容器才退出。\n\n针对上述场景，ECI支持通过设置容器环境变量的方式，为ECI实例内的容器设置启动和退出优先级。您可以按照您的业务需求为容器添加相应的环境变量，来保证容器按顺序启动或按顺序退出。\n## 配置说明\n\n设置容器启动和退出顺序的环境变量如下：\n\n[表格]\n\n配置项\n\n环境变量名称\n\n配置说明\n\n容器启动优先级\n\nECI_CONTAINER_LAUNCH_PRIORITY\n\n- \n\n取值范围为-1000~1000，默认值为0。数值越大，启动优先级越高。\n- \n\n优先级高的容器保证会在优先级低的容器启动之前启动，相同优先级的容器不保证启动顺序（并发启动）。\n- \n\n如果某容器依赖上一个容器提供服务，需要为容器配置Readiness Probe。例如：B容器依赖A容器提供服务，则在设置A容器的启动优先级高于B容器的同时，还需要为A容器配置Readiness Probe，确保A容器准备就绪后才启动B容器。\n\n容器退出优先级\n\nECI_CONTAINER_EXIT_PRIORITY\n\n- \n\n取值范围为-1000~1000，默认值为0。数值越大，退出优先级越高。\n- \n\n优先级高的容器保证会在优先级低的容器退出之前退出，相同优先级的容器不保证退出顺序（并发退出）。\n重要 \n\n设置容器退出顺序后，Pod总体的销毁时间可能会大于Pod Spec中TerminationGracePeriodSeconds声明的时间。\n## 配置示例\n### 设置容器启动顺序\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件创建Deployment。\n\nkubectl apply -f test-launch.yaml\n\n\ntest-launch.yaml的内容示例如下，表示创建一个包含1个Pod副本的Deployment。Pod内包含两个容器，c1容器的启动优先级高于c2容器，且c1容器配置了Readiness Probe，c2容器会在c1容器准备就绪后才启动。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test-launch\n  labels:\n    app: test\nspec:\n  replicas: 1 \n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      labels:\n        app: test\n    spec:\n      containers:\n      - image: registry-vpc.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\n        name: c1\n        env:\n        - name: ECI_CONTAINER_LAUNCH_PRIORITY\n          value: \"1000\"\n        readinessProbe:                  \n          httpGet:\n            path: /\n            port: 80\n          initialDelaySeconds: 30     \n          periodSeconds: 3\n      - image: registry-vpc.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\n        name: c2\n        env:\n        - name: ECI_CONTAINER_LAUNCH_PRIORITY\n          value: \"0\"\n        args:\n        - /bin/sh\n        - -c\n        - sleep 3600s\n\n\n- \n\n观察Pod status中各个容器的启动时间。\n\nkubectl describe pod <pod name>\n\n\n从返回信息的Containers中，可以看出c2容器的启动时间晚于c1容器。示例如下：\n\n### 设置容器退出顺序\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件创建Deployment。\n\nkubectl apply -f test-exit.yaml\n\n\ntest-exit.yaml的内容示例如下，表示创建一个包含1个Pod副本的Deployment。Pod内包含三个容器，退出优先级从高到低依次为c1、c2、c3。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test-exit\n  labels:\n    app: test\nspec:\n  replicas: 1 \n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      labels:\n        app: test\n    spec:\n      containers:\n      - image: registry-vpc.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\n        name: c1\n        env:\n        - name: ECI_CONTAINER_EXIT_PRIORITY\n          value: \"1000\"\n      - image: registry-vpc.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\n        name: c2\n        env:\n        - name: ECI_CONTAINER_EXIT_PRIORITY\n          value: \"0\"\n        args:\n        - /bin/sh\n        - -c\n        - sleep 3600s\n      - image: registry-vpc.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\n        name: c3\n        env:\n        - name: ECI_CONTAINER_EXIT_PRIORITY\n          value: \"-1000\"\n        args:\n        - /bin/sh\n        - -c\n        - sleep 3600s\n\n\n- \n\n删除Pod，然后观察Pod内容器Killing事件的顺序。说明 \n\n如果需要确认容器退出顺序，请及时查看事件，Pod彻底删除后可能无法观察到相关事件。\n\nkubectl describe pod <pod name>\n\n\n从返回信息的Events中，可以看出容器退出顺序依次为c1、c2、c3。示例如下：\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/set-container-start-and-exit-order-1", "page_type": "doc", "title": "设置容器启动和退出顺序", "keywords": "设置ECI容器启动顺序,设置ECI容器退出顺序,ECI容器启动顺序配置,ECI容器退出顺序配置", "last_modified_ms": 1692669491000, "last_modified_iso": "2023-08-22T09:58:11+08:00", "excerpt": "本文介绍如何通过环境变量的方式，为一个ECI实例内的各个容器设置启动和退出优先级，实现容器按顺序启动和退出。\n## 功能说明\n\n默认情况下，ECI实例内的各个容器是并发进行启动和退出的，没有固定的前后顺序。在某些场景下，一个实例内的多个容器之间可能存在依赖关系，某一容器需要在另一容器启动后再启动，或者某一容器需要在另一容器退出后再退出。例如：\n\n- \n\nistio服务治理场景，需要保证在业务容器产生流量时，istio-proxy容器已经Ready；在业务容器退出后，istio-proxy容器才退出。\n- \n\n采集日志时，需要保证在业务容器产生日志前，日志容器已经Ready；在业务容器退出后，日志容器才退出。\n\n针对上述场景，ECI支持通过设置容器环境变量的方式，为ECI实例内的容器设置启动和退出优先级。您可以按照您的业务需求为容器添加相应的环境变量，来保证容器按顺序启动或按顺序退出。\n## 配置说明\n\n设置容器启动和退出顺序的环境变量如下：\n\n[表格]\n\n配置项\n\n环境变量名称\n\n配置说明\n\n容器启动优先级\n\nECI_CONTAINER_LAUNCH_PRIORITY\n\n- \n\n取值范围为-1000~1000，默认值为0。数值越大，启动优先级越高。\n- \n\n优先级高的容器保证会在优先级低的容器启动之前启动，相同优先级的容器不保证启动顺序（并发启动）。\n- \n\n如果某容器依赖上一个容器提供服务，需要为容器配置Readiness Probe。例如：B容器依赖A容器提供服务，则在设置A容器的启动优先级高于B容器的同时，还需要为A容器配置Readiness Probe，确保A容器准备就绪后才启动B容器。\n\n容器退出优先级\n\nECI_CONTAINER_EXIT_PRIORITY\n\n- \n\n取值范围为-1000~1000，默认值为0。数值越大，退出优先级越高。\n- \n\n优先级高的容器保证会在优先级低的容器退出之前退出，相同优先级的容器不保证退出顺序（并发退出）。\n重要 \n\n通过OpenAPI创建ECI实例时，可以设置TerminationGracePeriodSeconds来保证实例优雅退出，此时如果设置了容器退出顺序，实例总体的销毁时间可能会大于TerminationGracePeriodSeconds声明的时间。\n## 配置示例\n### 设置容器启动顺序\n#### API\n\n- \n\n创建一台设置了容器启动顺序的ECI实例。\n\n调用[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)接口创建ECI实例所采用的参数示例如下，实例内包含两个容器，c1容器的启动优先级高于c2容器，且c1容器配置了Readiness Probe，c2容器会在c1容器准备就绪后才启动。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"ContainerGroupName\": \"test-launch\",\n  \"Container\": [\n    {\n      \"Name\": \"c1\",\n      \"Image\": \"registry.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\",\n      \"EnvironmentVar\": [\n        {\n          \"Key\": \"ECI_CONTAINER_LAUNCH_PRIORITY\",\n          \"Value\": \"1000\"\n        }\n      ],\n      \"ReadinessProbe.PeriodSeconds\": 3,\n      \"ReadinessProbe.HttpGet.Path\": \"/\",\n      \"ReadinessProbe.HttpGet.Port\": 80\n    },\n    {\n      \"Name\": \"c2\",\n      \"Image\": \"registry.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\",\n      \"EnvironmentVar\": [\n        {\n          \"Key\": \"ECI_CONTAINER_LAUNCH_PRIORITY\",\n          \"Value\": \"0\"\n        }\n      ],\n      \"Arg\": [\n        \"/bin/sh\",\n        \"-c\",\n        \"sleep 3600s\"\n      ]\n    }\n  ]\n}\n\n\n- \n\n查看实例详情，确认各个容器的启动时间。\n\n调用[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)查询实例详情，在返回信息的Containers中查看各个容器的详细信息，通过CurrentState.StartTime字段，可以看出c2容器的启动时间晚于c1容器。\n\n#### 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-beijing)创建ECI实例时，您可以在各个容器的高级配置中设置环境变量，为容器设置启动优先级，同时在健康检查处可以设置Readiness Probe（即应用业务探针）。\n\n创建完成后，您可以通过查看实例事件，确认各个容器的启动顺序。\n### 设置容器退出顺序\n#### API\n\n- \n\n创建一台设置了容器退出顺序的ECI实例。\n\n调用[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)接口创建ECI实例所采用的参数示例如下，实例设置了TerminationGracePeriodSeconds为30s，包含三个容器，容器退出优先级从高到低依次为c1、c2、c3。\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"ContainerGroupName\": \"test-exit\",\n  \"SecurityGroupId\": \"sg-2ze63v3jtm8e6syi****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"TerminationGracePeriodSeconds\": 30,\n  \"Container\": [\n    {\n      \"Name\": \"c1\",\n      \"Image\": \"registry.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\",\n      \"EnvironmentVar\": [\n        {\n          \"Key\": \"ECI_CONTAINER_EXIT_PRIORITY\",\n          \"Value\": \"1000\"\n        }\n      ]\n    },\n    {\n      \"Name\": \"c2\",\n      \"Image\": \"registry.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\",\n      \"EnvironmentVar\": [\n        {\n          \"Key\": \"ECI_CONTAINER_EXIT_PRIORITY\",\n          \"Value\": \"0\"\n        }\n      ],\n      \"Arg\": [\n        \"/bin/sh\",\n        \"-c\",\n        \"sleep 3600s\"\n      ]\n    },\n    {\n      \"Name\": \"c3\",\n      \"Image\": \"registry.cn-shanghai.aliyuncs.com/eci_open/nginx:alpine\",\n      \"EnvironmentVar\": [\n        {\n          \"Key\": \"ECI_CONTAINER_EXIT_PRIORITY\",\n          \"Value\": \"-1000\"\n        }\n      ],\n      \"Arg\": [\n        \"/bin/sh\",\n        \"-c\",\n        \"sleep 3600s\"\n      ]\n    }\n  ]\n}\n\n\n- \n\n删除实例，然后观察实例内容器Killing事件的顺序。说明 \n\n如果需要确认容器退出顺序，请及时查看事件，ECI实例彻底删除后可能无法观察到相关事件。\n\n调用[DescribeContainerGroupEvents](https://help.aliyu"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-multiple-specifications-to-create-an-elastic-container-instance", "page_type": "doc", "title": "多规格创建实例", "keywords": "创建多规格ECI实例,提升ECI创建成功率,查询ECI可用实例规格,ECI多规格创建方法,ECI实例规格列表,ECI多规格创建原理", "last_modified_ms": 1743158609000, "last_modified_iso": "2025-03-28T18:43:29+08:00", "excerpt": "大规模创建ECI实例时，可能会遇到库存不足的情况。此时，建议您配置多个规格，系统会按照配置顺序依次尝试创建，从而提升ECI实例的创建成功率。\n## 背景信息\n\n创建ECI实例的过程中，如果遇到库存不足而导致创建失败，系统会根据配置的规格顺序依次重试创建实例。因此，配置多个规格可以提升ECI实例的创建成功率。说明 \n\n- \n\n在重试创建过程中，ECI实例会一直处于Pending状态。\n- \n\n多规格方式为实例级别，仅影响单个实例的创建策略。\n- \n\n您可以配合使用多可用区和多规格的方式来创建实例，从而进一步提高实例的创建成功率。\n\n## 规格说明\n#### ECI支持的vCPU和内存规格\n\n- \n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n- \n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n\n#### ECI支持的ECS实例规格族\n\n- \n\n企业级x86计算规格族\n\nx86规格基于x86架构，每一个vCPU都对应一个处理器核心的超线程，具有性能稳定的特点，适用于各种类型和规模的企业级应用、数据库系统、视频编解码、数据分析等场景。\n\n[表格]\n\n规格类型\n\n企业级x86规格族\n\n通用型\n\ng8a、g8i、g7a、g7、g6e、g6a、g6、g5、sn2ne\n\n计算型\n\nc8a、c8i、c7a、c7、c6e、c6a、c6、c5、sn1ne\n\n内存型\n\nr8a、r8i、r7a、r7、r6e、r6a、r6、r5、se1ne、se1\n\n通用算力型\n\nu1\n\n密集计算型\n\nic5\n\n高主频\n\n- \n\nhfg8i、hfg7、hfg6、hfg5\n- \n\nhfc8i、hfc7、hfc6、hfc5\n- \n\nhfr8i、hfr7\n\n大数据\n\nd1、d1ne\n\n本地SSD型\n\ni2、i2g\n\n内存增强型\n\nre6\n- \n\n企业级异构计算规格族\n\nGPU规格含有GPU计算卡，适用于深度学习、图像处理等场景。GPU对应的Docker镜像可以直接运行在ECI GPU实例上。实例内已预装NVIDIA显卡设备驱动，不同GPU规格支持安装的驱动和CUDA版本不同。说明 \n\n下表中的gn8ia和gn8is目前仅支持海外等部分地域，如有需求，请联系阿里云销售人员。\n\n[表格]\n\n规格类型\n\nGPU规格族\n\n驱动和CUDA版本\n\nGPU虚拟化型实例规格族\n\nsgn7i-vws\n\nGRID 470，CUDA 11.4（默认安装）\n\nvgn7i-vws\n\nvgn6i-vws\n\nGPU计算型实例规格族\n\ngn7e\n\n- \n\nTesla 470，CUDA 11.4（默认安装）\n- \n\nTesla 535，CUDA 12.2\n- \n\nTesla 550，CUDA 12.4\n\ngn7i\n\ngn7s\n\ngn7\n\ngn6v\n\ngn6e\n\ngn6i\n\ngn5i\n\ngn5\n\ngn8ia\n\n- \n\nTesla 535，CUDA 12.2（默认安装）\n- \n\nTesla 550，CUDA 12.2\n\ngn8is重要 \n\n自2025年3月17日开始。指定GPU驱动版本不再使用完整版本号（如535.161.08），而是只使用大版本号（如535），实际创建出的实例的驱动版本可能会在保证大版本号不变的情况下更新小版本号，较老的驱动下线后会自动使用更高版本驱动创建。特定版本驱动的支持时间与NVIDIA官方对该驱动的支持时间一致，具体请参见[NVIDIA Driver Documentation](https://docs.nvidia.com/datacenter/tesla/index.html)。\n\nGPU驱动更新记录\n\n[表格]\n\n更新时间\n\n更新说明\n\n2025年3月\n\n- \n\nGRID 470驱动更新为470.239.06。\n- \n\nTesla 470驱动更新为470.256.02，Tesla 535驱动更新为535.230.02，Tesla550驱动更新为550.127.08。\n- \n\nTesla 525驱动不再支持，指定该驱动将回退到535版本。\n\n- \n\n企业级Arm计算规格族\n\nArm规格基于Arm架构，每一个vCPU都对应一个处理器的物理核心，具有性能稳定且资源独享的特点，适用于容器、微服务、网站和应用服务器、高性能计算、基于CPU的机器学习等场景。\n\n[表格]\n\n规格类型\n\nArm规格族\n\n通用型\n\ng8y\n\n计算型\n\nc8y\n\n内存型\n\nr8y\n- \n\n共享型x86计算规格族\n\n共享型规格主要面向一般中小网站或个人开发。与企业级规格相比，共享型规格在资源利用上更多强调资源性能的共享，所以无法保证实例计算性能的稳定，但是成本相对来说更低。\n\n[表格]\n\n规格类型\n\n共享型x86规格族\n\n经济型\n\ne\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明说明 \n\n仅支持通过OpenAPI指定多规格，控制台暂不支持。\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过InstanceType参数来指定规格。\n\n- \n\n指定多规格时，可以指定vCPU和内存规格，也可以指定ECS规格，支持同时指定两者。\n- \n\n请根据想要使用规格的优先级，按顺序设置多个规格（单次最多5个）。\n- \n\n对于GPU、本地盘、ARM等除了指定规格外还需要额外配置其他参数的规格，指定多规格时只能指定同类型的规格，无法和其他规格同时指定。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/)。\n\nInstanceType的参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nInstanceType\n\nString\n\n2-4Gi,ecs.c6.xlarge,ecs.g6.xlarge\n\n指定实例规格。支持指定多个规格（单次最多5个），各规格之间用半角逗号（,）进行分隔。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-multiple-zones-to-create-an-elastic-container-instance", "page_type": "doc", "title": "多可用区创建实例", "keywords": "创建多可用区ECI,解决ECI库存不足,配置ECI调度策略,ECI多可用区创建,ECI实例调度策略,CreateContainerGroup API参考", "last_modified_ms": 1739254942000, "last_modified_iso": "2025-02-11T14:22:22+08:00", "excerpt": "当您在应对突发流量，进行业务的快速水平扩容时，或者启动大量实例进行Job任务处理时，可能会遇到可用区对应规格实例库存不足或者指定的交换机IP耗尽等特殊情况，从而导致实例创建失败，影响业务。此时，您可以采用指定多可用区的方式来创建实例，提高实例创建的成功率。\n## 前提条件\n\n已在要使用的专有网络VPC下创建多个不同可用区的交换机。\n\n- \n\n关于如何创建交换机，请参见[创建交换机](https://help.aliyun.com/zh/vpc/user-guide/create-and-manage-vswitch#task-1012575)。\n- \n\n关于ECI支持的地域和可用区信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n\n## 背景信息\n\n创建ECI实例时，可以通过指定多个交换机来指定了多个可用区，系统会随机把请求分散到所有指定的可用区中，来分散压力，如果在某一个可用区遇到没有库存的情况，会自动切换到下一个可用区继续尝试创建。\n\n指定多可用区（交换机）时，需注意以下限制：\n\n- \n\n指定的交换机必须属于同一个VPC。\n- \n\n最多可以指定10个交换机。\n\n您可以配合使用多可用区和多规格的方式来创建实例，提高实例的创建成功率。\n## 配置说明\n## OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过VSwitchId参数来指定多可用区，以及通过ScheduleStrategy参数配置多可用区调度策略。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVSwitchId\n\nString\n\nvsw-bp1xpiowfm5vo8o3c****,vsw-bp1rkyjgr1xwoho6k**** \n\n指定虚拟交换机ID，支持指定多个交换机ID（单次最多10个），各交换机ID之间可以用半角逗号（,）进行分隔。例如：vsw-***,vsw-***。\n\nScheduleStrategy\n\nString\n\nVSwitchOrdered\n\n配置了多可用区时，ECI实例的调度策略。\n\n- \n\nVSwitchOrdered：按指定顺序调度。具体规则如下：\n\n- \n\n如果ECI Pod挂载了云盘，云盘所属可用区必须和Pod一致，不符合的可用区会被过滤。\n- \n\n按照指定的顺序尝试创建资源，当第一个可用区没有库存时，尝试使用第二个，以此类推，直至资源创建成功。\n\n- \n\nVSwitchRandom：库存最优策略调度。具体规则如下：\n\n- \n\n如果ECI Pod挂载了云盘，云盘所属可用区必须和Pod一致，不符合的可用区会被过滤。\n- \n\n由阿里云根据库存最优的调度策略选择合适的交换机（对应可用区）。\n- \n\n如果ECI Pod指定了规格，优先调度到有该规格对应预留实例券的可用区。\n- \n\n优先调度到存储性能较好的可用区。以下老的可用区调度优先级靠后。\n\n- \n\ncn-beijing-e、cn-beijing-d\n- \n\ncn-shenzhen-a、cn-shenzhen-b、cn-shenzhen-c\n- \n\ncn-hangzhou-b、cn-hangzhou-e、cn-hangzhou-f\n- \n\ncn-shanghai-a、cn-shanghai-c\n\n说明 \n\n建议您配合使用多可用区和多规格方式来创建实例，通过VSwitchId参数来指定多可用区，通过InstanceType参数来指定多规格。\n## 控制台\n\n通过[弹性容器实例售卖页](https://eci.console.aliyun.com/#/eci/createEci)创建ECI实例时，您可以选择多个交换机来指定多可用区。\n## 后续步骤\n\n如果您采用NAT网关来连接公网，配置多可用区（即多个交换机）后，您需要检查SNAT条目配置是否仍满足需求。\n\n例如：如果原有SNAT条目粒度为交换机粒度，则配置多个交换机后，您需要增加新增交换机对应的条目，保证新交换机下的ECI实例可以访问公网。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod", "page_type": "doc", "title": "指定或排除ECS规格族创建Pod", "keywords": "指定Pod的ECS规格族,排除Pod的ECS规格族,ECI Pod规格族配置,ECI Pod规格族示例", "last_modified_ms": 1731464748000, "last_modified_iso": "2024-11-13T10:25:48+08:00", "excerpt": "在指定vCPU和内存创建ECI Pod的场景下，如果您对规格有一定要求，例如只想使用ecs.g6规格族，可添加k8s.aliyun.com/eci-instance-family的Annotation来指定ECS规格族。本文介绍创建ECI Pod时，如何指定或排除ECS规格族。\n## 功能说明\n\n指定vCPU和内存创建ECI Pod时，系统会使用多种ECS规格进行支撑，并自动选择满足vCPU和内存条件且有库存的规格。此时，您可以添加Annotation（k8s.aliyun.com/eci-instance-family）来指定或排除ECS规格族。\n\n- \n\n如果指定了某些ECS规格族，则系统仅会从相应的ECS规格族中进行选择。如果指定的ECS规格族没有库存，则不会创建ECI Pod。\n- \n\n如果排除了某些ECS规格族，则系统在选择规格时会排除这些规格族，从其他ECI支持的ECS规格族中选择规格。\n说明 \n\n可以配合使用k8s.aliyun.com/eci-instance-generation来指定或排除ECS规格代数，实现更精细的规格控制。\n\n支持指定或排除的ECS规格族如下：\n\n[表格]\n\nECS规格代数\n\nECS规格族\n\n8\n\ng8i、c8i、r8i、hfg8i、hfc8i、hfr8i\n\n7\n\ng7、c7、r7、hfg7、hfc7、hfr7、g7ne\n\n6\n\ng6e、g6、c6e、c6、r6e、r6、hfc6、hfg6、s6\n\n5\n\nu1、g5、g5ne、c5、r5、ic5、hfc5、hfg5\n\n4\n\nsn2ne、sn1ne、se1ne、se1\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 注意事项\n\n- \n\n指定或排除ECS规格族创建的ECI Pod按照实际生成的ECS规格进行计费，不按照vCPU和内存计费。重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看其YAML详情，通过k8s.aliyun.com/eci-instance-spec字段确认ECI Pod实际使用的ECS规格，ECI会按照该ECS规格进行计费。\n- \n\n指定或排除ECS规格族时，系统无法自动选择到某些规格，如GPU规格（gn6i等）、本地盘规格（i2g等）等。如有需要，请明确指定ECS规格来创建ECI Pod。具体操作，请参见[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod/)。\n- \n\n指定或排除ECS规格族的功能仅适用于指定vCPU和内存规格的场景，如果优先指定的是ECS规格，则该功能不会生效。\n- \n\n支持指定或排除规格族创建抢占式实例，该场景下系统会综合考量配置的规格族顺序和市场价格（价格优先），为您选择最优的实例规格。如果您对规格族有严格要求，建议只配置一个规格族。\n\n## 配置说明\n\nk8s.aliyun.com/eci-instance-family的取值为ECS规格族，相关说明如下：\n\n- \n\n可配置多个规格族，取值范围为ECI支持的ECS规格族。\n- \n\n在规格族前加上-表示排除该规格族。\n\n例如：k8s.aliyun.com/eci-instance-family: \"-ecs.c6, -ecs.c5\"表示排除ecs.c6和ecs.c5规格族。\n- \n\n对于指定的规格族，系统会按照配置的顺序进行选择。\n\n例如：k8s.aliyun.com/eci-instance-family: \"ecs.c6, ecs.c5\"表示优先使用ecs.c6规格族，当ecs.c6规格族中，满足vCPU和内存条件的规格库存不足时，使用ecs.c5规格族。如果ecs.c5规格族仍库存不足，则创建失败。\n\n使用k8s.aliyun.com/eci-instance-family时，必须先指定vCPU和内存规格，您可以通过以下两种方式指定：\n\n- \n\n通过定义容器的limits或requests来指定，建议使用limits。\n- \n\n在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n\n### 示例一：指定ECS规格族\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过limit指定了vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-family: \"ecs.c6, ecs.g6\"指定优先使用ecs.c6规格族的规格，其次使用ecs.g6规格族中的规格。\n\n优先使用ecs.c6.large规格，其次使用ecs.g6.large规格。说明 \n\n该示例配置效果等同于k8s.aliyun.com/eci-use-specs: \"ecs.c6.large,ecs.g6.large\"。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      name: test\n      labels:\n        app: test\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-instance-family: \"ecs.c6,ecs.g6\"    # 指定优先使用ecs.c6规格族的规格，其次使用ecs.g6规格族的规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: \"2\"       # vCPU上限        \n            memory: \"4Gi\"  # 内存上限\n\n\n### 示例二：排除ECS规格族\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过k8s.aliyun.com/eci-use-specs: \"2-4Gi\"指定vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-family: \"-ecs.hfg6,-ecs.hfg5\"排除使用ecs.hfg6和ecs.hfg5规格族中的规格。\n\n从除了ecs.hfg6和ecs.hfg5规格族外的其他ECI支持的ECS规格族中选择满足vCPU和内存要求的规格。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"2-4Gi\"                    # 指定模糊的vCPU和内存规格\n        k8s.aliyun.com/eci-instance-family: \"-ecs.hfg6,-ecs.hfg5\"    # 排除ecs.hfg6和ecs.hfg5规格族\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n### 示例三：指定ECS规格代数并排除ECS规格族\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过k8s.aliyun.com/eci-use-specs: \"2-4Gi\"指定vCPU和内存资源（2 vCPU，4 GiB"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-ecs-instance-families-to-create-a-pod-1", "page_type": "doc", "title": "指定或排除ECS规格族创建Pod", "keywords": "指定Pod的ECS规格族,排除Pod的ECS规格族,ECI Pod规格族配置,ECS规格族配置示例", "last_modified_ms": 1729493516000, "last_modified_iso": "2024-10-21T14:51:56+08:00", "excerpt": "在指定vCPU和内存创建ECI Pod的场景下，如果您对规格有一定要求，例如只想使用ecs.g6规格族，可添加k8s.aliyun.com/eci-instance-family的Annotation来指定ECS规格族。本文介绍创建ECI Pod时，如何指定或排除ECS规格族。\n## 功能说明\n\n指定vCPU和内存创建ECI Pod时，系统会使用多种ECS规格进行支撑，并自动选择满足vCPU和内存条件且有库存的规格。此时，您可以添加Annotation（k8s.aliyun.com/eci-instance-family）来指定或排除ECS规格族。\n\n- \n\n如果指定了某些ECS规格族，则系统仅会从相应的ECS规格族中进行选择。如果指定的ECS规格族没有库存，则不会创建ECI Pod。\n- \n\n如果排除了某些ECS规格族，则系统在选择规格时会排除这些规格族，从其他ECI支持的ECS规格族中选择规格。\n说明 \n\n可以配合使用k8s.aliyun.com/eci-instance-generation来指定或排除ECS规格代数，实现更精细的规格控制。\n\n支持指定或排除的ECS规格族如下：\n\n[表格]\n\n架构\n\nECS规格代数\n\nECS规格族\n\nArm\n\n8\n\ng8y、c8y、r8y\n\nx86\n\n8\n\ng8i、c8i、r8i、hfg8i、hfc8i、hfr8i\n\n7\n\ng7、c7、r7、hfg7、hfc7、hfr7、g7ne\n\n6\n\ng6e、g6、c6e、c6、r6e、r6、hfc6、hfg6、s6\n\n5\n\nu1、g5、g5ne、c5、r5、ic5、hfc5、hfg5\n\n4\n\nsn2ne、sn1ne、se1ne、se1\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 注意事项\n\n- \n\n指定或排除ECS规格族创建的ECI Pod按照实际生成的ECS规格进行计费，不按照vCPU和内存计费。重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看其YAML详情，通过k8s.aliyun.com/eci-instance-spec字段确认ECI Pod实际使用的ECS规格，ECI会按照该ECS规格进行计费。\n- \n\n指定或排除ECS规格族时，系统无法自动选择到某些规格，如GPU规格（gn6i等）、本地盘规格（i2g等）等。如有需要，请明确指定ECS规格来创建ECI Pod。具体操作，请参见[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod-1/)。\n- \n\n指定或排除ECS规格族的功能仅适用于指定vCPU和内存规格的场景，如果优先指定的是ECS规格，则该功能不会生效。\n- \n\n支持指定或排除规格族创建抢占式实例，该场景下系统会综合考量配置的规格族顺序和市场价格（价格优先），为您选择最优的实例规格。如果您对规格族有严格要求，建议只配置一个规格族。\n\n## 配置说明\n\nk8s.aliyun.com/eci-instance-family的取值为ECS规格族，相关说明如下：\n\n- \n\n可配置多个规格族，取值范围为ECI支持的ECS规格族。重要 \n\n目前8代规格仅支持Arm架构规格，创建Pod时需要通过nodeSelector调度到Arm节点，因此无法与其他x86架构的规格同时配置，只能单独指定或排除Arm规格族，具体配置示例请参见[示例五：指定Arm规格族](#c8d6eea0584wd)。\n- \n\n在规格族前加上-表示排除该规格族。\n\n例如：k8s.aliyun.com/eci-instance-family: \"-ecs.c6, -ecs.c5\"表示排除ecs.c6和ecs.c5规格族。\n- \n\n对于指定的规格族，系统会按照配置的顺序进行选择。\n\n例如：k8s.aliyun.com/eci-instance-family: \"ecs.c6, ecs.c5\"表示优先使用ecs.c6规格族，当ecs.c6规格族中，满足vCPU和内存条件的规格库存不足时，使用ecs.c5规格族。如果ecs.c5规格族仍库存不足，则创建失败。\n\n使用k8s.aliyun.com/eci-instance-family时，必须先指定vCPU和内存规格，您可以通过以下两种方式指定：\n\n- \n\n通过定义容器的limits或requests来指定，建议使用limits。\n- \n\n在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n\n### 示例一：指定ECS规格族\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过limit指定了vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-family: \"ecs.c6, ecs.g6\"指定优先使用ecs.c6规格族的规格，其次使用ecs.g6规格族中的规格。\n\n优先使用ecs.c6.large规格，其次使用ecs.g6.large规格。说明 \n\n该示例配置效果等同于k8s.aliyun.com/eci-use-specs: \"ecs.c6.large,ecs.g6.large\"。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      name: test\n      labels:\n        app: test\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-instance-family: \"ecs.c6,ecs.g6\"    # 指定优先使用ecs.c6规格族的规格，其次使用ecs.g6规格族的规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: \"2\"       # vCPU上限        \n            memory: \"4Gi\"  # 内存上限\n\n\n### 示例二：排除ECS规格族\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过k8s.aliyun.com/eci-use-specs: \"2-4Gi\"指定vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-family: \"-ecs.hfg6,-ecs.hfg5\"排除使用ecs.hfg6和ecs.hfg5规格族中的规格。\n\n从除了ecs.hfg6和ecs.hfg5规格族外的其他ECI支持的ECS规格族中选择满足vCPU和内存要求的规格。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"2-4Gi\"                    # 指定模糊的vCPU和内存规格\n        k8s.aliyun.com/eci-instance-family: \"-ecs.hfg6,-ecs.hfg5\"    # 排除ecs.hfg6和ecs.hfg5规格族\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.1"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod", "page_type": "doc", "title": "指定或排除ECS规格代数创建Pod", "keywords": "指定Pod的ECS规格代数,排除Pod的ECS规格代数,ECI Pod规格代数配置,ECI Pod规格代数注解", "last_modified_ms": 1729493504000, "last_modified_iso": "2024-10-21T14:51:44+08:00", "excerpt": "在指定vCPU和内存创建ECI Pod的场景下，如果您对规格有一定要求，例如只想使用6代ECS规格（如g6、c6等），可添加k8s.aliyun.com/eci-instance-generation的Annotation来指定ECS规格代数。本文介绍创建ECI Pod时，如何指定或排除ECS规格代数。\n## 功能说明\n\n指定vCPU和内存创建ECI Pod时，系统会使用多种ECS规格进行支撑，并自动选择满足vCPU和内存条件且有库存的规格。此时，您可以添加Annotation（k8s.aliyun.com/eci-instance-generation）来指定或排除ECS规格代数。\n\n- \n\n如果指定了某些ECS规格代数，则系统仅会从相应代数的ECS规格中进行选择，如果指定的ECS规格代数没有库存，则不会创建ECI Pod。\n- \n\n如果排除了某些ECS规格代数，则系统在选择规格时会排除这些规格代数，从其他ECI支持的ECS规格代数中选择规格。\n\n支持指定或排除的ECS规格代数，及其包含的ECS规格族如下：\n\n[表格]\n\n架构\n\nECS规格代数\n\nECS规格族\n\nArm\n\n8\n\ng8y、c8y、r8y\n\nx86\n\n8\n\ng8i、c8i、r8i、hfg8i、hfc8i、hfr8i\n\n7\n\ng7、c7、r7、hfg7、hfc7、hfr7、g7ne\n\n6\n\ng6e、g6、c6e、c6、r6e、r6、hfc6、hfg6、s6\n\n5\n\nu1、g5、g5ne、c5、r5、ic5、hfc5、hfg5\n\n4\n\nsn2ne、sn1ne、se1ne、se1\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 注意事项\n\n- \n\n指定ECS规格代数创建的ECI Pod按照实际生成的ECS规格进行计费，不按照vCPU和内存计费。重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看其YAML详情，通过k8s.aliyun.com/eci-instance-spec字段确认ECI Pod实际使用的ECS规格，ECI会按照该ECS规格进行计费。\n- \n\n指定或排除ECS规格代数时，系统无法自动选择到某些规格，如GPU规格（如gn6i）、本地盘规格（如i2g）等。如有需要，请明确指定ECS规格来创建ECI Pod。具体操作，请参见[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod-1/)。\n- \n\n支持指定或排除规格代数创建抢占式实例，该场景下系统会综合考量配置的代数顺序和市场价格（价格优先），为您选择最优的实例规格。如果您对规格代数有严格要求，建议只配置一个代数。\n- \n\n指定或排除ECS规格代数的功能仅适用于指定vCPU和内存规格的场景，如果优先指定的是ECS规格，则该功能不会生效。\n\n## 配置说明\n\nk8s.aliyun.com/eci-instance-generation的取值为ECS规格代数，相关说明如下：\n\n- \n\n支持配置多个规格代数，取值范围为ECI支持的规格代数。重要 \n\n目前8代规格仅支持Arm架构规格，创建Pod时需要通过nodeSelector调度到Arm节点，因此无法与其他x86架构的规格同时配置。创建Arm规格的ECI Pod时，无需使用规格代数功能来过滤规格（单独指定或排除8代规格没有实际意义）。更多信息，请参见[调度Pod到Arm架构的虚拟节点](https://help.aliyun.com/zh/eci/user-guide/scheduling-pods-to-virtual-nodes-in-the-arm-architecture)和[指定Arm规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-arm-specification)。\n- \n\n在规格代数前加上-表示排除该规格代数。\n\n例如：k8s.aliyun.com/eci-instance-generation: \"-5,-4\"表示排除5代和4代ECS规格，使用7代或6代ECS规格。\n- \n\n对于指定的规格代数，系统会按照配置的顺序进行选择。\n\n例如：k8s.aliyun.com/eci-instance-generation: \"6,5\"表示优先使用6代ECS规格，当6代ECS规格中，满足vCPU和内存条件的规格库存不足时，使用5代ECS规格。如果5代ECS规格库存仍不足，则创建失败。\n\n使用k8s.aliyun.com/eci-instance-generation时，必须先指定vCPU和内存规格，您可以通过以下两种方式指定：\n\n- \n\n通过定义容器的limits或requests来指定，建议使用limits。\n- \n\n在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n\n### 示例一：指定ECS规格代数\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过limit指定了vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-generation: \"6,5\" 指定优先使用6代ECS规格，其次使用5代ECS规格。\n\n- \n\n优先从6代ECS规格中选择满足vCPU和内存条件的规格。\n- \n\n如果6代ECS规格库存不足，从5代规格中进行选择。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-instance-generation: \"6,5\"    # 指定优先使用6代ECS规格，其次使用5代ECS规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: \"2\"       # vCPU上限        \n            memory: \"4Gi\"  # 内存上限\n\n\n### 示例二：排除ECS规格代数\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过k8s.aliyun.com/eci-use-specs: \"2-4Gi\"指定vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-generation: \"-5,-4\" 排除使用5代和4代ECS规格。\n\n从7代和6代ECS规格中选择满足vCPU和内存条件的规格。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"2-4Gi\"                    # 指定模糊的vCPU和内存规格\n        k8s.aliyun.com/eci-instance-generation: \"-5,-4\"          # 排除5代和4代ECS规格\n    spec:\n      containers:\n      - name: nginx\n        image: "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod-1", "page_type": "doc", "title": "指定或排除ECS规格代数创建Pod", "keywords": "指定ECI Pod规格代数,排除ECI Pod规格代数,ECI Pod规格代数,ECI Pod创建配置", "last_modified_ms": 1731464762000, "last_modified_iso": "2024-11-13T10:26:02+08:00", "excerpt": "在指定vCPU和内存创建ECI Pod的场景下，如果您对规格有一定要求，例如只想使用6代ECS规格（如g6、c6等），可添加k8s.aliyun.com/eci-instance-generation的Annotation来指定ECS规格代数。本文介绍创建ECI Pod时，如何指定或排除ECS规格代数。\n## 功能说明\n\n指定vCPU和内存创建ECI Pod时，系统会使用多种ECS规格进行支撑，并自动选择满足vCPU和内存条件且有库存的规格。此时，您可以添加Annotation（k8s.aliyun.com/eci-instance-generation）来指定或排除ECS规格代数。\n\n- \n\n如果指定了某些ECS规格代数，则系统仅会从相应代数的ECS规格中进行选择，如果指定的ECS规格代数没有库存，则不会创建ECI Pod。\n- \n\n如果排除了某些ECS规格代数，则系统在选择规格时会排除这些规格代数，从其他ECI支持的ECS规格代数中选择规格。\n\n支持指定或排除的ECS规格代数，及其包含的ECS规格族如下：\n\n[表格]\n\nECS规格代数\n\nECS规格族\n\n8\n\ng8i、c8i、r8i、hfg8i、hfc8i、hfr8i\n\n7\n\ng7、c7、r7、hfg7、hfc7、hfr7、g7ne\n\n6\n\ng6e、g6、c6e、c6、r6e、r6、hfc6、hfg6、s6\n\n5\n\nu1、g5、g5ne、c5、r5、ic5、hfc5、hfg5\n\n4\n\nsn2ne、sn1ne、se1ne、se1\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 注意事项\n\n- \n\n指定ECS规格代数创建的ECI Pod按照实际生成的ECS规格进行计费，不按照vCPU和内存计费。重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看其YAML详情，通过k8s.aliyun.com/eci-instance-spec字段确认ECI Pod实际使用的ECS规格，ECI会按照该ECS规格进行计费。\n- \n\n指定或排除ECS规格代数时，系统无法自动选择到某些规格，如GPU规格（如gn6i）、本地盘规格（如i2g）等。如有需要，请明确指定ECS规格来创建ECI Pod。具体操作，请参见[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod/)。\n- \n\n支持指定或排除规格代数创建抢占式实例，该场景下系统会综合考量配置的代数顺序和市场价格（价格优先），为您选择最优的实例规格。如果您对规格代数有严格要求，建议只配置一个代数。\n- \n\n指定或排除ECS规格代数的功能仅适用于指定vCPU和内存规格的场景，如果优先指定的是ECS规格，则该功能不会生效。\n\n## 配置说明\n\nk8s.aliyun.com/eci-instance-generation的取值为ECS规格代数，相关说明如下：\n\n- \n\n支持配置多个规格代数，取值范围为4、5、6、7。\n- \n\n在规格代数前加上-表示排除该规格代数。\n\n例如：k8s.aliyun.com/eci-instance-generation: \"-5,-4\"表示排除5代和4代ECS规格，使用7代或6代ECS规格。\n- \n\n对于指定的规格代数，系统会按照配置的顺序进行选择。\n\n例如：k8s.aliyun.com/eci-instance-generation: \"6,5\"表示优先使用6代ECS规格，当6代ECS规格中，满足vCPU和内存条件的规格库存不足时，使用5代ECS规格。如果5代ECS规格库存仍不足，则创建失败。\n\n使用k8s.aliyun.com/eci-instance-generation时，必须先指定vCPU和内存规格，您可以通过以下两种方式指定：\n\n- \n\n通过定义容器的limits或requests来指定，建议使用limits。\n- \n\n在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n\n### 示例一：指定ECS规格代数\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过limit指定了vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-generation: \"6,5\" 指定优先使用6代ECS规格，其次使用5代ECS规格。\n\n- \n\n优先从6代ECS规格中选择满足vCPU和内存条件的规格。\n- \n\n如果6代ECS规格库存不足，从5代规格中进行选择。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-instance-generation: \"6,5\"    # 指定优先使用6代ECS规格，其次使用5代ECS规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: \"2\"       # vCPU上限        \n            memory: \"4Gi\"  # 内存上限\n\n\n### 示例二：排除ECS规格代数\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过k8s.aliyun.com/eci-use-specs: \"2-4Gi\"指定vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-generation: \"-5,-4\" 排除使用5代和4代ECS规格。\n\n从7代和6代ECS规格中选择满足vCPU和内存条件的规格。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: \"2-4Gi\"                    # 指定模糊的vCPU和内存规格\n        k8s.aliyun.com/eci-instance-generation: \"-5,-4\"          # 排除5代和4代ECS规格\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n### 示例三：指定ECS规格代数并排除ECS规格族\n\n[表格]\n\n配置项\n\n实现效果\n\n- \n\n通过k8s.aliyun.com/eci-use-specs: \"2-4Gi\"指定vCPU和内存资源（2 vCPU，4 GiB内存）。\n- \n\n通过k8s.aliyun.com/eci-instance-generation: \"6,5\" 指定优先使用6代ECS规格，其次使用5代ECS规格。\n- \n\n通过k8s.aliyun.com/eci-instance-family: \"-ecs.hfg5\"排除ecs.hfg5规格族。\n\n- \n\n优先从6代ECS规格中选择满足vCPU和内存条件"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-a-pod", "page_type": "doc", "title": "指定算力类别创建Pod", "keywords": "创建指定算力Pod,了解ECI算力类别,配置ECI算力类别,ECI算力类别介绍,ECI算力类别规格,ECI算力类别计费", "last_modified_ms": 1723600056000, "last_modified_iso": "2024-08-14T09:47:36+08:00", "excerpt": "大部分场景下，如果没有特殊的规格需求（如GPU、本地盘等），推荐您指定vCPU和内存来创建ECI Pod（即ECI实例）。在此基础上，您可以进一步指定算力类别。例如：对于0.25~8 vCPU的规格需求，在轻量型应用等入门场景，您可以选择经济型规格来满足降低成本的需求；对于1 vCPU及以上的规格需求，如果性能需求较高，则可以选择通用型规格。\n## 算力类别说明\n\n为了更好地满足低成本或性能稳定的需求，ECI推出了指定算力类别功能。当您采用指定vCPU和内存方式创建ECI实例时，ECI会将底层规格分为经济型和通用型两个算力类别。您可以按需选择，系统会从对应类别的底层规格中自动选择合适的规格。\n\n- \n\n经济型（economy）\n\n支持的vCPU范围为0.25~8 vCPU，规格单价相比通用型更低。\n- \n\n通用型（general）\n\n支持的vCPU范围为1~64 vCPU，规格单价与未开通指定算力类别时的ECI规格定价一致。在相同vCPU和内存条件下，通用型规格的性能更优。\n\n## 如何选择算力类别\n\n您可以根据业务情况，以及对低成本、性能稳定或高可用等需求，来选择合适的算力类别。建议如下：\n\n- \n\n对于轻量型应用等入门场景，可以选择经济型规格来降低资源成本。\n- \n\n对于性能需求较高的业务场景，可以选择通用型规格，该类别规格性能更优，并且与未指定算力类别相比，性能表现更稳定。\n- \n\n为了避免库存不足的情况，如果您的业务对性能波动有一定的容忍，可以指定多个算力类别来保证高可用。\n\n## 规格说明\n\nECI支持的经济型和通用型的详细规格如下：说明 \n\n各规格支持的临时存储空间大小默认均为30 GiB。\n### 经济型规格\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.08\n\n2\n\n1、2、4、8、16\n\n0.2\n\n4\n\n2、4、8、16、32\n\n0.4\n\n8\n\n4、8、16、32、64\n\n0.8\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n2\n\n6、10、12、14\n\n0.2\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n0.4\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n0.8\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n0.8\n### 通用型规格\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n1\n\n2、4、8\n\n1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n## 计费说明重要 \n\n经济型规格和通用型规格目前处于公测中。\n\n- \n\n经济型规格\n\n相比于未指定算力类别时的规格，经济型规格的内存单价与之前一致，vCPU单价更低。\n\n- \n\nvCPU单价（vCPU）：0.000027 元/秒（0.0972 元/小时）\n- \n\n内存单价（GiB）： 0.00000613 元/秒（0.0221 元/小时）\n\n- \n\n通用型规格\n\n与未开通指定算力类别时的ECI规格定价一致。\n\n- \n\nvCPU单价（vCPU）：0.000049 元/秒（0.1764 元/小时）\n- \n\n内存单价（GiB）： 0.00000613 元/秒（0.0221 元/小时）\n\n重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看详情，通过k8s.aliyun.com/eci-instance-compute-category字段确认ECI Pod实际使用的算力类别。计费会按照对应类别的规格单价计算。\n## 使用限制\n\n指定算力类别功能具有以下限制：\n\n- \n\n仅适用于指定vCPU和内存创建ECI实例。\n\n如果指定了ECS规格，则优先会采用指定的ECS规格，即无法指定算力类别。\n- \n\n不支持抢占式实例功能。\n\n如果同时配置了抢占式实例和指定算力类别的Annotation，系统会报错（错误码为FeatureBasedConstraintConflict）。\n- \n\n不支持ARM架构的规格。\n\n如果将ECI Pod调度到ARM架构节点的同时，配置了指定算力类别的Annotation，系统会报错（错误码为FeatureBasedConstraintConflict）。\n- \n\n不支持与以下功能同时使用：\n\n- \n\n指定或排除ECS规格族\n- \n\n指定或排除ECS规格代数\n\n## 配置说明\n\n指定vCPU和内存创建ECI Pod时，支持以下两种方式：\n\n- \n\n指定Pod内容器的vCPU和内存：通过定义Containers的limits或requests来指定，建议使用limits。\n- \n\n指定Pod级别的vCPU和内存：通过在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n说明 \n\n如果没有指定，或者同时设置了limits、requests和k8s.aliyun.com/eci-use-specs，实际生效情况请参见[配置说明](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod-1#9a30b29038a30)。\n\n在指定vCPU和内存的基础上，您可以在Pod metadata中添加Annotation来指定算力类别，对应Annotation为k8s.aliyun.com/eci-compute-category，配置说明如下：\n\n- \n\n取值为economy（表示经济型）和general（表示通用型）。\n- \n\n支持设置多个算力类别，系统会按照设置顺序创建。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 生效规则\n\n开通指定算力类别功能后，根据创建ECI Pod时设置的条件，实际创建的ECI Pod所使用的规格和算力类别按以下规则生效：重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看详情，通过k8s.aliyun.com/eci-instance-compute-category字段确认ECI Pod实际使用的算力类别。计费会按照对应类别的规格单价计算。\n\n[表格]\n\n创建ECI实例时设置的条件\n\n实际生效情况\n\n未指定vCPU和内存，但指定了算力类别。\n\n创建2 vCPU，4 GiB内存的实例，算力类别为指定的类别。\n\n指定了vCPU和内存，且指定了算力类别，两者组合后符合ECI的规格要求。\n\n按照指定的条件创建实例。\n\n指定的vCPU小于1 vCPU，但指定算力类别为通用型。"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-a-pod-1", "page_type": "doc", "title": "指定算力类别创建Pod", "keywords": "创建指定算力Pod,了解ECI算力类别,配置ECI算力类别,ECI算力类别介绍,ECI算力类别规格,ECI算力类别计费", "last_modified_ms": 1720423413000, "last_modified_iso": "2024-07-08T15:23:33+08:00", "excerpt": "大部分场景下，如果没有特殊的规格需求（如GPU、本地盘等），推荐您指定vCPU和内存来创建ECI Pod（即ECI实例）。在此基础上，您可以进一步指定算力类别。例如：对于0.25~8 vCPU的规格需求，在轻量型应用等入门场景，您可以选择经济型规格来满足降低成本的需求；对于1 vCPU及以上的规格需求，如果性能需求较高，则可以选择通用型规格。\n## 算力类别说明\n\n为了更好地满足低成本或性能稳定的需求，ECI推出了指定算力类别功能。当您采用指定vCPU和内存方式创建ECI实例时，ECI会将底层规格分为经济型和通用型两个算力类别。您可以按需选择，系统会从对应类别的底层规格中自动选择合适的规格。\n\n- \n\n经济型（economy）\n\n支持的vCPU范围为0.25~8 vCPU，规格单价相比通用型更低。\n- \n\n通用型（general）\n\n支持的vCPU范围为1~64 vCPU，规格单价与未开通指定算力类别时的ECI规格定价一致。在相同vCPU和内存条件下，通用型规格的性能更优。\n\n## 如何选择算力类别\n\n您可以根据业务情况，以及对低成本、性能稳定或高可用等需求，来选择合适的算力类别。建议如下：\n\n- \n\n对于轻量型应用等入门场景，可以选择经济型规格来降低资源成本。\n- \n\n对于性能需求较高的业务场景，可以选择通用型规格，该类别规格性能更优，并且与未指定算力类别相比，性能表现更稳定。\n- \n\n为了避免库存不足的情况，如果您的业务对性能波动有一定的容忍，可以指定多个算力类别来保证高可用。\n\n## 规格说明\n\nECI支持的经济型和通用型的详细规格如下：说明 \n\n各规格支持的临时存储空间大小默认均为30 GiB。\n### 经济型规格\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.08\n\n2\n\n1、2、4、8、16\n\n0.2\n\n4\n\n2、4、8、16、32\n\n0.4\n\n8\n\n4、8、16、32、64\n\n0.8\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n2\n\n6、10、12、14\n\n0.2\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n0.4\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n0.8\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n0.8\n### 通用型规格\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n1\n\n2、4、8\n\n1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n## 计费说明重要 \n\n经济型规格和通用型规格目前处于公测中。\n\n- \n\n经济型规格\n\n相比于未指定算力类别时的规格，经济型规格的内存单价与之前一致，vCPU单价更低。\n\n- \n\nvCPU单价（vCPU）：0.000027 元/秒（0.0972 元/小时）\n- \n\n内存单价（GiB）： 0.00000613 元/秒（0.0221 元/小时）\n\n- \n\n通用型规格\n\n与未开通指定算力类别时的ECI规格定价一致。\n\n- \n\nvCPU单价（vCPU）：0.000049 元/秒（0.1764 元/小时）\n- \n\n内存单价（GiB）： 0.00000613 元/秒（0.0221 元/小时）\n\n重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看详情，通过k8s.aliyun.com/eci-instance-compute-category字段确认ECI Pod实际使用的算力类别。计费会按照对应类别的规格单价计算。\n## 使用限制\n\n指定算力类别功能具有以下限制：\n\n- \n\n仅适用于指定vCPU和内存创建ECI实例。\n\n如果指定了ECS规格，则优先会采用指定的ECS规格，即无法指定算力类别。\n- \n\n不支持抢占式实例功能。\n\n如果同时配置了抢占式实例和指定算力类别的Annotation，系统会报错（错误码为FeatureBasedConstraintConflict）。\n- \n\n不支持ARM架构的规格。\n\n如果将ECI Pod调度到ARM架构节点的同时，配置了指定算力类别的Annotation，系统会报错（错误码为FeatureBasedConstraintConflict）。\n- \n\n不支持与以下功能同时使用：\n\n- \n\n指定或排除ECS规格族\n- \n\n指定或排除ECS规格代数\n\n## 配置说明\n\n指定vCPU和内存创建ECI Pod时，支持以下两种方式：\n\n- \n\n指定Pod内容器的vCPU和内存：通过定义Containers的limits或requests来指定，建议使用limits。\n- \n\n指定Pod级别的vCPU和内存：通过在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n说明 \n\n如果没有指定，或者同时设置了limits、requests和k8s.aliyun.com/eci-use-specs，实际生效情况请参见[配置说明](https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod-1#9a30b29038a30)。\n\n在指定vCPU和内存的基础上，您可以在Pod metadata中添加Annotation来指定算力类别，对应Anotation为k8s.aliyun.com/eci-compute-category，配置说明如下：\n\n- \n\n取值为economy（表示经济型）和general（表示通用型）。\n- \n\n支持设置多个算力类别，系统会按照设置顺序创建。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 生效规则\n\n开通指定算力类别功能后，根据创建ECI Pod时设置的条件，实际创建的ECI Pod所使用的规格和算力类别按以下规则生效：重要 \n\nECI Pod创建成功后，您可以执行kubectl describe pod命令查看详情，通过k8s.aliyun.com/eci-instance-compute-category字段确认ECI Pod实际使用的算力类别。计费会按照对应类别的规格单价计算。\n\n[表格]\n\n创建ECI实例时设置的条件\n\n实际生效情况\n\n未指定vCPU和内存，但指定了算力类别。\n\n创建2 vCPU，4 GiB内存的实例，算力类别为指定的类别。\n\n指定了vCPU和内存，且指定了算力类别，两者组合后符合ECI的规格要求。\n\n按照指定的条件创建实例。\n\n指定的vCPU小于1 vCPU，但指定算力类别为通用型。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-compute-category-to-create-an-instance", "page_type": "doc", "title": "指定算力类别创建实例", "keywords": "指定算力类别创建ECI,选择ECI算力类别,了解ECI算力类别,ECI算力类别规格,ECI算力类别计费,ECI算力类别配置", "last_modified_ms": 1720062993000, "last_modified_iso": "2024-07-04T11:16:33+08:00", "excerpt": "大部分场景下，如果没有特殊的规格需求（如GPU、本地盘等），推荐您指定vCPU和内存来创建ECI实例。在此基础上，您可以进一步指定算力类别。例如：对于0.25~8 vCPU的规格需求，在轻量型应用等入门场景，您可以选择经济型规格来满足降低成本的需求；对于1 vCPU及以上的规格需求，如果性能需求较高，则可以选择通用型规格。\n## 算力类别说明\n\n为了更好地满足低成本或性能稳定的需求，ECI推出了指定算力类别功能。当您采用指定vCPU和内存方式创建ECI实例时，ECI会将底层规格分为经济型和通用型两个算力类别。您可以按需选择，系统会从对应类别的底层规格中自动选择合适的规格。\n\n- \n\n经济型（economy）\n\n支持的vCPU范围为0.25~8 vCPU，规格单价相比通用型更低。\n- \n\n通用型（general）\n\n支持的vCPU范围为1~64 vCPU，规格单价与未开通指定算力类别时的ECI规格定价一致。在相同vCPU和内存条件下，通用型规格的性能更优。\n\n## 如何选择算力类别\n\n您可以根据业务情况，以及对低成本、性能稳定或高可用等需求，来选择合适的算力类别。建议如下：\n\n- \n\n对于轻量型应用等入门场景，可以选择经济型规格来降低资源成本。\n- \n\n对于性能需求较高的业务场景，可以选择通用型规格，该类别规格性能更优，并且与未指定算力类别相比，性能表现更稳定。\n- \n\n为了避免库存不足的情况，如果您的业务对性能波动有一定的容忍，可以指定多个算力类别来保证高可用。\n\n## 规格说明\n\nECI支持的经济型和通用型的详细规格如下：说明 \n\n各规格支持的临时存储空间大小默认均为30 GiB。\n## 经济型规格\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.08\n\n2\n\n1、2、4、8、16\n\n0.2\n\n4\n\n2、4、8、16、32\n\n0.4\n\n8\n\n4、8、16、32、64\n\n0.8\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n2\n\n6、10、12、14\n\n0.2\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n0.4\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n0.8\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n0.8\n## 通用型规格\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n1\n\n2、4、8\n\n1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络基准带宽能力（出+入）（Gbit/s）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n## 计费说明重要 \n\n经济型规格和通用型规格目前处于公测中。\n\n- \n\n经济型规格\n\n相比于未指定算力类别时的规格，经济型规格的内存单价与之前一致，vCPU单价更低。\n\n- \n\nvCPU单价（vCPU）：0.000027 元/秒（0.0972 元/小时）\n- \n\n内存单价（GiB）： 0.00000613 元/秒（0.0221 元/小时）\n\n- \n\n通用型规格\n\n与未开通指定算力类别时的ECI规格定价一致。\n\n- \n\nvCPU单价（vCPU）：0.000049 元/秒（0.1764 元/小时）\n- \n\n内存单价（GiB）： 0.00000613 元/秒（0.0221 元/小时）\n\n重要 \n\nECI实例创建成功后，您可以调用[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)接口查询实例详情，通过返回的ComputeCategory参数确认ECI实例实际使用的算力类别。计费会按照对应类别的规格单价计算。\n## 使用限制\n\n指定算力类别功能具有以下限制：\n\n- \n\n仅适用于指定vCPU和内存创建ECI实例。\n\n如果指定了ECS规格，则优先会采用指定的ECS规格，即无法指定算力类别。\n- \n\n不支持抢占式实例功能。\n\n如果同时配置了抢占式实例和指定算力类别，系统会报错（错误码为FeatureBasedConstraintConflict）。\n- \n\n不支持ARM架构的规格。\n\n如果同时配置了指定ARM架构和指定算力类别，系统会报错（错误码为FeatureBasedConstraintConflict）。\n\n## 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，在设置vCPU和内存的基础上，您可以通过ComputeCategory参数来指定算力类别。\n\n指定vCPU和内存可以通过以下几种方式：\n\n- \n\n方式一：仅指定容器级别vCPU和内存，系统自动汇总到实例级别。\n- \n\n方式二：指定实例级别vCPU和内存，按需设置容器级别vCPU和内存。\n- \n\n方式三：通过InstanceType参数设置实例级别vCPU和内存。\n\n相关参数如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nCpu\n\nnumber\n\n2.0\n\n实例级别vCPU大小。单位：核。\n\nMemory\n\nnumber\n\n4.0\n\n实例级别内存大小。单位：GiB。\n\nContainer.N.Cpu\n\nnumber\n\n0.5\n\n容器的vCPU大小。单位：核。\n\nContainer.N.Memory\n\nnumber\n\n1.0\n\n容器的内存大小。单位：GiB。\n\nInstanceType\n\nString\n\n2-4Gi\n\n指定实例规格。\n\n- \n\n支持指定多个规格（单次最多5个），各规格之间用半角逗号（,）进行分隔。\n- \n\n可以指定vCPU和内存规格，也可以指定ECS规格。本文介绍的指定算力类别功能仅适用于指定vCPU和内存规格。\n\nComputeCategory\n\nstring[]\n\neconomy\n\n指定算力类别。取值范围：\n\n- \n\neconomy：经济型\n- \n\ngeneral：通用型\n\n支持设置多个算力类别，系统会按照设置顺序创建。\n## 生效规则\n\n开通指定算力类别功能后，根据创建ECI实例时设置的条件，实际创建的ECI实例所使用的规格和算力类别按以下规则生效：重要 \n\nECI实例创建成功后，您可以调用[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)接口查询实例详情，通过返回的ComputeCategory参数确认ECI实例实际使用的算力类别。计费会按照对应类别的规格单价计算。\n\n[表格]\n\n创建ECI实例时设置的条件\n\n实际生效情况\n\n未指定vCPU和内存，但指定了算力类别。\n\n创建2 vCPU，4 G"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod", "page_type": "doc", "title": "指定vCPU和内存创建Pod", "keywords": "为ECI Pod指定vCPU内存,了解ECI Pod资源配置,ECI Pod资源配置方法,ECI Pod规格说明,ECI Pod资源规整规则", "last_modified_ms": 1717148156000, "last_modified_iso": "2024-05-31T17:35:56+08:00", "excerpt": "大部分场景下，如果没有特殊的规格需求（如GPU、本地盘等），推荐您指定vCPU和内存来创建ECI Pod（即ECI实例），系统会尝试使用多种ECS规格进行支撑，以提供比ECS单规格更好的弹性和资源供应能力。\n## 规格说明\n\n您可以指定实例或者容器的vCPU和内存来创建ECI实例。如果指定的vCPU和内存不符合要求，系统将自动按照ECI支持的规格进行规整。规整时将向最接近的ECI规格进行规整，同时需满足指定的vCPU和内存≤ECI规格的vCPU和内存。例如：在华东1（杭州）地域创建ECI实例时，声明了7 vCPU，13 GiB内存，则实际创建的ECI实例为8 vCPU，14 GiB内存。\n\nECI支持的规格如下：说明 \n\n- \n\n如果未指定vCPU和内存规格，系统默认采用2 vCPU和4 GiB内存的规格创建ECI实例。\n- \n\n目前仅支持一块弹性网卡，暂不支持多网卡能力。\n- \n\n各规格支持的默认临时存储空间大小均为30 GiB。\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n## 配置说明\n\n指定vCPU和内存创建ECI Pod时，支持以下两种：\n\n- \n\n指定Pod内容器的vCPU和内存：通过定义Containers的limits或requests来指定，建议使用limits。\n- \n\n指定Pod级别的vCPU和内存：通过在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n\n如果您没有指定，或者同时指定了limits、requests和eci-use-specs，实际生效情况如下：\n\n[表格]\n\n场景\n\nPod规格\n\n全部未指定\n\n按默认规格（2vCPU，4 GiB内存）\n\n仅指定limits\n\n汇总limits\n\n仅指定requests\n\n汇总requests\n\n同时指定limits和requests\n\n汇总limits（忽略requests）\n\n仅指定eci-use-specs\n\n按eci-use-specs的值\n\n指定limits或requests的同时指定eci-use-specs\n\n按eci-use-specs的值说明 \n\n如果汇总limits、requests后的规格，或者eci-use-specs指定的规格不满足ECI规格要求，系统会自动进行资源规整，并按规整后的规格进行计费。\n## 指定Pod内容器的vCPU和内存\n\n该方式为Kubernetes默认方式。每个ECI Pod最多可以支持20个容器，每个容器的vCPU和内存规格可以自定义配置，但汇总到Pod级别时需满足ECI Pod的vCPU和内存约束。说明 \n\nECI支持为特定容器（例如Sidecar容器）设置环境变量，实现在资源规整时忽略该容器，避免资源浪费。更多信息，请参见[配置资源规整时忽略特定容器](https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-when-the-system-adjusts-resources-1#04377f8021wis)。\n\n您可以直接定义Container的limits来指定该容器的vCPU和内存。配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: \"500m\"      #指定nginx容器的vCPU为0.5 vCPU\n            memory: \"1024Mi\"   #指定nginx容器的内存为1 GiB\n      - name: busybox\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n        command: [\"sleep\"]\n        args: [\"999999\"]\n        resources:\n          limits:\n            cpu: \"1000m\"   #指定busybox容器的vCPU为1 vCPU\n            memory: \"2048Mi\"  #指定busybox容器的内存为2 GiB\n\n\n## 指定ECI Pod的vCPU和内存\n\n该方式下，系统会尝试使用多种ECS规格进行支撑，以实现更好的弹性和资源供应能力。说明 \n\n如果您对规格有一定要求，例如只想使用6代ECS规格，可添加Annotation来指定ECS规格代数。更多信息，请参见[指定ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod)。\n\n该方式还具备以下优势：\n\n- \n\nPod内容器可以不用指定vCPU和内存规格或者限制资源上限，各容器可以更大程度地共享资源。\n- \n\n在基因计算和Istio场景下，业务框架会自动为Pod添加Sidecar容器，通过指定Pod级别规格，ECI可以无缝对接这类业务框架。\n\n您可以在Pod metadata中添加Annotation来指定Pod的vCPU和内存，配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs : \"2-4Gi\"   #指定ECI Pod的vCPU为2 vCPU，内存为4 GiB\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n      - name: busybox\n        image: re"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-a-pod-1", "page_type": "doc", "title": "指定vCPU和内存创建Pod", "keywords": "创建指定规格ECI Pod,了解ECI Pod规格,ECI Pod资源配置,ECI Pod规格列表", "last_modified_ms": 1717148091000, "last_modified_iso": "2024-05-31T17:34:51+08:00", "excerpt": "大部分场景下，如果没有特殊的规格需求（如GPU、本地盘等），推荐您指定vCPU和内存来创建ECI Pod（即ECI实例），系统会尝试使用多种ECS规格进行支撑，以提供比ECS单规格更好的弹性和资源供应能力。\n## 规格说明\n\n您可以指定实例或者容器的vCPU和内存来创建ECI实例。如果指定的vCPU和内存不符合要求，系统将自动按照ECI支持的规格进行规整。规整时将向最接近的ECI规格进行规整，同时需满足指定的vCPU和内存≤ECI规格的vCPU和内存。例如：在华东1（杭州）地域创建ECI实例时，声明了7 vCPU，13 GiB内存，则实际创建的ECI实例为8 vCPU，14 GiB内存。\n\nECI支持的规格如下：说明 \n\n- \n\n如果未指定vCPU和内存规格，系统默认采用2 vCPU和4 GiB内存的规格创建ECI实例。\n- \n\n目前仅支持一块弹性网卡，暂不支持多网卡能力。\n- \n\n各规格支持的默认临时存储空间大小均为30 GiB。\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n## 配置说明\n\n指定vCPU和内存创建ECI Pod时，支持以下两种：\n\n- \n\n指定Pod内容器的vCPU和内存：通过定义Containers的limits或requests来指定，建议使用limits。\n- \n\n指定Pod级别的vCPU和内存：通过在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定。\n\n如果您没有指定，或者同时指定了limits、requests和eci-use-specs，实际生效情况如下：\n\n[表格]\n\n场景\n\nPod规格\n\n全部未指定\n\n按默认规格（2vCPU，4 GiB内存）\n\n仅指定limits\n\n汇总limits\n\n仅指定requests\n\n汇总requests\n\n同时指定limits和requests\n\n汇总limits（忽略requests）\n\n仅指定eci-use-specs\n\n按eci-use-specs的值\n\n指定limits或requests的同时指定eci-use-specs\n\n按eci-use-specs的值说明 \n\n如果汇总limits、requests后的规格，或者eci-use-specs指定的规格不满足ECI规格要求，系统会自动进行资源规整，并按规整后的规格进行计费。\n## 指定Pod内容器的vCPU和内存\n\n该方式为Kubernetes默认方式。每个ECI Pod最多可以支持20个容器，每个容器的vCPU和内存规格可以自定义配置，但汇总到Pod级别时需满足ECI Pod的vCPU和内存约束。说明 \n\nECI支持为特定容器（例如Sidecar容器）设置环境变量，实现在资源规整时忽略该容器，避免资源浪费。更多信息，请参见[配置资源规整时忽略特定容器](https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-when-the-system-adjusts-resources-1#04377f8021wis)。\n\n您可以直接定义Container的limits来指定该容器的vCPU和内存。配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: \"500m\"      #指定nginx容器的vCPU为0.5 vCPU\n            memory: \"1024Mi\"   #指定nginx容器的内存为1 GiB\n      - name: busybox\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n        command: [\"sleep\"]\n        args: [\"999999\"]\n        resources:\n          limits:\n            cpu: \"1000m\"   #指定busybox容器的vCPU为1 vCPU\n            memory: \"2048Mi\"  #指定busybox容器的内存为2 GiB\n\n\n## 指定ECI Pod的vCPU和内存\n\n该方式下，系统会尝试使用多种ECS规格进行支撑，以实现更好的弹性和资源供应能力。说明 \n\n如果您对规格有一定要求，例如只想使用6代ECS规格，可添加Annotation来指定ECS规格代数。更多信息，请参见[指定ECS规格代数创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-or-exclude-specific-generations-of-ecs-instance-families-to-create-a-pod)。\n\n该方式还具备以下优势：\n\n- \n\nPod内容器可以不用指定vCPU和内存规格或者限制资源上限，各容器可以更大程度地共享资源。\n- \n\n在基因计算和Istio场景下，业务框架会自动为Pod添加Sidecar容器，通过指定Pod级别规格，ECI可以无缝对接这类业务框架。\n\n您可以在Pod metadata中添加Annotation来指定Pod的vCPU和内存，配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs : \"2-4Gi\"   #指定ECI Pod的vCPU为2 vCPU，内存为4 GiB\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n      - name: busybox\n        image: re"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-number-of-vcpus-and-memory-size-to-create-an-elastic-container-instance", "page_type": "doc", "title": "指定vCPU和内存创建实例", "keywords": "指定vCPU内存创建ECI,查询ECI实例规格,ECI实例规格,ECI实例创建方法,ECI vCPU内存规整", "last_modified_ms": 1717147702000, "last_modified_iso": "2024-05-31T17:28:22+08:00", "excerpt": "大部分场景下，如果没有特殊的规格需求（如GPU、本地盘等），推荐您指定vCPU和内存来创建ECI实例，系统会尝试使用多种ECS规格进行支撑，以提供比ECS单规格更好的弹性和资源供应能力。\n## 规格说明\n\n您可以指定实例或者容器的vCPU和内存来创建ECI实例。如果指定的vCPU和内存不符合要求，系统将自动按照ECI支持的规格进行规整。规整时将向最接近的ECI规格进行规整，同时需满足指定的vCPU和内存≤ECI规格的vCPU和内存。例如：在华东1（杭州）地域创建ECI实例时，声明了7 vCPU，13 GiB内存，则实际创建的ECI实例为8 vCPU，14 GiB内存。\n\nECI支持的规格如下：说明 \n\n- \n\n如果未指定vCPU和内存规格，系统默认采用2 vCPU和4 GiB内存的规格创建ECI实例。\n- \n\n目前仅支持一块弹性网卡，暂不支持多网卡能力。\n- \n\n各规格支持的默认临时存储空间大小均为30 GiB。\n\n所有ECI支持地域均支持的规格\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n0.25\n\n0.5、1\n\n0.08\n\n0.5\n\n1、2\n\n0.08\n\n1\n\n2、4、8\n\n0.1\n\n2\n\n1、2、4、8、16\n\n1\n\n4\n\n2、4、8、16、32\n\n1.5\n\n8\n\n4、8、16、32、64\n\n2\n\n12\n\n12、24、48、96\n\n2.5\n\n16\n\n16、32、64 、128\n\n3\n\n24\n\n24、48、96、192\n\n4.5\n\n32\n\n32、64、128、256\n\n6\n\n52\n\n96、192、384\n\n12.5\n\n64\n\n128、256、512\n\n20\n\n仅部分地域支持的规格重要 \n\n- \n\n下表中的规格仅在部分地域支持，创建以下规格的ECI实例时请确保已指定支持的地域和可用区，否则会因为无库存而导致创建失败。\n\n支持的地域为：华东1（杭州）、华东2（上海）、华北1（青岛）、华北2（北京）、华北3（张家口）、华北5（呼和浩特）、华北6（乌兰察布）、华南1（深圳）、华南2（河源）、华南3（广州）、西南1（成都）、新加坡。\n- \n\n不支持指定下表中的规格创建抢占式实例。\n\n[表格]\n\nvCPU\n\n内存（GiB）\n\n网络带宽能力（出+入）（Gbit/s）（理论上限值）\n\n2\n\n6、10、12、14\n\n1\n\n4\n\n6、10、12、14、18、20、22、24、26、28、30\n\n1.5\n\n6\n\n6、8、10、12、14、16、18、20、22、24、26、28、30、32、34、36、38、40、42、44、46、48\n\n1.5\n\n8\n\n10、12、14、18、20、22、24、26、28、30、34、36、38、40、42、44、46、48、50、52、54、56、58、60、62\n\n2.5\n## 指定实例内容器的vCPU和内存\n\n每个ECI实例最多支持20个容器，每个容器的vCPU和内存规格可以自定义配置，但汇总到实例级别时需满足ECI实例的vCPU和内存约束。对于不满足的情况，系统会进行自动规整，并按规整后的规格进行计费。说明 \n\nECI支持为特定容器（例如Sidecar容器）设置环境变量，实现在资源规整时忽略该容器，避免资源浪费。更多信息，请参见[配置资源规整忽略特定容器](https://help.aliyun.com/zh/eci/user-guide/ignore-specific-containers-during-resource-adjustment#topic-2241520)。\n#### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Container.N.Cpu和Container.N.Memory来指定容器的vCPU和内存，相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.Cpu\n\nnumber\n\n2\n\n容器的vCPU大小。单位：核。N表示第几个容器，最多20个。\n\nContainer.N.Memory\n\nnumber\n\n4\n\n容器的内存大小。单位：GiB。N表示第几个容器，最多20个。\n#### 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建ECI实例时，您可以在各个容器的高级配置中设置vCPU和内存。各容器的vCPU和内存汇总后，不能超过实例（即容器组）的vCPU和内存设置。\n\n## 指定实例的vCPU和内存\n\n该方式下，系统将根据指定的ECI实例的vCPU和内存，直接尝试使用多种ECS规格进行支撑，以实现更好的弹性和资源供应能力。该方式还具备以下优势：\n\n- \n\n实例内容器可以不用指定vCPU和内存规格或者限制资源上限，各容器可以更大程度地共享申请的资源。\n- \n\n在基因计算和Istio场景下，业务框架会自动给Pod添加Sidecar容器，通过显式指定ECI实例规格，ECI可以无缝对接这类业务框架。\n说明 \n\n控制台不支持部分规格，对于ECI支持的规格，如果无法在控制台选择，请采用OpenAPI方式。\n#### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Cpu和Memory来指定实例的vCPU和内存，相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nCpu\n\nnumber\n\n2\n\n实例级别vCPU大小。单位：核。\n\nMemory\n\nnumber\n\n4\n\n实例级别内存大小。单位：GiB。\n#### 控制台\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建ECI实例时，您可以在容器组配置区域的基础模式页签下，直接选择实例（即容器组）的vCPU和内存。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-private-ip-address-of-the-eci-instance", "page_type": "doc", "title": "指定ECI实例的私网IP地址", "keywords": "指定ECI实例私网IP,ECI实例IP指定方法,ECI实例IP使用限制", "last_modified_ms": 1691718833000, "last_modified_iso": "2023-08-11T09:53:53+08:00", "excerpt": "某些业务场景下，可能需要某一业务实例使用某个固定的IP地址。本文介绍在创建ECI实例时，如何指定实例的私网IP地址。\n## 功能说明\n\n默认情况下，创建ECI实例时，系统会从配置的交换机网段中，随机为实例分配一个私网IP地址。某些业务场景下，您可能想要指定实例的私网IP地址。例如迁移业务时，在删除了旧的ECI实例后，可以为新创建的ECI实例指定使用旧实例对应的IP地址，以此来保证业务连续性。\n## 使用限制\n\n指定私网IP地址功能仅支持IPv4地址，不支持IPv6地址。\n## 配置说明\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过PrivateIpAddress参数指定实例的私网IP地址。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nVSwitchId\n\nString\n\nvsw-bp1gds63lmlm7ib05****\n\n实例所属的交换机。\n\n指定私网IP地址的场景下，必须要指定交换机。\n\nSecurityGroupId\n\nString\n\nsg-bp1daxpbz9lzpvvc****\n\n实例所属的安全组。\n\n指定交换机的情况下，必须要指定安全组。\n\nPrivateIpAddress\n\nstring\n\n172.16.0.1\n\n指定交换机网段下某一私网IP地址。请确保该IP地址没有被占用。\n## 配置示例\n\n- \n\n指定私网IP地址创建一台ECI实例。\n\n调用[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)接口创建ECI实例所采用的参数示例如下：\n\n{\n  \"RegionId\": \"cn-beijing\",\n  \"SecurityGroupId\": \"sg-2ze1pjtsbqcuykpp****\",\n  \"VSwitchId\": \"vsw-2ze94pjtfuj9vaymf****\",\n  \"PrivateIpAddress\": \"172.16.0.1\",\n  \"ContainerGroupName\": \"test\",\n  \"Container\": [\n    {\n      \"Name\": \"nginx\",\n      \"Image\": \"registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\"\n    }\n  ]\n}\n\n\n- \n\n确认实例的私网IP地址。\n\n您可以根据返回的实例ID调用[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)接口查询获取实例的私网IP地址（IntranetIp字段），也可以直接在控制台查看。\n\n示例如下：\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-the-private-ip-address-of-the-eci-pod", "page_type": "doc", "title": "指定ECI Pod的私网IP地址", "keywords": "指定ECI Pod私网IP,配置ECI Pod固定IP,ECI Pod私网IP配置,ECI Pod IP Annotation", "last_modified_ms": 1693879211000, "last_modified_iso": "2023-09-05T10:00:11+08:00", "excerpt": "某些业务场景下，可能需要某一业务Pod使用某个固定的IP地址。本文介绍在创建ECI Pod时，如何指定Pod的私网IP地址。\n## 功能说明\n\n默认情况下，创建ECI Pod时，系统会从eci-profile中配置的交换机网段中，随机为Pod分配一个私网IP地址。某些业务场景下，您可能想要指定Pod的私网IP地址。例如迁移业务时，在删除了旧的Pod后，可以为新创建的Pod指定使用旧Pod对应的IP地址，以此来保证业务连续性。说明 \n\n关于如何为集群或者Pod配置交换机，请参见[多可用区创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-in-multiple-zones)。\n## 使用限制\n\n指定私网IP地址功能仅支持IPv4地址，不支持IPv6地址。\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-private-ip-address的Annotation来指定ECI Pod的私网IP地址。相关注意事项如下：\n\n- \n\n指定的IP地址必须属于eci-profile中vSwitchIds字段对应交换机的网段。请确保该IP地址没有被占用。\n- \n\n不支持指定多个IP地址，即创建Deployment等资源时，如果添加了该Annotation，只允许1个副本。如果配置了多个副本，只会成功1个Pod，其他Pod会因无法分配IP地址而创建失败。\n\n## 配置示例\n\n- \n\n创建一个指定私网IP地址的Pod。\n\nkubectl create -f private-ip-test.yaml\n\n\nprivate-ip-test.yaml的内容示例如下：\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: private-ip-test\n  labels:\n    alibabacloud.com/eci: \"true\"\n  annotations:\n    k8s.aliyun.com/eci-private-ip-address: \"172.16.0.11\"    #指定私网IP地址\nspec:\n  containers:\n  - image: registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n    name: test-container\n\n\n- \n\n确认Pod的私网IP地址。\n\nkubectl get pod private-ip-test -o wide\n\n\n返回示例如下，可以看到系统已为Pod分配指定的私网IP地址。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-time-zone", "page_type": "doc", "title": "设置容器时区", "keywords": "设置容器时区,容器时区配置方法,ECI容器时区配置", "last_modified_ms": 1710813324000, "last_modified_iso": "2024-03-19T09:55:24+08:00", "excerpt": "本文介绍如何为容器配置时区，以此来保证容器中的时间与所处环境的时间一致，避免时区错误导致的时间一致性和准确性等问题。\n## 配置示例\n\n- \n\n创建一个ConfigMap，导入您需要指定的时区。\n\n以下为命令示例，其他时区请使用/usr/share/zoneinfo/目录下对应的文件。\n\nkubectl create configmap tz --from-file=/usr/share/zoneinfo/Asia/Shanghai\n\n\n- \n\n创建配置时区的应用。\n\nkubectl apply -f set-timezone.yaml\n\n\nset-timezone.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: timezone\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: timezone\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: timezone\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        volumeMounts:\n          - name: tz\n            mountPath: /etc/localtime   # 挂载路径\n            subPath: Shanghai       # 请根据您的ConfigMap替换\n      volumes:\n        - name: tz\n          configMap:   # 挂载ConfigMap\n            name: tz  \n\n\n## 验证结果\n\n登录到容器，验证时区是否设置成功。\n\n- \n\n获取Pod信息。\n\nkubectl get pod\n\n\n返回示例如下：\n\nNAME                        READY   STATUS    RESTARTS   AGE\ntimezone-77cc64c57d-h59n8   1/1     Running   0          6\n\n\n- \n\n进入容器。\n\n命令如下，请根据实际Pod名称替换<pod-name>。\n\nkubectl exec -it <pod-name> -- sh\n\n\n- \n\n查询容器的时区。\n\ndate -R\n\n\n如果返回的时间与设置的时区信息对应，则表示设置成功。返回示例如下：\n\nMon, 19 Feb 2024 17:24:00 +0800\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specify-time-zone-2", "page_type": "doc", "title": "设置容器时区", "keywords": "设置容器时区,容器时区配置,ECI容器时区配置", "last_modified_ms": 1710813369000, "last_modified_iso": "2024-03-19T09:56:09+08:00", "excerpt": "本文介绍如何为容器配置时区，以此来保证容器中的时间与所处环境的时间一致，避免时区错误导致的时间一致性和准确性等问题。\n## 配置示例\n\n- \n\n创建一个ConfigMap，导入您需要指定的时区。\n\n以下为命令示例，其他时区请使用/usr/share/zoneinfo/目录下对应的文件。\n\nkubectl create configmap tz --from-file=/usr/share/zoneinfo/Asia/Shanghai\n\n\n- \n\n创建配置时区的应用。\n\nkubectl apply -f set-timezone.yaml\n\n\nset-timezone.yaml的内容示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: timezone\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: timezone\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: timezone\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        volumeMounts:\n          - name: tz\n            mountPath: /etc/localtime   # 挂载路径\n            subPath: Shanghai       # 请根据您的ConfigMap替换\n      volumes:\n        - name: tz\n          configMap:   # 挂载ConfigMap\n            name: tz  \n\n\n## 验证结果\n\n登录到容器，验证时区是否设置成功。\n\n- \n\n获取Pod信息。\n\nkubectl get pod\n\n\n返回示例如下：\n\nNAME                        READY   STATUS    RESTARTS   AGE\ntimezone-77cc64c57d-h59n8   1/1     Running   0          6\n\n\n- \n\n进入容器。\n\n命令如下，请根据实际Pod名称替换<pod-name>。\n\nkubectl exec -it <pod-name> -- sh\n\n\n- \n\n查询容器的时区。\n\ndate -R\n\n\n如果返回的时间与设置的时区信息对应，则表示设置成功。返回示例如下：\n\nMon, 19 Feb 2024 17:24:00 +0800\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specifying-the-x86-specification-to-create-a-pod", "page_type": "doc", "title": "指定x86规格创建Pod", "keywords": "为Pod指定x86规格,查询x86规格列表,x86规格配置方法,x86规格列表", "last_modified_ms": 1766113149000, "last_modified_iso": "2025-12-19T10:59:09+08:00", "excerpt": "本文介绍如何指定ECS x86规格创建一个ECI Pod。\n## 规格说明\n\n根据是否适合企业场景，x86架构规格可以分为企业级和共享型：\n\n企业级x86计算规格族\n\nx86规格基于x86架构，每一个vCPU都对应一个处理器核心的超线程，具有性能稳定的特点，适用于各种类型和规模的企业级应用、数据库系统、视频编解码、数据分析等场景。\n\n[表格]\n\n规格类型\n\n企业级x86规格族\n\n通用型\n\ng9ae、g9a、g9i、g8a、g8i、g7a、g7、g6e、g6a、g6、g5、sn2ne\n\n计算型\n\nc9ae、c9a、c9i、c8a、c8i、c7a、c7、c6e、c6a、c6、c5、sn1ne\n\n内存型\n\nr9ae、r9a、r9i、r8a、r8i、r7a、r7、r6e、r6a、r6、r5、se1ne、se1\n\n通用算力型\n\nu2a、u2i、u1\n\n密集计算型\n\nic5\n\n高主频\n\n- \n\nhfg8i、hfg7、hfg6、hfg5\n- \n\nhfc8i、hfc7、hfc6、hfc5\n- \n\nhfr8i、hfr7\n\n大数据\n\nd1、d1ne\n\n本地SSD型\n\ni2、i2g\n\n内存增强型\n\nre6\n\n共享型x86计算规格族\n\n共享型规格主要面向一般中小网站或个人开发。与企业级规格相比，共享型规格在资源利用上更多强调资源性能的共享，所以无法保证实例计算性能的稳定，但是成本相对来说更低。\n\n[表格]\n\n规格类型\n\n共享型x86规格族\n\n经济型\n\ne说明 \n\n上述规格族部分带有本地盘（如i2、d1ne等），如果需要挂载本地盘，请配置Volume。具体操作，请参见[指定本地盘规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-specifications-of-a-local-disk)。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定ECS规格。YAML示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.c6.large,ecs.c5.large  # 根据需要指定ECS规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/specifying-the-x86-specification-to-create-a-pod-1", "page_type": "doc", "title": "指定x86规格创建Pod", "keywords": "创建x86规格ECI Pod,查询可用x86规格,ECI Pod的x86规格配置,x86规格分类与列表", "last_modified_ms": 1743158681000, "last_modified_iso": "2025-03-28T18:44:41+08:00", "excerpt": "本文介绍如何指定ECS x86规格创建一个ECI Pod。\n## 规格说明\n\n根据是否适合企业场景，x86架构规格可以分为企业级和共享型：\n\n企业级x86计算规格族\n\nx86规格基于x86架构，每一个vCPU都对应一个处理器核心的超线程，具有性能稳定的特点，适用于各种类型和规模的企业级应用、数据库系统、视频编解码、数据分析等场景。\n\n[表格]\n\n规格类型\n\n企业级x86规格族\n\n通用型\n\ng8a、g8i、g7a、g7、g6e、g6a、g6、g5、sn2ne\n\n计算型\n\nc8a、c8i、c7a、c7、c6e、c6a、c6、c5、sn1ne\n\n内存型\n\nr8a、r8i、r7a、r7、r6e、r6a、r6、r5、se1ne、se1\n\n通用算力型\n\nu1\n\n密集计算型\n\nic5\n\n高主频\n\n- \n\nhfg8i、hfg7、hfg6、hfg5\n- \n\nhfc8i、hfc7、hfc6、hfc5\n- \n\nhfr8i、hfr7\n\n大数据\n\nd1、d1ne\n\n本地SSD型\n\ni2、i2g\n\n内存增强型\n\nre6\n\n共享型x86计算规格族\n\n共享型规格主要面向一般中小网站或个人开发。与企业级规格相比，共享型规格在资源利用上更多强调资源性能的共享，所以无法保证实例计算性能的稳定，但是成本相对来说更低。\n\n[表格]\n\n规格类型\n\n共享型x86规格族\n\n经济型\n\ne说明 \n\n上述规格族部分带有本地盘（如i2、d1ne等），如果需要挂载本地盘，请配置Volume。具体操作，请参见[指定本地盘规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-a-pod-by-specifying-the-specifications-of-a-local-disk)。\n\n关于ECS规格的详细信息，请参见：\n\n- \n\n[实例规格族](https://help.aliyun.com/zh/ecs/user-guide/overview-of-instance-families#concept-sx4-lxv-tdb)\n- \n\n[ECS实例规格定价](https://www.aliyun.com/price/product#/commodity/vm)\n- \n\n[ECS实例规格可购买地域总览](https://ecs-buy.aliyun.com/instanceTypes/#/instanceTypeByRegion)\n\n## 配置说明\n\n您可以在Pod metadata中添加k8s.aliyun.com/eci-use-specs的Annotation来指定ECS规格。YAML示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.c6.large,ecs.c5.large  # 根据需要指定ECS规格，单次最多5个。\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/update-the-image-of-an-elastic-container-instance-while-keeping-the-ip-address-of-the-instance-unchanged", "page_type": "doc", "title": "修改ECI实例的镜像并保持IP不变", "keywords": "修改ECI实例镜像,保持ECI实例IP,ECI实例镜像修改,ECI实例IP不变", "last_modified_ms": 1704965129000, "last_modified_iso": "2024-01-11T17:25:29+08:00", "excerpt": "在应用迭代过程中，因为解决bug或者增加功能特性而制作新的镜像后，您可能需要修改镜像，同时为了不影响业务，需要保持ECI实例的IP不变。本文介绍如何修改ECI实例的容器镜像，同时保持实例IP不变。\n## 前提条件\n\n已准备好要更新的镜像，且已将镜像上传到镜像仓库中。\n## 操作步骤\n\n下文以部署Nginx的ECI实例为例，介绍如何更新容器镜像，将容器镜像从nginx:1.14.2修改为nginx:1.15.10，并保持ECI实例的IP不变。说明 \n\n以下操作步骤以OpenAPI为例进行介绍，如果您使用控制台进行操作，可在容器组页面找到目标ECI实例，单击对应操作列中的修改，即可在弹出页面配置新的容器镜像。\n\n- \n\n创建ECI实例。\n\n调用CreateContainerGroup接口创建一台ECI实例，采用的参数示例如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\nContainerGroupName=test\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\n\n\n接口调用成功将返回ECI实例ID。\n- \n\n查询ECI实例信息。\n\n根据创建完成返回的ECI实例ID，调用DescribeContainerGroups接口查询实例信息。更多信息，请参见[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)。\n\n返回示例如下，当实例状态为Running时，表示实例创建成功，此时可以获取到ECI实例的IP（IntranetIp）。\n\n{\n  \"TotalCount\": 1,\n  \"NextToken\": \"\",\n  \"RequestId\": \"869A3D4B-EDC7-5716-BF53-2396028FAC5A\",\n  \"ContainerGroups\": [\n    {\n      \"Cpu\": 2,  \n      \"Memory\": 4,\n      \"Containers\": [\n        {\n          ......\n          \"Image\": \"registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.14.2\",\n          ......\n        }\n      ],\n      \"IntranetIp\": \"172.16.52.122\",\n       ......\n      \"ContainerGroupId\": \"eci-bp1cug0yp63qnuag****\",\n      \"RegionId\": \"cn-hangzhou\"\n    }\n  ]\n}\n\n\n- \n\n更新容器镜像。\n\n调用UpdateContainerGroup即可更新实例，采用的参数示例如下，更多信息，请参见[UpdateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updatecontainergroup)。\n\nContainerGroupId=eci-bp1cug0yp63qnuag****\nContainer.1.Image=registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10\n\n\n- \n\n再次查询ECI实例信息。\n\n根据更新完成返回的ECI实例ID，调用DescribeContainerGroups接口查询实例信息。\n\n返回示例如下，当实例状态为Running时，表示实例更新成功，此时，可以看到容器镜像已更新，且实例IP保持不变。\n\n{\n  \"TotalCount\": 1,\n  \"NextToken\": \"\",\n  \"RequestId\": \"0FB8256B-EEB4-511C-98B8-B442163B7352\",\n  \"ContainerGroups\": [\n    {\n      \"Cpu\": 2,  \n      \"Memory\": 4,\n      \"Containers\": [\n        {\n          ......\n          \"Image\": \"registry-vpc.cn-hangzhou.aliyuncs.com/eci_open/nginx:1.15.10\",\n           ......\n        }\n      ],\n      \"IntranetIp\": \"172.16.52.122\",\n       ......\n      \"ContainerGroupId\": \"eci-bp1cug0yp63qnuag****\",\n      \"RegionId\": \"cn-hangzhou\"\n    }\n  ]\n}\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-alibaba-cloud-dns-privatezone-to-implement-service-discovery-in-ask-clusters", "page_type": "doc", "title": "基于云解析PrivateZone的服务发现", "keywords": "实现PrivateZone服务发现,配置PrivateZone服务发现,PrivateZone服务发现操作,ACK服务发现方案", "last_modified_ms": 1751360287000, "last_modified_iso": "2025-07-01T16:58:07+08:00", "excerpt": "如果您希望在自定义的一个或多个专有网络中将私有域名映射到IP资源地址，同时在其他网络环境中无法访问您的私有域名，可以使用云解析PrivateZone的服务发现功能。阿里云容器服务 Serverless 版支持的服务发现功能是基于阿里云专有网络VPC（Virtual Private Cloud）环境的私有域名解析和管理服务，目前支持Intranet service、Headless service、ClusterIP service。\n## 前提条件\n\n- \n\n已在[云解析DNS控制台](https://dns.console.aliyun.com/)中开通云解析PrivateZone。\n\n请选择合适的地域。PrivateZone目前未在中东东部1（迪拜）地域开服。\n- \n\n[已创建ACK Serverless集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/create-an-ask-cluster-2#task-e3c-311-ydb)，并确保已启用PrivateZone组件。\n\n- \n\n方式一：对于新建的ACK Serverless集群，您可以在创建集群时，指定PrivateZone作为DNS服务发现，启用PrivateZone组件。\n\n- \n\n方式二：对于已创建的ACK Serverless集群，您可以在eci-profile配置项中设置enablePrivateZone参数值为true，启用PrivateZone组件。\n\n- \n\n[已通过kubectl连接Kubernetes集群](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/connect-to-an-ack-cluster-by-using-kubectl#task-msl-bc1-ydb)。\n\n## 费用说明\n\nPrivateZone的收费规则，请参见[产品定价](https://help.aliyun.com/document_detail/71338.html)。\n## 操作步骤\n\n- \n\n部署Deployment和创建Service。\n\n样例模板如下所示，在YAML文件中复制如下的YAML代码，然后执行kubectl create -f nginx-service.yaml命令进行创建。\n\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-headless-service\nspec:\n  ports:\n  - port: 80\n    protocol: TCP\n  selector:\n    app: nginx\n  clusterIP: None\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-clusterip-service\nspec:\n  ports:\n  - port: 80\n    protocol: TCP\n  selector:\n    app: nginx\n  type: ClusterIP\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-intranet-service\n  annotations:\n    service.beta.kubernetes.io/alicloud-loadbalancer-address-type: intranet\nspec:\n  ports:\n  - port: 80\n    protocol: TCP\n  selector:\n    app: nginx\n  type: LoadBalancer\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image:  nginx:alpine\n        ports:\n        - containerPort: 80\n\n\n- \n\n执行以下命令，查看应用的运行状况。\n\nkubectl get svc,pod,deployment\n\n\n- \n\n登录到 [云解析DNS控制台](https://dc.console.aliyun.com/dns/)。\n- \n\n在左侧导航栏单击内网DNS解析（PrivateZone），在右上角选择管理配置模式，再单击内置权威，在此页签下单击用户域名。\n- \n\n在用户域名页签，单击目标域名操作列的解析记录。说明 \n\nZone里面的Record格式为$svc.$ns，对应相应的IP解析。解析规则如下： \n\n- \n\nLoadBalancer service：PrivateZone中只对应一条解析Record，为SLB IP。\n- \n\nClusterIP service：PrivateZone中只对应一条解析Record，为Cluster IP。\n- \n\nHeadless service：PrivateZone中对应多条解析Record，分别为后端Pod的IP。\n\n您可在该VPC网络环境中通过私有域名访问Service。 \n\n- \n\n长域名访问：$svc.$ns.svc.cluster.local.$clusterId，通过这种方式也可以访问其他集群中同步到PrivateZone的Service。\n- \n\n短域名访问：您可以通过$svc访问本Namespace下的Service，通过$svc.$ns访问其他Namespace中的Service。\n\n更多信息，请参见[serverless-k8s-examples](https://github.com/AliyunContainerService/serverless-k8s-examples)。\n\n## 相关文档\n\nACK Serverless集群除了可以选择PrivateZone，也可以选择CoreDNS作为DNS服务器（二者选其一即可）。具体操作，请参见[ACK Serverless集群中DNS域名解析原理](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/ask-service-discovery-and-dns#cfab95f017t2g)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-alibaba-cloud-storage-services-in-ack-and-ask", "page_type": "doc", "title": "使用云存储", "keywords": "为ACK挂载云存储,了解ACK云存储类型,ACK云存储概述,ACK云存储挂载,CSI存储插件", "last_modified_ms": 1693968801000, "last_modified_iso": "2023-09-06T10:53:21+08:00", "excerpt": "基于CSI插件，容器服务Kubernetes版支持使用云盘、文件存储NAS和对象存储OSS等阿里云存储服务。本文介绍云存储类型、存储插件和如何使用云存储。\n## 云存储介绍\n\n阿里云提供针对各种存储资源（块、文件和对象）的低成本、高可靠、高可用的存储服务，您可以根据业务负载的存储需求，考虑数据量、数据访问频率、IOPS和吞吐量等因素，来选择合适的云存储服务。常用的云存储服务如下：\n\n- \n\n云盘\n\n一种数据块级别的块存储产品，采用分布式多副本机制，具有低时延、高性能、持久性、高可靠等性能，可以随时创建、扩容以及释放。更多信息，请参见[云盘概述](https://help.aliyun.com/zh/ecs/user-guide/disks-2)。\n- \n\n文件存储NAS\n\n一种可共享访问、弹性扩展、高可靠以及高性能的分布式文件系统，支持NFS和SMB协议。更多信息，请参见[文件存储NAS概述](https://help.aliyun.com/zh/nas/product-overview/what-is-nas)。\n- \n\n对象存储OSS\n\n一个海量、安全、低成本、高可靠的存储空间，适合存储非结构化数据（如图片、音视频等）。更多信息，请参见[对象存储OSS概述](https://help.aliyun.com/zh/oss/user-guide/what-is-oss)。\n- \n\n文件存储CPFS\n\n阿里云完全托管、可扩展的并行文件存储系统，针对高性能计算场景的性能要求进行了深度优化，提供对数据毫秒级的访问和百万级IOPS的数据读写请求。更多信息，请参见[文件存储CPFS概述](https://help.aliyun.com/zh/cpfs/what-is-cpfs)。\n\n更多信息，请参见[阿里云存储服务](https://help.aliyun.com/document_detail/207150.html)。\n## 存储插件说明\n\n容器服务Kubernetes版支持CSI和FlexVolume两种存储插件，其中FlexVolume已经弃用。重要 \n\n在1.20版本之后的新建集群已不再支持Flexvolume插件，Flexvolume插件已弃用。更多信息，请参见[存储Flexvolume概述](https://help.aliyun.com/zh/ack/flexvolume-overview)。\n\nCSI是当前Kubernetes社区推荐的插件实现方案，阿里云提供的CSI插件主要包括以下几部分：\n\n- \n\nCSI-Plugin：实现数据卷的挂载、卸载功能。\n- \n\nCSI-Provisioner：实现数据卷的自动创建能力，目前支持云盘、NAS两种数据卷创建能力。\n\n## 挂载云存储\n\n[表格]\n\n云存储\n\n说明\n\nACK集群\n\nACK Serverless集群\n\n云盘\n\n- \n\n云盘为非共享存储，一个云盘只能挂载到一个Pod上。\n- \n\n挂载时，支持静态数据卷和动态数据卷。\n\n[云盘存储卷概述](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/disk-volume-overview-3/#task-l5p-qvs-vdb)\n\n[云盘存储卷概述](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/disk-volume-overview-1#task-l5p-qvs-vdb)\n\nNAS\n\n- \n\nNAS为共享存储，一个NAS文件系统可以挂载到多个Pod上。\n- \n\n挂载时，ACK集群支持静态数据卷和动态数据卷，ACK Serverless集群仅支持静态数据卷。说明 \n\nACK Serverless集群中的Pod均为ECI Pod，由于ECI不支持Privileged，因此ACK Serverless集群中的ECI Pod不支持动态挂载NAS。\n\n[NAS存储卷概述](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/nas-volume-overview-1/#concept-l5p-qvs-vdb)\n\n[NAS存储卷概述](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/nas-volume-overview#concept-l5p-qvs-vdb)\n\nOSS\n\n- \n\nOSS为共享存储，一个OSS Bucket可以挂载到多个Pod上。\n- \n\n挂载时，仅支持静态数据卷。\n\n[OSS存储卷概述](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/oss-volume-overview-1/#concept-h11-5bt-vdb)\n\n[挂载OSS](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/mount-oss-buckets-as-volumes)\n\nCPFS\n\n- \n\nCPFS为共享存储，一个CPFS文件系统可以挂载到多个Pod上。\n- \n\n挂载时，推荐使用CPFS 2.0（静态数据卷）。\n\n[CPFS存储卷概述](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/cpfs-volume-overview/)\n\n[CPFS存储卷概述](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/cpfs-volume-overview)\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-an-instance-ram-role-by-calling-api-operations", "page_type": "doc", "title": "通过API使用实例RAM角色", "keywords": "使用ECI实例RAM角色,获取实例角色STS凭证,ECI实例RAM角色,实例RAM角色使用流程", "last_modified_ms": 1704707800000, "last_modified_iso": "2024-01-08T17:56:40+08:00", "excerpt": "实例RAM角色允许您将一个角色关联到ECI实例，在实例内部基于STS（Security Token Service）临时凭证访问其他云产品的API。本文介绍如何通过API创建、授权实例RAM角色，并将该角色授予给ECI实例。\n## 应用场景\n\nECI实例上部署的应用程序在云产品通信中，通过云账号或者RAM用户的AccessKey访问阿里云其他云产品（例如OSS、VPC、RDS等）的API。为了方便和快速地调用，部分用户直接把AccessKey固化在实例中，例如直接写在配置文件中。这种方式存在权限过高、泄露信息和难以维护等问题。实例RAM角色能够避免此类问题。\n\nRAM角色是一种具备某些权限的虚拟用户，可以被ECI实例扮演，从而使得ECI实例获得相应的权限。使用RAM角色，无需在实例中保存AccessKey，通过修改RAM角色的权限即可变更ECI实例的权限，在使用上安全便捷。更多关于RAM角色的信息，请参见[RAM角色概览](https://help.aliyun.com/zh/ram/user-guide/ram-role-overview#concept-fgc-wjc-mfb)。\n## 使用流程\n\n使用实例RAM角色的步骤如下：\n\n- \n\n[创建实例RAM角色](#section-y6y-i5e-na7)\n\n调用CreateRole创建实例RAM角色，设置允许扮演该角色的可信实体为ECI服务（受信服务为云服务器ECS）。\n- \n\n[授权实例RAM角色](#section-aoa-v1j-e99)\n\n根据需要调用CreatePolicy创建权限策略，然后调用AttachPolicyToRole将该权限策略授予给实例RAM角色。\n- \n\n（可选）[授权RAM用户使用实例RAM角色](#section-umf-qpm-e9r)\n\n如果您使用RAM用户创建ECI实例并指定实例RAM角色，则必须先授权RAM用户可以使用实例RAM角色。\n- \n\n[为ECI实例授予实例RAM角色](#section-x3j-g0s-qha)\n\n调用CreateContainerGroup创建ECI实例，通过RamRoleName参数为ECI实例授予实例RAM角色，使得ECI实例获得对应的权限。一个ECI实例只能授予一个实例RAM角色。\n- \n\n[获取STS Token](#4f5c81a113yxy)\n\n为ECI实例授予了实例RAM角色后，如果需要在ECI实例内部部署的应用程序中访问云产品的API，您需要通过实例元数据获取实例RAM角色的STS Token。\n\n## 创建实例RAM角色\n\n调用CreateRole可以创建一个实例RAM角色。具体参数信息，请参见[CreateRole](https://help.aliyun.com/zh/ram/developer-reference/api-ram-2015-05-01-createrole)。\n\n您可以自定义设置RoleName来指定角色名（假设为ECIRamRoleTest），然后按如下策略文本设置AssumeRolePolicyDocument。\n\n{\n\"Statement\": [\n{\n  \"Action\": \"sts:AssumeRole\",\n  \"Effect\": \"Allow\",\n  \"Principal\": {\n    \"Service\": [\n      \"ecs.aliyuncs.com\"\n    ]\n  }\n}\n],\n\"Version\": \"1\"\n}\n\n\n## 授权实例RAM角色\n\n- \n\n调用CreatePolicy创建一个自定义权限策略。\n\n调用时，需设置以下参数：\n\n- \n\nPolicyName：权限策略名称（假设为ECIRamRoleTestPolicy）。\n- \n\nPolicyDocument：权限策略内容。\n\n{\n     \"Statement\": [\n         {\n         \"Action\": [\n             \"oss:Get*\",\n             \"oss:List*\"\n         ],\n         \"Effect\": \"Allow\",\n         \"Resource\": \"*\"\n         }\n     ],\n     \"Version\": \"1\"\n }\n\n\n更多信息，请参见[CreatePolicy](https://help.aliyun.com/zh/ram/developer-reference/api-ram-2015-05-01-createpolicy)。\n- \n\n调用AttachPolicyToRole为RAM角色添加权限策略。\n\n调用时，需设置以下参数：\n\n- \n\nPolicyName：指定权限策略名称，例如ECIRamRoleTestPolicy。\n- \n\nPolicyType：权限策略类型，配置为Custom，表示是自定义权限策略。\n- \n\nRoleName：指定RAM角色，例如ECIRamRoleTest。\n\n更多信息，请参见[AttachPolicyToRole](https://help.aliyun.com/zh/ram/developer-reference/api-ram-2015-05-01-attachpolicytorole)。\n\n## 授权RAM用户使用实例RAM角色\n\n如果您使用RAM用户，则必须先授权RAM用户具备该实例RAM角色的ram:PassRole权限，RAM用户才可以使用实例RAM角色。ram:PassRole权限决定RAM用户能否直接执行角色策略赋予的权限。\n\n- \n\n使用阿里云账号（或者具备管理权限的RAM用户）登录[RAM控制台](https://ram.console.aliyun.com/overview)。\n- \n\n授权RAM用户使用实例RAM角色。\n\n授权时，请创建以下自定义权限策略，并将其授权给RAM用户。其中，ECIRamRoleTest为要授权的ram:PassRole权限的实例RAM角色。具体操作，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users#topic-1860119)。\n\n{\n   \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ram:PassRole\",\n      \"Resource\": \"acs:ram:*:*:role/ECIRamRoleTest\" \n    }\n  ],\n  \"Version\": \"1\"\n}                \n\n\n## 为ECI实例授予实例RAM角色\n\n调用CreateContainerGroup创建ECI实例时，可以通过RamRoleName参数来指定RAM角色。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。说明 \n\n一个ECI实例只能授予一个实例RAM角色。如果ECI实例已有RAM角色，则会报错提示您不能附加新的角色。\n## 获取STS Token\n\n在ECI实例内部，您可以访问元数据URL来获取RAM角色的STS Token，该STS Token可以执行RAM角色的权限和资源，并且该STS Token会自动周期性地更新。\n\ncurl http://100.100.100.200/latest/meta-data/ram/security-credentials/${your_ram_role_name}\n\n\n请使用实际RAM角色名称替换${your_ram_role_name}，假设RAM角色名称为ECIRamRoleTest，命令示例如下：\n\ncurl http://100.100.100.200/latest/meta-data/ram/security-credentials/ECIRamRoleTest\n\n\n返回结果中可以获取STS Token，示例如下：\n\n{\n  \"AccessKeyId\" : \"STS.******\",\n  \"AccessKeySecret\" : \"******\",\n  \"Expiration\" : \"2023-06-22T19:13:58Z\",\n  \"SecurityToken\" : \"******\",\n  \"LastUpdated\" : \"2023-06-22T13:13:58Z\",\n  \"Code\" : \"Success\"\n}\n\n\n## 基于STS Token访问云服务\n\n以下示例以使用Go SDK访问OSS为例介绍如何基于STS Token访问云服务，该示例可以实现基于STS Token访问某个OSS Bucket并列举其中的所有文件。说明 \n\n该示例仅用于演示基于STS Token访问云服务的方法，实际场景中请根据自身业务编写代码，具体请参考您要使用的云服务的SDK。\n\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"flag\"\n\t\"log\"\n\t\"os/exec\"\n\n\t\"github.com/aliyun/aliyun-oss-go-sdk/oss\"\n)\n\nconst (\n\tsecurityCredUrl = \"http"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-arms-prometheus-monitoring-to-monitor-a-gpu-accelerated-elastic-container-instance", "page_type": "doc", "title": "通过Prometheus监控GPU实例", "keywords": "Prometheus监控GPU,查看GPU实例监控,ECI GPU实例监控,GPU监控操作指南", "last_modified_ms": 1723182934000, "last_modified_iso": "2024-08-09T13:55:34+08:00", "excerpt": "接入可观测监控Prometheus版后，您可以通过预定义的大盘监控Kubernetes集群中ECI GPU实例的性能指标。本文为您介绍如何通过Prometheus监控ECI GPU实例。\n## 前提条件\n\n已创建ACK Serverless集群，且集群已接入可观测监控 Prometheus 版。具体操作，请参见[阿里云Prometheus监控](https://help.aliyun.com/zh/ack/serverless-kubernetes/user-guide/enable-prometheus-service)。\n## 操作步骤\n\n- \n\n登录[容器服务管理控制台](https://cs.console.aliyun.com/?spm=a2c4g.11186623.2.16.61a036c8iieu29&amp;accounttraceid=caa7f456b82e4e998e461e8bee1a3cb6xetj#/k8s/cluster/list)。\n- \n\n创建一个ECI GPU实例。\n\n以Deployment为例，YAML示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gpu-monitor\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test\n  template:\n    metadata:\n      labels:\n        app: test\n        alibabacloud.com/eci: \"true\" \n      annotations:\n       k8s.aliyun.com/eci-use-specs : \"ecs.gn6i-c4g1.xlarge\"     #指定GPU规格\n    spec:\n      containers:\n      - name: bert-container\n        image: registry.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            nvidia.com/gpu: 1   #指定容器使用的GPU个数\n\n\n\n- \n\n查看GPU指标。\n\n- \n\n在集群信息页面的概览页签下，单击右上角的Prometheus 监控。\n- \n\n在Prometheus 监控页面，单击GPU监控页签，查看对应的监控详情。\n\nACK Serverless集群接入可观测监控 Prometheus 版后，您无需部署额外插件，即可监控ECI GPU实例。默认情况下，系统已为您提前创建好了对应的监控大盘。更多信息，请参见[监控面板说明](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/panels)和[监控指标说明](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/introduction-to-metrics)。\n\n## 相关文档\n\n在使用GPU来做高性能计算时，为了节约成本，您往往需要根据GPU指标（利用率、显存等）来做弹性伸缩。ECI GPU实例支持复用ACK中基于GPU指标的HPA组件，以实现弹性伸缩。具体操作，请参见[基于GPU指标实现弹性伸缩](https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/enable-auto-scaling-based-on-gpu-metrics#task-1963547)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-arms-prometheus-monitoring-to-monitor-disks", "page_type": "doc", "title": "通过Prometheus监控磁盘", "keywords": "监控ECI Pod磁盘,配置Grafana大盘,ECI磁盘监控,Prometheus监控实践", "last_modified_ms": 1759203098000, "last_modified_iso": "2025-09-30T11:31:38+08:00", "excerpt": "在Kubernetes集群中创建ECI Pod时，ECI Pod会运行在虚拟节点上。由于并不存在真实节点，磁盘是与Pod相关，而不是节点。因此，需额外配置Pod级别的磁盘监控，才能监控磁盘相关指标。本文介绍如何通过ARMS Prometheus监控ECI Pod相关的磁盘，在Grafana中自定义磁盘监控大盘。\n## 前提条件\n\n- \n\n已创建ACK Serverless集群，且集群已接入ARMS Prometheus监控。具体操作，请参见[接入Prometheus监控](https://help.aliyun.com/zh/eci/user-guide/connect-ask-clusters-to-arms-prometheus#topic-1915159)。\n- \n\n已创建Grafana工作区（非共享版），完成数据迁移和云服务集成。具体操作，请参见[快速使用可观测可视化 Grafana 版](https://help.aliyun.com/zh/grafana/getting-started/get-started-with-grafana)。重要 \n\n- \n\n默认情况下，接入ARMS Prometheus监控后使用的Grafana工作区为共享版，共享版不支持自定义大盘。\n- \n\n本文操作步骤以Grafana 10.0.X为例，如使用其他版本的Grafana，请参考配置项自行操作。\n\n## 操作步骤\n\n- \n\n登录[ARMS控制台](https://arms.console.aliyun.com/#/home)。\n- \n\n打开Grafana页面。\n\n- \n\n在左侧导航栏，选择Grafana服务>工作区管理。\n- \n\n找到目标工作区，单击访问地址URL处的地址，打开Grafana登录页面。\n\n- \n\n输入账号信息，登录Grafana。\n\n可使用admin账号和创建工作区时设置的密码登录Grafana，也可以使用其他账号。\n- \n\n在Grafana页面左上角单击图标，然后在导航栏中单击仪表板。\n- \n\n在仪表板页面的右上角，单击新建，然后选择导入。\n- \n\n单击Upload dashboard JSON file，然后上传JSON文件。\n\nJSON文件包含大盘相关配置，示例文件：[ECI_Pod_Disk](https://help-static-aliyun-doc.aliyuncs.com/file-manage-files/zh-CN/20250930/pouejc/ECI+Pod+Disk.json)。\n- \n\n修改大盘文件夹和数据源为目标集群。\n\n- \n\n单击Import。\n\n导入成功后，在新增的磁盘监控大盘中，可查看对应ECI Pod的磁盘相关监控信息。\n\n- \n\n（可选）如果需要筛选查看Deployment级别或者StatefulSet级别的监控，可将当前磁盘监控大盘中的对应Panel复制到Deployment或者StatefulSet的大盘中，或者直接在该大盘中修改Dashboard Settings。\n\n在磁盘监控大盘中修改Dashboard Settings，添加筛选变量的操作如下：\n\n- \n\n在Grafana页面磁盘监控大盘中，单击右上角的图标。\n- \n\n在Settings页面的左侧导航栏，选择Variables。\n- \n\n单击New Variable，编辑General和Query Options相关设置，然后单击Apply。\n\n添加变量时，请根据需要变量类型设置Query。示例如下表所示。\n\n[表格]\n\n类型\n\nQuery Type\n\nLabel *\n\nMetric\n\ndeployment\n\nLabel_values\n\ndeployment\n\nkube_deployment_created{namespace=~\"$namespace\"}\n\nstatefulset\n\nLabel_values\n\nstatefulset\n\nkube_statefulset_created{namespace=~\"$namespace\"}\n\n下图以添加deployment变量为例：\n\n- \n\n单击pod变量，修改Query，然后单击Apply。\n\n请根据上一步添加的变量类型修改pod变量对应的Query。示例如下表所示。\n\n[表格]\n\n类型\n\nQuery Type\n\nQuery\n\ndeployment\n\nQuery_result\n\nkube_pod_info{namespace=~'$namespace',pod=~\"$deployment.*\"} >= 1\n\nstatefulset\n\nQuery_result\n\nkube_pod_info{namespace=~'$namespace',pod=~\"$statefulset.*\"} >= 1\n\n下图以deployment为例，修改pod变量对应的Query：\n\n- \n\n调整deployment变量（或者statefulset变量）与pod变量的顺序，使deployment变量（或者statefulset变量）在pod变量之上。说明 \n\n鼠标左键按住对应的图标即可移动该Variable的位置。\n\n- \n\n单击右上角的Save dashboard，输入描述后单击Save保存配置。\n- \n\n返回磁盘监控大盘页面，查看筛选功能是否生效。\n\n下图以生效Deployment级别的筛选功能为例：\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-auto-scaling-to-automatically-scale-elastic-container-instances", "page_type": "doc", "title": "通过弹性伸缩自动扩缩容ECI实例", "keywords": "配置ECI实例自动扩缩容,了解ECI实例自动扩缩容,ECI实例自动扩缩容,ECI实例扩缩容流程", "last_modified_ms": 1721373358000, "last_modified_iso": "2024-07-19T15:15:58+08:00", "excerpt": "阿里云弹性伸缩服务是根据业务需求和策略自动调整计算能力（即实例数量）的服务，使用ECI实例来运行容器应用时，可以配合使用弹性伸缩服务，实现根据业务量自动增加或者减少ECI实例，在保证业务正常运行的同时节约使用成本。\n## 功能概述\n\n弹性伸缩（Elastic Scaling Service，简称ESS），也称为Auto Scaling，其能根据您设定的策略自动调整计算资源数量（即业务所需的实例数量），帮助您应对业务流量波动的同时，提高资源利用率，有效降低成本。更多信息，请参见[弹性伸缩简介](https://help.aliyun.com/zh/auto-scaling/product-overview/what-is-auto-scaling#concept-25857-zh)。\n\n对于运行同一业务的ECI实例，您可以将其加入到弹性伸缩组中，设置伸缩组最小实例数来保证日常业务运行，设置伸缩组最大实例数来避免成本超标，同时可以设置伸缩规则，配合定时任务或者报警任务来实现自动扩缩容组内的ECI实例。功能示意图如下：\n\n通过弹性伸缩自动扩缩容ECI实例适用于以下场景：\n\n- \n\n业务量变化有规律，在某一特定时间进行扩缩容。\n\n例如：某游戏公司在每晚18点~24点的时间段内业务量激增，您可以创建定时任务，在每天的18:00自动增加ECI实例，在每天的24:00自动减少ECI实例。\n\n- \n\n业务量变化无规律，根据监控指标自动进行扩缩容。\n\n例如：某视频直播公司的日常业务量难以预测，您可以创建报警任务，监控伸缩组内ECI实例的CPU使用率，自动增加或者减少ECI实例，使得CPU使用率维持在60%。\n\n## 配置流程\n\n通过弹性伸缩自动扩缩容ECI实例的流程如下：说明 \n\n创建伸缩组时，如果您选择已有实例作为组内实例配置信息来源，会自动创建并生效对应的伸缩配置，即您无需手动创建伸缩配置，就可以直接启用伸缩组。\n\n- \n\n创建伸缩组\n\n伸缩组用于管理具有相同应用场景的ECI实例集合。您可以通过伸缩组定义可容纳实例数量的边界值（最大和最小实例数）、弹性扩张时使用的实例模板、弹性收缩时移出实例的策略等属性，让伸缩组按照您的需求维护一组实例。更多信息，请参见[创建伸缩组](https://help.aliyun.com/zh/auto-scaling/user-guide/manage-scaling-groups#concept-25882-zh)。\n- \n\n创建伸缩配置\n\n伸缩组自动扩张时，将根据伸缩配置来创建ECI实例，并将ECI实例加入到伸缩组中。更多信息，请参见[创建伸缩配置（ECI实例）](https://help.aliyun.com/zh/auto-scaling/user-guide/create-a-scaling-configuration-of-the-eci-type/#concept-25890-zh)。说明 \n\n由于容器镜像一般较大，拉取镜像会影响ECI实例的启动耗时，因此配置时建议开启自动匹配镜像缓存，以加速ECI实例的创建。\n- \n\n启用伸缩组\n\n伸缩组处于启用状态才能进行弹性伸缩。当伸缩组内存在生效的伸缩配置时，会自动提示启用伸缩组。您也可以在伸缩组列表中自行启用伸缩组。更多信息，请参见[启用伸缩组](https://help.aliyun.com/zh/auto-scaling/scaling-group-enable-a-scaling-group#task-2118188)。\n- \n\n创建伸缩规则\n\n伸缩规则用于触发伸缩活动，您可以根据业务需要创建对应类型的伸缩规则。\n\n- \n\n简单规则：指定增加、减少的实例数，或者将实例数量调整到指定值。\n- \n\n目标追踪规则：选择某一监控指标并设置目标值，系统将自动增加或者减少实例数，使得监控指标值维持在目标值附近。\n\n更多信息，请参见[创建伸缩规则](https://help.aliyun.com/zh/auto-scaling/user-guide/manage-scaling-rules#section-bry-qyu-qdr)。\n- \n\n执行伸缩规则\n\n您可以通过以下方式执行伸缩规则，实现伸缩组内ECI实例的弹性伸缩。更多信息，请参见[执行伸缩规则](https://help.aliyun.com/zh/auto-scaling/user-guide/manage-scaling-rules#section-n9s-pdg-o6k)。\n\n- \n\n手动执行：人工手动执行伸缩规则，适用于不确定的临时业务需求。\n- \n\n通过定时任务自动执行：按照定时任务设置的时间自动执行伸缩规则，适用于周期性有规律的业务波动。更多信息，请参见[定时任务概述](https://help.aliyun.com/zh/auto-scaling/user-guide/overview-8)。\n- \n\n通过报警任务自动执行：基于监控指标触发报警并自动执行伸缩规则，适用于无规律的业务波动。更多信息，请参见[报警任务概述](https://help.aliyun.com/zh/auto-scaling/user-guide/overview-11)。\n\n## 配置示例\n\n[表格]\n\n业务场景\n\n配置示例\n\n实现效果\n\n某公司日常业务需要10台ECI实例，但每晚18点~23点的时间段内业务量会激增，需增加5台ECI实例。\n\n- \n\n创建伸缩组，设置类型为ECI，最小实例数为10台，最大实例数为20台。\n- \n\n创建伸缩配置，设置实例配置来源。\n- \n\n启用伸缩组，此时系统将创建10台ECI实例。\n- \n\n创建伸缩规则，设置2条简单规则。\n\n- \n\n规则1：执行操作为调整至15台。\n- \n\n规则2：执行操作为调整至10台。\n\n- \n\n创建定时任务，设置2个任务。\n\n- \n\n任务1：执行时间17:55，按天重复执行一次规则1。\n- \n\n任务2：执行时间23:05，按天重复执行一次规则2。\n\n业务量平峰时段有10台ECI实例维持日常业务运行；业务量高峰时段（18点~23点）将扩容到15台ECI实例。\n\n某公司日常业务需要10台ECI实例，但业务变化情况难以预测，无法确定何时需要增加或减少多少台ECI实例。\n\n- \n\n创建伸缩组，设置类型为ECI，最小实例数为10台，最大实例数为30台。\n- \n\n创建伸缩配置，设置实例配置来源。\n- \n\n启用伸缩组，此时系统将创建10台ECI实例。\n- \n\n创建伸缩规则，设置1条目标追踪规则。\n\n- \n\n监控指标：CPU使用率\n- \n\n目标值：60%。\n- \n\n其余参数保持默认。\n\n- \n\n查看报警任务，确认触发伸缩的条件。\n\n创建目标追踪规则后，系统将自动创建报警任务，监控CPU使用率。\n\n系统将持续监测组内ECI实例的CPU使用率，根据报警任务中触发伸缩的条件，自动增加或减少ECI实例，使得CPU使用率不超过60%，并且组内至少有10台ECI实例维持日常业务运行。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-cloud-monitoring-to-monitor-eci-instances", "page_type": "doc", "title": "使用云监控对ECI实例进行监控", "keywords": "监控ECI实例,查看ECI监控数据,ECI实例监控,ECI监控指标说明", "last_modified_ms": 1729490131000, "last_modified_iso": "2024-10-21T13:55:31+08:00", "excerpt": "云监控会自动获取您当前阿里云账号下的云产品资源，您可以在云监控控制台查看ECI实例的监控图表，了解ECI实例运行状况，也可以设置报警规则，以便及时得知异常监控数据，并进行处理。\n## 监控指标说明\n\n云监控（CloudMonitor）是一项针对阿里云资源和互联网应用进行监控的服务。对于ECI实例，云监控支持以下监控指标：\n\n[表格]\n\n类别\n\n指标\n\n说明\n\n实例\n\ninstance_cpu_utilization\n\nCPU利用率\n\ninstance_memory_utilization\n\n内存利用率\n\nGPU\n\ngpu_memory_used\n\nGPU显存使用量\n\ngpu_memory_utilization\n\nGPU显存利用率\n\ngpu_utilization\n\nGPU利用率\n\nVolume\n\nvolume_space_total\n\n存储空间的总容量\n\nvolume_space_used\n\n存储空间的已使用容量\n\nvolume_space_utilization\n\n存储空间的利用率\n\nvolume_inode_total\n\nInode可用容量\n\nvolume_inode_used\n\nInode使用量\n\nvolume_inode_utilization\n\nInode利用率重要 \n\n- \n\nVolume类别的指标仅支持临时存储空间和挂载的云盘数据卷，不支持其他类型的数据卷。\n- \n\nLinux的Inode节点中记录了文件的类型、大小、权限、所有者、文件连接的数目、创建时间与更新时间等重要信息，以及指向数据块的指针信息。Inode利用率达到100%会造成无法继续新建目录或者文件。\n\n更多信息，请参见[ECI监控指标](https://cms.console.aliyun.com/metric-meta/acs_eci_dashboard/eci)。\n## 查看监控数据\n\n您可以在云监控控制台查看ECI实例的运行状态和各个指标的监控数据。\n\n- \n\n登录[云监控控制台](https://cloudmonitornext.console.aliyun.com/)。\n- \n\n在左侧导航栏，单击云资源监控 > 云产品监控。\n- \n\n在云产品监控页面，选择弹性容器实例ECI。\n- \n\n在页面上方，选择地域。\n- \n\n在实例列表中，单击要查看监控数据的ECI实例。\n- \n\n选择想要查看的监控指标类别。\n\n- \n\n默认分组：CPU和内存指标。\n- \n\nGPU：GPU相关指标。\n\n仅指定GPU实例规格（例如gn7等规格族）创建的ECI GPU实例，可以查看GPU的指标数据。\n\n选择该类别后，可进一步选择查看某一GPU的数据。\n- \n\nVolume：存储相关指标。\n\n该类别指标仅支持临时存储空间和挂载的云盘数据卷，不支持其他类型的数据卷。\n\n择该类别后，可进一步选择查看临时存储空间（EphemeralVolume）或者某个数据卷的数据。\n\n- \n\n根据需要选择或自定义设置时间段，查看监控数据。说明 \n\n一次最多可查看连续30天的监控数据。\n## 默认分组\n\n## GPU\n\n## Volume\n\n## 后续操作\n\n您可以针对ECI实例的一个或多个监控指标设置报警规则（例如CPU利用率高于80%），当监控数据符合报警规则时，云监控会自动发送报警通知，便于您及时了解资源运行状态，处理异常情况。\n\n教程示例：[通过云监控及时获取存储空间不足的实例信息](https://help.aliyun.com/zh/eci/use-cases/obtain-timely-information-about-instances-with-insufficient-storage-space-through-cloud-monitoring)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-cloud-monitoring-to-monitor-eci-instances-1693991084267", "page_type": "doc", "title": "使用云监控对ECI实例进行监控", "keywords": "查看ECI实例监控数据,了解ECI实例监控指标,ECI实例监控指标,ECI实例监控方法", "last_modified_ms": 1729490147000, "last_modified_iso": "2024-10-21T13:55:47+08:00", "excerpt": "云监控会自动获取您当前阿里云账号下的云产品资源，您可以在云监控控制台查看ECI实例的监控图表，了解ECI实例运行状况，也可以设置报警规则，以便及时得知异常监控数据，并进行处理。\n## 监控指标说明\n\n云监控（CloudMonitor）是一项针对阿里云资源和互联网应用进行监控的服务。对于ECI实例，云监控支持以下监控指标：\n\n[表格]\n\n类别\n\n指标\n\n说明\n\n实例\n\ninstance_cpu_utilization\n\nCPU利用率\n\ninstance_memory_utilization\n\n内存利用率\n\nGPU\n\ngpu_memory_used\n\nGPU显存使用量\n\ngpu_memory_utilization\n\nGPU显存利用率\n\ngpu_utilization\n\nGPU利用率\n\nVolume\n\nvolume_space_total\n\n存储空间的总容量\n\nvolume_space_used\n\n存储空间的已使用容量\n\nvolume_space_utilization\n\n存储空间的利用率\n\nvolume_inode_total\n\nInode可用容量\n\nvolume_inode_used\n\nInode使用量\n\nvolume_inode_utilization\n\nInode利用率重要 \n\n- \n\nVolume类别的指标仅支持临时存储空间和挂载的云盘数据卷，不支持其他类型的数据卷。\n- \n\nLinux的Inode节点中记录了文件的类型、大小、权限、所有者、文件连接的数目、创建时间与更新时间等重要信息，以及指向数据块的指针信息。Inode利用率达到100%会造成无法继续新建目录或者文件。\n\n更多信息，请参见[ECI监控指标](https://cms.console.aliyun.com/metric-meta/acs_eci_dashboard/eci)。\n## 查看监控数据\n\n您可以在云监控控制台查看ECI实例的运行状态和各个指标的监控数据。\n\n- \n\n登录[云监控控制台](https://cloudmonitornext.console.aliyun.com/)。\n- \n\n在左侧导航栏，单击云资源监控 > 云产品监控。\n- \n\n在云产品监控页面，选择弹性容器实例ECI。\n- \n\n在页面上方，选择地域。\n- \n\n在实例列表中，单击要查看监控数据的ECI实例。\n- \n\n选择想要查看的监控指标类别。\n\n- \n\n默认分组：CPU和内存指标。\n- \n\nGPU：GPU相关指标。\n\n仅指定GPU实例规格（例如gn7等规格族）创建的ECI GPU实例，可以查看GPU的指标数据。\n\n选择该类别后，可进一步选择查看某一GPU的数据。\n- \n\nVolume：存储相关指标。\n\n该类别指标仅支持临时存储空间和挂载的云盘数据卷，不支持其他类型的数据卷。\n\n择该类别后，可进一步选择查看临时存储空间（EphemeralVolume）或者某个数据卷的数据。\n\n- \n\n根据需要选择或自定义设置时间段，查看监控数据。说明 \n\n一次最多可查看连续30天的监控数据。\n## 默认分组\n\n## GPU\n\n## Volume\n\n## 后续操作\n\n您可以针对ECI实例的一个或多个监控指标设置报警规则（例如CPU利用率高于80%），当监控数据符合报警规则时，云监控会自动发送报警通知，便于您及时了解资源运行状态，处理异常情况。\n\n教程示例：[通过云监控及时获取存储空间不足的实例信息](https://help.aliyun.com/zh/eci/use-cases/obtain-timely-information-about-instances-with-insufficient-storage-space-through-cloud-monitoring)。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-coredump-to-analyze-instance-program-exceptions", "page_type": "doc", "title": "使用coredump分析实例程序异常", "keywords": "开启ECI实例coredump,分析ECI程序异常,ECI coredump使用方法,ECI coredump开启方式", "last_modified_ms": 1761136186000, "last_modified_iso": "2025-10-22T20:29:46+08:00", "excerpt": "coredump是指在程序运行过程中发生异常终止或崩溃时，操作系统将程序的内存内容转储到一个特殊的文件中，以便于后续的调试和分析。本文介绍如何为ECI Pod（即ECI实例）开启coredump，以便在容器异常终止时可以查看分析coredump生成的文件，从而定位问题原因，修复程序异常。\n## 背景信息\n\n在Linux中，如果程序突然异常终止或者崩溃，操作系统会将程序当时的内存状态记录下来，保存在一个文件中，这种行为就叫做coredump。此时，您可以查看分析coredump生成的core文件，找出问题原因。\n\nLinux中支持coredump（Action为Core）的Signal如下图所示。\n\n更多信息，请参见[coredump file](https://man7.org/linux/man-pages/man5/core.5.html)。\n## 功能概述\n\nECI默认关闭coredump，避免磁盘占用过多而导致业务不可用。您可以根据需要选择以下一种方式开启coredump：\n\n- \n\n方式一：开启coredump运维任务\n\n手动开启coredump后，将生成一个运维任务。在容器运行异常终止或者退出时，触发coredump生成的core文件将自动保存到OSS中。\n- \n\n方式二：自定义设置core文件保存路径\n\n支持自定义设置core文件保存到外挂存储中，设置保存路径后，将自动开启coredump。在容器运行异常终止或者退出时，触发coredump生成的core文件，将保存到指定的外挂存储的路径下。\n说明 \n\n- \n\n方式一便于操作，但有时效和地域等限制，可用于临时调试和诊断程序。\n\n- \n\n生成的运维任务为一次性任务，执行成功获取到一次core文件后，将会关闭coredump，并且运维任务有一定的期限（12小时），超出时间后任务将会失效。\n- \n\n不支持以下地域：华北6（乌兰察布）、华南2（河源）、华南3（广州）、华东5 （南京-本地地域-关停中）、菲律宾（马尼拉）、韩国（首尔）、泰国（曼谷）。\n\n- \n\n方式二需要额外配置外挂存储，在程序运行状态不稳定的情况下，可以采用该方式确保能够获取到core文件，但如果程序有问题，反复重启可能会产生大量core文件。\n\n## 方式一：开启coredump运维任务\n\n通过弹性容器实例控制台，可以手动开启coredump运维任务。\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/list)。\n- \n\n为ECI实例开启coredump。\n\n- \n\n单击目标实例ID，打开实例详情页面。\n- \n\n单击运维页签，然后选择Coredump页签，单击开启。\n\n开启coredump后，系统将生成一个运维任务，未触发coredump时，任务状态为等待中。\n\n- \n\n触发coredump。\n\n连接ECI实例，在容器内执行sleep 100命令后按Ctrl+\\键，触发coredump，生成的core文件将自动保存到OSS中。\n- \n\n下载core文件。\n\n触发coredump生成core文件后，运维任务的状态将变为成功，此时单击对应结果列中的下载即可下载core文件到本地。\n\n说明 \n\n如果下载没有反应，请检查浏览器的网站权限设置。\n\n## 方式二：自定义设置core文件保存路径\n\ncore文件一般用于离线分析问题，因此设置core文件的保存路径时，一般采用外挂存储，而不是保存在容器本地路径，避免容器退出而丢失core文件。ECI支持自定义设置core文件保存路径，设置后将自动开启coredump。重要 \n\n配置的路径不能以|开头，即不能通过coredump来配置可执行程序。\n\n以使用NAS作为外挂存储为例，配置示例如下：\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: coredump-test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-core-pattern: \"/data/dump-a/core\"    # 设置core文件保存路径\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        volumeMounts:\n          - name: nas-volume\n            mountPath: /data/dump-a/\n      volumes:     # 挂载NAS\n        - name: nas-volume\n          csi:\n            driver: nasplugin.csi.alibabacloud.com\n            fsType: nas\n            volumeAttributes:\n              server: \"0389a***-nh7m.cn-shanghai.extreme.nas.aliyuncs.com\"\n              path: \"/\"\n              vers: \"3\"\n              options: \"nolock,tcp,noresvport\"\n\n\n## 常见问题\n\n触发coredump后，在控制台下载core文件没有反应，怎么办？\n\n如果下载没有反应，请检查浏览器的网站权限设置。例如Chrome浏览器可以参考以下方式开启权限：\n\n- \n\n打开弹性容器实例控制台，单击浏览器地址栏前面的图标，选择网站设置。\n- \n\n将配置项不安全内容改为允许。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-coredump-to-analyze-instance-program-exceptions-1", "page_type": "doc", "title": "使用coredump分析实例程序异常", "keywords": "开启ECI实例coredump,分析ECI程序异常,保存ECI的core文件,ECI coredump使用方法,ECI程序异常排查,ECI core文件保存", "last_modified_ms": 1761135970000, "last_modified_iso": "2025-10-22T20:26:10+08:00", "excerpt": "coredump是指在程序运行过程中发生异常终止或崩溃时，操作系统将程序的内存内容转储到一个特殊的文件中，以便于后续的调试和分析。本文介绍如何为ECI实例开启coredump，以便在容器异常终止时可以查看分析coredump生成的文件，从而定位问题原因，修复程序异常。\n## 背景信息\n\n在Linux中，如果程序突然异常终止或者崩溃，操作系统会将程序当时的内存状态记录下来，保存在一个文件中，这种行为就叫做coredump。此时，您可以查看分析coredump生成的core文件，找出问题原因。\n\nLinux中支持coredump（Action为Core）的Signal如下图所示。\n\n更多信息，请参见[coredump file](https://man7.org/linux/man-pages/man5/core.5.html)。\n## 功能概述\n\nECI默认关闭coredump，避免磁盘占用过多而导致业务不可用。您可以根据需要选择以下一种方式开启coredump：\n\n- \n\n方式一：开启coredump运维任务\n\n手动开启coredump后，将生成一个运维任务。在容器运行异常终止或者退出时，触发coredump生成的core文件将自动保存到OSS中。\n- \n\n方式二：自定义设置core文件保存路径\n\n支持自定义设置core文件保存到外挂存储中，设置保存路径后，将自动开启coredump。在容器运行异常终止或者退出时，触发coredump生成的core文件，将保存到指定的外挂存储的路径下。\n说明 \n\n- \n\n方式一便于操作，但有时效和地域等限制，可用于临时调试和诊断程序。\n\n- \n\n生成的运维任务为一次性任务，执行成功获取到一次core文件后，将会关闭coredump，并且运维任务有一定的期限（12小时），超出时间后任务将会失效。\n- \n\n不支持以下地域：华北6（乌兰察布）、华南2（河源）、华南3（广州）、华东5 （南京-本地地域-关停中）、菲律宾（马尼拉）、韩国（首尔）、泰国（曼谷）。\n\n- \n\n方式二需要额外配置外挂存储，在程序运行状态不稳定的情况下，可以采用该方式确保能够获取到core文件，但如果程序有问题，反复重启可能会产生大量core文件。\n\n## 方式一：开启coredump运维任务\n### 控制台\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/list)。\n- \n\n为ECI实例开启coredump。\n\n- \n\n单击目标实例ID，打开实例详情页面。\n- \n\n单击运维页签，然后选择Coredump页签，单击开启。\n\n开启coredump后，系统将生成一个运维任务，未触发coredump时，任务状态为等待中。\n\n- \n\n触发coredump。\n\n连接ECI实例，在容器内执行sleep 100命令后按Ctrl+\\键，触发coredump，生成的core文件将自动保存到OSS中。\n- \n\n下载core文件。\n\n触发coredump生成core文件后，运维任务的状态将变为成功，此时单击对应结果列中的下载即可下载core文件到本地。\n\n说明 \n\n如果下载没有反应，请检查浏览器的网站权限设置。\n\n### OpenAPI\n\n- \n\n为ECI实例开启coredump。\n\n调用CreateInstanceOpsTask接口创建运维任务，需指定目标ECI实例，然后将OpsType设为coredump，OpsValue设为enable，即可开启coredump。更多信息，请参见[CreateInstanceOpsTask](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createinstanceopstask)。说明 \n\n指定ECI实例时，需确保目标ECI实例在创建时没有设置CorePattern。\n- \n\n触发coredump。\n\n连接ECI实例，在容器内执行sleep 100命令后按Ctrl+\\键，触发coredump，生成的core文件将自动保存到OSS中。\n- \n\n下载Core文件。\n\n调用DescribeInstanceOpsRecords接口查看运维任务的结果，从返回信息的ResultContent中，可以获取core文件保存在OSS中的地址，访问该地址即可下载core文件。\n\n## 方式二：自定义设置core文件保存路径\n\ncore文件一般用于离线分析问题，因此设置core文件的保存路径时，一般采用外挂存储，而不是保存在容器本地路径，避免容器退出而丢失core文件。ECI支持自定义设置core文件保存路径，设置后将自动开启coredump。\n\n调用CreateContainerGroup接口创建ECI实例时，可传入CorePattern参数来设置core文件保存路径。相关参数说明如下，更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。说明 \n\n示例以NFSVolume作为示例，Volume相关参数请根据实际Volume类型进行配置。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nCorePattern\n\nString\n\n/data/dump-a/core\n\n自定义设置Core dump文件的保存目录。重要 \n\n配置的路径不能以|开头，即不能通过coredump来配置可执行程序。\n\nVolume.N.Name\n\nString\n\nvolume1\n\n数据卷名称。\n\nVolume.N.Type\n\nString\n\nNFSVolume\n\n数据卷类型。本文以NFSVolume为例。\n\nVolume.N.NFSVolume.Path\n\nString\n\n/dump\n\nNFS数据卷的路径。\n\nVolume.N.NFSVolume.Server\n\nString\n\n143b24****-gfn3.cn-beijing.nas.aliyuncs.com\n\nNFS服务器地址。\n\n如果使用阿里云文件存储NAS，则此处为NAS文件系统的挂载点地址。\n\nContainer.N.VolumeMount.N.Name\n\nString\n\nvolume1\n\n要挂载到容器的数据卷的名称，对应Volume.N.Name的值。\n\nContainer.N.VolumeMount.N.MountPath\n\nString\n\n/data/dump-a/\n\n挂载目录。\n\n容器挂载目录下的内容会被数据卷的内容直接覆盖，请准确填写。\n\n以使用NAS作为外挂存储为例，示例如下：\n\n- \n\n创建一台ECI实例A，挂载NAS并设置core文件保存路径。\n\n调用CreateContainerGroup接口创建ECI实例A时传入以下参数，将NAS的/dump/目录挂载到容器的/data/dump-a/目录，将core文件保存路径设置为/data/dump-a/core。\n\nContainerGroupName=test-a\nSecurityGroupId=sg-bp1daxpbz9lzpvvc****\nVSwitchId=vsw-bp1gds63lmlm7ib05****\n# 声明数据卷\nVolume.1.Name=volume1\nVolume.1.Type=NFSVolume\nVolume.1.NFSVolume.Path=/dump/\nVolume.1.NFSVolume.Server=143b24****-gfn3.cn-beijing.nas.aliyuncs.com\n# 为容器挂载数据卷\nContainer.1.Name=nginx\nContainer.1.Image=registry-vpc.cn-beijing.aliyuncs.com/eci_open/nginx:1.14.2\nContainer.1.VolumeMount.1.Name=volume1\nContainer.1.VolumeMount.1.MountPath=/data/dump-a/\n# 设置core文件保存路径\nCorePattern=/data/dump-a/core\n\n\n- \n\n在实例A的容器任意目录下触发coredump。\n\n如下示例，在容器内执行sleep 100命令后同时按Ctrl键和\\键，触发coredump后，core文件已保存到容器的/data/dump-a/路径下。\n\n- \n\n释放ECI实例A。\n- \n\n将同一NAS挂载到另一台ECI实例B。\n\n调用CreateContainerGroup接口创建ECI实例B时传入以下参数，将同一NAS的/dump/目录挂载到容器的/data/dump-b/目录。\n\nContainerGroupName=test-nas-b\nSecurityGroupId=sg-bp1daxpbz9lzpvvc****\nVSwitchId=vsw-bp1gds63lmlm7ib05****\n# 声明数据卷\nVolume.1.Name=volume1\nVolume.1.Type=NFSVolume\nVolume.1.NFSVolume.Path=/dump/\nVolume.1.NFSVolume.Server=143b24****-gfn3.cn-beijing.nas.aliyuncs.com\n# 为容器挂载数据卷\nCon"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-data-caching-to-accelerate-deployment-of-stable-diffusion-applications", "page_type": "doc", "title": "使用数据缓存加速部署Stable Diffusion应用", "keywords": "加速部署Stable Diffusion,部署Stable Diffusion应用,Stable Diffusion部署教程,数据缓存加速实践,ECI部署Stable Diffusion", "last_modified_ms": 1692342775000, "last_modified_iso": "2023-08-18T15:12:55+08:00", "excerpt": "本文以部署HuggingFace上的Stable Diffusion为例，演示如何使用数据缓存。通过数据缓存提前拉取Stable Diffusion相关模型数据，然后在创建Stable Diffusion应用实例时直接挂载模型数据，可以免去在实例中拉取模型数据的等待时间，加速Stable Diffusion应用部署。\n## 背景信息\n\nStable Diffusion是一个可以根据文字描述生成和修改图像的模型。Stable Diffusion分为文字理解和图片生成两个部分。文字理解部分使用CLIP模型对文本进行Encoding，图片生成采用Diffusion模型。重要 \n\n- \n\n阿里云不对第三方模型的合法性、安全性、准确性进行任何保证，阿里云不对由此引发的任何损害承担责任。\n- \n\n您应自觉遵守第三方模型的用户协议、使用规范和相关法律法规，并就使用第三方模型的合法性、合规性自行承担相关责任。\n\n## 前提条件\n\n您使用的VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建数据缓存和部署应用时绑定EIP，以便可以拉取公网数据。\n## 准备运行环境\n\n部署Stable Diffusion应用需要准备好包含Stable Diffusion运行所需环境的容器镜像，环境需求包括CUDA、Diffusers库，以及其他的基础依赖等。ECI已经准备好了能运行大多数模型的稳定环境的容器镜像。如果您的应用没有特殊依赖，可以直接使用。\n\n- \n\n启动HTTP服务的镜像\n\n- \n\nGPU版：registry.cn-hangzhou.aliyuncs.com/eci_open/ubuntu:cuda11.7.1-cudnn8-ubuntu20.04\n- \n\nCPU版：registry.cn-hangzhou.aliyuncs.com/eci_open/ubuntu:hf-ubuntu20.04\n\n镜像相关信息参考如下：\n\n展开查看构建镜像的完整Dockerfile\n\n以下Dockerfile可以构建一个基于Ubuntu和Python的开发环境，并预安装一些常用依赖。在启动容器后，可以使用命令python3 http-server.py启动一个HTTP服务。\n\nFROM nvidia/cuda:11.7.1-cudnn8-runtime-ubuntu20.04\nLABEL maintainer=\"Alibaba Cloud Serverless Container\"\n\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt update && \\\n    apt install -y bash \\\n                   vim \\\n                   build-essential \\\n                   git \\\n                   git-lfs \\\n                   curl \\\n                   ca-certificates \\\n                   libsndfile1-dev \\\n                   libgl1 \\\n                   python3.8 \\\n                   python3-pip \\\n                   python3.8-venv && \\\n    rm -rf /var/lib/apt/lists\n\n# make sure to use venv\nRUN python3 -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN mkdir -p /workspace/pic/\nWORKDIR /workspace\nCOPY http-server.py http-server.py\n\n# pre-install the heavy dependencies (these can later be overridden by the deps from setup.py)\nRUN python3 -m pip install --no-cache-dir --upgrade pip && \\\n    python3 -m pip install --no-cache-dir \\\n        torch \\\n        torchvision \\\n        torchaudio \\\n        invisible_watermark && \\\n    python3 -m pip install --no-cache-dir \\\n        accelerate \\\n        datasets \\\n        hf-doc-builder \\\n        huggingface-hub \\\n        Jinja2 \\\n        librosa \\\n        numpy \\\n        scipy \\\n        tensorboard \\\n        transformers \\\n        omegaconf \\\n        pytorch-lightning \\\n        xformers \\\n        safetensors \\\n        diffusers\n        \n\nCMD [\"/bin/bash\"]\n\n\n展开查看镜像中用到的HTTP服务脚本\n\nhttp-server.py脚本是一个简单的HTTP服务，用于接收输入的文本，生成对应的图片，并返回图片路径。\n\nimport os\nimport hashlib\nimport torch\nfrom diffusers import StableDiffusionPipeline, DPMSolverMultistepScheduler\nfrom http.server import BaseHTTPRequestHandler\nfrom http.server import HTTPServer\nfrom urllib.parse import urlparse, parse_qs\n\nMODEL_DIR_NEV = \"MODEL_DIR\"\nAPP_PORT_ENV = \"APP_PORT\"\n\ndef text2image(input):\n    model_id = os.getenv(MODEL_DIR_NEV, default=\"/data/model/\")\n    pipe = StableDiffusionPipeline.from_pretrained(model_id, torch_dtype=torch.float16)\n\n    pipe.scheduler = DPMSolverMultistepScheduler.from_config(pipe.scheduler.config)\n    pipe = pipe.to(\"cuda\")\n\n    image = pipe(input).images[0]\n    name = \"/workspace/pic/\" + hashlib.md5(input.encode('utf8')).hexdigest() + \".png\"\n    image.save(name)\n    return name\n\nclass GetHandler(BaseHTTPRequestHandler):\n\n    def do_GET(self):\n        query = parse_qs(urlparse(self.path).query)\n        # 获取参数值\n        input = query.get('input')[0]\n        print(\"get user input:%s, try generate image\" % input)\n        picName = text2image(input)\n        # 构造响应\n        self.send_response(200)\n        self.send_header('Content-type', 'text/html')\n        self.end_headers()\n        self.wfile.write(bytes(\"<html><head><title>Stable Diffusion</title></head>\", \"utf-8\"))\n        self.wfile.write(bytes(\"<body><p>Success generate image:%s</p>\" % picName, \"utf-8\"))\n        self.wfile.write(bytes(\"</body></html>\", \"utf-8\"))\n\nif __name__ == '__main__':\n    server = HTTPServer(('', int(os.getenv(APP_PORT_ENV, default=\"8888\"))), GetHandler)\n    server.serve_forever()\n "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-datacache-to-accelerate-deployment-of-stable-diffusion-applications", "page_type": "doc", "title": "部署Stable Diffusion应用", "keywords": "部署Stable Diffusion应用,使用DataCache加速部署,Stable Diffusion部署教程,DataCache实践教程,ECI部署AI应用", "last_modified_ms": 1741845569000, "last_modified_iso": "2025-03-13T13:59:29+08:00", "excerpt": "本文以部署HuggingFace上的Stable Diffusion为例，演示如何使用DataCache。通过DataCache提前拉取Stable Diffusion相关模型数据，然后在创建Stable Diffusion应用Pod时直接挂载模型数据，可以免去在Pod中拉取模型数据的等待时间，加速Stable Diffusion应用部署。\n## 背景信息\n\nStable Diffusion是一个可以根据文字描述生成和修改图像的模型。Stable Diffusion分为文字理解和图片生成两个部分。文字理解部分使用CLIP模型对文本进行Encoding，图片生成采用Diffusion模型。重要 \n\n- \n\n阿里云不对第三方模型的合法性、安全性、准确性进行任何保证，阿里云不对由此引发的任何损害承担责任。\n- \n\n您应自觉遵守第三方模型的用户协议、使用规范和相关法律法规，并就使用第三方模型的合法性、合规性自行承担相关责任。\n\n## 前提条件\n\n- \n\n集群中已[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n- \n\n集群所属VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建DataCache和部署应用时绑定EIP，以便可以拉取公网数据。\n\n## 准备运行环境\n\n部署Stable Diffusion应用需要准备好包含Stable Diffusion运行所需环境的容器镜像，环境需求包括CUDA、Diffusers库，以及其他的基础依赖等。ECI已经准备好了能运行大多数模型的稳定环境的容器镜像。如果您的应用没有特殊依赖，可以直接使用。\n\n- \n\n启动HTTP服务的镜像\n\n- \n\nGPU版：registry.cn-hangzhou.aliyuncs.com/eci_open/ubuntu:cuda11.7.1-cudnn8-ubuntu20.04\n- \n\nCPU版：registry.cn-hangzhou.aliyuncs.com/eci_open/ubuntu:hf-ubuntu20.04\n\n镜像相关信息参考如下：\n\n展开查看构建镜像的完整Dockerfile\n\n以下Dockerfile可以构建一个基于Ubuntu和Python的开发环境，并预安装一些常用依赖。在启动容器后，可以使用命令python3 http-server.py启动一个HTTP服务。\n\nFROM nvidia/cuda:11.7.1-cudnn8-runtime-ubuntu20.04\nLABEL maintainer=\"Alibaba Cloud Serverless Container\"\n\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt update && \\\n    apt install -y bash \\\n                   vim \\\n                   build-essential \\\n                   git \\\n                   git-lfs \\\n                   curl \\\n                   ca-certificates \\\n                   libsndfile1-dev \\\n                   libgl1 \\\n                   python3.8 \\\n                   python3-pip \\\n                   python3.8-venv && \\\n    rm -rf /var/lib/apt/lists\n\n# make sure to use venv\nRUN python3 -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN mkdir -p /workspace/pic/\nWORKDIR /workspace\nCOPY http-server.py http-server.py\n\n# pre-install the heavy dependencies (these can later be overridden by the deps from setup.py)\nRUN python3 -m pip install --no-cache-dir --upgrade pip && \\\n    python3 -m pip install --no-cache-dir \\\n        torch \\\n        torchvision \\\n        torchaudio \\\n        invisible_watermark && \\\n    python3 -m pip install --no-cache-dir \\\n        accelerate \\\n        datasets \\\n        hf-doc-builder \\\n        huggingface-hub \\\n        Jinja2 \\\n        librosa \\\n        numpy \\\n        scipy \\\n        tensorboard \\\n        transformers \\\n        omegaconf \\\n        pytorch-lightning \\\n        xformers \\\n        safetensors \\\n        diffusers\n        \n\nCMD [\"/bin/bash\"]\n\n\n展开查看镜像中用到的HTTP服务脚本\n\nhttp-server.py脚本是一个简单的HTTP服务，用于接收输入的文本，生成对应的图片，并返回图片路径。\n\nimport os\nimport hashlib\nimport torch\nfrom diffusers import StableDiffusionPipeline, DPMSolverMultistepScheduler\nfrom http.server import BaseHTTPRequestHandler\nfrom http.server import HTTPServer\nfrom urllib.parse import urlparse, parse_qs\n\nMODEL_DIR_NEV = \"MODEL_DIR\"\nAPP_PORT_ENV = \"APP_PORT\"\n\ndef text2image(input):\n    model_id = os.getenv(MODEL_DIR_NEV, default=\"/data/model/\")\n    pipe = StableDiffusionPipeline.from_pretrained(model_id, torch_dtype=torch.float16)\n\n    pipe.scheduler = DPMSolverMultistepScheduler.from_config(pipe.scheduler.config)\n    pipe = pipe.to(\"cuda\")\n\n    image = pipe(input).images[0]\n    name = \"/workspace/pic/\" + hashlib.md5(input.encode('utf8')).hexdigest() + \".png\"\n    image.save(name)\n    return name\n\nclass GetHandler(BaseHTTPRequestHandler):\n\n    def do_GET(self):\n        query = parse_qs(urlparse(self.path).query)\n        # 获取参数值\n        input = query.get('input')[0]\n        print(\"get user input:%s, try generate image\" % input)\n        picName = text2image(input)\n        # 构造响应\n        self.send_response(200)\n        self.send_header('Content-type', 'text/html')\n        self.end_headers()\n        self.wfile.write(bytes(\"<html><head><title>Stable Diffusion</title></head>\", \"utf-8\"))\n        self.wfile.write(bytes(\"<body><p>Success generate image:%s</p>\" % picName, \"utf-8\"))\n        self.wfile.write(bytes(\"</body></html>\", \"utf-8\"))\n\nif __name__ == '__main__':\n   "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-datacache-to-speed-up-building-alpaca-lora", "page_type": "doc", "title": "搭建Alpaca-LoRa", "keywords": "搭建Alpaca-LoRa应用,使用DataCache缓存模型,Alpaca-LoRa实践教程,DataCache使用方法", "last_modified_ms": 1741845584000, "last_modified_iso": "2025-03-13T13:59:44+08:00", "excerpt": "本文以搭建Alpaca-LoRa为例，演示如何使用DataCache。通过DataCache提前拉取llama-7b-hf模型数据和alpaca-lora-7b权重数据，然后在创建Alpaca-LoRa应用Pod时直接挂载模型和权重数据，可以免去在Pod中拉取数据的等待时间，加速Apache-LoRa启动过程。\n## 背景信息\n\nAlpaca-LoRa是一种使用Lora技术在LLaMA模型进行微调的轻量级语言模型。它可以模拟自然语言进行对话交互，根据用户输入的指令来生成不同的文本，协助用户完成写作、翻译、编写代码等任务。重要 \n\n- \n\n阿里云不对第三方模型的合法性、安全性、准确性进行任何保证，阿里云不对由此引发的任何损害承担责任。\n- \n\n您应自觉遵守第三方模型的用户协议、使用规范和相关法律法规，并就使用第三方模型的合法性、合规性自行承担相关责任。\n\n## 前提条件\n\n- \n\n集群中已[部署DataCache CRD](https://help.aliyun.com/zh/eci/user-guide/deploy-datacache-crd)。\n- \n\n集群所属VPC已绑定公网NAT网关，并配置SNAT条目允许该VPC或下属交换机的资源可以访问公网。说明 \n\n如果VPC没有绑定公网NAT网关，您需要在创建DataCache和部署应用时绑定EIP，以便可以拉取公网数据。\n\n## 操作步骤\n### 制作Alpaca-LoRa镜像\n\n请根据自身业务需求，参考以下步骤制作镜像。\n\n- \n\n访问[alpaca-lora](https://github.com/tloen/alpaca-lora)，将仓库克隆到本地。\n- \n\n修改仓库中的requirements.txt和Dockerfile。\n\n展开查看requirements.txt\n\naccelerate\nappdirs\nloralib\nbitsandbytes\nblack\nblack[jupyter]\ndatasets\nfire\ngit+https://github.com/huggingface/peft.git\ntransformers>=4.28.0\nsentencepiece\ngradio\nscipy\n\n\n展开查看Dockerfile\n\nFROM nvidia/cuda:11.8.0-devel-ubuntu22.04\n\nARG DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && apt-get install -y \\\n    git \\\n    curl \\\n    software-properties-common \\\n    && add-apt-repository ppa:deadsnakes/ppa \\\n    && apt install -y python3.10 \\\n    && rm -rf /var/lib/apt/lists/*\nWORKDIR /workspace\nCOPY requirements.txt requirements.txt\nRUN curl -sS https://bootstrap.pypa.io/get-pip.py | python3.10 \\\n    && python3.10 -m pip install -r requirements.txt \\\n    && python3.10 -m pip install numpy --pre torch --force-reinstall --index-url https://download.pytorch.org/whl/nightly/cu118 \\\n    && python3.10 -m pip install --upgrade typing-extensions\nCOPY . .\n\nEXPOSE 7860\n\n\n- \n\n使用Dockerfile构建镜像。\n- \n\n将镜像推送到镜像仓库中。\n\n### 创建DataCache\n\n- \n\n访问[HuggingFace](https://huggingface.co/)，获取模型ID。\n\n本文使用以下两个模型，在HuggingFace找到目标模型后，在模型详情页面顶部可以复制模型ID。\n\n- \n\ndecapoda-research/llama-7b-hf\n- \n\ntloen/alpaca-lora-7b\n\n- \n\n创建DataCache。\n\n- \n\n创建llama-7b-hf的DataCache。\n\nkubectl apply -f llama-7b-hf.yaml\n\n\nllama-7b-hf.yaml的内容如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: llama-7b-hf\nspec:\n  path: /model/llama-7b-hf                          # 设置模型数据的存储路径\n  bucket: test                                      # 指定DataCache Bucket\n  dataSource:\n    type: URL \n    options:\n      repoSource: \"HuggingFace/Model\"               # 指定数据源为HuggingFace的模型\n      repoId: \"decapoda-research/llama-7b-hf\"       # 指定模型ID\n  netConfig: \n    securityGroupId: sg-2ze63v3jtm8e6sy******\n    vSwitchId: vsw-2ze94pjtfuj9vaym******           # 指定已配置SNAT的交换机\n\n\n- \n\n创建alpaca-lora-7b的DataCache。\n\nkubectl apply -f alpaca-lora-7b.yaml\n\n\nalpaca-lora-7b.yaml的内容如下：\n\napiVersion: eci.aliyun.com/v1alpha1\nkind: DataCache\nmetadata:\n  name: alpaca-lora-7b\nspec:\n  path: /model/alpaca-lora-7b                        # 设置模型数据的存储路径\n  bucket: test                                       # 指定DataCache Bucket\n  dataSource:\n    type: URL \n    options:\n      repoSource: \"HuggingFace/Model\"               # 指定数据源为HuggingFace的模型\n      repoId: \"tloen/alpaca-lora-7b\"                # 指定模型ID\n  netConfig: \n    securityGroupId: sg-2ze63v3jtm8e6sy******\n    vSwitchId: vsw-2ze94pjtfuj9vaym******           # 指定已配置SNAT的交换机\n\n\n- \n\n查询DataCache状态。\n\nkubectl get edc\n\n\n当数据下载完成，DataCache的状态为Available时，表示可以使用DataCache。示例如下：\n\n### 部署Alpaca-lora应用\n\n- \n\n编写应用的YAML配置文件，然后使用该YAML文件部署Alpaca-lora应用。\n\nkubectl create -f alpacalora.yaml\n\n\nalpacalora.yaml的内容示例如下，可以创建两个资源对象：\n\n- \n\nDeployment：名称为alpacalora，包含一个Pod副本。Pod增加了20 GiB的临时存储空间，并挂载了llama-7b-hf和alpaca-lora-7b缓存数据。Pod内容器使用的镜像为您制作好的Alpaca-LoRa镜像，容器启动后会运行python3.10 generate.py --load_8bit --base_model /data/llama-7b-hf --lora_weights /data/alpaca-lora-7b。\n- \n\nService：名称为alpacalora-svc，类型为LoadBalancer，对外公开80端口，可以将流量转发到带有app: alpacalora的Label的Pod的7860端口。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: alpacalora\n  labels:\n    app: alpacalora\nspec:\n  replicas: 1 \n  selector:\n    matchLabels:\n      app: alpacalora\n  template:\n    metadata:\n      labels:\n        app: alpacalora\n      annotations:\n        k8s.aliyun.com/eci"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-eci-profile-to-schedule-pods-to-a-vnode", "page_type": "doc", "title": "使用eci-profile调度Pod到VNode", "keywords": "使用eci-profile调度Pod,部署eci-profile组件,配置eci-profile策略,eci-profile功能说明,eci-profile调度策略", "last_modified_ms": 1724219652000, "last_modified_iso": "2024-08-21T13:54:12+08:00", "excerpt": "eci-profile可以提供集群维度的ECI资源视图，支持根据Selector实现Pod编排。本文介绍如何部署eci-profile组件，以及如何使用eci-profile。\n\n## eci-profile功能说明\n\neci-profile可以通过Pod、Namespace的Label筛选符合条件的Pod，实现以下功能：\n\n- \n\n添加Annotation和Label\n- \n\n执行调度策略\n\n支持的调度策略如下：\n\n[表格]\n\n策略\n\n说明\n\nfair\n\n公平调度，由kube-scheduler决定调度到标准Node或VNode。\n\nnormalNodePrefer\n\n优先调度到标准Node，标准Node资源不足时允许调度到VNode。\n\nvirtualNodeOnly\n\nPod只会调度到VNode。\n说明 \n\n本文部署的eci-profile组件通过Selector CRD实现Pod自动调度。如果您之前已经部署了旧版eci-profile组件（通过ConfigMap实现），仍可以继续使用。建议您升级到Selector CRD模式，后续ConfigMap模式不再支持新增功能。更多信息，请参见[升级说明](#c49352f0544or)。\n\n## 部署eci-profile组件\n### 通过VNodectl工具\n\n如果您已安装配置VNodectl工具，可以执行以下命令一键部署eci-profile。\n\n- \n\n部署eci-profile。\n\nvnode addon enable eci-profile --kubeconfig /path/to/kubeconfig\n\n\n- \n\n查看eci-profile部署状态。\n\nvnode addon list\n\n\n预期返回如下，其中eci-profile的STATUS为enabled。\n\n|----------------|------------|------------|-------------------------------------------------|\n|   ADDON NAME   |   STATUS   | MAINTAINER |                   REPOSITORY                    |\n|----------------|------------|------------|-------------------------------------------------|\n| eci-profile    | enabled ✅ | ECI Group  | https://github.com/aliyuneci/eci-profile.git    |\n| vnode-approver | enabled ✅ | ECI Group  | https://github.com/aliyuneci/vnode-approver.git |\n|----------------|------------|------------|-------------------------------------------------|\n\n\n### 手动部署\n\n- \n\n将以下内容保存为eci-profile.yaml。\n\n请根据您的集群版本复制对应YAML。\n## 集群版本为1.16及以上\n\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: eci-profile\nrules:\n  - apiGroups:\n      - \"\"\n    resources:\n      - nodes\n      - namespaces\n      - resourcequotas\n    verbs:\n      - get\n      - list\n      - watch\n  - apiGroups:\n      - \"\"\n    resources:\n      - pods\n    verbs:\n      - get\n      - list\n      - watch\n      - create\n      - patch\n  - apiGroups:\n      - \"admissionregistration.k8s.io\"\n    resources:\n      - mutatingwebhookconfigurations\n    verbs:\n      - get\n      - patch\n      - create\n      - delete\n  - apiGroups:\n      - \"eci.aliyun.com\"\n    resources:\n      - selectors\n    verbs:\n      - get\n      - watch\n      - list\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: eci-profile\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: eci-profile\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: eci-profile\nsubjects:\n- kind: ServiceAccount\n  name: eci-profile\n  namespace: kube-system\n---\napiVersion: apiextensions.k8s.io/v1\nkind: CustomResourceDefinition\nmetadata:\n  annotations:\n    controller-gen.kubebuilder.io/version: (devel)\n  creationTimestamp: null\n  name: selectors.eci.aliyun.com\nspec:\n  group: eci.aliyun.com\n  names:\n    kind: Selector\n    listKind: SelectorList\n    plural: selectors\n    singular: selector\n  scope: Namespaced\n  versions:\n  - name: v1\n    schema:\n      openAPIV3Schema:\n        properties:\n          apiVersion:\n            description: 'APIVersion defines the versioned schema of this representation\n              of an object. Servers should convert recognized schemas to the latest\n              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'\n            type: string\n          kind:\n            description: 'Kind is a string value representing the REST resource this\n              object represents. Servers may infer this from the endpoint the client\n              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'\n            type: string\n          metadata:\n            type: object\n          spec:\n            properties:\n              effect:\n                properties:\n                  annotations:\n                    additionalProperties:\n                      type: string\n                    type: object\n                  labels:\n                    addit"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-imagecache-to-accelerate-the-creation-of-pods", "page_type": "doc", "title": "使用ImageCache加速创建Pod", "keywords": "使用ImageCache,加速Pod创建,ImageCache配置说明,ImageCache配置示例", "last_modified_ms": 1727167244000, "last_modified_iso": "2024-09-24T16:40:44+08:00", "excerpt": "阿里云以ImageCache CRD的方式将ECI的镜像缓存功能提供给Kubernetes用户，以便Kubernetes用户也可以使用该功能来加速创建Pod。本文介绍如何使用ImageCache加速创建Pod。\n## 配置说明\n\nImageCache（即镜像缓存）是Cluster级别的资源，因此在不同的namespace下创建Pod时均可以使用ImageCache来实现加速创建Pod。\n\n使用ImageCache创建Pod包括自动匹配和明确指定两种方式。您可以在Pod级别的metadata中添加Annotation来配置。相关Annotation如下：说明 \n\n- \n\n建议使用自动匹配方式。如果同时设置了两种方式，则明确指定方式的优先级高于自动匹配方式。更多信息，请参见[镜像缓存概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2#topic-2131957)。\n- \n\n使用自动匹配方式时，如果您的业务场景希望在完全匹配的情况下才使用ImageCache，可以设置imc-perfect-match或imc-match-count-request。此时，建议使用imc-perfect-match；如果同时设置两者，imc-perfect-match的优先级更高。\n\n[表格]\n\n使用方式\n\n配置项\n\n示例值\n\n说明\n\n自动匹配\n\nk8s.aliyun.com/eci-auto-imc\n\n\"true\"\n\n是否自动匹配ImageCache，默认为true，表示系统会根据匹配策略自动匹配最优的ImageCache创建Pod。匹配策略的优先级从高到低依次为：镜像匹配度、匹配的镜像大小、创建时间。\n\n如果没有完全匹配，系统会在创建Pod的同时自动创建对应的ImageCache。\n\nk8s.aliyun.com/imc-perfect-match\n\n\"true\"\n\nPod内所有容器镜像是否均要完全匹配ImageCache。默认为false。\n\nk8s.aliyun.com/imc-match-count-request\n\n\"2\"\n\nPod内要完全匹配ImageCache的容器镜像个数。\n\n明确指定\n\nk8s.aliyun.com/eci-imc-id\n\nimc-2zebxkiifuyzzlhl****\n\n明确指定使用某个ImageCache创建Pod。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\n使用ImageCache创建Pod时，请注意以下事项：\n\n- \n\nPod内容器的镜像建议采用已有ImageCache的镜像，可以提高匹配度。\n- \n\nPod中容器的镜像拉取策略（ImagePullPolicy）建议设置为按需拉取（IfNotPresent），可以避免镜像层重复下载。\n\n#### 示例一：自动匹配ImageCache\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-auto-imc: \"true\"       # 开启自动匹配ImageCache\n        k8s.aliyun.com/imc-perfect-match: \"true\"  # 设置Pod内所有容器镜像均需完全匹配\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        imagePullPolicy: IfNotPresent\n      - name: busybox\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n        command: [\"sleep\"]\n        args: [\"999999\"]\n        imagePullPolicy: IfNotPresent\n\n\n#### 示例二：明确指定ImageCache重要 \n\n请确保指定的ImageCache的状态为Ready，其它状态的ImageCache会导致Pod创建失败。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-imc-id: imc-2ze5tm5gehgtiiga****  # 明确指定ImageCache\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        imagePullPolicy: IfNotPresent\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-imagecache-to-accelerate-the-creation-of-pods-2", "page_type": "doc", "title": "使用ImageCache加速创建Pod", "keywords": "使用ImageCache加速Pod,配置ImageCache注解,ImageCache配置方法,ImageCache使用示例", "last_modified_ms": 1727167639000, "last_modified_iso": "2024-09-24T16:47:19+08:00", "excerpt": "阿里云以ImageCache CRD的方式将ECI的镜像缓存功能提供给Kubernetes用户，以便Kubernetes用户也可以使用该功能来加速创建Pod。本文介绍如何使用ImageCache加速创建Pod。\n## 配置说明\n\nImageCache（即镜像缓存）是Cluster级别的资源，因此在不同的namespace下创建Pod时均可以使用ImageCache来实现加速创建Pod。\n\n使用ImageCache创建Pod包括自动匹配和明确指定两种方式。您可以在Pod级别的metadata中添加Annotation来配置。相关Annotation如下：说明 \n\n- \n\n建议使用自动匹配方式。如果同时设置了两种方式，则明确指定方式的优先级高于自动匹配方式。更多信息，请参见[镜像缓存概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2#topic-2131957)。\n- \n\n使用自动匹配方式时，如果您的业务场景希望在完全匹配的情况下才使用ImageCache，可以设置imc-perfect-match或imc-match-count-request。此时，建议使用imc-perfect-match；如果同时设置两者，imc-perfect-match的优先级更高。\n\n[表格]\n\n使用方式\n\n配置项\n\n示例值\n\n说明\n\n自动匹配\n\nk8s.aliyun.com/eci-auto-imc\n\n\"true\"\n\n是否自动匹配ImageCache，默认为true，表示系统会根据匹配策略自动匹配最优的ImageCache创建Pod。匹配策略的优先级从高到低依次为：镜像匹配度、匹配的镜像大小、创建时间。\n\n如果没有完全匹配，系统会在创建Pod的同时自动创建对应的ImageCache。\n\nk8s.aliyun.com/imc-perfect-match\n\n\"true\"\n\nPod内所有容器镜像是否均要完全匹配ImageCache。默认为false。\n\nk8s.aliyun.com/imc-match-count-request\n\n\"2\"\n\nPod内要完全匹配ImageCache的容器镜像个数。\n\n明确指定\n\nk8s.aliyun.com/eci-imc-id\n\nimc-2zebxkiifuyzzlhl****\n\n明确指定使用某个ImageCache创建Pod。重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n## 配置示例\n\n使用ImageCache创建Pod时，请注意以下事项：\n\n- \n\nPod内容器的镜像建议采用已有ImageCache的镜像，可以提高匹配度。\n- \n\nPod中容器的镜像拉取策略（ImagePullPolicy）建议设置为按需拉取（IfNotPresent），可以避免镜像层重复下载。\n\n#### 示例一：自动匹配ImageCache\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-auto-imc: \"true\"       # 开启自动匹配ImageCache\n        k8s.aliyun.com/imc-perfect-match: \"true\"  # 设置Pod内所有容器镜像均需完全匹配\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        imagePullPolicy: IfNotPresent\n      - name: busybox\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/busybox:1.30\n        command: [\"sleep\"]\n        args: [\"999999\"]\n        imagePullPolicy: IfNotPresent\n\n\n#### 示例二：明确指定ImageCache重要 \n\n请确保指定的ImageCache的状态为Ready，其它状态的ImageCache会导致Pod创建失败。\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-imc-id: imc-2ze5tm5gehgtiiga****  # 明确指定ImageCache\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        imagePullPolicy: IfNotPresent\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-probes-to-perform-health-checks-on-containers", "page_type": "doc", "title": "使用探针对容器进行健康检查", "keywords": "配置ECI容器探针,进行容器健康检查,容器探针配置方法,容器探针功能说明", "last_modified_ms": 1722582495000, "last_modified_iso": "2024-08-02T15:08:15+08:00", "excerpt": "Liveness Probe和Readiness Probe是用于检测容器状态的机制，其中Liveness Probe用于检测容器是否正常运行，Readiness Probe用于检测容器是否已经就绪。本文介绍如何配置Liveness Probe和Readiness Probe对容器进行健康检查，以便ECI更好地监控和管理容器的运行状态，确保服务的高可用性和稳定性。\n## 功能说明\n\nECI支持通过存活探针和业务探针来检查容器的状态和运行情况。\n\n[表格]\n\n探针\n\n说明\n\n应用场景\n\n应用存活探针（ Liveness Probe）\n\n用于检查容器是否正常运行。\n\n- \n\n如果检查成功，则表示容器正常运行。\n- \n\n如果检查失败，系统会根据配置的容器重启策略进行相应的处理。\n- \n\n如果未配置该探针，则默认容器一直正常运行。\n\n- \n\n当应用程序处于运行状态但无法进行进一步操作时，Liveness Probe将捕获到deadlock，重启对应的容器，使得应用程序在存在bug的情况下依然能够运行。\n- \n\n长时间运行的应用程序最终可能会转换到broken状态，此时除了重新启动，无法恢复。Liveness Probe可以检测并补救这种情况。\n\n应用业务探针（Readiness Probe）\n\n用于检查容器是否已经准备就绪，可以为请求提供服务。\n\n- \n\n如果检查成功，则表示容器已经准备就绪，可以接收业务请求。\n- \n\n如果检查失败，则表示容器没有准备就绪，系统将停止向该容器发送任何请求，直至重新检查成功。\n- \n\n如果未配置该探针，则默认容器已经准备就绪。\n\n如果应用程序暂时无法对外部流量提供服务，例如应用程序需要在启动期间加载大量数据或配置文件，此时，如果不想终止应用程序，也不想向其发送请求，可以通过Readiness Probe来检测和缓解这种情况。\n\n## 配置说明（OpenAPI）\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过容器中的LivenessProbe和ReadinessProbe参数来设置应用存活探针和应用业务探针。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n#### LivenessProbe相关参数重要 \n\n设置LivenessProbe相关参数时，HttpGet、Exec和TcpSocket这三种检查方式，只能选择其中一种。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.LivenessProbe.HttpGet.Path\n\nstring\n\n/healthyz\n\n使用HTTP请求方式进行健康检查时，HTTP Get请求检测的路径。\n\nContainer.N.LivenessProbe.HttpGet.Port\n\ninteger\n\n8888\n\n使用HTTP请求方式进行健康检查时，HTTP Get请求检测的端口号。\n\nContainer.N.LivenessProbe.HttpGet.Scheme\n\nstring\n\nHTTP\n\n使用HTTP请求方式进行健康检查时，HTTP Get请求对应的协议类型，取值范围：\n\n- \n\nHTTP\n- \n\nHTTPS\n\nContainer.N.LivenessProbe.Exec.Command.N\n\narray\n\ncat /tmp/healthy\n\n使用命令行方式进行健康检查时，在容器内执行的命令。\n\nContainer.N.LivenessProbe.TcpSocket.Port\n\ninteger\n\n8000\n\n使用TCP Socket方式进行健康检查时，TCP Socket检测的端口。\n\nContainer.N.LivenessProbe.InitialDelaySeconds\n\ninteger\n\n5\n\n容器启动多久后开始检查。单位为秒。\n\nContainer.N.LivenessProbe.PeriodSeconds\n\ninteger\n\n1\n\n检查执行的周期，默认为10秒，最小为1秒。\n\nContainer.N.LivenessProbe.SuccessThreshold\n\ninteger\n\n1\n\n从上次检查失败后重新认定检查成功的检查次数阈值（必须是连续成功），默认为1。当前必须为1。\n\nContainer.N.LivenessProbe.FailureThreshold\n\ninteger\n\n3\n\n从上次检查成功后认定检查失败的检查次数阈值（必须是连续失败），默认为3。\n\nContainer.N.LivenessProbe.TimeoutSeconds\n\ninteger\n\n1\n\n检查超时的时间，默认为1秒，最小为1秒。\n#### ReadinessProbe相关参数重要 \n\n设置ReadinessProbe相关参数时，HttpGet、Exec和TcpSocket这三种检查方式，只能选择其中一种。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nContainer.N.ReadinessProbe.HttpGet.Path\n\nstring\n\n/healthyz\n\n使用HTTP请求方式进行健康检查时，HTTP Get请求检测的路径。\n\nContainer.N.ReadinessProbe.HttpGet.Port\n\ninteger\n\n8888\n\n使用HTTP请求方式进行健康检查时，HTTP Get请求检测的端口号。\n\nContainer.N.ReadinessProbe.HttpGet.Scheme\n\nstring\n\nHTTP\n\n使用HTTP请求方式进行健康检查时，HTTP Get请求对应的协议类型，取值范围：\n\n- \n\nHTTP\n- \n\nHTTPS\n\nContainer.N.ReadinessProbe.Exec.Command.N\n\narray\n\ncat /tmp/healthy\n\n使用命令行方式进行健康检查时，在容器内执行的命令。\n\nContainer.N.ReadinessProbe.TcpSocket.Port\n\ninteger\n\n8000\n\n使用TCP Socket方式进行健康检查时，TCP Socket检测的端口。\n\nContainer.N.ReadinessProbe.InitialDelaySeconds\n\ninteger\n\n5\n\n容器启动多久后开始检查。单位为秒。\n\nContainer.N.ReadinessProbe.PeriodSeconds\n\ninteger\n\n1\n\n检查执行的周期，默认为10秒，最小为1秒。\n\nContainer.N.ReadinessProbe.SuccessThreshold\n\ninteger\n\n1\n\n从上次检查失败后重新认定检查成功的检查次数阈值（必须是连续成功），默认为1。当前必须为1。\n\nContainer.N.ReadinessProbe.FailureThreshold\n\ninteger\n\n3\n\n从上次检查成功后认定检查失败的检查次数阈值（必须是连续失败），默认为3。\n\nContainer.N.ReadinessProbe.TimeoutSeconds\n\ninteger\n\n1\n\n检查超时的时间，默认为1秒，最小为1秒。\n## 配置说明（控制台）\n\n通过[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/createEci?regionId=cn-shanghai)创建ECI实例时，您可以在容器配置区域选择容器，展开该容器的高级配置，然后打开监控检查开关，并配置探针。示例如下：说明 \n\n使用控制台配置时，仅支持命令行和HTTP请求两种检查方式，不支持TCP Socket方式。\n\n[表格]\n\n参数\n\n描述\n\n时间设置\n\n- \n\n延迟时间：容器启动多久后开始检查。\n- \n\n超时时间：检查的超时等待时间，如果超时，则视为检查失败。\n\n检查方式\n\n根据需要选择检查方式。\n\n- \n\n命令行脚本：探针在容器内执行命令，并检查命令退出的状态码，如果状态码为0，则表示检查成功。\n- \n\nHTTP请求方式：探针向容器发送HTTP请求，如果返回状态码符合以下要求：200≤状态码<400，则表示检查成功。\n\n命令行脚本\n\n当检查方式为命令行脚本时，需要配置在容器内执行的命令行脚本。\n\nHTTP请求方式\n\n当检查方式为HTTP请求方式时，需要配置HTTP Get请求包含的路径、端口和协议。\n## 配置示例\n\n创建一台设置了Liveness Probe和Readiness Probe的ECI实例，然后模拟服务异常，以查看探针的配置效果。\n\n- \n\n调用CreateContainerGroup接口创建一台ECI实例。\n\n以下示例采用TCP Socket方式进行健康检查：\n\nContainerGroupName=test-probe\n# 使用Nginx镜像，同时自动创建和绑定一个EIP\nContainer.1.Name=container-1\nContainer.1.Image=nginx\nAutoCreateEip=true\n# 配置应用存活探针，在容器运行5秒后，每3秒检测一次80端口，成功阈值为1次，失败阈值为3次，超时时间为10秒\nContainer.1.LivenessProbe.TcpSocket.Port=80\nContainer"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-probes-to-perform-health-checks-on-containers-1", "page_type": "doc", "title": "使用探针对容器进行健康检查", "keywords": "配置容器健康检查,了解容器探针,容器探针配置,容器探针功能", "last_modified_ms": 1722582524000, "last_modified_iso": "2024-08-02T15:08:44+08:00", "excerpt": "Liveness Probe和Readiness Probe是用于检测容器状态的机制，其中Liveness Probe用于检测容器是否正常运行，Readiness Probe用于检测容器是否已经就绪。本文介绍如何配置Liveness Probe和Readiness Probe对容器进行健康检查，以便Kubernetes可以更好地监控和管理容器的运行状态，确保服务的高可用性和稳定性。\n## 功能说明\n\n在Kubernetes中，容器的健康检查由kubelet定期执行。kubelet通过Liveness Probe和Readiness Probe来检查容器的状态和运行情况。\n\n[表格]\n\n探针\n\n说明\n\n应用场景\n\n应用存活探针（ Liveness Probe）\n\n用于检查容器是否正常运行。\n\n- \n\n如果检查成功，则表示容器正常运行。\n- \n\n如果检查失败，系统会根据配置的容器重启策略进行相应的处理。\n- \n\n如果未配置该探针，则默认容器一直正常运行。\n\n- \n\n当应用程序处于运行状态但无法进行进一步操作时，Liveness Probe将捕获到deadlock，重启对应的容器，使得应用程序在存在bug的情况下依然能够运行。\n- \n\n长时间运行的应用程序最终可能会转换到broken状态，此时除了重新启动，无法恢复。Liveness Probe可以检测并补救这种情况。\n\n应用业务探针（Readiness Probe）\n\n用于检查容器是否已经准备就绪，可以为请求提供服务。\n\n- \n\n如果检查成功，则表示容器已经准备就绪，可以接收业务请求。\n- \n\n如果检查失败，则表示容器没有准备就绪，系统将停止向该容器发送任何请求，直至重新检查成功。\n- \n\n如果未配置该探针，则默认容器已经准备就绪。\n\n如果应用程序暂时无法对外部流量提供服务，例如应用程序需要在启动期间加载大量数据或配置文件，此时，如果不想终止应用程序，也不想向其发送请求，可以通过Readiness Probe来检测和缓解这种情况。\n## 配置示例\n\n您可以通过容器的livenessProbe和readinessProbe字段来设置Liveness Probe或者Readiness Probe。更多信息，请参见[配置存活、就绪和启动探测器](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)。\n#### 示例一：设置Liveness Probe\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        args:\n        - /bin/sh\n        - -c\n        - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600\n       # 设置Liveness Probe，通过命令行方式进行检查\n        livenessProbe:    \n          exec:           \n            command:\n            - cat\n            - /tmp/healthy\n          initialDelaySeconds: 5    # 容器启动5秒后开始检查\n          periodSeconds: 5     # 每5秒执行一次检查\n\n\n#### 示例二：设置Readiness Probe\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        args:\n        - /bin/sh\n        - -c\n        - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600\n        # 设置Readiness Probe，通过命令行方式进行检查\n        readinessProbe:\n          exec:           \n            command:\n            - cat\n            - /tmp/healthy\n          initialDelaySeconds: 5    # 容器启动5秒后开始检查\n          periodSeconds: 5     # 每5秒执行一次检查\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-probes-to-perform-health-checks-on-containers-2", "page_type": "doc", "title": "使用探针对容器进行健康检查", "keywords": "配置容器探针,了解容器探针,容器探针配置,存活与就绪探针", "last_modified_ms": 1722582552000, "last_modified_iso": "2024-08-02T15:09:12+08:00", "excerpt": "Liveness Probe和Readiness Probe是用于检测容器状态的机制，其中Liveness Probe用于检测容器是否正常运行，Readiness Probe用于检测容器是否已经就绪。本文介绍如何配置Liveness Probe和Readiness Probe对容器进行健康检查，以便Kubernetes可以更好地监控和管理容器的运行状态，确保服务的高可用性和稳定性。\n## 功能说明\n\n在Kubernetes中，容器的健康检查由kubelet定期执行。kubelet通过Liveness Probe和Readiness Probe来检查容器的状态和运行情况。\n\n[表格]\n\n探针\n\n说明\n\n应用场景\n\n应用存活探针（ Liveness Probe）\n\n用于检查容器是否正常运行。\n\n- \n\n如果检查成功，则表示容器正常运行。\n- \n\n如果检查失败，系统会根据配置的容器重启策略进行相应的处理。\n- \n\n如果未配置该探针，则默认容器一直正常运行。\n\n- \n\n当应用程序处于运行状态但无法进行进一步操作时，Liveness Probe将捕获到deadlock，重启对应的容器，使得应用程序在存在bug的情况下依然能够运行。\n- \n\n长时间运行的应用程序最终可能会转换到broken状态，此时除了重新启动，无法恢复。Liveness Probe可以检测并补救这种情况。\n\n应用业务探针（Readiness Probe）\n\n用于检查容器是否已经准备就绪，可以为请求提供服务。\n\n- \n\n如果检查成功，则表示容器已经准备就绪，可以接收业务请求。\n- \n\n如果检查失败，则表示容器没有准备就绪，系统将停止向该容器发送任何请求，直至重新检查成功。\n- \n\n如果未配置该探针，则默认容器已经准备就绪。\n\n如果应用程序暂时无法对外部流量提供服务，例如应用程序需要在启动期间加载大量数据或配置文件，此时，如果不想终止应用程序，也不想向其发送请求，可以通过Readiness Probe来检测和缓解这种情况。\n## 配置示例\n\n您可以通过容器的livenessProbe和readinessProbe字段来设置Liveness Probe或者Readiness Probe。更多信息，请参见[配置存活、就绪和启动探测器](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)。\n#### 示例一：设置Liveness Probe\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        args:\n        - /bin/sh\n        - -c\n        - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600\n       # 设置Liveness Probe，通过命令行方式进行检查\n        livenessProbe:    \n          exec:           \n            command:\n            - cat\n            - /tmp/healthy\n          initialDelaySeconds: 5    # 容器启动5秒后开始检查\n          periodSeconds: 5     # 每5秒执行一次检查\n\n\n#### 示例二：设置Readiness Probe\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n        args:\n        - /bin/sh\n        - -c\n        - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600\n        # 设置Readiness Probe，通过命令行方式进行检查\n        readinessProbe:\n          exec:           \n            command:\n            - cat\n            - /tmp/healthy\n          initialDelaySeconds: 5    # 容器启动5秒后开始检查\n          periodSeconds: 5     # 每5秒执行一次检查\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-reserved-instances", "page_type": "doc", "title": "使用预留实例券", "keywords": "用券抵扣ECI费用,购买预留实例券,查看券抵扣明细,ECI成本优化,预留实例券使用,预留实例券抵扣规则", "last_modified_ms": 1732675363000, "last_modified_iso": "2024-11-27T10:42:43+08:00", "excerpt": "如果您的业务是长时间运行的在线业务，在创建ECI实例时指定了ECS规格，推荐您使用预留实例券来抵扣ECI实例费用。本文介绍如何使用预留实例券来降低长时间运行的ECI实例的费用成本。\n## 购买预留实例券\n\n预留实例券是一种抵扣券，可以抵扣按量付费ECS实例（不含抢占式实例）的账单。如果您的ECI实例是指定ECS规格创建的，则对应的ECI实例费用可以使用预留实例券来抵扣。更多信息，请参见[预留实例券概述](https://help.aliyun.com/zh/ecs/user-guide/overview-6#concept-tc4-zhq-dgb)。\n\n预留实例券仅支持抵扣指定ECS规格创建的ECI实例。购买前，请了解以下信息：\n\n- \n\nECI仅支持指定部分ECS规格，请确保选择的ECS规格能够满足您的业务需求。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/#topic-1860130)。\n- \n\n预留实例券仅支持抵扣符合匹配规则的实例，请确保您的ECI实例符合预留实例券的使用要求。说明 \n\n购买预留实例券即代表承诺使用一定时长的实例资源，在有效期内，预留实例券将自动匹配满足条件的按量付费实例（您无法手动管理匹配状态）。匹配成功后，预留实例券每小时检查可抵扣的按量付费账单，并按券面的计算力抵扣账单。更多信息，请参见[预留实例券的抵扣规则](https://help.aliyun.com/zh/ecs/match-between-reserved-instances-and-pay-as-you-go-instances#concept-af1-zxq-dgb)。\n\n您可以在[ECS管理控制台的预留实例券页面](https://ecs.console.aliyun.com/reservedInstance/region/cn-shanghai)购买并管理预留实例券。具体操作，请参见[购买预留实例券](https://help.aliyun.com/zh/ecs/purchase-reserved-instances#concept-wvj-gjr-dgb)。\n\n- \n\n如果您希望对已有的ECI实例进行成本优化，可以筛选出指定ECS规格创建的ECI实例，并根据规格情况购买对应的预留实例券。\n- \n\n如果您还没有创建ECI实例，请根据业务需求选择合适的ECS规格，然后购买对应的预留实例券，并指定ECS规格创建ECI实例。\n- \n\n如果您已经购买了预留实例券，则在创建ECI实例时，必须要指定预留实例券对应的ECS规格，否则预留实例券无法抵扣。\n\n## 查看预留实例券抵扣信息\n\n您可以打开[费用与成本](https://usercenter2.aliyun.com/home)页面，查看实例账单和预留实例券的账单，确认券的抵扣情况。重要 \n\n在配置了多可用区创建ECI实例的场景下，创建的ECI实例可能会发布在多个可用区。如果您发现预留实例券未按预期进行抵扣，请检查预留实例券所在可用区和ECI实例所属可用区是否一致。如果不一致，您可以调整预留实例券为地域型（跨可用区），具体操作，请参见[修改预留实例券的可用区](https://help.aliyun.com/zh/ecs/split-merge-or-modify-reserved-instances#6d95c5c88fdmi)。\n\n- \n\n查看实例账单\n\n在账单 > 账单详情页面，在明细账单页签下，您可以按实例查看消费明细。对于预留实例券已经抵扣的实例费用，不会产生对应的实例账单。\n- \n\n查看预留实例券账单\n\n在账户 > 资源包页面，资源维度选择预留实例券，在使用明细页签下，您可以查看预留实例券的抵扣情况。\n\n预留实例券的使用明细将记录每个出账周期（每小时）该预留实例券抵扣的实例信息。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-reserved-instances-1", "page_type": "doc", "title": "使用预留实例券", "keywords": "抵扣ECI实例费用,购买预留实例券,查看券抵扣明细,ECI成本优化,预留实例券抵扣规则,预留实例券使用方法", "last_modified_ms": 1732675386000, "last_modified_iso": "2024-11-27T10:43:06+08:00", "excerpt": "如果您的业务是长时间运行的在线业务，在创建ECI实例时指定了ECS规格，推荐您使用预留实例券来抵扣ECI实例费用。本文介绍如何使用预留实例券来降低长时间运行的ECI实例的费用成本。\n## 购买预留实例券\n\n预留实例券是一种抵扣券，可以抵扣按量付费ECS实例（不含抢占式实例）的账单。如果您的ECI实例是指定ECS规格创建的，则对应的ECI实例费用可以使用预留实例券来抵扣。更多信息，请参见[预留实例券概述](https://help.aliyun.com/zh/ecs/user-guide/overview-6#concept-tc4-zhq-dgb)。\n\n预留实例券仅支持抵扣指定ECS规格创建的ECI实例。购买前，请了解以下信息：\n\n- \n\nECI仅支持指定部分ECS规格，请确保选择的ECS规格能够满足您的业务需求。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/#topic-1860130)。\n- \n\n预留实例券仅支持抵扣符合匹配规则的实例，请确保您的ECI实例符合预留实例券的使用要求。说明 \n\n购买预留实例券即代表承诺使用一定时长的实例资源，在有效期内，预留实例券将自动匹配满足条件的按量付费实例（您无法手动管理匹配状态）。匹配成功后，预留实例券每小时检查可抵扣的按量付费账单，并按券面的计算力抵扣账单。更多信息，请参见[预留实例券的抵扣规则](https://help.aliyun.com/zh/ecs/match-between-reserved-instances-and-pay-as-you-go-instances#concept-af1-zxq-dgb)。\n\n您可以在[ECS管理控制台的预留实例券页面](https://ecs.console.aliyun.com/reservedInstance/region/cn-shanghai)购买并管理预留实例券。具体操作，请参见[购买预留实例券](https://help.aliyun.com/zh/ecs/purchase-reserved-instances#concept-wvj-gjr-dgb)。\n\n- \n\n如果您希望对已有的ECI实例进行成本优化，可以筛选出指定ECS规格创建的ECI实例，并根据规格情况购买对应的预留实例券。\n- \n\n如果您还没有创建ECI实例，请根据业务需求选择合适的ECS规格，然后购买对应的预留实例券，并指定ECS规格创建ECI实例。\n- \n\n如果您已经购买了预留实例券，则在创建ECI实例时，必须要指定预留实例券对应的ECS规格，否则预留实例券无法抵扣。\n\n## 查看预留实例券抵扣信息\n\n您可以打开[费用与成本](https://usercenter2.aliyun.com/home)页面，查看实例账单和预留实例券的账单，确认券的抵扣情况。重要 \n\n在配置了多可用区创建ECI实例的场景下，创建的ECI实例可能会发布在多个可用区。如果您发现预留实例券未按预期进行抵扣，请检查预留实例券所在可用区和ECI实例所属可用区是否一致。如果不一致，您可以调整预留实例券为地域型（跨可用区），具体操作，请参见[修改预留实例券的可用区](https://help.aliyun.com/zh/ecs/split-merge-or-modify-reserved-instances#6d95c5c88fdmi)。\n\n- \n\n查看实例账单\n\n在账单 > 账单详情页面，在明细账单页签下，您可以按实例查看消费明细。对于预留实例券已经抵扣的实例费用，不会产生对应的实例账单。\n- \n\n查看预留实例券账单\n\n在账户 > 资源包页面，资源维度选择预留实例券，在使用明细页签下，您可以查看预留实例券的抵扣情况。\n\n预留实例券的使用明细将记录每个出账周期（每小时）该预留实例券抵扣的实例信息。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-reserved-instances-2", "page_type": "doc", "title": "使用预留实例券", "keywords": "抵扣ECI实例费用,购买预留实例券,查看券抵扣信息,ECI成本优化,预留实例券抵扣", "last_modified_ms": 1732675407000, "last_modified_iso": "2024-11-27T10:43:27+08:00", "excerpt": "如果您的业务是长时间运行的在线业务，在创建ECI实例时指定了ECS规格，推荐您使用预留实例券来抵扣ECI实例费用。本文介绍如何使用预留实例券来降低长时间运行的ECI实例的费用成本。\n## 购买预留实例券\n\n预留实例券是一种抵扣券，可以抵扣按量付费ECS实例（不含抢占式实例）的账单。如果您的ECI实例是指定ECS规格创建的，则对应的ECI实例费用可以使用预留实例券来抵扣。更多信息，请参见[预留实例券概述](https://help.aliyun.com/zh/ecs/user-guide/overview-6#concept-tc4-zhq-dgb)。\n\n预留实例券仅支持抵扣指定ECS规格创建的ECI实例。购买前，请了解以下信息：\n\n- \n\nECI仅支持指定部分ECS规格，请确保选择的ECS规格能够满足您的业务需求。更多信息，请参见[指定ECS规格创建实例](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-an-elastic-container-instance/#topic-1860130)。\n- \n\n预留实例券仅支持抵扣符合匹配规则的实例，请确保您的ECI实例符合预留实例券的使用要求。说明 \n\n购买预留实例券即代表承诺使用一定时长的实例资源，在有效期内，预留实例券将自动匹配满足条件的按量付费实例（您无法手动管理匹配状态）。匹配成功后，预留实例券每小时检查可抵扣的按量付费账单，并按券面的计算力抵扣账单。更多信息，请参见[预留实例券的抵扣规则](https://help.aliyun.com/zh/ecs/match-between-reserved-instances-and-pay-as-you-go-instances#concept-af1-zxq-dgb)。\n\n您可以在[ECS管理控制台的预留实例券页面](https://ecs.console.aliyun.com/reservedInstance/region/cn-shanghai)购买并管理预留实例券。具体操作，请参见[购买预留实例券](https://help.aliyun.com/zh/ecs/purchase-reserved-instances#concept-wvj-gjr-dgb)。\n\n- \n\n如果您希望对已有的ECI实例进行成本优化，可以筛选出指定ECS规格创建的ECI实例，并根据规格情况购买对应的预留实例券。\n- \n\n如果您还没有创建ECI实例，请根据业务需求选择合适的ECS规格，然后购买对应的预留实例券，并指定ECS规格创建ECI实例。\n- \n\n如果您已经购买了预留实例券，则在创建ECI实例时，必须要指定预留实例券对应的ECS规格，否则预留实例券无法抵扣。\n\n## 查看预留实例券抵扣信息\n\n您可以打开[费用与成本](https://usercenter2.aliyun.com/home)页面，查看实例账单和预留实例券的账单，确认券的抵扣情况。重要 \n\n在配置了多可用区创建ECI实例的场景下，创建的ECI实例可能会发布在多个可用区。如果您发现预留实例券未按预期进行抵扣，请检查预留实例券所在可用区和ECI实例所属可用区是否一致。如果不一致，您可以调整预留实例券为地域型（跨可用区），具体操作，请参见[修改预留实例券的可用区](https://help.aliyun.com/zh/ecs/split-merge-or-modify-reserved-instances#6d95c5c88fdmi)。\n\n- \n\n查看实例账单\n\n在账单 > 账单详情页面，在明细账单页签下，您可以按实例查看消费明细。对于预留实例券已经抵扣的实例费用，不会产生对应的实例账单。\n- \n\n查看预留实例券账单\n\n在账户 > 资源包页面，资源维度选择预留实例券，在使用明细页签下，您可以查看预留实例券的抵扣情况。\n\n预留实例券的使用明细将记录每个出账周期（每小时）该预留实例券抵扣的实例信息。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-resource-groups-to-control-the-permissions-of-a-ram-user", "page_type": "doc", "title": "通过资源组实现RAM用户鉴权", "keywords": "使用资源组管理ECI权限,实现RAM用户分权管理,资源组权限管理,ECI资源权限控制", "last_modified_ms": 1671702101000, "last_modified_iso": "2022-12-22T17:41:41+08:00", "excerpt": "创建ECI资源时，您可以指定所属的资源组，以便对资源进行分组管理。本文介绍如何通过资源组控制RAM用户的权限，实现RAM用户只能操作特定资源组内的ECI资源。\n## 背景信息\n\n资源组是在阿里云账号下进行资源分组管理的一种机制，可以帮助您解决单个阿里云账号内的资源分组和授权管理的问题。资源组的使用说明如下：\n\n- \n\n一个资源组可以包含不同地域的云资源。例如：资源组A中可以包含华北2（北京）地域的实例和华东1（杭州）地域的实例。\n- \n\n同一个账号内不同资源组中，相同地域的资源可以进行关联。例如：资源组A中华北2（北京）地域的实例可以加入到资源组B中华北2（北京）地域的VPC内。\n- \n\n资源组会继承RAM用户的全局权限，即：如果您授权RAM用户管理所有的阿里云资源，那么阿里云账号下所有的资源组都会在该RAM用户中显示出来。\n\n## 应用场景\n\n每个ECI资源（ECI实例、镜像缓存）必须且只能属于一个资源组。创建ECI资源时，您可以指定资源组，如果没有指定资源组，则该资源将加入到默认资源组中。说明 \n\n对于已创建的ECI资源，如果想要修改资源组，可至[资源管理控制台](https://resourcemanager.console.aliyun.com/)的资源组页面进行操作。具体操作，请参见[跨资源组转移资源](https://help.aliyun.com/zh/resource-management/resource-group/user-guide/resource-manual-transfer-group)。\n\n您可以将不同用途的ECI资源分别加入到多个资源组中，并为每个资源组设置不同的RAM用户作为管理员，从而实现分组、分权管理ECI资源。\n\n例如：如果您的ECI实例分别用于生产环境和测试环境，您可以将ECI实例分别加入到生产资源组和测试资源组中，授权RAM用户A可以操作生产资源组中的ECI实例，授权RAM用户B可以操作测试资源组中的ECI实例。配置完成后，当产品进行测试时，由RAM用户B操作测试资源组中的ECI实例。当产品需要上线时，由RAM用户A对生产资源组中的ECI实例进行操作。两套环境由不同的RAM用户进行管理，可以很好地控制权限，避免不必要的误操作。\n## 配置流程\n\n按以下场景为示例，创建多个资源组对ECI资源进行分组，并授权RAM用户只能操作特定资源组的ECI资源：\n\n- \n\n新增两个资源组：生产资源组、测试资源组。\n- \n\n新增两个RAM用户：RAM用户A具备生产环境的AliyunECIFullAccess权限，RAM用户B具备测试环境的AliyunECIFullAccess权限。说明 \n\nAliyunECIFullAccess是RAM提供的系统策略，包含操作ECI资源的所有权限。\n\n配置流程如下：\n\n- \n\n创建两个资源组。具体操作，请参见[创建资源组](https://help.aliyun.com/zh/resource-management/resource-group/user-guide/create-a-resource-group#task-xpl-kjm-4fb)。\n- \n\n创建两个RAM用户。具体操作，请参见[创建RAM用户](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-user#task-187540)。\n- \n\n分别为两个资源组设置对应的RAM用户作为管理员。具体操作，请参见[添加RAM身份并授权](https://help.aliyun.com/zh/resource-management/resource-group/user-guide/add-ram-authorization#task-sst-wjm-4fb)。\n\n授权时，授权主体请输入RAM用户，权限可以选择AliyunECIFullAccess权限。\n- \n\n指定资源组创建ECI实例。\n\n- \n\n如果通过[弹性容器实例售卖页](https://eci.console.aliyun.com/?spm=a2c4g.11186623.0.0.18a33e06qDrEax#/eci/createEci)创建，请在其他设置（选填）页面指定资源组。\n- \n\n如果调用CreateContainerGroup创建，请传入资源组ID（ResourceGroupId）。\n\n## 预期结果\n\n按配置流程配置分组、分权管理ECI实例后，预期结果如下：\n\n- \n\n在弹性容器实例控制台上，RAM用户只能查看和操作有权限的资源组中的ECI资源。\n- \n\n调用各API接口时，RAM用户只能查看和操作有权限的资源组中的ECI资源。例如：\n\n- \n\nCreateContainerGroup\n\n创建ECI实例时，必须要传入正确的资源组ID，才可以通过鉴权；如果没有传入资源组ID，或者传入的资源组ID不正确，则鉴权不通过。说明 \n\n如果RAM用户具备默认资源的权限，则无需传入资源组ID，ECI实例将默认将加入到默认资源组中。\n- \n\nDescribeContainerGroups\n\n查询ECI实例信息时，必须要传入正确的资源组ID，才可以通过鉴权；如果没有传入资源组ID，或者传入的资源组ID不正确，则鉴权不通过。说明 \n\n如果传入的ECI实例ID与资源组ID不匹配，即ECI实例不属于该资源组时，即使资源组ID正确，也无法查看ECI实例的信息。\n- \n\nDescribeContainerLog\n\n查询ECI实例的日志时，无需传入资源组ID，系统将自动检索ECI实例所属的资源组并进行鉴权。\n- \n\nDeleteContainerGroup\n\n删除ECI实例时，无需传入资源组ID，系统将自动检索ECI实例所属的资源组并进行鉴权。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-self-managed-image-repositories", "page_type": "doc", "title": "拉取自建镜像仓库的镜像", "keywords": "拉取自建仓库镜像,解决镜像拉取失败,自建仓库镜像拉取,ECI镜像拉取配置", "last_modified_ms": 1705642258000, "last_modified_iso": "2024-01-19T13:30:58+08:00", "excerpt": "拉取自建镜像仓库中的镜像时，可能会碰到因协议不同或者证书认证失败而导致镜像拉取失败的问题。本文介绍在自建镜像仓库采用HTTP协议和使用自签发证书的情况下，如何拉取自建镜像仓库中的镜像来创建ECI实例或者镜像缓存。\n## 功能说明\n\n拉取自建镜像仓库中的镜像时，可能会碰到“ErrImagePull”告警事件，出现镜像拉取失败的问题。在保证ECI与镜像仓库网络连通性的前提下，问题原因和解决方法如下：\n\n[表格]\n\n场景\n\n原因\n\n解决方法\n\n自建镜像仓库采用HTTP协议。\n\nECI默认使用HTTPS协议拉取镜像，协议不同导致镜像拉取失败。\n\n配置ECI使用HTTP协议与镜像仓库进行交互。\n\n自建镜像仓库采用HTTPS协议，但使用的证书是自签发证书。\n\n使用自签发证书的情况下，拉取镜像时无法通过证书认证，导致镜像拉取失败。\n\n配置跳过证书认证。\n## 配置说明\n\n调用CreateContainerGroup接口创建ECI实例，或者调CreateImageCache接口创建镜像缓存时，如果需要拉取自建镜像仓库的镜像，且自建镜像仓库采用HTTP协议，或者使用自签发证书时，需配置PlainHttpRegistry或InsecureRegistry参数来避免镜像拉取失败。说明 \n\n仅支持通过OpenAPI配置，控制台暂不支持。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nPlainHttpRegistry\n\nString\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n取值为自建镜像仓库地址。\n\n拉取采用HTTP协议的自建镜像仓库中的镜像时，需配置该参数，使得ECI使用HTTP协议拉取镜像，避免因协议不同而导致镜像拉取失败。\n\nInsecureRegistry\n\nString\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n取值为自建镜像仓库地址。\n\n拉取使用自签发证书的自建镜像仓库中的镜像时，需配置该参数来跳过证书认证，避免因证书认证失败而导致镜像拉取失败。说明 \n\n- \n\n如果有多个容器的镜像需要从不同的镜像仓库中拉取，支持填写多个镜像仓库地址，各个地址之间采用半角逗号隔开，例如harbor***.pre.com,192.168.XX.XX。\n- \n\n如果镜像仓库地址有端口号，则需要带上端口号，例如：镜像地址为192.168.XX.XX:5000/nginx:latest，则参数值需设置为192.168.XX.XX:5000。\n\n更多信息，请参见：\n\n- \n\n[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)\n- \n\n[CreateImageCache](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createimagecache)\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-self-managed-image-repositories-1", "page_type": "doc", "title": "拉取自建镜像仓库的镜像", "keywords": "拉取自建仓库镜像,解决镜像拉取失败,ECI镜像拉取Annotation,自建仓库镜像拉取方法", "last_modified_ms": 1705633656000, "last_modified_iso": "2024-01-19T11:07:36+08:00", "excerpt": "拉取自建镜像仓库中的镜像时，可能会碰到因协议不同或者证书认证失败而导致镜像拉取失败的问题。本文介绍在自建镜像仓库采用HTTP协议和使用自签发证书的情况下，如何拉取自建镜像仓库中的镜像来创建ECI Pod或者ImageCache。\n## 功能说明\n\n拉取自建镜像仓库中的镜像时，可能会碰到“ErrImagePull”告警事件，出现镜像拉取失败的问题。在保证ECI与镜像仓库网络连通性的前提下，问题原因和解决方法如下：\n\n[表格]\n\n场景\n\n原因\n\n解决方法\n\n自建镜像仓库采用HTTP协议。\n\nECI默认使用HTTPS协议拉取镜像，协议不同导致镜像拉取失败。\n\n配置ECI使用HTTP协议与镜像仓库进行交互。\n\n自建镜像仓库采用HTTPS协议，但使用的证书是自签发证书。\n\n使用自签发证书的情况下，拉取镜像时无法通过证书认证，导致镜像拉取失败。\n\n配置跳过证书认证。\n## 配置说明\n\n拉取自建镜像仓库中的镜像时，如果镜像仓库采用HTTP协议，或者使用自签发证书，需配置Annotation来避免镜像拉取失败。相关Annotation说明如下：\n\n[表格]\n\n配置项\n\n示例值\n\n说明\n\nk8s.aliyun.com/plain-http-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n取值为自建镜像仓库地址。\n\n拉取采用HTTP协议的自建镜像仓库中的镜像时，需配置该Annotation，使得ECI使用HTTP协议拉取镜像，避免因协议不同而导致镜像拉取失败。\n\nk8s.aliyun.com/insecure-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n取值为自建镜像仓库地址。\n\n拉取使用自签发证书的自建镜像仓库中的镜像时，需配置该Annotation来跳过证书认证，避免因证书认证失败而导致镜像拉取失败。说明 \n\n- \n\n如果有多个容器的镜像需要从不同的镜像仓库中拉取，支持填写多个镜像仓库地址，各个地址之间采用半角逗号隔开，例如harbor***.pre.com,192.168.XX.XX。\n- \n\n如果镜像仓库地址有端口号，则需要带上端口号，例如：镜像地址为192.168.XX.XX:5000/nginx:latest，则参数值需设置为192.168.XX.XX:5000。\n\n## 配置示例\n### 拉取自建镜像仓库中的镜像创建ECI Pod重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n- \n\n示例一：自建镜像仓库采用HTTP协议\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      annotations:\n        k8s.aliyun.com/plain-http-registry: \"192.168.XX.XX:5000\" # 指定自建镜像仓库地址，使用HTTP协议拉取镜像\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: 192.168.XX.XX:5000/test/nginx:latest\n\n\n- \n\n示例二：自建镜像仓库使用自签发证书\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      annotations:\n        k8s.aliyun.com/insecure-registry: \"harbor***.pre.com\" # 指定自建镜像仓库地址，拉取镜像时跳过证书认证\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: harbor***.pre.com/test/nginx:latest\n\n\n### 拉取自建镜像仓库中的镜像创建ImageCache\n\n- \n\n示例一：自建镜像仓库采用HTTP协议\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/plain-http-registry: \"192.168.XX.XX:5000\"  # 指定自建镜像仓库地址，使用HTTP协议拉取镜像\nspec:\n  images:\n  - 192.168.XX.XX:5000/test/nginx:latest\n  imagePullSecrets:\n  - default:secret1\n  - default:secret2\n  - kube-system:secret3\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n- \n\n示例二：自建镜像仓库使用自签发证书\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/insecure-registry: \"harbor***.pre.com\"  # 指定自建镜像仓库地址，拉取镜像时跳过证书认证\nspec:\n  images:\n  - harbor***.pre.com/test/nginx:latest\n  imagePullSecrets:\n  - default:secret1\n  - default:secret2\n  - kube-system:secret3\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-self-managed-image-repositories-2", "page_type": "doc", "title": "使用自建镜像仓库", "keywords": "配置ECI使用自建仓库,解决ECI镜像拉取失败,自建镜像仓库用法,ECI镜像拉取配置", "last_modified_ms": 1695280465000, "last_modified_iso": "2023-09-21T15:14:25+08:00", "excerpt": "拉取自建镜像仓库中的镜像时，可能会碰到因协议不同或者证书认证失败而导致镜像拉取失败的问题。本文介绍在自建镜像仓库采用HTTP协议和使用自签发证书的情况下，如何拉取自建镜像仓库中的镜像来创建ECI Pod或者ImageCache。\n## 功能说明\n\n拉取自建镜像仓库中的镜像时，可能会碰到“ErrImagePull”告警事件，出现镜像拉取失败的问题。在保证ECI与镜像仓库网络连通性的前提下，问题原因和解决方法如下：\n\n[表格]\n\n场景\n\n原因\n\n解决方法\n\n自建镜像仓库采用HTTP协议。\n\nECI默认使用HTTPS协议拉取镜像，协议不同导致镜像拉取失败。\n\n配置ECI使用HTTP协议与镜像仓库进行交互。\n\n自建镜像仓库采用HTTPS协议，但使用的证书是自签发证书。\n\n使用自签发证书的情况下，拉取镜像时无法通过证书认证，导致镜像拉取失败。\n\n配置跳过证书认证。\n## 配置说明\n\n拉取自建镜像仓库中的镜像时，如果镜像仓库采用HTTP协议，或者使用自签发证书，需配置Annotation来避免镜像拉取失败。相关Annotation说明如下：\n\n[表格]\n\n配置项\n\n示例值\n\n说明\n\nk8s.aliyun.com/plain-http-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n取值为自建镜像仓库地址。\n\n拉取采用HTTP协议的自建镜像仓库中的镜像时，需配置该参数，使得ECI使用HTTP协议拉取镜像，避免因协议不同而导致镜像拉取失败。\n\nk8s.aliyun.com/insecure-registry\n\n\"harbor***.pre.com,192.168.XX.XX:5000,reg***.test.com:80\"\n\n取值为自建镜像仓库地址。\n\n拉取使用自签发证书的自建镜像仓库中的镜像时，需配置该参数来跳过证书认证，避免因证书认证失败而导致镜像拉取失败。说明 \n\n- \n\n如果有多个容器的镜像需要从不同的镜像仓库中拉取，支持填写多个镜像仓库地址，各个地址之间采用半角逗号隔开，例如harbor***.pre.com,192.168.XX.XX。\n- \n\n如果镜像仓库地址有端口号，则需要带上端口号，例如：镜像地址为192.168.XX.XX:5000/nginx:latest，则Annotation的值需设置为192.168.XX.XX:5000。\n\n## 配置示例\n### 拉取自建镜像仓库中的镜像创建ECI Pod重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n- \n\n示例一：自建镜像仓库采用HTTP协议\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      annotations:\n        k8s.aliyun.com/plain-http-registry: \"192.168.XX.XX:5000\"\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: 192.168.XX.XX:5000/test/nginx:latest\n\n\n- \n\n示例二：自建镜像仓库使用自签发证书\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      annotations:\n        k8s.aliyun.com/insecure-registry: \"harbor***.pre.com\"\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n    spec:\n      containers:\n      - name: nginx\n        image: harbor***.pre.com/test/nginx:latest\n\n\n### 拉取自建镜像仓库中的镜像创建ImageCache\n\n- \n\n示例一：自建镜像仓库采用HTTP协议\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/plain-http-registry: \"192.168.XX.XX:5000\"  #指定自建镜像仓库地址，使用HTTP协议拉取镜像\nspec:\n  images:\n  - 192.168.XX.XX:5000/test/nginx:latest\n  imagePullSecrets:\n  - default:secret1\n  - default:secret2\n  - kube-system:secret3\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n\n\n- \n\n示例二：自建镜像仓库使用自签发证书\n\napiVersion: eci.alibabacloud.com/v1\nkind: ImageCache\nmetadata:\n  name: imagecache-sample\n  annotations:\n    k8s.aliyun.com/insecure-registry: \"harbor***.pre.com\"  #指定自建镜像仓库地址，拉取镜像时跳过正式认证\nspec:\n  images:\n  - harbor***.pre.com/test/nginx:latest\n  imagePullSecrets:\n  - default:secret1\n  - default:secret2\n  - kube-system:secret3\n  imageCacheSize:\n   25\n  retentionDays:\n   7\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-tags-to-authenticate-a-ram-user", "page_type": "doc", "title": "通过标签实现RAM用户鉴权", "keywords": "实现RAM用户标签鉴权,配置标签鉴权策略,RAM用户标签鉴权方法,API接口标签鉴权", "last_modified_ms": 1701077819000, "last_modified_iso": "2023-11-27T17:36:59+08:00", "excerpt": "本文介绍如何基于标签控制RAM用户权限，实现不同的用户可以拥有不同云资源的访问和操作权限。\n## 背景信息\n\n标签可用于标识云资源，实现分类管理资源；访问控制RAM可基于权限策略，控制云资源的访问和操作权限。结合标签和RAM，将标签作为权限策略的匹配条件，可以实现云资源精细化权限管理。\n\n基于标签控制RAM用户权限（即标签鉴权）的逻辑如下：\n\n说明 \n\n支持绑定标签的ECI资源包括ECI实例、镜像缓存和虚拟节点；仅支持在创建或者更新ECI资源时为其绑定标签。更多信息，请参见[使用标签管理ECI实例](https://help.aliyun.com/zh/eci/user-guide/use-tags-to-manage-elastic-container-instances#topic-1860115)。\n## 配置示例\n### 示例场景说明\n\n本文以下述场景作为示例，说明如何实现标签鉴权。\n\n假设您需要控制某一RAM用户只能操作特定（假设绑定了env:test标签）的ECI资源，如下图：\n\n具体需求包括：\n\n- \n\n需求1：不允许创建不带标签的ECI资源，仅当创建时为ECI资源绑定env:test标签才可以创建成功。\n- \n\n需求2：只允许操作自身创建（即绑定env:test标签）的ECI资源，不允许操作其他ECI资源。\n- \n\n需求3：查询ECI资源时，只允许查看自身创建（即绑定env:test标签）的ECI资源。\n\n### 步骤一：配置自定义权限策略并授权\n\n- \n\n使用阿里云账号登录[RAM控制台](https://ram.console.aliyun.com/overview)。\n- \n\n在左侧导航栏选择权限管理>权限策略。\n- \n\n在权限策略页面，单击创建权限策略。\n- \n\n完成自定义策略配置。\n\n- \n\n单击导入策略页签。\n- \n\n在弹出的对话框的右侧筛选项中选择系统策略，然后搜索并选中AliyunECIFullAccess，单击导入。\n\nAliyunECIFullAccess为系统默认的管理ECI资源的权限，包括操作ECI资源、查询相关资源（安全组、VPC等资源）、创建ECI服务关联角色等权限。\n- \n\n单击脚本编辑页签。\n- \n\n在编辑框中修改权限策略内容，然后单击继续编辑基本信息。说明 \n\n权限策略是一组访问权限的集合。结构包括版本号和授权语句列表，每条授权语句包括授权效果（Effect）、操作（Action）、资源（Resource）以及条件（Condition，可选项）。更多信息，请参见[权限策略语法和结构](https://help.aliyun.com/zh/ram/policy-structure-and-syntax#concept-srq-fbk-xdb)和[权限策略基本元素](https://help.aliyun.com/zh/ram/policy-elements#concept-xg5-51g-xdb)。\n\n在权限策略的Condition中，您可以增加需要匹配标签的条件来限制操作权限。支持的标签条件关键字如下：\n\n[表格]\n\n标签条件关键字\n\n说明\n\nacs:RequestTag\n\n限制在请求中必须传入特定的标签。\n\n如果API请求中没有标签参数，则不能使用acs:RequestTag，否则会导致鉴权失败。\n\nacs:ResourceTag\n\n限制指定的资源必须包含特定的标签。\n\n如果API请求中没有资源ID参数，则不能使用acs:ResourceTag，否则会导致鉴权失败。说明 \n\n设计权限策略时，您可以根据各操作接口特性（API请求是否需要指定资源ID、是否支持传入标签），结合实际业务需求，来设置acs:RequestTag或acs:ResourceTag。更多信息，请参见[API接口鉴权说明](#section-arb-5fa-soq)。\n\n根据示例场景中的需求，设计权限策略如下：\n\n[表格]\n\n需求\n\n权限策略\n\n不允许创建不带标签的ECI资源，仅当创建时为ECI资源绑定env:test标签才可以创建成功\n\n{\n   \"Effect\": \"Allow\",\n   \"Action\": \"eci:Create*\",\n   \"Resource\": \"*\",\n   \"Condition\": {\n    \"StringEquals\": {\n     \"acs:RequestTag/env\": \"test\"\n    }\n   }\n  }\n\n\n只允许操作绑定了env:test标签的ECI资源，不允许操作其他资源\n\n{\n   \"Effect\": \"Allow\",\n   \"Action\": \"eci:*\",\n   \"Resource\": \"*\",\n   \"Condition\": {\n    \"StringEquals\": {\n     \"acs:ResourceTag/env\": \"test\"\n    }\n   }\n  }\n\n\n查询ECI资源时，只允许查看绑定了env:test标签的ECI资源。\n\n{\n   \"Effect\": \"Allow\",\n   \"Action\": \"eci:Describe*\",\n   \"Resource\": \"*\",\n   \"Condition\": {\n    \"StringEquals\": {\n     \"acs:RequestTag/env\": \"test\"\n    }\n   }\n  }\n\n\n结合AliyunECIFullAccess已有的权限策略，完整权限策略示例如下：\n\n{\n \"Version\": \"1\",\n \"Statement\": [{\n   \"Effect\": \"Allow\",\n   \"Action\": \"eci:Create*\",\n   \"Resource\": \"*\",\n   \"Condition\": {\n    \"StringEquals\": {\n     \"acs:RequestTag/env\": \"test\"\n    }\n   }\n  },\n  {\n   \"Effect\": \"Allow\",\n   \"Action\": \"eci:*\",\n   \"Resource\": \"*\",\n   \"Condition\": {\n    \"StringEquals\": {\n     \"acs:ResourceTag/env\": \"test\"\n    }\n   }\n  },\n  {\n   \"Effect\": \"Allow\",\n   \"Action\": \"eci:Describe*\",\n   \"Resource\": \"*\",\n   \"Condition\": {\n    \"StringEquals\": {\n     \"acs:RequestTag/env\": \"test\"\n    }\n   }\n  },\n  {\n   \"Action\": [\n    \"ecs:DescribeSecurityGroups\"\n   ],\n   \"Resource\": \"*\",\n   \"Effect\": \"Allow\"\n  },\n  {\n   \"Action\": [\n    \"vpc:DescribeVSwitches\",\n    \"vpc:DescribeVpcs\",\n    \"vpc:DescribeEipAddresses\"\n   ],\n   \"Resource\": \"*\",\n   \"Effect\": \"Allow\"\n  },\n  {\n   \"Action\": \"ram:CreateServiceLinkedRole\",\n   \"Resource\": \"*\",\n   \"Effect\": \"Allow\",\n   \"Condition\": {\n    \"StringEquals\": {\n     \"ram:ServiceName\": [\n      \"eci.aliyuncs.com\",\n      \"vnode.eci.aliyuncs.com\"\n     ]\n    }\n   }\n  }\n ]\n}\n\n说明 \n\n如果您通过OpenAPI操作ECI资源，则使用AliyunECIFullAccess的权限即可；如果您通过ECI控制台操作ECI资源，则除了AliyunECIFullAccess的权限外，还需添加额外权限。更多信息，请参见[为RAM用户授权](https://help.aliyun.com/zh/eci/user-guide/grant-permissions-to-ram-users#topic-1860119)。\n- \n\n输入权限策略名称，单击确定。\n\n- \n\n将自定义权限策略授予RAM用户。\n\n- \n\n在左侧导航栏选择身份管理>用户。\n- \n\n创建RAM用户。\n\n请根据自身管理需求创建相应的RAM用户。具体操作，请参见[创建RAM用户](https://help.aliyun.com/zh/ram/user-guide/create-a-ram-user#task-187540)。如果已有RAM用户，可跳过该步骤。\n- \n\n为RAM用户授权。\n\n为RAM用户授予新创建的自定义权限策略，具体操作，请参见[为RAM用户授权](https://help.aliyun.com/zh/ram/user-guide/grant-permissions-to-the-ram-user#task-187800)。\n\n### 步骤二：验证权限策略是否生效\n\n- \n\n使用RAM用户登录[OpenAPI平台](https://next.api.aliyun.com/api/Eci/2018-08-08/CreateCont"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-tags-to-manage-elastic-container-instances", "page_type": "doc", "title": "使用标签管理ECI实例", "keywords": "管理ECI实例标签,为ECI实例添加标签,查询ECI实例标签,ECI实例标签管理,ECI实例标签操作指南,ECI实例标签使用限制", "last_modified_ms": 1706600415000, "last_modified_iso": "2024-01-30T15:40:15+08:00", "excerpt": "标签由一组键值对组成，可以用于标记ECI实例。您可以使用标签来分组管理ECI实例，便于筛选和批量操作。\n## 背景信息\n\n如果您使用OpenAPI或者弹性容器实例控制台来管理使用ECI，您可以使用标签来标记有相同管理或者业务需求的ECI实例，便于后续进行筛选和操作。\n\n使用标签时，请注意以下限制：\n\n- \n\n标签都由一对键值对组成，资源的任一标签键必须唯一，不能重复。\n- \n\n不同地域的标签信息不互通。\n- \n\n每个ECI实例最多可以绑定20个标签。\n- \n\n不支持单独删除标签。说明 \n\n删除标签对应的ECI实例时，标签会随之一起删除。\n\n## 创建带标签的ECI实例\n### OpenAPI\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过Tag参数来设置标签。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nTag.N.Key\n\nString\n\nversion\n\n标签键。N的取值范围为：1~20。\n\n如果传入该值，则不允许为空字符串，且不允许重复。最多支持64个字符，不能以aliyun和acs:开头，不能包含http://或者https://。\n\nTag.N.Value\n\nString\n\n2.0\n\n标签值。N的取值范围为：1~20。\n\n如果传入该值，可以为空字符串。最多支持128个字符，不能以acs:开头，不能包含http://或者https://。\n### 控制台\n\n通过弹性容器实例售卖页创建ECI实例时，您可以在其他设置中添加标签。\n\n## 查询ECI实例的标签\n### OpenAPI\n\n调用DescribeContainerGroups接口查询ECI实例时，返回参数中，Tags字段即为该实例绑定的标签，其中Key为标签键，Value为标签值。更多信息，请参见[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)。\n### 控制台\n\n在弹性容器实例控制台的容器组页面，找到目标实例，鼠标移动到对应的图标，即可查看该实例绑定的标签。\n\n## 使用标签过滤ECI实例\n\n为ECI实例添加标签后，您可以使用标签过滤ECI实例，包括筛选查看ECI实例，或者通过标签实现鉴权。\n### OpenAPI\n\n调用DescribeContainerGroups接口查询ECI实例时，您可以传入Tag相关参数来筛选查询ECI实例。更多信息，请参见[DescribeContainerGroups](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroups)。\n### 控制台\n\n在弹性容器实例控制台的容器组页面，您可以通过标签来筛选ECI实例。\n\n说明 \n\n如果您使用阿里云RAM用户管理ECI资源，支持通过标签实现鉴权，实现只允许RAM用户操作带有特定标签的ECI资源。更多信息，请参见[通过标签实现RAM用户鉴权](https://help.aliyun.com/zh/eci/user-guide/use-tags-to-authenticate-a-ram-user#topic3927)。\n## 更新ECI实例的标签\n\n更新标签前，您可以先查询ECI实例已绑定哪些标签。更新时，仅支持更新已有的标签，或者新增标签。不支持删除标签（即减少标签个数）。\n### OpenAPI\n\n调用UpdateContainerGroup接口更新ECI实例时，您可以传入新的Tag相关参数来更新标签。相关参数说明如下表所示。更多信息，请参见[UpdateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-updatecontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nTag.N.Key\n\nString\n\nversion\n\n标签键。N的取值范围为：1~20。\n\n如果传入该值，则不允许为空字符串，且不允许重复。最多支持64个字符，不能以aliyun和acs:开头，不能包含http://或者https://。\n\nTag.N.Value\n\nString\n\n2.0\n\n标签值。N的取值范围为：1~20。\n\n如果传入该值，可以为空字符串。最多支持128个字符，不能以acs:开头，不能包含http://或者https://。\n### 控制台\n\n对于已创建的ECI实例，您可以在容器组页面找到目标实例进行修改，以更新标签。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-tcpdump-to-capture-packets-and-analyze-network-problems", "page_type": "doc", "title": "使用tcpdump抓包分析网络问题", "keywords": "分析ECI网络问题,开启ECI的tcpdump,tcpdump功能介绍,ECI抓包操作步骤", "last_modified_ms": 1761136400000, "last_modified_iso": "2025-10-22T20:33:20+08:00", "excerpt": "ECI支持一键开启tcpdump功能，用于捕获和解析网络数据包，帮助您监视和分析网络流量。本文介绍如何开启tcpdump，以便在容器出现网络异常时，抓取网络报文，分析定位问题。\n## 背景信息\n\n容器出现网络异常时，您可能需要抓取网络报文来分析定位问题，但实际操作时可能会碰到以下问题：\n\n- \n\n抓包需要使用exec进入容器，但网络异常时，容器不一定处于运行状态，您可能无法使用exec进入容器。\n- \n\n抓包需要使用tcpdump工具，但容器的rootfs内可能没有预装tcpdump工具。\n\n为解决上述问题，ECI支持一键开启tcpdump功能。该功能的逻辑如下：\n\n## 使用限制\n\n以下地域暂不支持tcpdump：华北6（乌兰察布）、华南2（河源）、华南3（广州）、华东5 （南京-本地地域-关停中）、菲律宾（马尼拉）、韩国（首尔）、泰国（曼谷）、马来西亚（吉隆坡）。\n## 操作步骤\n\n您可以通过弹性容器实例控制台或者OpenAPI来使用tcpdump功能。\n### 控制台\n\n- \n\n登录[弹性容器实例控制台](https://eci.console.aliyun.com/#/eci/cn-hangzhou/list)。\n- \n\n为ECI实例开启tcpdump。\n\n- \n\n单击目标实例ID，打开实例详情页面。\n- \n\n单击运维页签，然后选择Tcpdump页签。\n- \n\n单击开启。\n- \n\n根据需要设置参数，然后单击确定。\n\n参数说明如下：\n\n[表格]\n\n参数\n\n描述\n\n源\n\n可设置要抓包的源端IP地址或IP网段，以及对应端口。\n\n目的\n\n可设置要抓包的目的端IP地址或IP网段，以及对应端口。\n\n网卡\n\n选择要抓包的网卡。\n\n包\n\n- \n\n长度：设置数据包的抓取长度。默认为65535字节。\n- \n\n数量：设置数据包抓取的目标个数。\n- \n\n持续时长：设置抓取数据包的时长。单位为秒。\n\n网络协议\n\n选择网络协议。支持TCP、UDP和ICMPv4。\n\n开启tcpdump后，系统将开始抓包，并生成一个对应的运维任务，任务的状态为运行中。\n\n- \n\n根据需要对目标ECI实例进行调试，然后关闭tcpdump。\n\n关闭tcpdump后，系统将停止抓包，并生成相应的数据包文件，存储到OSS中。关闭方式如下：\n\n[表格]\n\n关闭方式\n\n说明\n\n手动关闭\n\n在目标实例的Tcpdump页签下，单击关闭。\n\n自动关闭\n\n如果在开启tcpdump时，设置了包长度、包数量、持续时长等参数限制数据包大小、抓取时间等，则系统将在满足某一限制条件时，自动关闭tcpdump。\n- \n\n单击运维任务对应结果列中的下载，下载数据包文件到本地。说明 \n\n如果下载没有反应，请检查浏览器的网站权限设置。更多信息，请参见[常见问题](#section-yjk-zzj-5df)。\n\n### OpenAPI\n\n- \n\n调用CreateInstanceOpsTask，为ECI实例开启tcpdump。\n\n开启tcpdump时，需设置以下参数：\n\n- \n\nContainerGroupId：指定目标ECI实例。\n- \n\nOpsType：设为tcpdump。\n- \n\nOpsValue：设为{\"Enable\":true}。说明 \n\nOpsValue为tcpdump类型的运维任务的参数集合，格式是JSON格式的字符串，您可以根据需要设置源端地址、目的端地址、网卡、数据包相关参数。更多关于OpsValue的配置，请参见[CreateInstanceOpsTask](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createinstanceopstask)。\n\n- \n\n根据需要对目标ECI实例进行调试，然后关闭tcpdump。\n\n关闭tcpdump后，系统将停止抓包，并生成相应的数据包文件，存储到OSS中。关闭方式如下：\n\n[表格]\n\n关闭方式\n\n说明\n\n手动关闭\n\n调用CreateInstanceOpsTask关闭tcpdump，需设置以下参数：\n\n- \n\nContainerGroupId：指定目标ECI实例。\n- \n\nOpsType：设为tcpdump。\n- \n\nOpsValue：设为{\"Enable\":false}。\n\n自动关闭\n\n如果在开启tcpdump时，OpsValue中设置了Snaplen、Duration、PacketNum、FileSize等参数限制数据包大小、抓取时间等，则系统将在满足某一限制条件时，自动关闭tcpdump。\n- \n\n下载数据包文件。\n\n- \n\n调用DescribeInstanceOpsRecords，从返回信息的ResultContent中获取数据包文件保存地址。\n\n数据包文件保存在OSS中，地址示例：http://eci-ops-files-cn-beijing.oss-cn-beijing.aliyuncs.com/pcaps/1609****/eci-2ze6n7kqdici********-eth0-****.pcap?Expires=****&OSSAccessKeyId=****&Signature=****&security-token=****。\n- \n\n访问数据包文件保存地址，下载数据包文件到本地。\n\n## 常见问题\n\n开启tcpdump抓取网络数据包后，在控制台下载数据包文件没有反应，怎么办？\n\n如果下载没有反应，请检查浏览器的网站权限设置。例如Chrome浏览器可以参考以下方式开启权限：\n\n- \n\n打开弹性容器实例控制台，单击浏览器地址栏前面的图标，选择网站设置。\n- \n\n将配置项不安全内容改为允许。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-the-image-cache-feature-to-accelerate-the-creation-of-an-elastic-container-instance", "page_type": "doc", "title": "使用镜像缓存加速创建ECI实例", "keywords": "加速创建ECI实例,使用镜像缓存创建ECI,ECI实例加速创建,镜像缓存使用方法", "last_modified_ms": 1706174287000, "last_modified_iso": "2024-01-25T17:18:07+08:00", "excerpt": "创建ECI实例时，使用镜像缓存可以加速拉取镜像，减少ECI实例启动耗时。本文介绍如何使用镜像缓存加速创建ECI实例。\n## 背景信息\n\n使用镜像缓存创建ECI实例支持以下两种方式：\n\n- \n\n自动匹配\n\n根据匹配策略自动匹配最优的镜像缓存来创建实例。如果没有匹配到，系统将在创建实例的同时，自动创建一个镜像缓存。\n- \n\n明确指定\n\n明确指定使用哪个镜像缓存来创建实例。该镜像缓存必须为创建完成（Ready）状态。\n\n更多信息，请参见[镜像缓存概述](https://help.aliyun.com/zh/eci/user-guide/overview-of-image-caches-2#topic-2131957)。\n## 自动匹配镜像缓存\n### 通过openAPI创建实例\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过AutoMatchImageCache参数来开启自动匹配镜像缓存。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nAutoMatchImageCache\n\nBoolean\n\ntrue\n\n设置是否开启自动匹配镜像缓存。\n### 通过控制台创建实例\n\n- \n\n在[弹性容器实例控制台](https://eci.console.aliyun.com)的容器组页面，单击创建弹性容器组。\n- \n\n配置实例相关参数。\n\n您可以在容器组配置区域展开高级配置，然后选中自动匹配镜像缓存。系统将自动匹配和使用最佳的镜像缓存。如果没有匹配到，系统将自动创建一个镜像缓存。\n\n- \n\n单击配置确认，并按提示完成后续操作。\n\n## 明确指定镜像缓存\n\n调用CreateContainerGroup接口创建ECI实例时，您可以通过ImageSnapshotId参数来明确指定镜像缓存。相关参数说明如下表所示。更多信息，请参见[CreateContainerGroup](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-createcontainergroup)。说明 \n\n仅openAPI支持指定镜像缓存，控制台不支持该操作。\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nImageSnapshotId\n\nString\n\nimc-2zebxkiifuyzzlhl****\n\n指定镜像缓存ID。\n## 查看使用效果\n\n在[弹性容器实例控制台](https://eci.console.aliyun.com)的容器组页面，找到使用镜像缓存创建的ECI实例，单击ID进入详情页面。在事件页签下，您可以看到该实例匹配了镜像缓存，镜像拉取耗时几乎为0，实例启动时间为秒级。\n"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-the-private-pool-of-an-elasticity-assurance-to-create-a-pod", "page_type": "doc", "title": "使用弹性保障的私有资源池创建Pod", "keywords": "使用弹性保障创建Pod,配置弹性保障Annotation,弹性保障使用方法,弹性保障Pod配置", "last_modified_ms": 1751248614000, "last_modified_iso": "2025-06-30T09:56:54+08:00", "excerpt": "弹性保障可以为按量付费的资源需求提供资源确定性保障。如果您的业务在某一时间段必须要使用一定数量的特定ECS规格的ECI实例，建议您购买弹性保障来获得资源确定性保障，避免因库存不足导致实例创建失败，进而影响业务。\n## 弹性保障介绍\n### 功能简介\n\n通过弹性保障，您只需要支付一笔较低的保障费用，即可换取固定周期（支持1个月~5年）的资源确定性保障。购买弹性保障时设置地域可用区、实例规格等属性，系统会以私有池的方式预留属性相匹配的资源。例如：在华东1（杭州）可用区I预留ecs.c6.large规格的实例，在保障期内，随时可以在华东1（杭州）可用区I创建指定ecs.c6.large规格的ECI实例。更多关于弹性保障的信息，请参见[弹性保障概述](https://help.aliyun.com/zh/ecs/user-guide/overview-of-elasticity-assurance)。说明 \n\n不支持为创建抢占式实例提供保障。\n### 计费说明\n\n购买弹性保障后不能手动释放。使用弹性保障过程中，您需要支付以下费用：\n\n- \n\n购买弹性保障时，需一次性支付保障费用。\n- \n\n使用弹性保障对应的私有资源池成功创建ECI实例后，需支付ECI实例的小时账单。重要 \n\n弹性保障对应的私有资源池所创建的ECI实例仍然可以匹配已有节省计划和地域级预留实例券来抵扣实例账单，但不支持匹配可用区级预留实例券。\n\n## 购买弹性保障\n\n- \n#### 购买前\n\n弹性保障对应的私有资源池仅支持用于创建指定ECS规格的ECI实例。购买前，请先确认您想要的地域可用区和ECS规格支持弹性保障。\n\n- \n\nECI仅支持指定部分ECS规格，请确保选择的ECS规格能够满足您的业务需求。更多信息，请参见[规格说明](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod-1/#011fa1e121058)。\n- \n\n仅部分地域可用区、实例规格支持弹性保障。具体请参见[弹性保障售卖页](https://ecs.console.aliyun.com/#/resourceAssuranceV2/createResourceReserve/cn-beijing)。\n\n- \n#### 购买时\n\n在[ECS管理控制台的资源预定页面](https://ecs.console.aliyun.com/#/resourceAssuranceV2/region/cn-beijing?tabKey=RESOURCE_RESERVATION)创建资源预定，预定方式选择弹性保障，即可购买弹性保障。具体操作，请参见[购买资源预定](https://help.aliyun.com/zh/ecs/user-guide/purchase-a-resource-reservation)。\n- \n#### 购买后\n\n购买成功后，在资源预定页面的资源预定或者私有资源池页签下，可以查看弹性保障以及关联的私有池信息。\n\n## 使用弹性保障\n### 配置说明\n\n在保障期内，您可以使用弹性保障对应的私有资源池来创建ECI实例。\n\n- \n\n创建前，请先确认集群配置的交换机所对应的可用区，已包含弹性保障对应的可用区。关于如何配置可用区，请参见[多可用区创建Pod](https://help.aliyun.com/zh/eci/user-guide/create-pods-in-multiple-zones)。\n- \n\n创建时，指定的私有资源池和ECS规格，需要与购买的弹性保障一致。相关Annotation如下：\n\n[表格]\n\nAnnotation\n\n示例值\n\n是否必选\n\n说明\n\nk8s.aliyun.com/eci-use-specs\n\necs.c6.large\n\n是\n\n指定ECS规格。该规格需要与弹性保障对应的ECS规格一致。说明 \n\n除了指定规格外，GPU、本地盘等特殊规格还需配置相关参数。具体请参见[指定ECS规格创建Pod](https://help.aliyun.com/zh/eci/user-guide/specify-ecs-instance-types-to-create-a-pod-1/)。\n\nk8s.aliyun.com/eci-privatepool-matchcriteria\n\n\"Open\"\n\n是\n\n配置私有池的匹配模式。取值范围：\n\n- \n\nOpen：开放模式。该模式下系统自动为实例匹配开放的私有池。\n- \n\nTarget：指定模式。该模式下必须同时指定私有池ID。当私有池类型为专有时，必须使用该模式。\n重要 \n\n- \n\nOpen模式下，私有池如果资源不足，会自动使用公共池的资源进行补齐；Target模式下，私有池如果资源不足，会导致ECI实例创建失败。\n- \n\nOpen模式下，ECI不支持匹配带有标签的私有池。使用Open模式私有池创建ECI Pod时，请去除私有池上的标签，否则会导致匹配失败。\n\nk8s.aliyun.com/eci-privatepool-id\n\neap-2ze1g68k2melxkkl****\n\n否\n\n指定私有池ID（即弹性保障ID）。您可以在[ECS管理控制台的资源预定页面](https://ecs.console.aliyun.com/#/resourceAssuranceV2/region/cn-beijing?tabKey=RESOURCE_RESERVATION)的资源预定或者私有资源池页签下获取。\n\n- \n\n当k8s.aliyun.com/eci-privatepool-matchcriteria配置为Target时，必须配置该Annotation。\n- \n\n当k8s.aliyun.com/eci-privatepool-matchcriteria配置为Open时，该Annotation无效。\n重要 \n\n- \n\nAnnotation请添加在Pod的metadata下，例如：创建Deployment时，Annotation需添加在spec>template>metadata下。\n- \n\n仅支持在创建ECI Pod时添加ECI相关Annotation来生效ECI功能，更新ECI Pod时添加或者修改ECI相关Annotation均不会生效。\n\n- \n\n创建后，在[ECS管理控制台的资源预定页面](https://ecs.console.aliyun.com/#/resourceAssuranceV2/region/cn-beijing?tabKey=RESOURCE_RESERVATION)的资源预定或者私有资源池页签下，可以查看弹性保障对应的私有资源池的使用情况。\n\n说明 \n\n使用弹性保障的ECI Pod释放后，对应私有池的容量会同步释放。\n\n### 配置示例\n\n- \n\n示例一：不指定弹性保障ID，系统自动匹配开放的私有池\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.c6.large  #指定弹性保障对应的ECS规格\n        k8s.aliyun.com/eci-privatepool-matchcriteria: open  #配置私有池的匹配模式为开放模式，系统自动匹配开放的私有池\n    spec:\n      containers:\n      - name: nginx\n        image: registry.cn-shanghai.aliyuncs.com/eci_open/nginx:1.14.2\n        ports:\n        - containerPort: 80\n\n\n- \n\n示例二：弹性保障对应私有池类型为专有，必须指定弹性保障ID\n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test\n  labels:\n    app: test\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      name: nginx-test\n      labels:\n        app: nginx\n        alibabacloud.com/eci: \"true\" \n      annotations:\n        k8s.aliyun.com/eci-use-specs: ecs.c6.large  #指定弹性保障对应的ECS规格\n        k8s.aliyun.com/eci-privatepool-matchcriteria: target  #配置私有池的匹配模式为指定模式\n      "}
{"url": "https://help.aliyun.com/zh/eci/user-guide/use-vnodectl-to-connect-a-vnode-to-a-self-managed-kubernetes-cluster", "page_type": "doc", "title": "接入VNode（VNodectl工具）", "keywords": "ECI,自建K8s,VNode,虚拟节点,VNodectl", "last_modified_ms": 1770796850000, "last_modified_iso": "2026-02-11T16:00:50+08:00", "excerpt": "如果您在线下IDC或者阿里云ECS上自建了Kubernetes集群，您需要在集群中部署虚拟节点（VNode）来使用ECI。为了能够方便地接入和管理VNode，ECI提供了VNodectl命令行工具。本文为您介绍如何使用VNodectl工具自动创建VNode，以便在自建Kubernetes集群中可以使用ECI。\n## 前提条件\n\n- \n\n已部署好Kubernetes集群，且集群的版本属于1.16~1.30版本。\n- \n\n如果您的Kubernetes集群部署在线下IDC，请确保已通过高速通道、智能接入网关或者VPN网关打通IDC和云上网络。相关参考如下：\n\n- \n\n[高速通道](https://help.aliyun.com/zh/express-connect/product-overview/what-is-express-connect/#concept-ipg-pry-xdb)\n- \n\n[智能接入网关](https://help.aliyun.com/zh/sag/product-overview/what-is-sag#concept-2403019)\n- \n\n[VPN网关](https://help.aliyun.com/zh/vpn/product-overview/what-is-vpn-gateway#concept-r5s-gzv-wdb)\n\n## 准备工作\n\n操作前，请准备创建VNode所需的参数信息，并了解VNode所需的权限信息。需要准备的参数如下表所示。\n\n[表格]\n\n参数\n\n描述\n\n操作\n\n地域（Region）\n\n地域指的是物理的数据中心。请根据您以及您目标用户所在的地理位置，资源价格等因素选择合适的地域。更多信息，请参见[地域和可用区](https://help.aliyun.com/zh/eci/product-overview/regions-and-zones#topic-1860084)。\n\nECI及其相关资源将创建在选择的地域下。\n\n您可以通过[弹性容器实例控制台](https://eci.console.aliyun.com/?#/eci/cn-hangzhou/welcome)或者调用[DescribeRegions](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describeregions)获取ECI支持的地域信息。\n\n专有网络（VPC）\n\n专有网络是您基于阿里云创建的自定义私有网络，不同的专有网络之间逻辑上彻底隔离。更多信息，请参见[什么是专有网络VPC](https://help.aliyun.com/zh/vpc/what-is-vpc#concept-kbk-cpz-ndb)。\n\nECI及其相关资源将创建在您配置的专有网络中。说明 \n\n如果您的Kubernetes集群部署在线下IDC，请确保IDC网络与该VPC网络之间已实现网络互通。\n\n您可以在[专有网络控制台](https://vpc.console.aliyun.com/vpc/cn-hangzhou/vpcs)的专有网络页面创建并查看专有网络。\n\n交换机（vSwitch）\n\n交换机是组成专有网络的基础网络设备。交换机可以连接不同的云资源。在专有网络中创建ECI及其相关资源时，需要指定交换机（支持指定多个，系统将自动选择）。\n\n您可以在[专有网络控制台](https://vpc.console.aliyun.com/vpc/cn-hangzhou/switches)的交换机页面创建并查看交换机，根据已选的VPC来选择对应的交换机。\n\n安全组（Security Group）\n\n安全组是一种虚拟防火墙，可以控制组内资源的进出流量，从而提高网络安全性。更多信息，请参见[安全组概述](https://help.aliyun.com/zh/ecs/user-guide/overview-44#concept-o2y-mqw-ydb)。\n\nECI及其相关资源将加入到安全组中。说明 \n\n推荐使用企业安全组，并添加以下入方向的安全组规则：\n\n- \n\n允许VPC对应网段访问全部端口（1/65535）。\n- \n\n允许K8s API Server对应地址访问VNode服务端口（10250和10255端口）。\n\n您可以在[ECS管理控制台](https://ecs.console.aliyun.com/?#/securityGroup/region/cn-hangzhou)的安全组页面创建并查看安全组，根据已选的VPC来选择对应的安全组。\n\n创建VNode时，需要配置相关权限，包括原生K8s节点使用的标准权限，以及VNode所需的额外权限，具体如下表所示。\n\n[表格]\n\n类型\n\n权限\n\n说明\n\n标准权限\n\nsystem:node\n\nNode标准权限。\n\nsystem:node-proxier\n\nkube-proxy标准权限。\n\nsystem:certificates.k8s.io:certificatesigningrequests:nodeclient\n\nNode发起创建证书请求的权限。\n\nsystem:certificates.k8s.io:certificatesigningrequests:selfnodeclient\n\nNode基于已有证书发起创建证书请求的权限，即证书轮换权限。\n\n额外权限\n\npods update和pods patch\n\n更新Pod的Annotation。例如为Pod增加k8s.aliyun.com/eci-instance-id等Computed Annotation。\n\npvc update和pvc patch\n\n更新PVC的Annotation。\n## 安装VNodectl\n\n操作前，您需要安装VNodectl命令行工具。请根据自身环境获取对应的安装包并安装VNodectl。\n\n[表格]\n\n操作系统\n\nCPU架构\n\n安装包获取链接\n\nmacOS\n\nAMD64\n\n[macOS_AMD64](https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_darwin_amd64.tar.gz)\n\nARM64\n\n[macOS_ARM64](https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_darwin_arm64.tar.gz)\n\nLinux\n\nAMD64\n\n[Linux_AMD64](https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_linux_amd64.tar.gz)\n\nARM64\n\n[Linux_ARM64](https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_linux_arm64.tar.gz)\n\nWindows\n\nAMD64\n\n[Windows_AMD64](https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_windows_amd64.tar.gz)\n\nARM64\n\n[Windows_ARM64](https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_windows_arm64.tar.gz)\n\n建议您将VNodectl安装在Kubernetes集群的Master节点上，操作步骤如下：\n\n- \n\n连接集群。\n- \n\n下载安装包。\n\nwget https://eci-docs.oss-cn-beijing.aliyuncs.com/vnode/vnodectl_0.0.5-beta_linux_amd64.tar.gz -O vnodectl.tar.gz \n\n\n- \n\n解压安装包。\n\ntar xvf vnodectl.tar.gz \n\n\n- \n\n复制vnodectl到指定目录。\n\ncp vnodectl /usr/local/bin/vnode\n\n\n说明 \n\n- \n\nvnode命令均支持添加--dry进行客户端校验。\n- \n\n执行vnode命令的过程中，如果遇到API版本兼容的错误，请添加--kubernetes-version明确指定集群的Kubernetes版本。\n\n## 配置集群\n\nVNode需要使用kubeconfig来接入集群。因此，创建VNode前需要为VNode签发证书（即kubeconfig）。配置方式分为TLS Bootstrap方式和ServiceAccount方式。说明 \n\n- \n\n如果有安全性要求，建议采用TLS Bootstrap方式。采用该方式时，将自动部署vnode-approver组件。vnode-approver组件用于签发Vnode提交的CSR请求，目前已开源至GitHub。更多信息，请参见[vnode-approver](https://github.com/aliyuneci/vnode-approver)。\n- \n\nServiceAccount方式不支持证书轮换。签发证书时需确保token有足够的有效期（或者设置为不过期），防止因证书过期导致VNode无法正常工"}
{"url": "https://help.aliyun.com/zh/eci/user-guide/view-the-monitoring-metrics-of-an-elastic-container-instance", "page_type": "doc", "title": "查看ECI实例监控指标", "keywords": "了解ECI监控指标含义,计算ECI监控指标,ECI监控指标计算方法,ECI监控指标概述", "last_modified_ms": 1697103487000, "last_modified_iso": "2023-10-12T17:38:07+08:00", "excerpt": "在弹性容器实例控制台上，您可以查看ECI实例的监控数据，包括CPU、内存和网络等相关指标。本文介绍ECI实例监控数据的含义和计算方式，方便您了解各项指标的具体作用，以便进行二次计算开发。\n## 监控指标概述\n\n在弹性容器实例控制台上查看ECI实例（即容器组）的监控数据时，您可以筛选时间段查看某一小时的数据，或者查看近5分钟的实时数据，支持查看的监控指标如下：\n\n- \n\nCPU\n\n显示CPU利用率，即实例的CPU使用率，上限为100%。\n- \n\n内存\n\n显示内存利用率，即实例的内存使用率，上限为100%。\n- \n\n网络\n\n显示发送速率和接收速率，即在对应时间窗内平均发送速率和平均接收速率。\n- \n\n磁盘\n\n显示磁盘分区和空间数据。具体如下：\n\n- \n\n磁盘分区数据：包括系统分区和数据分区，其中数据分区为挂载作为数据盘的云盘分区。\n- \n\n磁盘空间数据：包括磁盘的总空间、已使用空间、剩余可用空间和使用率。\n\n对于ECI实例的监控数据，您可以通过DescribeContainerGroupMetric和DescribeMultiContainerGroupMetric接口进行查询，然后进行二次开发计算。查询监控数据时，系统将同时返回容器组，以及容器组内容器的监控数据：\n\n- \n\n返回结构体的根节点Records中包含容器组整体的监控数据（CPU、内存、网络和磁盘数据）。\n- \n\n返回结构体的子节点Containers中包含各个容器的监控数据（CPU和内存数据）。\n\n更多信息，请参见[DescribeContainerGroupMetric](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describecontainergroupmetric)和[DescribeMultiContainerGroupMetric](https://help.aliyun.com/zh/eci/developer-reference/api-eci-2018-08-08-describemulticontainergroupmetric)。\n## CPU指标计算方式\n\n调用OpenAPI接口可以获取的CPU原始数据如下：\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nUsageNanoCores\n\nLong\n\n0\n\nCPU在采样窗口内的使用量（纳秒）。\n\nUsageCoreNanoSeconds\n\nLong\n\n70769883\n\nCPU历史使用总量。\n\nLoad\n\nLong\n\n0\n\n最近10秒的平均负载情况。\n\nLimit\n\nLong\n\n2000\n\nCPU使用上限（CPU核数*1000）。\n\nCPU相关指标计算方式如下：\n\n- \n\nCPU核数利用率=UsageNanoCores/109\n- \n\nCPU利用率=UsageNanoCores/Limit/106\n\n## 内存指标计算方式\n\n调用openAPI接口可以获取的内存原始数据如下：\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nAvailableBytes\n\nLong\n\n4289445888\n\n可用内存。\n\nUsageBytes\n\nLong\n\n11153408\n\n已使用内存。\n\nCache\n\nLong\n\n7028736\n\n缓存。\n\nWorkingSet\n\nLong\n\n5521408\n\n当前内存工作集使用量。\n\nRss\n\nLong\n\n1593344\n\n常驻内存集，即实际使用的物理内存。\n\n内存相关指标计算方式如下：\n\n内存利用率=WorkingSet/（WorkingSet + AvailableBytes）\n## 网络指标计算方式\n\n调用openAPI接口可以获取的网络原始数据如下：\n\n[表格]\n\n名称\n\n类型\n\n示例值\n\n描述\n\nTxBytes\n\nLong\n\n1381805699\n\n累计发送字节数。\n\nRxBytes\n\nLong\n\n505001954\n\n累计接收字节数。\n\nTxErrors\n\nLong\n\n0\n\n累计发送错误数。\n\nRxErrors\n\nLong\n\n0\n\n累计接收错误数。\n\nTxPackets\n\nLong\n\n5158427\n\n累计发送包数量。\n\nRxPackets\n\nLong\n\n4800583\n\n累计接收包数量。\n\nTxDrops\n\nLong\n\n0\n\n累计发送丢包数。\n\nRxDrops\n\nLong\n\n0\n\n累计接收丢包数。\n\nName\n\nString\n\neth0\n\n网卡名称。\n\n网络相关指标计算方式如下：\n\n- \n\n网络带宽速率（每秒发送比特数，单位为bps）\n\n网络带宽速率=（B时刻的累计发送字节数-A时刻的累计发送字节数）/A时刻和B时刻之间的秒数*8\n- \n\n网络吞吐率（每秒发送包数量，单位为pps）\n\n网络吞吐率=（B时刻的累计发送包数量-A时刻的累计发送包数量）/A时刻和B时刻之间的秒数\n"}
